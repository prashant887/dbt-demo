2021-09-29 18:09:29.964700 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:09:33.086848 (MainThread): Loading KWallet
2021-09-29 18:09:33.088195 (MainThread): Loading SecretService
2021-09-29 18:09:33.089356 (MainThread): Loading Windows
2021-09-29 18:09:33.090581 (MainThread): Loading chainer
2021-09-29 18:09:33.091318 (MainThread): Loading macOS
2021-09-29 18:09:33.741425 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.741548 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.741641 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.741724 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.770198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:09:33.772636 (MainThread): Tracking: tracking
2021-09-29 18:09:33.773121 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d3614af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4a47670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4a47ac0>]}
2021-09-29 18:09:33.778117 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.778361 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.778529 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.778677 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.785992 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.786320 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.786550 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.786767 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:09:33.794031 (MainThread): Partial parsing not enabled
2021-09-29 18:09:33.837169 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:09:33.841268 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:09:33.893569 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:09:33.899663 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:09:33.906275 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:09:33.908224 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:09:33.912707 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:09:33.924846 (MainThread): Parsing macros/core.sql
2021-09-29 18:09:33.930999 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:09:33.940289 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:09:33.952463 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:09:33.954443 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:09:33.979989 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:09:34.052783 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:09:34.087453 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:09:34.091340 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:09:34.107693 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:09:34.140188 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:09:34.164342 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:09:34.185129 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:09:34.203241 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:09:34.213263 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:09:34.215587 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:09:34.218044 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:09:34.220639 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:09:34.233891 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:09:34.236418 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:09:34.238529 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:09:34.329428 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:09:34.332216 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:09:34.334447 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:09:34.336744 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:09:34.556556 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:09:34.564910 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:09:34.606530 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b43bfc09-62cf-4e66-8bf1-8319ea86bbd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d56490a0>]}
2021-09-29 18:09:34.611196 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b43bfc09-62cf-4e66-8bf1-8319ea86bbd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d55888e0>]}
2021-09-29 18:09:34.611443 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-09-29 18:09:34.612494 (MainThread): 
2021-09-29 18:09:34.612941 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:09:34.613790 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-29 18:09:34.625356 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-29 18:09:34.625523 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-29 18:09:34.625647 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-29 18:09:37.533600 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.91 seconds
2021-09-29 18:09:37.535500 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-29 18:09:38.174484 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:09:38.181850 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:09:38.182075 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-29 18:09:38.182234 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:09:40.206762 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 2.02 seconds
2021-09-29 18:09:40.208103 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-29 18:09:41.113420 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:09:41.115456 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:09:41.115626 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_dbt_test__audit"} */

    show terse objects in DEMO_DB.PUBLIC_dbt_test__audit
2021-09-29 18:09:41.115763 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:09:42.825933 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4721-0000-36dd-0000-cdb90002000e
2021-09-29 18:09:42.826146 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-29 18:09:42.826352 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-29 18:09:42.826502 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-29 18:09:42.826697 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: Close
2021-09-29 18:09:43.753881 (MainThread): 23:39:43 | Concurrency: 1 threads (target='dev')
2021-09-29 18:09:43.754143 (MainThread): 23:39:43 | 
2021-09-29 18:09:43.755026 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:09:43.755342 (Thread-1): 23:39:43 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-29 18:09:43.755666 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:09:43.755845 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:09:43.758456 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:09:43.759603 (Thread-1): finished collecting timing info
2021-09-29 18:09:43.788489 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:09:43.790497 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:09:43.790696 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-29 18:09:43.790854 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:09:46.635556 (Thread-1): SQL status: SUCCESS 1 in 2.84 seconds
2021-09-29 18:09:46.657326 (Thread-1): finished collecting timing info
2021-09-29 18:09:46.657656 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-29 18:09:47.337670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43bfc09-62cf-4e66-8bf1-8319ea86bbd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d5c162b0>]}
2021-09-29 18:09:47.338139 (Thread-1): 23:39:47 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.58s]
2021-09-29 18:09:47.338348 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:09:47.338931 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:09:47.339277 (Thread-1): 23:39:47 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-29 18:09:47.339642 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:09:47.339810 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:09:47.342309 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:09:47.342879 (Thread-1): finished collecting timing info
2021-09-29 18:09:47.358737 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:09:47.359735 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:09:47.359916 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-29 18:09:47.360070 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:09:49.439591 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2021-09-29 18:09:49.441669 (Thread-1): finished collecting timing info
2021-09-29 18:09:49.441916 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-29 18:09:50.082525 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43bfc09-62cf-4e66-8bf1-8319ea86bbd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d5c16310>]}
2021-09-29 18:09:50.083116 (Thread-1): 23:39:50 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.74s]
2021-09-29 18:09:50.083333 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:09:50.084655 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:09:50.085167 (MainThread): 23:39:50 | 
2021-09-29 18:09:50.085417 (MainThread): 23:39:50 | Finished running 1 table model, 1 view model in 15.47s.
2021-09-29 18:09:50.085658 (MainThread): Connection 'master' was properly closed.
2021-09-29 18:09:50.085810 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-29 18:09:50.091977 (MainThread): 
2021-09-29 18:09:50.092351 (MainThread): Completed successfully
2021-09-29 18:09:50.092721 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-09-29 18:09:50.093169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d5677bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d564c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d5691c70>]}
2021-09-29 18:09:50.093498 (MainThread): Flushing usage events
2021-09-29 18:34:43.354619 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:34:45.365439 (MainThread): Loading KWallet
2021-09-29 18:34:45.367070 (MainThread): Loading SecretService
2021-09-29 18:34:45.368727 (MainThread): Loading Windows
2021-09-29 18:34:45.371712 (MainThread): Loading chainer
2021-09-29 18:34:45.373768 (MainThread): Loading macOS
2021-09-29 18:34:45.945230 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.945357 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.945450 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.945536 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.981474 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:34:45.984706 (MainThread): Tracking: tracking
2021-09-29 18:34:45.985119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f8f14ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fa447d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fa447160>]}
2021-09-29 18:34:45.992041 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.992403 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.992578 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.992730 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.999125 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.999358 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.999544 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:45.999699 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:34:46.005050 (MainThread): Partial parsing not enabled
2021-09-29 18:34:46.044679 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:34:46.048441 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:34:46.119586 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:34:46.125078 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:34:46.131229 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:34:46.133566 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:34:46.138463 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:34:46.151022 (MainThread): Parsing macros/core.sql
2021-09-29 18:34:46.158150 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:34:46.168413 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:34:46.182735 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:34:46.185718 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:34:46.211004 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:34:46.264698 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:34:46.298634 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:34:46.301114 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:34:46.314987 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:34:46.341067 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:34:46.362823 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:34:46.374061 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:34:46.384725 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:34:46.389768 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:34:46.391431 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:34:46.392745 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:34:46.394831 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:34:46.405770 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:34:46.408278 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:34:46.410236 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:34:46.485011 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:34:46.487234 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:34:46.488758 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:34:46.490733 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:34:46.738059 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:34:46.749864 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:34:46.754194 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:34:46.758724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6faebe820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fb048f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6fb051fa0>]}
2021-09-29 18:34:46.759212 (MainThread): Flushing usage events
2021-09-29 18:34:48.497058 (MainThread): Connection 'model.dbt_demo_project.sales_models' was properly closed.
2021-09-29 18:34:48.497343 (MainThread): Encountered an error:
2021-09-29 18:34:48.497561 (MainThread): Compilation Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  The source name (first) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
2021-09-29 18:34:48.507397 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 385, in parse_node
    self.render_update(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/models.py", line 58, in render_update
    super().render_update(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 360, in render_update
    self.render_with_context(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 273, in render_with_context
    get_rendered(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/providers.py", line 273, in __call__
    self.validate_args(args[0], args[1])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/providers.py", line 257, in validate_args
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  The source name (first) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>

2021-09-29 18:37:45.066455 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:37:46.132463 (MainThread): Loading KWallet
2021-09-29 18:37:46.133781 (MainThread): Loading SecretService
2021-09-29 18:37:46.134982 (MainThread): Loading Windows
2021-09-29 18:37:46.136294 (MainThread): Loading chainer
2021-09-29 18:37:46.137016 (MainThread): Loading macOS
2021-09-29 18:37:46.642620 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.642733 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.642829 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.642907 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.669695 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:37:46.672015 (MainThread): Tracking: tracking
2021-09-29 18:37:46.672435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd816853be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd817b48a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd817b48640>]}
2021-09-29 18:37:46.676648 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.676867 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.677025 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.677171 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.683211 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.683433 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.683596 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.683748 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:37:46.688354 (MainThread): Partial parsing not enabled
2021-09-29 18:37:46.720594 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:37:46.723339 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:37:46.762287 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:37:46.766290 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:37:46.771227 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:37:46.772889 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:37:46.776835 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:37:46.788704 (MainThread): Parsing macros/core.sql
2021-09-29 18:37:46.793581 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:37:46.801503 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:37:46.813000 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:37:46.814936 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:37:46.836326 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:37:46.877272 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:37:46.897667 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:37:46.899312 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:37:46.910069 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:37:46.929309 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:37:46.942464 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:37:46.950180 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:37:46.958072 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:37:46.962050 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:37:46.962877 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:37:46.963764 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:37:46.965137 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:37:46.973769 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:37:46.975491 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:37:46.976994 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:37:47.030970 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:37:47.032632 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:37:47.034020 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:37:47.035505 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:37:47.214623 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:37:47.222949 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:37:47.225715 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:37:47.228604 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8187c54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818849880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818849670>]}
2021-09-29 18:37:47.228832 (MainThread): Flushing usage events
2021-09-29 18:37:49.094539 (MainThread): Connection 'model.dbt_demo_project.sales_models' was properly closed.
2021-09-29 18:37:49.094840 (MainThread): Encountered an error:
2021-09-29 18:37:49.095104 (MainThread): Compilation Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  The source name (first) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
2021-09-29 18:37:49.104574 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 385, in parse_node
    self.render_update(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/models.py", line 58, in render_update
    super().render_update(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 360, in render_update
    self.render_with_context(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 273, in render_with_context
    get_rendered(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/providers.py", line 273, in __call__
    self.validate_args(args[0], args[1])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/providers.py", line 257, in validate_args
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  The source name (first) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>

2021-09-29 18:38:29.359563 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:38:30.003821 (MainThread): Loading KWallet
2021-09-29 18:38:30.004581 (MainThread): Loading SecretService
2021-09-29 18:38:30.005210 (MainThread): Loading Windows
2021-09-29 18:38:30.006002 (MainThread): Loading chainer
2021-09-29 18:38:30.006479 (MainThread): Loading macOS
2021-09-29 18:38:30.312479 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.312654 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.312751 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.312833 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.337246 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:38:30.338784 (MainThread): Tracking: tracking
2021-09-29 18:38:30.339156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a814dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31ba17d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31ba179a0>]}
2021-09-29 18:38:30.342749 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.342913 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.343036 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.343150 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.347927 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.348103 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.348261 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.348414 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:38:30.352454 (MainThread): Partial parsing not enabled
2021-09-29 18:38:30.371430 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:38:30.373668 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:38:30.410507 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:38:30.414126 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:38:30.418135 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:38:30.419499 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:38:30.422441 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:38:30.430955 (MainThread): Parsing macros/core.sql
2021-09-29 18:38:30.434405 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:38:30.442155 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:38:30.453378 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:38:30.455013 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:38:30.472844 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:38:30.510955 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:38:30.532379 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:38:30.533996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:38:30.544239 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:38:30.564161 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:38:30.578441 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:38:30.586093 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:38:30.593602 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:38:30.597158 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:38:30.597980 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:38:30.598841 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:38:30.600268 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:38:30.608148 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:38:30.609812 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:38:30.611374 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:38:30.664804 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:38:30.666487 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:38:30.667548 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:38:30.668731 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:38:30.848165 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:38:30.856751 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:38:30.859930 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:38:30.916101 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb808bd-9129-4647-92f0-746ec38a5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31c760040>]}
2021-09-29 18:38:30.973718 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb808bd-9129-4647-92f0-746ec38a5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31c5f83d0>]}
2021-09-29 18:38:30.974123 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-29 18:38:30.975413 (MainThread): 
2021-09-29 18:38:30.975882 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:38:30.976890 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-29 18:38:30.991515 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-29 18:38:30.991731 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-29 18:38:30.991882 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-29 18:38:33.861425 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.87 seconds
2021-09-29 18:38:33.862691 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-29 18:38:34.478083 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:38:34.484962 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:38:34.485157 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-29 18:38:34.485341 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:38:36.203210 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.72 seconds
2021-09-29 18:38:36.205147 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-29 18:38:36.994216 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:38:36.996148 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:38:36.996297 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_dbt_test__audit"} */

    show terse objects in DEMO_DB.PUBLIC_dbt_test__audit
2021-09-29 18:38:36.996425 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:38:39.039954 (ThreadPoolExecutor-1_0): Snowflake query id: 019f473e-0000-36dc-0000-cdb90001f02a
2021-09-29 18:38:39.040149 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-29 18:38:39.040341 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-29 18:38:39.040485 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-29 18:38:39.040657 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: Close
2021-09-29 18:38:39.651030 (MainThread): 00:08:39 | Concurrency: 1 threads (target='dev')
2021-09-29 18:38:39.651325 (MainThread): 00:08:39 | 
2021-09-29 18:38:39.652541 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:38:39.652945 (Thread-1): 00:08:39 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-29 18:38:39.653274 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:38:39.653454 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:38:39.657020 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:38:39.657674 (Thread-1): finished collecting timing info
2021-09-29 18:38:39.685754 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:38:39.687094 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:38:39.687294 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-29 18:38:39.687482 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:38:43.274081 (Thread-1): SQL status: SUCCESS 1 in 3.59 seconds
2021-09-29 18:38:43.284355 (Thread-1): finished collecting timing info
2021-09-29 18:38:43.284610 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-29 18:38:44.129117 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb808bd-9129-4647-92f0-746ec38a5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31cd56970>]}
2021-09-29 18:38:44.129484 (Thread-1): 00:08:44 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.48s]
2021-09-29 18:38:44.129677 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:38:44.129833 (Thread-1): Began running node model.dbt_demo_project.sales_models
2021-09-29 18:38:44.130182 (Thread-1): 00:08:44 | 2 of 3 START view model PUBLIC.sales_models.......................... [RUN]
2021-09-29 18:38:44.130488 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:38:44.130632 (Thread-1): Compiling model.dbt_demo_project.sales_models
2021-09-29 18:38:44.132776 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:38:44.133431 (Thread-1): finished collecting timing info
2021-09-29 18:38:44.149347 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:38:44.150639 (Thread-1): Using snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:38:44.150835 (Thread-1): On model.dbt_demo_project.sales_models: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.sales_models"} */

  create or replace  view DEMO_DB.PUBLIC.sales_models  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final;
2021-09-29 18:38:44.150984 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:38:46.539895 (Thread-1): Snowflake query id: 019f473e-0000-36dd-0000-cdb90002003e
2021-09-29 18:38:46.540088 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 19 unexpected ';'.
2021-09-29 18:38:46.540285 (Thread-1): finished collecting timing info
2021-09-29 18:38:46.540468 (Thread-1): On model.dbt_demo_project.sales_models: Close
2021-09-29 18:38:47.589060 (Thread-1): Database Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 19 unexpected ';'.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/sales_models.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 19 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 19 unexpected ';'.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/sales_models.sql
2021-09-29 18:38:47.591732 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb808bd-9129-4647-92f0-746ec38a5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31cd56730>]}
2021-09-29 18:38:47.592149 (Thread-1): 00:08:47 | 2 of 3 ERROR creating view model PUBLIC.sales_models................. [ERROR in 3.46s]
2021-09-29 18:38:47.592371 (Thread-1): Finished running node model.dbt_demo_project.sales_models
2021-09-29 18:38:47.592650 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:38:47.593088 (Thread-1): 00:08:47 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-29 18:38:47.593454 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:38:47.593624 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:38:47.595783 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:38:47.596638 (Thread-1): finished collecting timing info
2021-09-29 18:38:47.598839 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:38:47.599894 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:38:47.600087 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-29 18:38:47.600246 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:38:49.914458 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2021-09-29 18:38:49.916540 (Thread-1): finished collecting timing info
2021-09-29 18:38:49.916798 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-29 18:38:50.517344 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb808bd-9129-4647-92f0-746ec38a5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31cf23700>]}
2021-09-29 18:38:50.517762 (Thread-1): 00:08:50 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.92s]
2021-09-29 18:38:50.517961 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:38:50.519067 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:38:50.519414 (MainThread): 00:08:50 | 
2021-09-29 18:38:50.519581 (MainThread): 00:08:50 | Finished running 1 table model, 2 view models in 19.54s.
2021-09-29 18:38:50.519728 (MainThread): Connection 'master' was properly closed.
2021-09-29 18:38:50.519870 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-29 18:38:50.524949 (MainThread): 
2021-09-29 18:38:50.525171 (MainThread): Completed with 1 error and 0 warnings:
2021-09-29 18:38:50.525350 (MainThread): 
2021-09-29 18:38:50.525525 (MainThread): Database Error in model sales_models (models/snowflake_model_data/sales_models.sql)
2021-09-29 18:38:50.525680 (MainThread):   001003 (42000): SQL compilation error:
2021-09-29 18:38:50.525828 (MainThread):   syntax error line 6 at position 19 unexpected ';'.
2021-09-29 18:38:50.525972 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/sales_models.sql
2021-09-29 18:38:50.526128 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-09-29 18:38:50.526357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31c5f84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31c77aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31cc30910>]}
2021-09-29 18:38:50.526614 (MainThread): Flushing usage events
2021-09-29 18:39:23.266636 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:39:24.150996 (MainThread): Loading KWallet
2021-09-29 18:39:24.152078 (MainThread): Loading SecretService
2021-09-29 18:39:24.152973 (MainThread): Loading Windows
2021-09-29 18:39:24.154037 (MainThread): Loading chainer
2021-09-29 18:39:24.154789 (MainThread): Loading macOS
2021-09-29 18:39:24.606619 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.606725 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.606803 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.606874 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.629472 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:39:24.631222 (MainThread): Tracking: tracking
2021-09-29 18:39:24.631485 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e9713c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eab16d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eab16af0>]}
2021-09-29 18:39:24.634880 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.635046 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.635168 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.635282 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.640268 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.640468 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.640614 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.640781 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:39:24.644874 (MainThread): Partial parsing not enabled
2021-09-29 18:39:24.674112 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:39:24.676769 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:39:24.715215 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:39:24.718921 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:39:24.723029 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:39:24.724364 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:39:24.727238 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:39:24.735278 (MainThread): Parsing macros/core.sql
2021-09-29 18:39:24.739159 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:39:24.745807 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:39:24.756495 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:39:24.758402 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:39:24.779898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:39:24.822257 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:39:24.846151 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:39:24.848109 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:39:24.859494 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:39:24.878848 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:39:24.893008 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:39:24.900604 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:39:24.907777 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:39:24.911393 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:39:24.912224 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:39:24.913135 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:39:24.914628 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:39:24.923304 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:39:24.925579 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:39:24.927626 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:39:24.980500 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:39:24.982189 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:39:24.983246 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:39:24.984429 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:39:25.161710 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:39:25.170832 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:39:25.173838 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:39:25.229293 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04df5d67-ced2-488f-8709-c5e6a0782ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb8780a0>]}
2021-09-29 18:39:25.292253 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04df5d67-ced2-488f-8709-c5e6a0782ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb6f8340>]}
2021-09-29 18:39:25.292611 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-29 18:39:25.293932 (MainThread): 
2021-09-29 18:39:25.294501 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:39:25.295637 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-29 18:39:25.310274 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-29 18:39:25.310481 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-29 18:39:25.310635 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-29 18:39:27.481396 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.17 seconds
2021-09-29 18:39:27.483198 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-29 18:39:28.149892 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:39:28.157364 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:39:28.157547 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_dbt_test__audit"} */

    show terse objects in DEMO_DB.PUBLIC_dbt_test__audit
2021-09-29 18:39:28.157695 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:39:30.096345 (ThreadPoolExecutor-1_0): Snowflake query id: 019f473f-0000-36dc-0000-cdb90001f032
2021-09-29 18:39:30.096566 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-29 18:39:30.096787 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-29 18:39:30.096923 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-29 18:39:30.097110 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: Close
2021-09-29 18:39:30.730129 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:39:30.732127 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:39:30.732294 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-29 18:39:30.732437 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:39:32.453815 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.72 seconds
2021-09-29 18:39:32.455620 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-29 18:39:33.143964 (MainThread): 00:09:33 | Concurrency: 1 threads (target='dev')
2021-09-29 18:39:33.144265 (MainThread): 00:09:33 | 
2021-09-29 18:39:33.145400 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:39:33.145746 (Thread-1): 00:09:33 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-29 18:39:33.146084 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:39:33.146258 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:39:33.149875 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:39:33.150511 (Thread-1): finished collecting timing info
2021-09-29 18:39:33.179622 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:39:33.182120 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:39:33.182437 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-29 18:39:33.182679 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:39:36.274024 (Thread-1): SQL status: SUCCESS 1 in 3.09 seconds
2021-09-29 18:39:36.285161 (Thread-1): finished collecting timing info
2021-09-29 18:39:36.285427 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-29 18:39:36.931131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04df5d67-ced2-488f-8709-c5e6a0782ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ebb163d0>]}
2021-09-29 18:39:36.931552 (Thread-1): 00:09:36 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.79s]
2021-09-29 18:39:36.931754 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:39:36.931944 (Thread-1): Began running node model.dbt_demo_project.sales_models
2021-09-29 18:39:36.932289 (Thread-1): 00:09:36 | 2 of 3 START view model PUBLIC.sales_models.......................... [RUN]
2021-09-29 18:39:36.932718 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:39:36.932884 (Thread-1): Compiling model.dbt_demo_project.sales_models
2021-09-29 18:39:36.935495 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:39:36.936155 (Thread-1): finished collecting timing info
2021-09-29 18:39:36.952186 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:39:36.953763 (Thread-1): Using snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:39:36.953955 (Thread-1): On model.dbt_demo_project.sales_models: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.sales_models"} */

  create or replace  view DEMO_DB.PUBLIC.sales_models  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
  );
2021-09-29 18:39:36.954127 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:39:39.083796 (Thread-1): SQL status: SUCCESS 1 in 2.13 seconds
2021-09-29 18:39:39.085512 (Thread-1): finished collecting timing info
2021-09-29 18:39:39.085762 (Thread-1): On model.dbt_demo_project.sales_models: Close
2021-09-29 18:39:39.798625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04df5d67-ced2-488f-8709-c5e6a0782ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ebb163d0>]}
2021-09-29 18:39:39.799068 (Thread-1): 00:09:39 | 2 of 3 OK created view model PUBLIC.sales_models..................... [SUCCESS 1 in 2.87s]
2021-09-29 18:39:39.799275 (Thread-1): Finished running node model.dbt_demo_project.sales_models
2021-09-29 18:39:39.799470 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:39:39.799827 (Thread-1): 00:09:39 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-29 18:39:39.800194 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:39:39.800366 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:39:39.802590 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:39:39.803157 (Thread-1): finished collecting timing info
2021-09-29 18:39:39.805395 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:39:39.806285 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:39:39.806504 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-29 18:39:39.806663 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:39:41.924466 (Thread-1): SQL status: SUCCESS 1 in 2.12 seconds
2021-09-29 18:39:41.925935 (Thread-1): finished collecting timing info
2021-09-29 18:39:41.926148 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-29 18:39:42.548099 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04df5d67-ced2-488f-8709-c5e6a0782ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ebcafd60>]}
2021-09-29 18:39:42.548544 (Thread-1): 00:09:42 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.75s]
2021-09-29 18:39:42.548789 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:39:42.549922 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:39:42.550282 (MainThread): 00:09:42 | 
2021-09-29 18:39:42.550469 (MainThread): 00:09:42 | Finished running 1 table model, 2 view models in 17.26s.
2021-09-29 18:39:42.550652 (MainThread): Connection 'master' was properly closed.
2021-09-29 18:39:42.550791 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-29 18:39:42.556580 (MainThread): 
2021-09-29 18:39:42.556891 (MainThread): Completed successfully
2021-09-29 18:39:42.557107 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-09-29 18:39:42.557429 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb789910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb6f8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb71cdf0>]}
2021-09-29 18:39:42.557726 (MainThread): Flushing usage events
2021-09-29 18:44:53.192819 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:44:54.271641 (MainThread): Loading KWallet
2021-09-29 18:44:54.273193 (MainThread): Loading SecretService
2021-09-29 18:44:54.274584 (MainThread): Loading Windows
2021-09-29 18:44:54.275972 (MainThread): Loading chainer
2021-09-29 18:44:54.276740 (MainThread): Loading macOS
2021-09-29 18:44:54.755991 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.756108 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.756190 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.756266 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.783515 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:44:54.785764 (MainThread): Tracking: tracking
2021-09-29 18:44:54.786117 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb6f0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfcb49670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfcb49ac0>]}
2021-09-29 18:44:54.790912 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.791120 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.791272 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.791414 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.797185 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.797390 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.797543 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.797689 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:44:54.802720 (MainThread): Partial parsing not enabled
2021-09-29 18:44:54.840716 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:44:54.843077 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:44:54.882785 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:44:54.887943 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:44:54.893099 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:44:54.894815 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:44:54.898518 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:44:54.909602 (MainThread): Parsing macros/core.sql
2021-09-29 18:44:54.914471 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:44:54.922633 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:44:54.933288 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:44:54.934857 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:44:54.951357 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:44:54.985757 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:44:55.006791 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:44:55.008524 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:44:55.019505 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:44:55.041007 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:44:55.058913 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:44:55.069425 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:44:55.079693 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:44:55.085299 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:44:55.086545 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:44:55.087808 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:44:55.089789 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:44:55.101311 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:44:55.103936 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:44:55.106067 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:44:55.180241 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:44:55.182940 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:44:55.184653 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:44:55.186599 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:44:55.449183 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:44:55.460474 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:44:55.464199 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:44:55.522891 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0d3adf6-45e4-4ade-83b1-0c0085aa50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfd85c5b0>]}
2021-09-29 18:44:55.581094 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0d3adf6-45e4-4ade-83b1-0c0085aa50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb79e550>]}
2021-09-29 18:44:55.581478 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-29 18:44:55.582774 (MainThread): 
2021-09-29 18:44:55.583229 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:44:55.584379 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-29 18:44:55.598463 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-29 18:44:55.598674 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-29 18:44:55.598829 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-29 18:44:58.260806 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.66 seconds
2021-09-29 18:44:58.262594 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-29 18:44:58.885187 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:44:58.892371 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:44:58.892585 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-29 18:44:58.892743 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:45:01.038431 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 2.15 seconds
2021-09-29 18:45:01.040599 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-29 18:45:01.846195 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:45:01.848650 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:45:01.848823 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_dbt_test__audit"} */

    show terse objects in DEMO_DB.PUBLIC_dbt_test__audit
2021-09-29 18:45:01.848969 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:45:04.441592 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4745-0000-36dc-0000-cdb90001f0a6
2021-09-29 18:45:04.441792 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-29 18:45:04.441989 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-29 18:45:04.442118 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-29 18:45:04.442292 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: Close
2021-09-29 18:45:05.227064 (MainThread): 00:15:05 | Concurrency: 1 threads (target='dev')
2021-09-29 18:45:05.227380 (MainThread): 00:15:05 | 
2021-09-29 18:45:05.228565 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:45:05.228950 (Thread-1): 00:15:05 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-29 18:45:05.229347 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:45:05.229587 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:45:05.233266 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:45:05.234971 (Thread-1): finished collecting timing info
2021-09-29 18:45:05.263612 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:45:05.265303 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:45:05.265557 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-29 18:45:05.265741 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:45:07.969775 (Thread-1): SQL status: SUCCESS 1 in 2.70 seconds
2021-09-29 18:45:07.981378 (Thread-1): finished collecting timing info
2021-09-29 18:45:07.981641 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-29 18:45:08.607914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0d3adf6-45e4-4ade-83b1-0c0085aa50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfdb579d0>]}
2021-09-29 18:45:08.608423 (Thread-1): 00:15:08 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-09-29 18:45:08.608640 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:45:08.608853 (Thread-1): Began running node model.dbt_demo_project.sales_models
2021-09-29 18:45:08.609117 (Thread-1): 00:15:08 | 2 of 3 START view model PUBLIC.sales_models.......................... [RUN]
2021-09-29 18:45:08.609681 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:45:08.609868 (Thread-1): Compiling model.dbt_demo_project.sales_models
2021-09-29 18:45:08.612381 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:45:08.612993 (Thread-1): finished collecting timing info
2021-09-29 18:45:08.629068 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:45:08.630221 (Thread-1): Using snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:45:08.630407 (Thread-1): On model.dbt_demo_project.sales_models: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.sales_models"} */

  create or replace  view DEMO_DB.PUBLIC.sales_models  as (
    with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customers
),
final as (select * from store_sales)
select * from final
  );
2021-09-29 18:45:08.630563 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:45:10.740153 (Thread-1): Snowflake query id: 019f4745-0000-36dc-0000-cdb90001f0ae
2021-09-29 18:45:10.740402 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
2021-09-29 18:45:10.740642 (Thread-1): finished collecting timing info
2021-09-29 18:45:10.740879 (Thread-1): On model.dbt_demo_project.sales_models: Close
2021-09-29 18:45:11.486418 (Thread-1): Database Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/sales_models.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_models (models/snowflake_model_data/sales_models.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/sales_models.sql
2021-09-29 18:45:11.489625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0d3adf6-45e4-4ade-83b1-0c0085aa50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfda8f730>]}
2021-09-29 18:45:11.490115 (Thread-1): 00:15:11 | 2 of 3 ERROR creating view model PUBLIC.sales_models................. [ERROR in 2.88s]
2021-09-29 18:45:11.490358 (Thread-1): Finished running node model.dbt_demo_project.sales_models
2021-09-29 18:45:11.490597 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:45:11.490900 (Thread-1): 00:15:11 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-29 18:45:11.491283 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:45:11.491603 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:45:11.493776 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:45:11.494351 (Thread-1): finished collecting timing info
2021-09-29 18:45:11.496548 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:45:11.497581 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:45:11.497786 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-29 18:45:11.497958 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:45:14.274842 (Thread-1): SQL status: SUCCESS 1 in 2.78 seconds
2021-09-29 18:45:14.276313 (Thread-1): finished collecting timing info
2021-09-29 18:45:14.276527 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-29 18:45:14.929463 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0d3adf6-45e4-4ade-83b1-0c0085aa50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfdbfb250>]}
2021-09-29 18:45:14.929986 (Thread-1): 00:15:14 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.44s]
2021-09-29 18:45:14.930233 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:45:14.931439 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:45:14.931798 (MainThread): 00:15:14 | 
2021-09-29 18:45:14.931984 (MainThread): 00:15:14 | Finished running 1 table model, 2 view models in 19.35s.
2021-09-29 18:45:14.932148 (MainThread): Connection 'master' was properly closed.
2021-09-29 18:45:14.932284 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-29 18:45:14.938342 (MainThread): 
2021-09-29 18:45:14.938631 (MainThread): Completed with 1 error and 0 warnings:
2021-09-29 18:45:14.938953 (MainThread): 
2021-09-29 18:45:14.939149 (MainThread): Database Error in model sales_models (models/snowflake_model_data/sales_models.sql)
2021-09-29 18:45:14.939371 (MainThread):   002003 (42S02): SQL compilation error:
2021-09-29 18:45:14.939537 (MainThread):   Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
2021-09-29 18:45:14.939727 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/sales_models.sql
2021-09-29 18:45:14.939917 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-09-29 18:45:14.940161 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfd6f84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfd6ec190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfd87abb0>]}
2021-09-29 18:45:14.940432 (MainThread): Flushing usage events
2021-09-29 18:46:41.775454 (MainThread): Running with dbt=0.21.0-b1
2021-09-29 18:46:42.920013 (MainThread): Loading KWallet
2021-09-29 18:46:42.921191 (MainThread): Loading SecretService
2021-09-29 18:46:42.922390 (MainThread): Loading Windows
2021-09-29 18:46:42.923877 (MainThread): Loading chainer
2021-09-29 18:46:42.924896 (MainThread): Loading macOS
2021-09-29 18:46:43.609756 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.609911 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.610029 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.610140 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.650205 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-29 18:46:43.653050 (MainThread): Tracking: tracking
2021-09-29 18:46:43.653586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95056b4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95068d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95068d5d00>]}
2021-09-29 18:46:43.663863 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.664166 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.664373 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.664572 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.673027 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.673639 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.673925 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.674176 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-29 18:46:43.682020 (MainThread): Partial parsing not enabled
2021-09-29 18:46:43.725323 (MainThread): Parsing macros/catalog.sql
2021-09-29 18:46:43.729967 (MainThread): Parsing macros/adapters.sql
2021-09-29 18:46:43.780393 (MainThread): Parsing macros/materializations/merge.sql
2021-09-29 18:46:43.784881 (MainThread): Parsing macros/materializations/seed.sql
2021-09-29 18:46:43.789704 (MainThread): Parsing macros/materializations/view.sql
2021-09-29 18:46:43.791144 (MainThread): Parsing macros/materializations/table.sql
2021-09-29 18:46:43.794458 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-29 18:46:43.804639 (MainThread): Parsing macros/core.sql
2021-09-29 18:46:43.808909 (MainThread): Parsing macros/materializations/test.sql
2021-09-29 18:46:43.817438 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-29 18:46:43.828719 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-29 18:46:43.830341 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-29 18:46:43.849581 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-29 18:46:43.885346 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-29 18:46:43.907493 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-29 18:46:43.909149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-29 18:46:43.919358 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-29 18:46:43.941564 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-29 18:46:43.956170 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-29 18:46:43.963822 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-29 18:46:43.971656 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-29 18:46:43.975257 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-29 18:46:43.976172 (MainThread): Parsing macros/etc/query.sql
2021-09-29 18:46:43.977055 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-29 18:46:43.978425 (MainThread): Parsing macros/etc/datetime.sql
2021-09-29 18:46:43.986668 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-29 18:46:43.988355 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-29 18:46:43.989763 (MainThread): Parsing macros/adapters/common.sql
2021-09-29 18:46:44.042654 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-29 18:46:44.044269 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-29 18:46:44.045513 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-29 18:46:44.046708 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-29 18:46:44.237384 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:46:44.246080 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:46:44.249011 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:46:44.304720 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fff6244-9def-4c64-ac94-5ddb507c19bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95077130a0>]}
2021-09-29 18:46:44.395644 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fff6244-9def-4c64-ac94-5ddb507c19bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95074b73d0>]}
2021-09-29 18:46:44.396233 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-29 18:46:44.397863 (MainThread): 
2021-09-29 18:46:44.398317 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:46:44.399241 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-29 18:46:44.418566 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-29 18:46:44.418832 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-29 18:46:44.419017 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-29 18:46:47.334808 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.92 seconds
2021-09-29 18:46:47.336726 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-29 18:46:47.987287 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:46:47.994737 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-29 18:46:47.994952 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-29 18:46:47.995107 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:46:49.693376 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 1.70 seconds
2021-09-29 18:46:49.695507 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-29 18:46:50.000031 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.221.191', 53642), raddr=('52.228.75.102', 443)>
2021-09-29 18:46:51.517910 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:46:51.519764 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-29 18:46:51.519918 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_dbt_test__audit"} */

    show terse objects in DEMO_DB.PUBLIC_dbt_test__audit
2021-09-29 18:46:51.520065 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-29 18:46:54.028316 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4746-0000-36dd-0000-cdb9000200da
2021-09-29 18:46:54.028529 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-29 18:46:54.028731 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-29 18:46:54.028867 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-29 18:46:54.029054 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: Close
2021-09-29 18:46:54.641055 (MainThread): 00:16:54 | Concurrency: 1 threads (target='dev')
2021-09-29 18:46:54.641313 (MainThread): 00:16:54 | 
2021-09-29 18:46:54.642262 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:46:54.642593 (Thread-1): 00:16:54 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-29 18:46:54.642938 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:46:54.643119 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:46:54.645784 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:46:54.647155 (Thread-1): finished collecting timing info
2021-09-29 18:46:54.676435 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-29 18:46:54.678056 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-29 18:46:54.678376 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-29 18:46:54.678579 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:46:57.020752 (Thread-1): SQL status: SUCCESS 1 in 2.34 seconds
2021-09-29 18:46:57.031994 (Thread-1): finished collecting timing info
2021-09-29 18:46:57.032235 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-29 18:46:57.654747 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.221.191', 53663), raddr=('52.228.75.102', 443)>
2021-09-29 18:46:57.657661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fff6244-9def-4c64-ac94-5ddb507c19bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95079804f0>]}
2021-09-29 18:46:57.658139 (Thread-1): 00:16:57 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.01s]
2021-09-29 18:46:57.658381 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-29 18:46:57.658615 (Thread-1): Began running node model.dbt_demo_project.sales_models
2021-09-29 18:46:57.659135 (Thread-1): 00:16:57 | 2 of 3 START view model PUBLIC.sales_models.......................... [RUN]
2021-09-29 18:46:57.659581 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:46:57.659772 (Thread-1): Compiling model.dbt_demo_project.sales_models
2021-09-29 18:46:57.662336 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:46:57.662997 (Thread-1): finished collecting timing info
2021-09-29 18:46:57.678919 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.sales_models"
2021-09-29 18:46:57.680002 (Thread-1): Using snowflake connection "model.dbt_demo_project.sales_models".
2021-09-29 18:46:57.680173 (Thread-1): On model.dbt_demo_project.sales_models: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.sales_models"} */

  create or replace  view DEMO_DB.PUBLIC.sales_models  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
  );
2021-09-29 18:46:57.680330 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:47:00.106986 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-09-29 18:47:00.108479 (Thread-1): finished collecting timing info
2021-09-29 18:47:00.108704 (Thread-1): On model.dbt_demo_project.sales_models: Close
2021-09-29 18:47:01.032970 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fff6244-9def-4c64-ac94-5ddb507c19bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9507bfc580>]}
2021-09-29 18:47:01.033508 (Thread-1): 00:17:01 | 2 of 3 OK created view model PUBLIC.sales_models..................... [SUCCESS 1 in 3.37s]
2021-09-29 18:47:01.033784 (Thread-1): Finished running node model.dbt_demo_project.sales_models
2021-09-29 18:47:01.034093 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:47:01.034505 (Thread-1): 00:17:01 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-29 18:47:01.034908 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:47:01.035078 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:47:01.037203 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:47:01.037787 (Thread-1): finished collecting timing info
2021-09-29 18:47:01.040041 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-29 18:47:01.041492 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-29 18:47:01.041760 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-29 18:47:01.041933 (Thread-1): Opening a new connection, currently in state closed
2021-09-29 18:47:03.166037 (Thread-1): SQL status: SUCCESS 1 in 2.12 seconds
2021-09-29 18:47:03.167859 (Thread-1): finished collecting timing info
2021-09-29 18:47:03.168114 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-29 18:47:04.011257 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fff6244-9def-4c64-ac94-5ddb507c19bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9507980460>]}
2021-09-29 18:47:04.011777 (Thread-1): 00:17:04 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.98s]
2021-09-29 18:47:04.012020 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-29 18:47:04.013257 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 18:47:04.013774 (MainThread): 00:17:04 | 
2021-09-29 18:47:04.013970 (MainThread): 00:17:04 | Finished running 1 table model, 2 view models in 19.62s.
2021-09-29 18:47:04.014137 (MainThread): Connection 'master' was properly closed.
2021-09-29 18:47:04.014273 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-29 18:47:04.019560 (MainThread): 
2021-09-29 18:47:04.019791 (MainThread): Completed successfully
2021-09-29 18:47:04.019985 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-09-29 18:47:04.020222 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95078aa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95074b7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95056b4d90>]}
2021-09-29 18:47:04.020491 (MainThread): Flushing usage events
2021-09-30 05:21:45.658340 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 05:21:46.427482 (MainThread): Loading KWallet
2021-09-30 05:21:46.428314 (MainThread): Loading SecretService
2021-09-30 05:21:46.428991 (MainThread): Loading Windows
2021-09-30 05:21:46.429828 (MainThread): Loading chainer
2021-09-30 05:21:46.430360 (MainThread): Loading macOS
2021-09-30 05:21:46.819808 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.819937 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.820033 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.820119 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.847861 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 05:21:46.850654 (MainThread): Tracking: tracking
2021-09-30 05:21:46.851080 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8d714e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8eb47b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8eb47610>]}
2021-09-30 05:21:46.855963 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.856231 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.856414 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.856592 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.862957 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.863253 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.863429 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.863583 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:21:46.868029 (MainThread): Partial parsing not enabled
2021-09-30 05:21:46.901744 (MainThread): Parsing macros/catalog.sql
2021-09-30 05:21:46.904486 (MainThread): Parsing macros/adapters.sql
2021-09-30 05:21:46.948583 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 05:21:46.952962 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 05:21:46.958211 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 05:21:46.960011 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 05:21:46.963921 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 05:21:46.974412 (MainThread): Parsing macros/core.sql
2021-09-30 05:21:46.978814 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 05:21:46.987086 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 05:21:47.000084 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 05:21:47.002155 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 05:21:47.024667 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 05:21:47.069111 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 05:21:47.094986 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 05:21:47.096996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 05:21:47.109580 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 05:21:47.133007 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 05:21:47.148826 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 05:21:47.158650 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 05:21:47.167563 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 05:21:47.172064 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 05:21:47.173192 (MainThread): Parsing macros/etc/query.sql
2021-09-30 05:21:47.174300 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 05:21:47.176069 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 05:21:47.185937 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 05:21:47.188157 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 05:21:47.189954 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 05:21:47.254538 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 05:21:47.256633 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 05:21:47.258253 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 05:21:47.259931 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 05:21:47.504902 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:21:47.515341 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:21:47.518908 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-30 05:21:47.589167 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aabd93f7-7b40-4cf2-8b63-8f6f6d44a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8f864040>]}
2021-09-30 05:21:47.653133 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aabd93f7-7b40-4cf2-8b63-8f6f6d44a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8f6f5460>]}
2021-09-30 05:21:47.653650 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 05:21:47.655495 (MainThread): 
2021-09-30 05:21:47.656510 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:21:47.657857 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 05:21:47.673216 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 05:21:47.673451 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 05:21:47.673611 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 05:21:49.611576 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.94 seconds
2021-09-30 05:21:49.613256 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 05:21:50.183523 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:21:50.191123 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:21:50.191367 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 05:21:50.191535 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:21:51.906438 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.71 seconds
2021-09-30 05:21:51.907899 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 05:21:52.469194 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:21:52.471192 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:21:52.471396 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit"} */

    show terse objects in DEMO_DB.SALES_SCHEMA_dbt_test__audit
2021-09-30 05:21:52.471550 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:21:54.058382 (ThreadPoolExecutor-1_0): Snowflake query id: 019f49c1-0000-36dc-0000-cdb90001f0e6
2021-09-30 05:21:54.058677 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 05:21:54.058906 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 05:21:54.059053 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 05:21:54.059259 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: Close
2021-09-30 05:21:54.621392 (MainThread): 10:51:54 | Concurrency: 1 threads (target='dev')
2021-09-30 05:21:54.621705 (MainThread): 10:51:54 | 
2021-09-30 05:21:54.622804 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:21:54.623186 (Thread-1): 10:51:54 | 1 of 3 START table model SALES_SCHEMA.my_first_dbt_model............. [RUN]
2021-09-30 05:21:54.623566 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:21:54.623760 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:21:54.627455 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:21:54.629421 (Thread-1): finished collecting timing info
2021-09-30 05:21:54.662938 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:21:54.665522 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:21:54.665747 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 05:21:54.665973 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:21:57.642629 (Thread-1): SQL status: SUCCESS 1 in 2.98 seconds
2021-09-30 05:21:57.653942 (Thread-1): finished collecting timing info
2021-09-30 05:21:57.654216 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 05:21:58.218563 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aabd93f7-7b40-4cf2-8b63-8f6f6d44a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8fc5b850>]}
2021-09-30 05:21:58.219117 (Thread-1): 10:51:58 | 1 of 3 OK created table model SALES_SCHEMA.my_first_dbt_model........ [SUCCESS 1 in 3.60s]
2021-09-30 05:21:58.219411 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:21:58.219626 (Thread-1): Began running node model.dbt_demo_project.sales_models
2021-09-30 05:21:58.220086 (Thread-1): 10:51:58 | 2 of 3 START view model SALES_SCHEMA.sales_models.................... [RUN]
2021-09-30 05:21:58.220598 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.sales_models".
2021-09-30 05:21:58.220793 (Thread-1): Compiling model.dbt_demo_project.sales_models
2021-09-30 05:21:58.223398 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.sales_models"
2021-09-30 05:21:58.224539 (Thread-1): finished collecting timing info
2021-09-30 05:21:58.241859 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.sales_models"
2021-09-30 05:21:58.244212 (Thread-1): Using snowflake connection "model.dbt_demo_project.sales_models".
2021-09-30 05:21:58.244496 (Thread-1): On model.dbt_demo_project.sales_models: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.sales_models"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.sales_models  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
  );
2021-09-30 05:21:58.244671 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:22:00.118078 (Thread-1): SQL status: SUCCESS 1 in 1.87 seconds
2021-09-30 05:22:00.120107 (Thread-1): finished collecting timing info
2021-09-30 05:22:00.120641 (Thread-1): On model.dbt_demo_project.sales_models: Close
2021-09-30 05:22:00.682034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aabd93f7-7b40-4cf2-8b63-8f6f6d44a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8fc5b160>]}
2021-09-30 05:22:00.682576 (Thread-1): 10:52:00 | 2 of 3 OK created view model SALES_SCHEMA.sales_models............... [SUCCESS 1 in 2.46s]
2021-09-30 05:22:00.682845 (Thread-1): Finished running node model.dbt_demo_project.sales_models
2021-09-30 05:22:00.683249 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:22:00.683637 (Thread-1): 10:52:00 | 3 of 3 START view model SALES_SCHEMA.my_second_dbt_model............. [RUN]
2021-09-30 05:22:00.684075 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:22:00.684266 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:22:00.686930 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:22:00.688745 (Thread-1): finished collecting timing info
2021-09-30 05:22:00.692018 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:22:00.693527 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:22:00.693760 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.SALES_SCHEMA.my_first_dbt_model
where id = 1
  );
2021-09-30 05:22:00.693924 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:22:02.446287 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-09-30 05:22:02.447871 (Thread-1): finished collecting timing info
2021-09-30 05:22:02.448099 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 05:22:03.012349 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aabd93f7-7b40-4cf2-8b63-8f6f6d44a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8ff41070>]}
2021-09-30 05:22:03.012815 (Thread-1): 10:52:03 | 3 of 3 OK created view model SALES_SCHEMA.my_second_dbt_model........ [SUCCESS 1 in 2.33s]
2021-09-30 05:22:03.013022 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:22:03.014035 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:22:03.014398 (MainThread): 10:52:03 | 
2021-09-30 05:22:03.014586 (MainThread): 10:52:03 | Finished running 1 table model, 2 view models in 15.36s.
2021-09-30 05:22:03.014752 (MainThread): Connection 'master' was properly closed.
2021-09-30 05:22:03.014887 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 05:22:03.020511 (MainThread): 
2021-09-30 05:22:03.021023 (MainThread): Completed successfully
2021-09-30 05:22:03.021500 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-09-30 05:22:03.022088 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8f6f5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8f87bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8fc7a880>]}
2021-09-30 05:22:03.022702 (MainThread): Flushing usage events
2021-09-30 05:43:03.540595 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 05:43:04.888671 (MainThread): Loading KWallet
2021-09-30 05:43:04.889949 (MainThread): Loading SecretService
2021-09-30 05:43:04.890855 (MainThread): Loading Windows
2021-09-30 05:43:04.892489 (MainThread): Loading chainer
2021-09-30 05:43:04.893249 (MainThread): Loading macOS
2021-09-30 05:43:05.397890 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.398017 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.398108 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.398210 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.433238 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 05:43:05.435439 (MainThread): Tracking: tracking
2021-09-30 05:43:05.435988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9939853b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ab49af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ab49ac0>]}
2021-09-30 05:43:05.441441 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.441699 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.441863 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.442012 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.449580 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.449822 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.449990 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.450198 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:43:05.454931 (MainThread): Partial parsing not enabled
2021-09-30 05:43:05.489104 (MainThread): Parsing macros/catalog.sql
2021-09-30 05:43:05.491445 (MainThread): Parsing macros/adapters.sql
2021-09-30 05:43:05.546419 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 05:43:05.555050 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 05:43:05.562932 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 05:43:05.565174 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 05:43:05.570827 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 05:43:05.580586 (MainThread): Parsing macros/core.sql
2021-09-30 05:43:05.585687 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 05:43:05.594585 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 05:43:05.607468 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 05:43:05.609680 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 05:43:05.631611 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 05:43:05.676000 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 05:43:05.701510 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 05:43:05.703679 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 05:43:05.717101 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 05:43:05.741388 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 05:43:05.763351 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 05:43:05.777033 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 05:43:05.787180 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 05:43:05.792229 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 05:43:05.793572 (MainThread): Parsing macros/etc/query.sql
2021-09-30 05:43:05.794896 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 05:43:05.797430 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 05:43:05.811209 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 05:43:05.833253 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 05:43:05.835426 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 05:43:05.900946 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 05:43:05.903115 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 05:43:05.904240 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 05:43:05.905444 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 05:43:06.085689 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:43:06.095605 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:43:06.099284 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:43:06.102995 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:43:06.225521 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ac78b4-d24c-42a5-8c39-01437a11384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993b6eb370>]}
2021-09-30 05:43:06.232172 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ac78b4-d24c-42a5-8c39-01437a11384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993b6eb4f0>]}
2021-09-30 05:43:06.232737 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 05:43:06.234413 (MainThread): 
2021-09-30 05:43:06.234887 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:43:06.235950 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 05:43:06.250855 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 05:43:06.251080 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 05:43:06.251241 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 05:43:08.260273 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.01 seconds
2021-09-30 05:43:08.262038 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 05:43:08.828174 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:43:08.835763 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:43:08.835994 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 05:43:08.836147 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:43:10.465335 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.63 seconds
2021-09-30 05:43:10.469257 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 05:43:11.040634 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:43:11.042964 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:43:11.043258 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit"} */

    show terse objects in DEMO_DB.SALES_SCHEMA_dbt_test__audit
2021-09-30 05:43:11.043438 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:43:12.868187 (ThreadPoolExecutor-1_0): Snowflake query id: 019f49d7-0000-36de-0000-cdb900021072
2021-09-30 05:43:12.868503 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 05:43:12.868796 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 05:43:12.868999 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 05:43:12.869303 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: Close
2021-09-30 05:43:13.428589 (MainThread): 11:13:13 | Concurrency: 1 threads (target='dev')
2021-09-30 05:43:13.428860 (MainThread): 11:13:13 | 
2021-09-30 05:43:13.429911 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 05:43:13.430257 (Thread-1): 11:13:13 | 1 of 4 START view model SALES_SCHEMA.cust_count_by_state............. [RUN]
2021-09-30 05:43:13.430592 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:43:13.430772 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 05:43:13.433743 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 05:43:13.435596 (Thread-1): finished collecting timing info
2021-09-30 05:43:13.460481 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 05:43:13.461650 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:43:13.461875 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.cust_count_by_state  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
  );
2021-09-30 05:43:13.462064 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:43:15.140288 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-09-30 05:43:15.148065 (Thread-1): finished collecting timing info
2021-09-30 05:43:15.148353 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 05:43:15.717025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac78b4-d24c-42a5-8c39-01437a11384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993bd1d730>]}
2021-09-30 05:43:15.717540 (Thread-1): 11:13:15 | 1 of 4 OK created view model SALES_SCHEMA.cust_count_by_state........ [SUCCESS 1 in 2.29s]
2021-09-30 05:43:15.717769 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 05:43:15.717976 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 05:43:15.718328 (Thread-1): 11:13:15 | 2 of 4 START view model SALES_SCHEMA.customer........................ [RUN]
2021-09-30 05:43:15.718700 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:43:15.718887 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 05:43:15.721462 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 05:43:15.722089 (Thread-1): finished collecting timing info
2021-09-30 05:43:15.723971 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 05:43:15.724935 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:43:15.725096 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.customer  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
  );
2021-09-30 05:43:15.725249 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:43:17.406832 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-09-30 05:43:17.408286 (Thread-1): finished collecting timing info
2021-09-30 05:43:17.408504 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 05:43:17.668095 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 56162), raddr=('52.228.75.102', 443)>
2021-09-30 05:43:18.873443 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac78b4-d24c-42a5-8c39-01437a11384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993bd1d580>]}
2021-09-30 05:43:18.873909 (Thread-1): 11:13:18 | 2 of 4 OK created view model SALES_SCHEMA.customer................... [SUCCESS 1 in 3.15s]
2021-09-30 05:43:18.874123 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 05:43:18.874324 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:43:18.874685 (Thread-1): 11:13:18 | 3 of 4 START table model SALES_SCHEMA.my_first_dbt_model............. [RUN]
2021-09-30 05:43:18.875060 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:43:18.875249 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:43:18.877452 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:43:18.878798 (Thread-1): finished collecting timing info
2021-09-30 05:43:18.898447 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:43:18.900660 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:43:18.900871 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 05:43:18.901031 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:43:21.849050 (Thread-1): SQL status: SUCCESS 1 in 2.95 seconds
2021-09-30 05:43:21.855400 (Thread-1): finished collecting timing info
2021-09-30 05:43:21.855739 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 05:43:22.454653 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac78b4-d24c-42a5-8c39-01437a11384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993bd1d3a0>]}
2021-09-30 05:43:22.455117 (Thread-1): 11:13:22 | 3 of 4 OK created table model SALES_SCHEMA.my_first_dbt_model........ [SUCCESS 1 in 3.58s]
2021-09-30 05:43:22.455326 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:43:22.455906 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:43:22.456239 (Thread-1): 11:13:22 | 4 of 4 START view model SALES_SCHEMA.my_second_dbt_model............. [RUN]
2021-09-30 05:43:22.456580 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:43:22.456753 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:43:22.458949 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:43:22.459554 (Thread-1): finished collecting timing info
2021-09-30 05:43:22.461758 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:43:22.462655 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:43:22.462819 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.SALES_SCHEMA.my_first_dbt_model
where id = 1
  );
2021-09-30 05:43:22.462967 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:43:24.319784 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2021-09-30 05:43:24.321214 (Thread-1): finished collecting timing info
2021-09-30 05:43:24.321434 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 05:43:24.874736 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac78b4-d24c-42a5-8c39-01437a11384c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993bf13940>]}
2021-09-30 05:43:24.875261 (Thread-1): 11:13:24 | 4 of 4 OK created view model SALES_SCHEMA.my_second_dbt_model........ [SUCCESS 1 in 2.42s]
2021-09-30 05:43:24.875511 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:43:24.876729 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:43:24.877092 (MainThread): 11:13:24 | 
2021-09-30 05:43:24.877294 (MainThread): 11:13:24 | Finished running 3 view models, 1 table model in 18.64s.
2021-09-30 05:43:24.877465 (MainThread): Connection 'master' was properly closed.
2021-09-30 05:43:24.877600 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 05:43:24.884331 (MainThread): 
2021-09-30 05:43:24.884631 (MainThread): Completed successfully
2021-09-30 05:43:24.884826 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 05:43:24.885065 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993b67efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993bf11a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993bf11f40>]}
2021-09-30 05:43:24.885335 (MainThread): Flushing usage events
2021-09-30 05:47:46.663741 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 05:47:47.787614 (MainThread): Loading KWallet
2021-09-30 05:47:47.788863 (MainThread): Loading SecretService
2021-09-30 05:47:47.789907 (MainThread): Loading Windows
2021-09-30 05:47:47.791030 (MainThread): Loading chainer
2021-09-30 05:47:47.791696 (MainThread): Loading macOS
2021-09-30 05:47:48.273834 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.273963 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.274054 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.274139 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.307758 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 05:47:48.311871 (MainThread): Tracking: tracking
2021-09-30 05:47:48.312739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2af13c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2c308670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2c308ac0>]}
2021-09-30 05:47:48.318424 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.318672 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.318835 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.318984 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.325519 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.325764 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.325931 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.326084 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:47:48.331311 (MainThread): Partial parsing not enabled
2021-09-30 05:47:48.372061 (MainThread): Parsing macros/catalog.sql
2021-09-30 05:47:48.375302 (MainThread): Parsing macros/adapters.sql
2021-09-30 05:47:48.429102 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 05:47:48.435276 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 05:47:48.444667 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 05:47:48.447492 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 05:47:48.454179 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 05:47:48.470739 (MainThread): Parsing macros/core.sql
2021-09-30 05:47:48.476160 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 05:47:48.485503 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 05:47:48.499945 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 05:47:48.503155 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 05:47:48.528478 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 05:47:48.576072 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 05:47:48.606910 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 05:47:48.609314 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 05:47:48.623582 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 05:47:48.651839 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 05:47:48.672394 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 05:47:48.682207 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 05:47:48.691848 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 05:47:48.696801 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 05:47:48.697837 (MainThread): Parsing macros/etc/query.sql
2021-09-30 05:47:48.698994 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 05:47:48.700752 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 05:47:48.711964 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 05:47:48.714807 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 05:47:48.716668 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 05:47:48.777747 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 05:47:48.779812 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 05:47:48.781222 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 05:47:48.782893 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 05:47:48.974560 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:47:48.983973 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:47:48.987609 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:47:48.991419 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:47:49.113654 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07a7309d-7937-485f-b891-cc15bf1a149e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2cfad640>]}
2021-09-30 05:47:49.121232 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07a7309d-7937-485f-b891-cc15bf1a149e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2cfad640>]}
2021-09-30 05:47:49.121645 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 05:47:49.123072 (MainThread): 
2021-09-30 05:47:49.123532 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:47:49.124636 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 05:47:49.139200 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 05:47:49.139421 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 05:47:49.139576 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 05:47:51.145648 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.01 seconds
2021-09-30 05:47:51.147317 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 05:47:51.714293 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:47:51.721318 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:47:51.721514 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 05:47:51.721667 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:47:53.422045 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.70 seconds
2021-09-30 05:47:53.423631 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 05:47:53.975518 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:47:53.977656 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:47:53.977840 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit"} */

    show terse objects in DEMO_DB.SALES_SCHEMA_dbt_test__audit
2021-09-30 05:47:53.977992 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:47:55.536359 (ThreadPoolExecutor-1_0): Snowflake query id: 019f49db-0000-36de-0000-cdb900021112
2021-09-30 05:47:55.536576 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 05:47:55.536805 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 05:47:55.536990 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 05:47:55.537198 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: Close
2021-09-30 05:47:56.100445 (MainThread): 11:17:56 | Concurrency: 1 threads (target='dev')
2021-09-30 05:47:56.100708 (MainThread): 11:17:56 | 
2021-09-30 05:47:56.101707 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 05:47:56.102062 (Thread-1): 11:17:56 | 1 of 4 START view model SALES_SCHEMA.cust_count_by_state............. [RUN]
2021-09-30 05:47:56.102414 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:47:56.102599 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 05:47:56.105580 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 05:47:56.106444 (Thread-1): finished collecting timing info
2021-09-30 05:47:56.132495 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 05:47:56.133705 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:47:56.133888 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.cust_count_by_state  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) from final group by CUSTOMER_STATE
  );
2021-09-30 05:47:56.134045 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:47:57.742747 (Thread-1): Snowflake query id: 019f49db-0000-36de-0000-cdb900021116
2021-09-30 05:47:57.743028 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-09-30 05:47:57.743287 (Thread-1): finished collecting timing info
2021-09-30 05:47:57.743537 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 05:47:58.315173 (Thread-1): Database Error in model cust_count_by_state (models/snowflake_model_data/cust_count_by_state.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/cust_count_by_state.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model cust_count_by_state (models/snowflake_model_data/cust_count_by_state.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/cust_count_by_state.sql
2021-09-30 05:47:58.317200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a7309d-7937-485f-b891-cc15bf1a149e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d3959d0>]}
2021-09-30 05:47:58.317598 (Thread-1): 11:17:58 | 1 of 4 ERROR creating view model SALES_SCHEMA.cust_count_by_state.... [ERROR in 2.21s]
2021-09-30 05:47:58.317811 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 05:47:58.318016 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 05:47:58.318417 (Thread-1): 11:17:58 | 2 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-09-30 05:47:58.318761 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:47:58.318930 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 05:47:58.321607 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 05:47:58.322203 (Thread-1): finished collecting timing info
2021-09-30 05:47:58.343610 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 05:47:58.345255 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:47:58.345494 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 05:47:58.345655 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:48:00.730035 (Thread-1): SQL status: SUCCESS 1 in 2.38 seconds
2021-09-30 05:48:00.742413 (Thread-1): finished collecting timing info
2021-09-30 05:48:00.742712 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 05:48:01.320073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a7309d-7937-485f-b891-cc15bf1a149e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d76fa60>]}
2021-09-30 05:48:01.320565 (Thread-1): 11:18:01 | 2 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.00s]
2021-09-30 05:48:01.320775 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 05:48:01.320978 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:48:01.321391 (Thread-1): 11:18:01 | 3 of 4 START table model SALES_SCHEMA.my_first_dbt_model............. [RUN]
2021-09-30 05:48:01.321759 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:48:01.321933 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:48:01.324503 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:48:01.325476 (Thread-1): finished collecting timing info
2021-09-30 05:48:01.327413 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:48:01.328993 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:48:01.329282 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 05:48:01.329471 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:48:03.688060 (Thread-1): SQL status: SUCCESS 1 in 2.36 seconds
2021-09-30 05:48:03.689992 (Thread-1): finished collecting timing info
2021-09-30 05:48:03.690247 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 05:48:04.260844 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a7309d-7937-485f-b891-cc15bf1a149e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d78c430>]}
2021-09-30 05:48:04.261321 (Thread-1): 11:18:04 | 3 of 4 OK created table model SALES_SCHEMA.my_first_dbt_model........ [SUCCESS 1 in 2.94s]
2021-09-30 05:48:04.261529 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:48:04.262045 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:48:04.262404 (Thread-1): 11:18:04 | 4 of 4 START view model SALES_SCHEMA.my_second_dbt_model............. [RUN]
2021-09-30 05:48:04.262826 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:48:04.263015 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:48:04.265354 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:48:04.266071 (Thread-1): finished collecting timing info
2021-09-30 05:48:04.268439 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:48:04.269664 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:48:04.269889 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.SALES_SCHEMA.my_first_dbt_model
where id = 1
  );
2021-09-30 05:48:04.270050 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:48:06.242237 (Thread-1): SQL status: SUCCESS 1 in 1.97 seconds
2021-09-30 05:48:06.243764 (Thread-1): finished collecting timing info
2021-09-30 05:48:06.243996 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 05:48:06.821622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a7309d-7937-485f-b891-cc15bf1a149e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d7b9700>]}
2021-09-30 05:48:06.822181 (Thread-1): 11:18:06 | 4 of 4 OK created view model SALES_SCHEMA.my_second_dbt_model........ [SUCCESS 1 in 2.56s]
2021-09-30 05:48:06.822436 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:48:06.823640 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:48:06.824011 (MainThread): 11:18:06 | 
2021-09-30 05:48:06.824201 (MainThread): 11:18:06 | Finished running 2 view models, 2 table models in 17.70s.
2021-09-30 05:48:06.824371 (MainThread): Connection 'master' was properly closed.
2021-09-30 05:48:06.824510 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 05:48:06.832012 (MainThread): 
2021-09-30 05:48:06.832275 (MainThread): Completed with 1 error and 0 warnings:
2021-09-30 05:48:06.832468 (MainThread): 
2021-09-30 05:48:06.832651 (MainThread): Database Error in model cust_count_by_state (models/snowflake_model_data/cust_count_by_state.sql)
2021-09-30 05:48:06.832817 (MainThread):   002022 (42601): SQL compilation error:
2021-09-30 05:48:06.832975 (MainThread):   Missing column specification
2021-09-30 05:48:06.833131 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/cust_count_by_state.sql
2021-09-30 05:48:06.833304 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-09-30 05:48:06.833539 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d7a4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d7a4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2d7a4580>]}
2021-09-30 05:48:06.833805 (MainThread): Flushing usage events
2021-09-30 05:50:35.381942 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 05:50:36.956912 (MainThread): Loading KWallet
2021-09-30 05:50:36.958488 (MainThread): Loading SecretService
2021-09-30 05:50:36.960133 (MainThread): Loading Windows
2021-09-30 05:50:36.962066 (MainThread): Loading chainer
2021-09-30 05:50:36.963230 (MainThread): Loading macOS
2021-09-30 05:50:37.596175 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.596313 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.596410 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.596500 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.632422 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 05:50:37.635117 (MainThread): Tracking: tracking
2021-09-30 05:50:37.635590 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92d7d3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e9d4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92e9d4d00>]}
2021-09-30 05:50:37.643987 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.644322 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.644539 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.644712 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.652683 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.653006 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.653212 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.653379 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 05:50:37.663701 (MainThread): Partial parsing not enabled
2021-09-30 05:50:37.708664 (MainThread): Parsing macros/catalog.sql
2021-09-30 05:50:37.712857 (MainThread): Parsing macros/adapters.sql
2021-09-30 05:50:37.788454 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 05:50:37.794703 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 05:50:37.802201 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 05:50:37.804474 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 05:50:37.809391 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 05:50:37.824120 (MainThread): Parsing macros/core.sql
2021-09-30 05:50:37.829859 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 05:50:37.840514 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 05:50:37.854711 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 05:50:37.858428 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 05:50:37.885471 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 05:50:37.935709 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 05:50:37.969065 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 05:50:37.971427 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 05:50:37.986344 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 05:50:38.016032 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 05:50:38.038064 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 05:50:38.049623 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 05:50:38.063729 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 05:50:38.070704 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 05:50:38.072038 (MainThread): Parsing macros/etc/query.sql
2021-09-30 05:50:38.073340 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 05:50:38.075472 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 05:50:38.087329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 05:50:38.091268 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 05:50:38.093555 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 05:50:38.167900 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 05:50:38.170095 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 05:50:38.171566 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 05:50:38.173290 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 05:50:38.424216 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:50:38.436677 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:50:38.441126 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:50:38.446639 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:50:38.624113 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bd74dcf-1856-4f12-a5f2-52bf81bcdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92f7a4970>]}
2021-09-30 05:50:38.632117 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bd74dcf-1856-4f12-a5f2-52bf81bcdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92f7a49a0>]}
2021-09-30 05:50:38.632514 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 05:50:38.634132 (MainThread): 
2021-09-30 05:50:38.634732 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:50:38.635944 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 05:50:38.653048 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 05:50:38.653346 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 05:50:38.653551 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 05:50:40.637666 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.98 seconds
2021-09-30 05:50:40.641357 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 05:50:41.201480 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:50:41.209425 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 05:50:41.209709 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit"} */

    show terse objects in DEMO_DB.SALES_SCHEMA_dbt_test__audit
2021-09-30 05:50:41.209891 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:50:42.954649 (ThreadPoolExecutor-1_0): Snowflake query id: 019f49de-0000-36dc-0000-cdb90001f236
2021-09-30 05:50:42.954867 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 05:50:42.955073 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 05:50:42.955217 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 05:50:42.955408 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: Close
2021-09-30 05:50:43.533125 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:50:43.534995 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 05:50:43.535176 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 05:50:43.535324 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 05:50:45.128579 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.59 seconds
2021-09-30 05:50:45.131005 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 05:50:45.716281 (MainThread): 11:20:45 | Concurrency: 1 threads (target='dev')
2021-09-30 05:50:45.716745 (MainThread): 11:20:45 | 
2021-09-30 05:50:45.718009 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 05:50:45.718393 (Thread-1): 11:20:45 | 1 of 4 START view model SALES_SCHEMA.cust_count_by_state............. [RUN]
2021-09-30 05:50:45.718991 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:50:45.719233 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 05:50:45.722929 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 05:50:45.723683 (Thread-1): finished collecting timing info
2021-09-30 05:50:45.764739 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 05:50:45.769093 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 05:50:45.769898 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.cust_count_by_state  as (
    with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) "CUST_COUNT" from final group by CUSTOMER_STATE
  );
2021-09-30 05:50:45.770279 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:50:47.508176 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-09-30 05:50:47.515730 (Thread-1): finished collecting timing info
2021-09-30 05:50:47.516017 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 05:50:48.088602 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd74dcf-1856-4f12-a5f2-52bf81bcdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92fcb90a0>]}
2021-09-30 05:50:48.089060 (Thread-1): 11:20:48 | 1 of 4 OK created view model SALES_SCHEMA.cust_count_by_state........ [SUCCESS 1 in 2.37s]
2021-09-30 05:50:48.089271 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 05:50:48.089474 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 05:50:48.089852 (Thread-1): 11:20:48 | 2 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-09-30 05:50:48.090216 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:50:48.090389 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 05:50:48.093356 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 05:50:48.094051 (Thread-1): finished collecting timing info
2021-09-30 05:50:48.115948 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 05:50:48.117099 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 05:50:48.117278 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 05:50:48.117431 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:50:50.425237 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2021-09-30 05:50:50.430571 (Thread-1): finished collecting timing info
2021-09-30 05:50:50.430804 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 05:50:50.995309 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd74dcf-1856-4f12-a5f2-52bf81bcdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92fcb94f0>]}
2021-09-30 05:50:50.995830 (Thread-1): 11:20:50 | 2 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 2.91s]
2021-09-30 05:50:50.996075 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 05:50:50.996310 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:50:50.996735 (Thread-1): 11:20:50 | 3 of 4 START table model SALES_SCHEMA.my_first_dbt_model............. [RUN]
2021-09-30 05:50:50.997150 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:50:50.997372 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:50:50.999569 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:50:51.000155 (Thread-1): finished collecting timing info
2021-09-30 05:50:51.002338 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 05:50:51.003600 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 05:50:51.003802 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 05:50:51.003997 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:50:53.408647 (Thread-1): SQL status: SUCCESS 1 in 2.40 seconds
2021-09-30 05:50:53.410146 (Thread-1): finished collecting timing info
2021-09-30 05:50:53.410407 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 05:50:53.980903 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd74dcf-1856-4f12-a5f2-52bf81bcdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92ff50280>]}
2021-09-30 05:50:53.981421 (Thread-1): 11:20:53 | 3 of 4 OK created table model SALES_SCHEMA.my_first_dbt_model........ [SUCCESS 1 in 2.98s]
2021-09-30 05:50:53.981644 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 05:50:53.982242 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:50:53.982623 (Thread-1): 11:20:53 | 4 of 4 START view model SALES_SCHEMA.my_second_dbt_model............. [RUN]
2021-09-30 05:50:53.982955 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:50:53.983152 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:50:53.985817 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:50:53.986524 (Thread-1): finished collecting timing info
2021-09-30 05:50:53.989124 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 05:50:53.990193 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 05:50:53.990435 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.SALES_SCHEMA.my_first_dbt_model
where id = 1
  );
2021-09-30 05:50:53.990607 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 05:50:55.704532 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-09-30 05:50:55.706257 (Thread-1): finished collecting timing info
2021-09-30 05:50:55.706523 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 05:50:56.282496 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd74dcf-1856-4f12-a5f2-52bf81bcdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92ff6e400>]}
2021-09-30 05:50:56.282942 (Thread-1): 11:20:56 | 4 of 4 OK created view model SALES_SCHEMA.my_second_dbt_model........ [SUCCESS 1 in 2.30s]
2021-09-30 05:50:56.283150 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 05:50:56.284263 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 05:50:56.284634 (MainThread): 11:20:56 | 
2021-09-30 05:50:56.284820 (MainThread): 11:20:56 | Finished running 2 view models, 2 table models in 17.65s.
2021-09-30 05:50:56.284984 (MainThread): Connection 'master' was properly closed.
2021-09-30 05:50:56.285215 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 05:50:56.291682 (MainThread): 
2021-09-30 05:50:56.291943 (MainThread): Completed successfully
2021-09-30 05:50:56.292166 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 05:50:56.292409 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92d7d3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92ff6b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92ff6b370>]}
2021-09-30 05:50:56.292683 (MainThread): Flushing usage events
2021-09-30 13:00:30.216886 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 13:00:31.413989 (MainThread): Loading KWallet
2021-09-30 13:00:31.415238 (MainThread): Loading SecretService
2021-09-30 13:00:31.416334 (MainThread): Loading Windows
2021-09-30 13:00:31.417464 (MainThread): Loading chainer
2021-09-30 13:00:31.418135 (MainThread): Loading macOS
2021-09-30 13:00:31.917939 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.918074 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.918140 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.918226 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.941734 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 13:00:31.943324 (MainThread): Tracking: tracking
2021-09-30 13:00:31.943639 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f0f14d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f2349d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f23499a0>]}
2021-09-30 13:00:31.947254 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.947410 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.947524 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.947633 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.952139 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.952285 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.952401 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.952511 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 13:00:31.956098 (MainThread): Partial parsing not enabled
2021-09-30 13:00:31.982126 (MainThread): Parsing macros/catalog.sql
2021-09-30 13:00:31.984280 (MainThread): Parsing macros/adapters.sql
2021-09-30 13:00:32.023959 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 13:00:32.028493 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 13:00:32.032607 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 13:00:32.033848 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 13:00:32.036884 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 13:00:32.045718 (MainThread): Parsing macros/core.sql
2021-09-30 13:00:32.049532 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 13:00:32.056208 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 13:00:32.068317 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 13:00:32.070137 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 13:00:32.086903 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 13:00:32.128852 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 13:00:32.150891 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 13:00:32.152597 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 13:00:32.163455 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 13:00:32.183217 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 13:00:32.197500 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 13:00:32.206082 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 13:00:32.214088 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 13:00:32.218816 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 13:00:32.219906 (MainThread): Parsing macros/etc/query.sql
2021-09-30 13:00:32.221017 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 13:00:32.222880 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 13:00:32.233486 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 13:00:32.235679 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 13:00:32.237712 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 13:00:32.328826 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 13:00:32.331021 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 13:00:32.332454 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 13:00:32.334186 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 13:00:32.582826 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 13:00:32.591882 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 13:00:32.595015 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 13:00:32.598144 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 13:00:32.705996 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad205de2-eedf-4721-9153-231edb716cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f2ea71c0>]}
2021-09-30 13:00:32.712791 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad205de2-eedf-4721-9153-231edb716cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f2eb4700>]}
2021-09-30 13:00:32.713206 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 13:00:32.715006 (MainThread): 
2021-09-30 13:00:32.715499 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 13:00:32.716540 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 13:00:32.731580 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 13:00:32.731795 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 13:00:32.731951 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 13:00:35.428520 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.70 seconds
2021-09-30 13:00:35.430696 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 13:00:36.164718 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 13:00:36.171581 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 13:00:36.171764 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 13:00:36.171911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 13:00:38.088247 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.92 seconds
2021-09-30 13:00:38.089744 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 13:00:38.835709 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 13:00:38.837801 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit".
2021-09-30 13:00:38.837974 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA_dbt_test__audit"} */

    show terse objects in DEMO_DB.SALES_SCHEMA_dbt_test__audit
2021-09-30 13:00:38.838120 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 13:00:40.997222 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4b8c-0000-36dc-0000-cdb90001f33a
2021-09-30 13:00:40.997465 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 13:00:40.997703 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 13:00:40.997871 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 13:00:40.998095 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA_dbt_test__audit: Close
2021-09-30 13:00:41.826567 (MainThread): 18:30:41 | Concurrency: 1 threads (target='dev')
2021-09-30 13:00:41.826818 (MainThread): 18:30:41 | 
2021-09-30 13:00:41.827741 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 13:00:41.828051 (Thread-1): 18:30:41 | 1 of 4 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-09-30 13:00:41.828371 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 13:00:41.828542 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 13:00:41.830951 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 13:00:41.831495 (Thread-1): finished collecting timing info
2021-09-30 13:00:41.855376 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 13:00:41.857032 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 13:00:41.857225 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) "CUST_COUNT" from final group by CUSTOMER_STATE
      );
2021-09-30 13:00:41.857354 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 13:00:45.815546 (Thread-1): SQL status: SUCCESS 1 in 3.96 seconds
2021-09-30 13:00:45.826322 (Thread-1): finished collecting timing info
2021-09-30 13:00:45.826565 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 13:00:46.544930 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad205de2-eedf-4721-9153-231edb716cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f35f1640>]}
2021-09-30 13:00:46.545443 (Thread-1): 18:30:46 | 1 of 4 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 4.72s]
2021-09-30 13:00:46.545686 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 13:00:46.545917 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 13:00:46.546213 (Thread-1): 18:30:46 | 2 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-09-30 13:00:46.546627 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 13:00:46.546791 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 13:00:46.549524 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 13:00:46.551785 (Thread-1): finished collecting timing info
2021-09-30 13:00:46.553781 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 13:00:46.554945 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 13:00:46.555140 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 13:00:46.555295 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 13:00:50.317607 (Thread-1): SQL status: SUCCESS 1 in 3.76 seconds
2021-09-30 13:00:50.319024 (Thread-1): finished collecting timing info
2021-09-30 13:00:50.319240 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 13:00:51.044737 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad205de2-eedf-4721-9153-231edb716cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f35f17f0>]}
2021-09-30 13:00:51.045137 (Thread-1): 18:30:51 | 2 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 4.50s]
2021-09-30 13:00:51.045320 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 13:00:51.045495 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 13:00:51.045794 (Thread-1): 18:30:51 | 3 of 4 START table model SALES_SCHEMA.my_first_dbt_model............. [RUN]
2021-09-30 13:00:51.046103 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 13:00:51.046259 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 13:00:51.048257 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 13:00:51.048801 (Thread-1): finished collecting timing info
2021-09-30 13:00:51.050775 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 13:00:51.051844 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 13:00:51.052059 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 13:00:51.052215 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 13:00:53.887474 (Thread-1): SQL status: SUCCESS 1 in 2.84 seconds
2021-09-30 13:00:53.889193 (Thread-1): finished collecting timing info
2021-09-30 13:00:53.889455 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 13:00:54.593200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad205de2-eedf-4721-9153-231edb716cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f35f19d0>]}
2021-09-30 13:00:54.593629 (Thread-1): 18:30:54 | 3 of 4 OK created table model SALES_SCHEMA.my_first_dbt_model........ [SUCCESS 1 in 3.55s]
2021-09-30 13:00:54.593825 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 13:00:54.594323 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 13:00:54.594586 (Thread-1): 18:30:54 | 4 of 4 START view model SALES_SCHEMA.my_second_dbt_model............. [RUN]
2021-09-30 13:00:54.595006 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 13:00:54.595194 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 13:00:54.597604 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 13:00:54.598196 (Thread-1): finished collecting timing info
2021-09-30 13:00:54.613981 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 13:00:54.615027 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 13:00:54.615210 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.SALES_SCHEMA.my_first_dbt_model
where id = 1
  );
2021-09-30 13:00:54.615358 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 13:00:56.656449 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2021-09-30 13:00:56.657920 (Thread-1): finished collecting timing info
2021-09-30 13:00:56.658139 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 13:00:57.523994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad205de2-eedf-4721-9153-231edb716cef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f3866580>]}
2021-09-30 13:00:57.524538 (Thread-1): 18:30:57 | 4 of 4 OK created view model SALES_SCHEMA.my_second_dbt_model........ [SUCCESS 1 in 2.93s]
2021-09-30 13:00:57.524782 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 13:00:57.525858 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 13:00:57.526255 (MainThread): 18:30:57 | 
2021-09-30 13:00:57.526415 (MainThread): 18:30:57 | Finished running 3 table models, 1 view model in 24.81s.
2021-09-30 13:00:57.526595 (MainThread): Connection 'master' was properly closed.
2021-09-30 13:00:57.526733 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 13:00:57.531956 (MainThread): 
2021-09-30 13:00:57.532174 (MainThread): Completed successfully
2021-09-30 13:00:57.532425 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 13:00:57.532680 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f2dd95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f2eecac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f0f14d00>]}
2021-09-30 13:00:57.532946 (MainThread): Flushing usage events
2021-09-30 17:10:08.712273 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 17:10:09.569300 (MainThread): Loading KWallet
2021-09-30 17:10:09.570539 (MainThread): Loading SecretService
2021-09-30 17:10:09.571625 (MainThread): Loading Windows
2021-09-30 17:10:09.572546 (MainThread): Loading chainer
2021-09-30 17:10:09.573226 (MainThread): Loading macOS
2021-09-30 17:10:09.937276 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.937370 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.937439 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.937503 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.959509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 17:10:09.961377 (MainThread): Tracking: tracking
2021-09-30 17:10:09.961731 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4586f6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc459a14700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc459a14100>]}
2021-09-30 17:10:09.965149 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.965319 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.965441 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.965553 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.970169 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.970340 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.970478 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.970611 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:10:09.974528 (MainThread): Partial parsing not enabled
2021-09-30 17:10:10.000738 (MainThread): Parsing macros/catalog.sql
2021-09-30 17:10:10.002922 (MainThread): Parsing macros/adapters.sql
2021-09-30 17:10:10.041254 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 17:10:10.045879 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 17:10:10.050548 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 17:10:10.051887 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 17:10:10.055618 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 17:10:10.064806 (MainThread): Parsing macros/core.sql
2021-09-30 17:10:10.069744 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 17:10:10.076994 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 17:10:10.087007 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 17:10:10.088790 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 17:10:10.108327 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 17:10:10.141937 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 17:10:10.163068 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 17:10:10.164797 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 17:10:10.175150 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 17:10:10.196735 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 17:10:10.211347 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 17:10:10.220796 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 17:10:10.229594 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 17:10:10.234588 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 17:10:10.236497 (MainThread): Parsing macros/etc/query.sql
2021-09-30 17:10:10.238144 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 17:10:10.240385 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 17:10:10.254259 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 17:10:10.256614 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 17:10:10.258673 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 17:10:10.315283 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 17:10:10.317021 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 17:10:10.318068 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 17:10:10.319245 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 17:10:10.512254 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:10:10.520504 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:10:10.523302 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:10:10.526523 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:10:10.631772 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '121e7678-9707-4288-8ae2-6e19a8b60f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45a7e9190>]}
2021-09-30 17:10:10.637924 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '121e7678-9707-4288-8ae2-6e19a8b60f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45a7afc70>]}
2021-09-30 17:10:10.638263 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 17:10:10.639680 (MainThread): 
2021-09-30 17:10:10.640208 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:10:10.641420 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:10:10.655708 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:10:10.655921 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:10:10.656074 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 17:10:12.930851 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.27 seconds
2021-09-30 17:10:12.932728 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:10:13.538723 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:10:13.540705 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:10:13.540885 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:10:13.541039 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 17:10:15.656630 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.12 seconds
2021-09-30 17:10:15.658629 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:10:16.267910 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_DEMO_DB_PUBLIC_SALES_SCHEMA".
2021-09-30 17:10:16.268254 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_DEMO_DB_PUBLIC_SALES_SCHEMA".
2021-09-30 17:10:16.268465 (ThreadPoolExecutor-0_0): Creating schema "DEMO_DB.PUBLIC_SALES_SCHEMA"
2021-09-30 17:10:16.273071 (ThreadPoolExecutor-0_0): Using snowflake connection "create_DEMO_DB_PUBLIC_SALES_SCHEMA".
2021-09-30 17:10:16.273231 (ThreadPoolExecutor-0_0): On create_DEMO_DB_PUBLIC_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "create_DEMO_DB_PUBLIC_SALES_SCHEMA"} */
create schema if not exists DEMO_DB.PUBLIC_SALES_SCHEMA
2021-09-30 17:10:16.273369 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 17:10:18.195550 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.92 seconds
2021-09-30 17:10:18.196493 (ThreadPoolExecutor-0_0): On create_DEMO_DB_PUBLIC_SALES_SCHEMA: Close
2021-09-30 17:10:18.812149 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:10:18.819920 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:10:18.820157 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 17:10:18.820313 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:10:20.602640 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.78 seconds
2021-09-30 17:10:20.604869 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 17:10:21.316437 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-30 17:10:21.318985 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_dbt_test__audit".
2021-09-30 17:10:21.319189 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_dbt_test__audit"} */

    show terse objects in DEMO_DB.PUBLIC_dbt_test__audit
2021-09-30 17:10:21.319336 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:10:23.550067 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4c86-0000-36de-0000-cdb90002124a
2021-09-30 17:10:23.550255 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 17:10:23.550458 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 17:10:23.550609 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 17:10:23.550787 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_dbt_test__audit: Close
2021-09-30 17:10:24.692377 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_SALES_SCHEMA".
2021-09-30 17:10:24.694108 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC_SALES_SCHEMA".
2021-09-30 17:10:24.694300 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.PUBLIC_SALES_SCHEMA
2021-09-30 17:10:24.694460 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:10:27.937745 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 3.24 seconds
2021-09-30 17:10:27.939566 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC_SALES_SCHEMA: Close
2021-09-30 17:10:28.733660 (MainThread): 22:40:28 | Concurrency: 1 threads (target='dev')
2021-09-30 17:10:28.733949 (MainThread): 22:40:28 | 
2021-09-30 17:10:28.735007 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:10:28.735353 (Thread-1): 22:40:28 | 1 of 4 START table model PUBLIC_SALES_SCHEMA.cust_count_by_state..... [RUN]
2021-09-30 17:10:28.735769 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:10:28.735961 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 17:10:28.739039 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:10:28.739729 (Thread-1): finished collecting timing info
2021-09-30 17:10:28.771340 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:10:28.772993 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:10:28.773210 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.PUBLIC_SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) "CUST_COUNT" from final group by CUSTOMER_STATE
      );
2021-09-30 17:10:28.773374 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:10:32.089598 (Thread-1): SQL status: SUCCESS 1 in 3.32 seconds
2021-09-30 17:10:32.100458 (Thread-1): finished collecting timing info
2021-09-30 17:10:32.100699 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 17:10:32.759332 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.221.191', 59619), raddr=('52.228.75.102', 443)>
2021-09-30 17:10:32.761703 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121e7678-9707-4288-8ae2-6e19a8b60f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ae229a0>]}
2021-09-30 17:10:32.762153 (Thread-1): 22:40:32 | 1 of 4 OK created table model PUBLIC_SALES_SCHEMA.cust_count_by_state [SUCCESS 1 in 4.03s]
2021-09-30 17:10:32.762374 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:10:32.762578 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 17:10:32.762953 (Thread-1): 22:40:32 | 2 of 4 START table model PUBLIC_SALES_SCHEMA.customer................ [RUN]
2021-09-30 17:10:32.763324 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:10:32.763501 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 17:10:32.766447 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:10:32.767085 (Thread-1): finished collecting timing info
2021-09-30 17:10:32.769089 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:10:32.770213 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:10:32.770457 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.PUBLIC_SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 17:10:32.770624 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:10:36.956796 (Thread-1): SQL status: SUCCESS 1 in 4.19 seconds
2021-09-30 17:10:36.958556 (Thread-1): finished collecting timing info
2021-09-30 17:10:36.958834 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 17:10:41.148548 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121e7678-9707-4288-8ae2-6e19a8b60f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ae64fd0>]}
2021-09-30 17:10:41.149073 (Thread-1): 22:40:41 | 2 of 4 OK created table model PUBLIC_SALES_SCHEMA.customer........... [SUCCESS 1 in 8.39s]
2021-09-30 17:10:41.149326 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 17:10:41.149564 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:10:41.149969 (Thread-1): 22:40:41 | 3 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-30 17:10:41.150354 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:10:41.150556 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:10:41.152848 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:10:41.153442 (Thread-1): finished collecting timing info
2021-09-30 17:10:41.155593 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:10:41.156694 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:10:41.156855 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 17:10:41.157005 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:10:46.324568 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.221.191', 59628), raddr=('52.228.75.102', 443)>
2021-09-30 17:10:46.325297 (Thread-1): SQL status: SUCCESS 1 in 5.17 seconds
2021-09-30 17:10:46.326973 (Thread-1): finished collecting timing info
2021-09-30 17:10:46.327223 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 17:10:48.040292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121e7678-9707-4288-8ae2-6e19a8b60f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ae3bbb0>]}
2021-09-30 17:10:48.040819 (Thread-1): 22:40:48 | 3 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 6.89s]
2021-09-30 17:10:48.041070 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:10:48.041655 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:10:48.041986 (Thread-1): 22:40:48 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-30 17:10:48.042302 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:10:48.042469 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:10:48.044586 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:10:48.045306 (Thread-1): finished collecting timing info
2021-09-30 17:10:48.061627 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:10:48.062656 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:10:48.062832 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-30 17:10:48.062996 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:10:50.064510 (Thread-1): SQL status: SUCCESS 1 in 2.00 seconds
2021-09-30 17:10:50.066204 (Thread-1): finished collecting timing info
2021-09-30 17:10:50.066458 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 17:10:50.877048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121e7678-9707-4288-8ae2-6e19a8b60f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45a74d040>]}
2021-09-30 17:10:50.877493 (Thread-1): 22:40:50 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.83s]
2021-09-30 17:10:50.877698 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:10:50.878653 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:10:50.879010 (MainThread): 22:40:50 | 
2021-09-30 17:10:50.879191 (MainThread): 22:40:50 | Finished running 3 table models, 1 view model in 40.24s.
2021-09-30 17:10:50.879350 (MainThread): Connection 'master' was properly closed.
2021-09-30 17:10:50.879483 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 17:10:50.884622 (MainThread): 
2021-09-30 17:10:50.884861 (MainThread): Completed successfully
2021-09-30 17:10:50.885153 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 17:10:50.885402 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4587a2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4586f6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ae24160>]}
2021-09-30 17:10:50.885671 (MainThread): Flushing usage events
2021-09-30 17:22:40.646806 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 17:22:41.672660 (MainThread): Loading KWallet
2021-09-30 17:22:41.673730 (MainThread): Loading SecretService
2021-09-30 17:22:41.674676 (MainThread): Loading Windows
2021-09-30 17:22:41.675995 (MainThread): Loading chainer
2021-09-30 17:22:41.676755 (MainThread): Loading macOS
2021-09-30 17:22:42.151064 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.151177 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.151263 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.151343 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.176708 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 17:22:42.178967 (MainThread): Tracking: tracking
2021-09-30 17:22:42.179334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3af14b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3c314d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3c314160>]}
2021-09-30 17:22:42.183619 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.183831 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.183992 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.184140 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.189738 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.189981 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.190145 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.190292 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:22:42.194584 (MainThread): Partial parsing not enabled
2021-09-30 17:22:42.228651 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 17:22:42.230067 (MainThread): Parsing macros/catalog.sql
2021-09-30 17:22:42.232536 (MainThread): Parsing macros/adapters.sql
2021-09-30 17:22:42.270342 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 17:22:42.274073 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 17:22:42.278237 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 17:22:42.279683 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 17:22:42.283607 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 17:22:42.291932 (MainThread): Parsing macros/core.sql
2021-09-30 17:22:42.295810 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 17:22:42.303465 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 17:22:42.315489 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 17:22:42.317443 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 17:22:42.337997 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 17:22:42.378402 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 17:22:42.400408 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 17:22:42.402057 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 17:22:42.412267 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 17:22:42.432329 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 17:22:42.446343 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 17:22:42.454247 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 17:22:42.461526 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 17:22:42.465414 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 17:22:42.466211 (MainThread): Parsing macros/etc/query.sql
2021-09-30 17:22:42.467084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 17:22:42.468642 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 17:22:42.477047 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 17:22:42.478860 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 17:22:42.480266 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 17:22:42.534135 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 17:22:42.535756 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 17:22:42.536832 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 17:22:42.538024 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 17:22:42.722533 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:22:42.732010 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:22:42.735010 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:22:42.738106 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:22:42.846906 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff17cde7-2d38-4ee0-bc13-60cb46b3098d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ceecc70>]}
2021-09-30 17:22:42.852965 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff17cde7-2d38-4ee0-bc13-60cb46b3098d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ceecc40>]}
2021-09-30 17:22:42.853297 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 17:22:42.854572 (MainThread): 
2021-09-30 17:22:42.854947 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:22:42.855945 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:22:42.872928 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:22:42.873162 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:22:42.873324 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 17:22:45.680927 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.81 seconds
2021-09-30 17:22:45.682820 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:22:46.344004 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:22:46.346105 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:22:46.346290 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:22:46.346445 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 17:22:48.633949 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.29 seconds
2021-09-30 17:22:48.635633 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:22:49.314511 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:22:49.321490 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:22:49.321673 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 17:22:49.321822 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:22:51.627239 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.31 seconds
2021-09-30 17:22:51.629522 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 17:22:52.589976 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:22:52.592161 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:22:52.592338 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 17:22:52.592488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:22:54.428710 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4c92-0000-36fb-0000-cdb900022092
2021-09-30 17:22:54.428926 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 17:22:54.429132 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 17:22:54.429278 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 17:22:54.429477 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 17:22:55.157068 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:22:55.158872 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:22:55.159038 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 17:22:55.159181 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:22:56.911136 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.75 seconds
2021-09-30 17:22:56.913110 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 17:22:57.543252 (MainThread): 22:52:57 | Concurrency: 1 threads (target='dev')
2021-09-30 17:22:57.543503 (MainThread): 22:52:57 | 
2021-09-30 17:22:57.544416 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:22:57.544735 (Thread-1): 22:52:57 | 1 of 4 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-09-30 17:22:57.545063 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:22:57.545236 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 17:22:57.547736 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:22:57.548312 (Thread-1): finished collecting timing info
2021-09-30 17:22:57.574792 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:22:57.575899 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:22:57.576060 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) "CUST_COUNT" from final group by CUSTOMER_STATE
      );
2021-09-30 17:22:57.576197 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:23:00.890927 (Thread-1): SQL status: SUCCESS 1 in 3.31 seconds
2021-09-30 17:23:00.904503 (Thread-1): finished collecting timing info
2021-09-30 17:23:00.904781 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 17:23:01.759506 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff17cde7-2d38-4ee0-bc13-60cb46b3098d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3d714400>]}
2021-09-30 17:23:01.760028 (Thread-1): 22:53:01 | 1 of 4 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 4.21s]
2021-09-30 17:23:01.760279 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:23:01.760520 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 17:23:01.760831 (Thread-1): 22:53:01 | 2 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-09-30 17:23:01.761345 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:23:01.761528 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 17:23:01.764320 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:23:01.764891 (Thread-1): finished collecting timing info
2021-09-30 17:23:01.766615 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:23:01.767602 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:23:01.767791 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 17:23:01.767951 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:23:04.545216 (Thread-1): SQL status: SUCCESS 1 in 2.78 seconds
2021-09-30 17:23:04.546989 (Thread-1): finished collecting timing info
2021-09-30 17:23:04.547244 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 17:23:05.390008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff17cde7-2d38-4ee0-bc13-60cb46b3098d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3d79ea30>]}
2021-09-30 17:23:05.390429 (Thread-1): 22:53:05 | 2 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.63s]
2021-09-30 17:23:05.390624 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 17:23:05.390812 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:23:05.391127 (Thread-1): 22:53:05 | 3 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-30 17:23:05.391433 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:23:05.391592 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:23:05.393739 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:23:05.394316 (Thread-1): finished collecting timing info
2021-09-30 17:23:05.398192 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:23:05.399524 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:23:05.399698 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 17:23:05.399852 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:23:08.577452 (Thread-1): SQL status: SUCCESS 1 in 3.18 seconds
2021-09-30 17:23:08.578929 (Thread-1): finished collecting timing info
2021-09-30 17:23:08.579150 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 17:23:09.213726 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff17cde7-2d38-4ee0-bc13-60cb46b3098d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3d729be0>]}
2021-09-30 17:23:09.214201 (Thread-1): 22:53:09 | 3 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.82s]
2021-09-30 17:23:09.214403 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:23:09.214821 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:23:09.215111 (Thread-1): 22:53:09 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-30 17:23:09.215373 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:23:09.215526 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:23:09.217469 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:23:09.217968 (Thread-1): finished collecting timing info
2021-09-30 17:23:09.234369 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:23:09.235352 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:23:09.235522 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-30 17:23:09.235666 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:23:11.122077 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-09-30 17:23:11.123996 (Thread-1): finished collecting timing info
2021-09-30 17:23:11.124338 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 17:23:11.785610 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff17cde7-2d38-4ee0-bc13-60cb46b3098d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3d7914f0>]}
2021-09-30 17:23:11.786080 (Thread-1): 22:53:11 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.57s]
2021-09-30 17:23:11.786282 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:23:11.787220 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:23:11.787587 (MainThread): 22:53:11 | 
2021-09-30 17:23:11.787775 (MainThread): 22:53:11 | Finished running 3 table models, 1 view model in 28.93s.
2021-09-30 17:23:11.787940 (MainThread): Connection 'master' was properly closed.
2021-09-30 17:23:11.788078 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 17:23:11.793476 (MainThread): 
2021-09-30 17:23:11.793741 (MainThread): Completed successfully
2021-09-30 17:23:11.794001 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 17:23:11.794257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ceecb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ceec8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3d79c700>]}
2021-09-30 17:23:11.794540 (MainThread): Flushing usage events
2021-09-30 17:24:59.674588 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 17:25:00.274376 (MainThread): Loading KWallet
2021-09-30 17:25:00.275166 (MainThread): Loading SecretService
2021-09-30 17:25:00.275834 (MainThread): Loading Windows
2021-09-30 17:25:00.276610 (MainThread): Loading chainer
2021-09-30 17:25:00.277059 (MainThread): Loading macOS
2021-09-30 17:25:00.649638 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.649735 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.649804 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.649869 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.671658 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 17:25:00.673004 (MainThread): Tracking: tracking
2021-09-30 17:25:00.673292 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c71153be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c72215a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c72215640>]}
2021-09-30 17:25:00.676875 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.677071 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.677221 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.677344 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.682200 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.682402 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.682551 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.682688 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:25:00.686778 (MainThread): Partial parsing not enabled
2021-09-30 17:25:00.707530 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 17:25:00.708683 (MainThread): Parsing macros/catalog.sql
2021-09-30 17:25:00.710688 (MainThread): Parsing macros/adapters.sql
2021-09-30 17:25:00.748832 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 17:25:00.752487 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 17:25:00.757050 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 17:25:00.758363 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 17:25:00.761386 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 17:25:00.770178 (MainThread): Parsing macros/core.sql
2021-09-30 17:25:00.773822 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 17:25:00.781194 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 17:25:00.795808 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 17:25:00.797913 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 17:25:00.823646 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 17:25:00.868905 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 17:25:00.896921 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 17:25:00.899334 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 17:25:00.913064 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 17:25:00.940786 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 17:25:00.960024 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 17:25:00.970274 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 17:25:00.980277 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 17:25:00.985260 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 17:25:00.987106 (MainThread): Parsing macros/etc/query.sql
2021-09-30 17:25:00.988498 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 17:25:00.990736 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 17:25:01.002041 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 17:25:01.004890 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 17:25:01.006985 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 17:25:01.079362 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 17:25:01.081623 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 17:25:01.083251 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 17:25:01.084983 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 17:25:01.279809 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:25:01.287918 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:25:01.291301 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:25:01.294479 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:25:01.400571 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd38171c-8532-45a0-b03e-5aa0c0656f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c72deb0a0>]}
2021-09-30 17:25:01.407090 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd38171c-8532-45a0-b03e-5aa0c0656f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c72df72e0>]}
2021-09-30 17:25:01.407519 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 17:25:01.408944 (MainThread): 
2021-09-30 17:25:01.409418 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:25:01.410498 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:25:01.424661 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:25:01.424858 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:25:01.425011 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 17:25:03.940910 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.52 seconds
2021-09-30 17:25:03.942786 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:25:04.581619 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:25:04.583494 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:25:04.583679 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:25:04.583824 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 17:25:06.770682 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.19 seconds
2021-09-30 17:25:06.772612 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:25:07.398645 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:25:07.405753 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:25:07.405980 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 17:25:07.406135 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:25:09.331583 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4c95-0000-36fb-0000-cdb9000220ea
2021-09-30 17:25:09.331799 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 17:25:09.332002 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 17:25:09.332145 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 17:25:09.332333 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 17:25:10.067963 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:25:10.069652 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:25:10.069837 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 17:25:10.069987 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:25:11.730367 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.66 seconds
2021-09-30 17:25:11.731873 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 17:25:12.710605 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:25:12.712759 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:25:12.712934 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 17:25:12.713087 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:25:15.116849 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 2.40 seconds
2021-09-30 17:25:15.118528 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 17:25:15.758688 (MainThread): 22:55:15 | Concurrency: 1 threads (target='dev')
2021-09-30 17:25:15.758997 (MainThread): 22:55:15 | 
2021-09-30 17:25:15.759985 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:25:15.760301 (Thread-1): 22:55:15 | 1 of 4 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-09-30 17:25:15.760631 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:25:15.760816 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 17:25:15.763355 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:25:15.763971 (Thread-1): finished collecting timing info
2021-09-30 17:25:15.792044 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:25:15.793213 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:25:15.793396 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) "CUST_COUNT" from final group by CUSTOMER_STATE
      );
2021-09-30 17:25:15.793545 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:25:18.757974 (Thread-1): SQL status: SUCCESS 1 in 2.96 seconds
2021-09-30 17:25:18.766591 (Thread-1): finished collecting timing info
2021-09-30 17:25:18.766813 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 17:25:19.418046 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd38171c-8532-45a0-b03e-5aa0c0656f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7332fcd0>]}
2021-09-30 17:25:19.418583 (Thread-1): 22:55:19 | 1 of 4 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.66s]
2021-09-30 17:25:19.418839 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:25:19.419082 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 17:25:19.419490 (Thread-1): 22:55:19 | 2 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-09-30 17:25:19.419910 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:25:19.420122 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 17:25:19.423049 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:25:19.423618 (Thread-1): finished collecting timing info
2021-09-30 17:25:19.425353 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:25:19.426453 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:25:19.426649 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 17:25:19.426808 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:25:22.407091 (Thread-1): SQL status: SUCCESS 1 in 2.98 seconds
2021-09-30 17:25:22.408876 (Thread-1): finished collecting timing info
2021-09-30 17:25:22.409146 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 17:25:23.142211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd38171c-8532-45a0-b03e-5aa0c0656f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7380b0d0>]}
2021-09-30 17:25:23.142719 (Thread-1): 22:55:23 | 2 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.72s]
2021-09-30 17:25:23.142961 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 17:25:23.143194 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:25:23.143490 (Thread-1): 22:55:23 | 3 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-30 17:25:23.143966 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:25:23.144181 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:25:23.146552 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:25:23.147100 (Thread-1): finished collecting timing info
2021-09-30 17:25:23.149166 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:25:23.150504 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:25:23.150704 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 17:25:23.150869 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:25:26.129976 (Thread-1): SQL status: SUCCESS 1 in 2.98 seconds
2021-09-30 17:25:26.131771 (Thread-1): finished collecting timing info
2021-09-30 17:25:26.132019 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 17:25:26.774987 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd38171c-8532-45a0-b03e-5aa0c0656f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c738bb370>]}
2021-09-30 17:25:26.775399 (Thread-1): 22:55:26 | 3 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.63s]
2021-09-30 17:25:26.775597 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:25:26.776081 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:25:26.776460 (Thread-1): 22:55:26 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-30 17:25:26.776786 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:25:26.776949 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:25:26.778950 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:25:26.780011 (Thread-1): finished collecting timing info
2021-09-30 17:25:26.795741 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:25:26.796754 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:25:26.796924 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-30 17:25:26.797070 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:25:28.962203 (Thread-1): SQL status: SUCCESS 1 in 2.17 seconds
2021-09-30 17:25:28.963758 (Thread-1): finished collecting timing info
2021-09-30 17:25:28.963991 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 17:25:29.620963 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd38171c-8532-45a0-b03e-5aa0c0656f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c738260d0>]}
2021-09-30 17:25:29.621414 (Thread-1): 22:55:29 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.84s]
2021-09-30 17:25:29.621620 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:25:29.622607 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:25:29.622974 (MainThread): 22:55:29 | 
2021-09-30 17:25:29.623163 (MainThread): 22:55:29 | Finished running 3 table models, 1 view model in 28.21s.
2021-09-30 17:25:29.623330 (MainThread): Connection 'master' was properly closed.
2021-09-30 17:25:29.623468 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 17:25:29.628738 (MainThread): 
2021-09-30 17:25:29.628955 (MainThread): Completed successfully
2021-09-30 17:25:29.629157 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 17:25:29.629397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c73836580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c73809b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c738099a0>]}
2021-09-30 17:25:29.629667 (MainThread): Flushing usage events
2021-09-30 17:33:09.710213 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 17:33:10.766323 (MainThread): Loading KWallet
2021-09-30 17:33:10.767455 (MainThread): Loading SecretService
2021-09-30 17:33:10.768423 (MainThread): Loading Windows
2021-09-30 17:33:10.769605 (MainThread): Loading chainer
2021-09-30 17:33:10.770423 (MainThread): Loading macOS
2021-09-30 17:33:11.245480 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.245600 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.245684 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.245763 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.273377 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-09-30 17:33:11.280845 (MainThread): Tracking: tracking
2021-09-30 17:33:11.281323 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39b5e5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39c9f2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39c9f2670>]}
2021-09-30 17:33:11.285640 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.285878 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.286075 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.286236 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.292150 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.292379 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.292623 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.292781 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:33:11.297185 (MainThread): Partial parsing not enabled
2021-09-30 17:33:11.332124 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 17:33:11.333574 (MainThread): Parsing macros/catalog.sql
2021-09-30 17:33:11.336048 (MainThread): Parsing macros/adapters.sql
2021-09-30 17:33:11.381435 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 17:33:11.386825 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 17:33:11.392350 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 17:33:11.394207 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 17:33:11.398142 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 17:33:11.409435 (MainThread): Parsing macros/core.sql
2021-09-30 17:33:11.414154 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 17:33:11.422595 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 17:33:11.435065 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 17:33:11.437132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 17:33:11.458651 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 17:33:11.501938 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 17:33:11.530827 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 17:33:11.533522 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 17:33:11.550989 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 17:33:11.576913 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 17:33:11.603952 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 17:33:11.616224 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 17:33:11.626430 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 17:33:11.632353 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 17:33:11.633501 (MainThread): Parsing macros/etc/query.sql
2021-09-30 17:33:11.634677 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 17:33:11.636532 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 17:33:11.647405 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 17:33:11.649665 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 17:33:11.651623 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 17:33:11.719881 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 17:33:11.722522 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 17:33:11.723926 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 17:33:11.725585 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 17:33:11.983877 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:33:11.996917 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:33:12.003035 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:33:12.008632 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:33:12.146807 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e6a0c1e-d38e-4e22-aec1-566e8ee81503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39d8e7190>]}
2021-09-30 17:33:12.153391 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e6a0c1e-d38e-4e22-aec1-566e8ee81503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39d8e7f40>]}
2021-09-30 17:33:12.153778 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 17:33:12.155206 (MainThread): 
2021-09-30 17:33:12.155731 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:33:12.157138 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:33:12.171360 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:33:12.171576 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 17:33:12.171733 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-09-30 17:33:14.436323 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.26 seconds
2021-09-30 17:33:14.438921 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 17:33:15.057119 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:33:15.059416 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:33:15.059594 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 17:33:15.059744 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:33:16.938631 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.88 seconds
2021-09-30 17:33:16.940253 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 17:33:17.561709 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:33:17.564019 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:33:17.564244 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 17:33:17.564413 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:33:19.683535 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4c9d-0000-36de-0000-cdb9000212be
2021-09-30 17:33:19.683757 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 17:33:19.683988 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 17:33:19.684162 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 17:33:19.684362 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 17:33:20.325825 (MainThread): 23:03:20 | Concurrency: 1 threads (target='dev')
2021-09-30 17:33:20.326120 (MainThread): 23:03:20 | 
2021-09-30 17:33:20.327132 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 17:33:20.327401 (Thread-1): 23:03:20 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-09-30 17:33:20.327777 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-09-30 17:33:20.327974 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 17:33:20.335972 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-09-30 17:33:20.337026 (Thread-1): finished collecting timing info
2021-09-30 17:33:20.358651 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-09-30 17:33:20.360790 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-09-30 17:33:20.361094 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
2021-09-30 17:33:20.361271 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:33:22.428710 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2021-09-30 17:33:22.431222 (Thread-1): finished collecting timing info
2021-09-30 17:33:22.431500 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: Close
2021-09-30 17:33:23.163642 (Thread-1): 23:03:23 | 1 of 4 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 2.84s]
2021-09-30 17:33:23.163972 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 17:33:23.164228 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 17:33:23.164583 (Thread-1): 23:03:23 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-09-30 17:33:23.164973 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-09-30 17:33:23.165152 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 17:33:23.169733 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-09-30 17:33:23.170388 (Thread-1): finished collecting timing info
2021-09-30 17:33:23.172461 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-09-30 17:33:23.173607 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-09-30 17:33:23.173802 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.PUBLIC.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-09-30 17:33:23.173959 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:33:25.416860 (Thread-1): SQL status: SUCCESS 1 in 2.24 seconds
2021-09-30 17:33:25.418699 (Thread-1): finished collecting timing info
2021-09-30 17:33:25.418978 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-09-30 17:33:26.054585 (Thread-1): 23:03:26 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 2.89s]
2021-09-30 17:33:26.054850 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 17:33:26.055055 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 17:33:26.055334 (Thread-1): 23:03:26 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2021-09-30 17:33:26.055658 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-09-30 17:33:26.055827 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 17:33:26.062962 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-09-30 17:33:26.063561 (Thread-1): finished collecting timing info
2021-09-30 17:33:26.065271 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-09-30 17:33:26.066826 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-09-30 17:33:26.067045 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-09-30 17:33:26.067208 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:33:28.087239 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2021-09-30 17:33:28.088973 (Thread-1): finished collecting timing info
2021-09-30 17:33:28.089275 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-09-30 17:33:28.748390 (Thread-1): 23:03:28 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 2.69s]
2021-09-30 17:33:28.748702 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 17:33:28.748913 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 17:33:28.749206 (Thread-1): 23:03:28 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2021-09-30 17:33:28.749581 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-09-30 17:33:28.749758 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 17:33:28.753836 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-09-30 17:33:28.754597 (Thread-1): finished collecting timing info
2021-09-30 17:33:28.756625 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-09-30 17:33:28.757780 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-09-30 17:33:28.757998 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-09-30 17:33:28.758252 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:33:30.900982 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-09-30 17:33:30.902588 (Thread-1): finished collecting timing info
2021-09-30 17:33:30.902826 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: Close
2021-09-30 17:33:31.689968 (Thread-1): 23:03:31 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 2.94s]
2021-09-30 17:33:31.690258 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 17:33:31.691286 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:33:31.691639 (MainThread): 23:03:31 | 
2021-09-30 17:33:31.691827 (MainThread): 23:03:31 | Finished running 4 tests in 19.54s.
2021-09-30 17:33:31.691992 (MainThread): Connection 'master' was properly closed.
2021-09-30 17:33:31.692128 (MainThread): Connection 'test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570' was properly closed.
2021-09-30 17:33:31.698682 (MainThread): 
2021-09-30 17:33:31.699155 (MainThread): Completed with 1 error and 0 warnings:
2021-09-30 17:33:31.699465 (MainThread): 
2021-09-30 17:33:31.699678 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-09-30 17:33:31.699969 (MainThread):   Got 1 result, configured to fail if != 0
2021-09-30 17:33:31.700163 (MainThread): 
2021-09-30 17:33:31.700333 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-09-30 17:33:31.700646 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-09-30 17:33:31.700949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39b5e5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39de6f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc39de6f8e0>]}
2021-09-30 17:33:31.701228 (MainThread): Flushing usage events
2021-09-30 17:42:54.750417 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 17:42:55.767449 (MainThread): Loading KWallet
2021-09-30 17:42:55.768592 (MainThread): Loading SecretService
2021-09-30 17:42:55.769647 (MainThread): Loading Windows
2021-09-30 17:42:55.770775 (MainThread): Loading chainer
2021-09-30 17:42:55.771458 (MainThread): Loading macOS
2021-09-30 17:42:56.163129 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.163237 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.163315 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.163391 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.185939 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-09-30 17:42:56.187866 (MainThread): Tracking: tracking
2021-09-30 17:42:56.188216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7af14dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7c449d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7c4499a0>]}
2021-09-30 17:42:56.191519 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.191693 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.191817 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.191935 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.196748 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.196952 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.197123 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.197386 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:42:56.201371 (MainThread): Partial parsing not enabled
2021-09-30 17:42:56.229375 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 17:42:56.230693 (MainThread): Parsing macros/catalog.sql
2021-09-30 17:42:56.232828 (MainThread): Parsing macros/adapters.sql
2021-09-30 17:42:56.270999 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 17:42:56.274744 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 17:42:56.279141 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 17:42:56.280771 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 17:42:56.284401 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 17:42:56.292918 (MainThread): Parsing macros/core.sql
2021-09-30 17:42:56.296405 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 17:42:56.303527 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 17:42:56.313061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 17:42:56.314706 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 17:42:56.331248 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 17:42:56.365707 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 17:42:56.386116 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 17:42:56.388046 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 17:42:56.399441 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 17:42:56.420013 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 17:42:56.433192 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 17:42:56.440580 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 17:42:56.447562 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 17:42:56.451160 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 17:42:56.451940 (MainThread): Parsing macros/etc/query.sql
2021-09-30 17:42:56.452890 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 17:42:56.454252 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 17:42:56.462327 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 17:42:56.464164 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 17:42:56.465788 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 17:42:56.518933 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 17:42:56.520537 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 17:42:56.521587 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 17:42:56.522947 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 17:42:56.702918 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:42:56.713332 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:42:56.716381 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:42:56.719598 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:42:56.832456 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eba5f79-79ce-4230-9756-1509b48ecd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d029250>]}
2021-09-30 17:42:56.840835 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eba5f79-79ce-4230-9756-1509b48ecd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d029130>]}
2021-09-30 17:42:56.841191 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 17:42:56.842661 (MainThread): 
2021-09-30 17:42:56.843261 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:42:56.844372 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:42:56.858782 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:42:56.859000 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:42:56.859154 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 17:42:59.346305 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.49 seconds
2021-09-30 17:42:59.348306 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:43:00.006964 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 17:43:00.008558 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 17:43:00.008690 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 17:43:00.008803 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 17:43:02.629641 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.62 seconds
2021-09-30 17:43:02.631341 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 17:43:03.973327 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:43:03.980243 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:43:03.980439 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 17:43:03.980592 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:43:06.022476 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.04 seconds
2021-09-30 17:43:06.024967 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 17:43:06.748663 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:43:06.750833 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:43:06.750997 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 17:43:06.751142 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:43:08.681099 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4ca7-0000-36dc-0000-cdb90001f472
2021-09-30 17:43:08.681286 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 17:43:08.681453 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 17:43:08.681564 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 17:43:08.681716 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 17:43:09.506980 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:43:09.508914 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:43:09.509100 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 17:43:09.509252 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:43:11.621269 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 2.11 seconds
2021-09-30 17:43:11.622754 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 17:43:12.277934 (MainThread): 23:13:12 | Concurrency: 1 threads (target='dev')
2021-09-30 17:43:12.278198 (MainThread): 23:13:12 | 
2021-09-30 17:43:12.279169 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:43:12.279513 (Thread-1): 23:13:12 | 1 of 4 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-09-30 17:43:12.279861 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:43:12.280042 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 17:43:12.282648 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:43:12.283646 (Thread-1): finished collecting timing info
2021-09-30 17:43:12.310073 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 17:43:12.311213 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:43:12.311386 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-09-30 17:43:12.311555 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:43:15.181134 (Thread-1): SQL status: SUCCESS 1 in 2.87 seconds
2021-09-30 17:43:15.192432 (Thread-1): finished collecting timing info
2021-09-30 17:43:15.192731 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-09-30 17:43:15.820908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eba5f79-79ce-4230-9756-1509b48ecd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d5d9610>]}
2021-09-30 17:43:15.821436 (Thread-1): 23:13:15 | 1 of 4 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.54s]
2021-09-30 17:43:15.821690 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 17:43:15.821927 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 17:43:15.822226 (Thread-1): 23:13:15 | 2 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-09-30 17:43:15.822737 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:43:15.822975 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 17:43:15.825730 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:43:15.826328 (Thread-1): finished collecting timing info
2021-09-30 17:43:15.828117 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-09-30 17:43:15.829184 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:43:15.829392 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-09-30 17:43:15.829549 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:43:18.291898 (Thread-1): SQL status: SUCCESS 1 in 2.46 seconds
2021-09-30 17:43:18.293481 (Thread-1): finished collecting timing info
2021-09-30 17:43:18.293726 (Thread-1): On model.dbt_demo_project.customer: Close
2021-09-30 17:43:19.068768 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eba5f79-79ce-4230-9756-1509b48ecd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d5de6a0>]}
2021-09-30 17:43:19.069293 (Thread-1): 23:13:19 | 2 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.25s]
2021-09-30 17:43:19.069540 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 17:43:19.069780 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:43:19.070077 (Thread-1): 23:13:19 | 3 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-09-30 17:43:19.070562 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:43:19.070770 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:43:19.073129 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:43:19.073752 (Thread-1): finished collecting timing info
2021-09-30 17:43:19.077461 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 17:43:19.078749 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:43:19.078933 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-09-30 17:43:19.079096 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:43:21.696889 (Thread-1): SQL status: SUCCESS 1 in 2.62 seconds
2021-09-30 17:43:21.698899 (Thread-1): finished collecting timing info
2021-09-30 17:43:21.699165 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-09-30 17:43:22.446297 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eba5f79-79ce-4230-9756-1509b48ecd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7cfd1df0>]}
2021-09-30 17:43:22.446703 (Thread-1): 23:13:22 | 3 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.38s]
2021-09-30 17:43:22.446889 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 17:43:22.447401 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:43:22.447753 (Thread-1): 23:13:22 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-09-30 17:43:22.448055 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:43:22.448203 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:43:22.450089 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:43:22.450570 (Thread-1): finished collecting timing info
2021-09-30 17:43:22.463722 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 17:43:22.464758 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:43:22.464900 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-09-30 17:43:22.465025 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:43:25.065565 (Thread-1): SQL status: SUCCESS 1 in 2.60 seconds
2021-09-30 17:43:25.067001 (Thread-1): finished collecting timing info
2021-09-30 17:43:25.067218 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-09-30 17:43:25.929219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eba5f79-79ce-4230-9756-1509b48ecd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d5f20a0>]}
2021-09-30 17:43:25.929762 (Thread-1): 23:13:25 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.48s]
2021-09-30 17:43:25.930789 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 17:43:25.937669 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:43:25.938304 (MainThread): 23:13:25 | 
2021-09-30 17:43:25.938612 (MainThread): 23:13:25 | Finished running 3 table models, 1 view model in 29.10s.
2021-09-30 17:43:25.938869 (MainThread): Connection 'master' was properly closed.
2021-09-30 17:43:25.939086 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-09-30 17:43:25.948796 (MainThread): 
2021-09-30 17:43:25.949213 (MainThread): Completed successfully
2021-09-30 17:43:25.949860 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-09-30 17:43:25.950302 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d5ec8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d029a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7af14dc0>]}
2021-09-30 17:43:25.950744 (MainThread): Flushing usage events
2021-09-30 17:43:42.462795 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 17:43:43.104158 (MainThread): Loading KWallet
2021-09-30 17:43:43.104829 (MainThread): Loading SecretService
2021-09-30 17:43:43.105373 (MainThread): Loading Windows
2021-09-30 17:43:43.106063 (MainThread): Loading chainer
2021-09-30 17:43:43.106428 (MainThread): Loading macOS
2021-09-30 17:43:43.419519 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.419639 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.419731 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.419815 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.447144 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-09-30 17:43:43.448901 (MainThread): Tracking: tracking
2021-09-30 17:43:43.449281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa5d4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80abad8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80abad8160>]}
2021-09-30 17:43:43.453502 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.453719 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.453878 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.454030 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.459928 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.460147 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.460308 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.460453 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 17:43:43.465053 (MainThread): Partial parsing not enabled
2021-09-30 17:43:43.488568 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 17:43:43.490335 (MainThread): Parsing macros/catalog.sql
2021-09-30 17:43:43.493439 (MainThread): Parsing macros/adapters.sql
2021-09-30 17:43:43.531721 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 17:43:43.535338 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 17:43:43.539323 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 17:43:43.540557 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 17:43:43.543407 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 17:43:43.551421 (MainThread): Parsing macros/core.sql
2021-09-30 17:43:43.555070 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 17:43:43.561752 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 17:43:43.571790 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 17:43:43.573728 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 17:43:43.591043 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 17:43:43.624159 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 17:43:43.646430 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 17:43:43.648220 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 17:43:43.659724 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 17:43:43.680048 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 17:43:43.693690 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 17:43:43.701810 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 17:43:43.708870 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 17:43:43.712771 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 17:43:43.713572 (MainThread): Parsing macros/etc/query.sql
2021-09-30 17:43:43.714528 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 17:43:43.715904 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 17:43:43.723850 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 17:43:43.725610 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 17:43:43.727137 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 17:43:43.781656 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 17:43:43.783280 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 17:43:43.784398 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 17:43:43.785610 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 17:43:43.964204 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 17:43:43.972565 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 17:43:43.975437 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 17:43:43.978628 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 17:43:44.090276 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e86428-2645-48a5-964c-83a0b03ffe4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ac782940>]}
2021-09-30 17:43:44.096955 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e86428-2645-48a5-964c-83a0b03ffe4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ac6b7730>]}
2021-09-30 17:43:44.097435 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 17:43:44.099142 (MainThread): 
2021-09-30 17:43:44.099624 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:43:44.101014 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:43:44.114691 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 17:43:44.114870 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 17:43:44.115017 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-09-30 17:43:46.382740 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4ca7-0000-36fb-0000-cdb900022132
2021-09-30 17:43:46.382952 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 17:43:46.383151 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 17:43:46.383292 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 17:43:46.383481 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 17:43:47.029588 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:43:47.032055 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 17:43:47.032273 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 17:43:47.032423 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:43:48.421292 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.221.191', 60507), raddr=('52.228.75.102', 443)>
2021-09-30 17:43:49.833192 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.80 seconds
2021-09-30 17:43:49.835108 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 17:43:50.497083 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:43:50.499111 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 17:43:50.499291 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 17:43:50.499439 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 17:43:52.587163 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.09 seconds
2021-09-30 17:43:52.589253 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 17:43:53.259137 (MainThread): 23:13:53 | Concurrency: 1 threads (target='dev')
2021-09-30 17:43:53.259347 (MainThread): 23:13:53 | 
2021-09-30 17:43:53.260146 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-09-30 17:43:53.260341 (Thread-1): 23:13:53 | 1 of 6 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-09-30 17:43:53.260605 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-09-30 17:43:53.260748 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-09-30 17:43:53.266896 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-09-30 17:43:53.267537 (Thread-1): finished collecting timing info
2021-09-30 17:43:53.281488 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-09-30 17:43:53.282985 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-09-30 17:43:53.283181 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-09-30 17:43:53.283318 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:43:55.681434 (Thread-1): SQL status: SUCCESS 1 in 2.40 seconds
2021-09-30 17:43:55.683597 (Thread-1): finished collecting timing info
2021-09-30 17:43:55.683815 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-09-30 17:43:56.326828 (Thread-1): 23:13:56 | 1 of 6 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 3.07s]
2021-09-30 17:43:56.327142 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-09-30 17:43:56.327386 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 17:43:56.327716 (Thread-1): 23:13:56 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-09-30 17:43:56.328112 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-09-30 17:43:56.328319 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 17:43:56.332676 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-09-30 17:43:56.333296 (Thread-1): finished collecting timing info
2021-09-30 17:43:56.334808 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-09-30 17:43:56.335828 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-09-30 17:43:56.336029 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
2021-09-30 17:43:56.336198 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:43:59.060184 (Thread-1): SQL status: SUCCESS 1 in 2.72 seconds
2021-09-30 17:43:59.061994 (Thread-1): finished collecting timing info
2021-09-30 17:43:59.062249 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: Close
2021-09-30 17:43:59.784810 (Thread-1): 23:13:59 | 2 of 6 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 3.46s]
2021-09-30 17:43:59.785115 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 17:43:59.785362 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 17:43:59.785593 (Thread-1): 23:13:59 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-09-30 17:43:59.786032 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-09-30 17:43:59.786217 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 17:43:59.790454 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-09-30 17:43:59.791100 (Thread-1): finished collecting timing info
2021-09-30 17:43:59.792703 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-09-30 17:43:59.793791 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-09-30 17:43:59.794002 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.PUBLIC.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-09-30 17:43:59.794166 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:44:01.994146 (Thread-1): SQL status: SUCCESS 1 in 2.20 seconds
2021-09-30 17:44:01.995646 (Thread-1): finished collecting timing info
2021-09-30 17:44:01.995875 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-09-30 17:44:02.699832 (Thread-1): 23:14:02 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 2.91s]
2021-09-30 17:44:02.700083 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 17:44:02.700365 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-09-30 17:44:02.700856 (Thread-1): 23:14:02 | 4 of 6 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-09-30 17:44:02.701476 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-09-30 17:44:02.701724 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-09-30 17:44:02.710585 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-09-30 17:44:02.711415 (Thread-1): finished collecting timing info
2021-09-30 17:44:02.713890 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-09-30 17:44:02.716120 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-09-30 17:44:02.716453 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-09-30 17:44:02.716718 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:44:05.323669 (Thread-1): SQL status: SUCCESS 1 in 2.61 seconds
2021-09-30 17:44:05.325469 (Thread-1): finished collecting timing info
2021-09-30 17:44:05.325730 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-09-30 17:44:06.127776 (Thread-1): 23:14:06 | 4 of 6 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 3.43s]
2021-09-30 17:44:06.128085 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-09-30 17:44:06.128327 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 17:44:06.128558 (Thread-1): 23:14:06 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2021-09-30 17:44:06.129046 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-09-30 17:44:06.129267 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 17:44:06.133379 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-09-30 17:44:06.133998 (Thread-1): finished collecting timing info
2021-09-30 17:44:06.135876 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-09-30 17:44:06.137058 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-09-30 17:44:06.137329 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-09-30 17:44:06.137498 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:44:08.747202 (Thread-1): SQL status: SUCCESS 1 in 2.61 seconds
2021-09-30 17:44:08.748599 (Thread-1): finished collecting timing info
2021-09-30 17:44:08.748803 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-09-30 17:44:09.506511 (Thread-1): 23:14:09 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 3.38s]
2021-09-30 17:44:09.506817 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 17:44:09.507060 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 17:44:09.507292 (Thread-1): 23:14:09 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2021-09-30 17:44:09.507814 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-09-30 17:44:09.508002 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 17:44:09.512332 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-09-30 17:44:09.512958 (Thread-1): finished collecting timing info
2021-09-30 17:44:09.514505 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-09-30 17:44:09.515673 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-09-30 17:44:09.515882 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-09-30 17:44:09.516050 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 17:44:11.538954 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2021-09-30 17:44:11.540710 (Thread-1): finished collecting timing info
2021-09-30 17:44:11.540967 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: Close
2021-09-30 17:44:12.159646 (Thread-1): 23:14:12 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 2.65s]
2021-09-30 17:44:12.159953 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 17:44:12.161168 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 17:44:12.161578 (MainThread): 23:14:12 | 
2021-09-30 17:44:12.161820 (MainThread): 23:14:12 | Finished running 6 tests in 28.06s.
2021-09-30 17:44:12.161987 (MainThread): Connection 'master' was properly closed.
2021-09-30 17:44:12.162126 (MainThread): Connection 'test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570' was properly closed.
2021-09-30 17:44:12.168078 (MainThread): 
2021-09-30 17:44:12.168331 (MainThread): Completed with 1 error and 0 warnings:
2021-09-30 17:44:12.168530 (MainThread): 
2021-09-30 17:44:12.168895 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-09-30 17:44:12.169126 (MainThread):   Got 1 result, configured to fail if != 0
2021-09-30 17:44:12.169314 (MainThread): 
2021-09-30 17:44:12.169487 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-09-30 17:44:12.169786 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-09-30 17:44:12.170171 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aa5d4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80acbdbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ac782940>]}
2021-09-30 17:44:12.170488 (MainThread): Flushing usage events
2021-09-30 18:01:24.212932 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:01:25.293948 (MainThread): Loading KWallet
2021-09-30 18:01:25.295532 (MainThread): Loading SecretService
2021-09-30 18:01:25.296816 (MainThread): Loading Windows
2021-09-30 18:01:25.298194 (MainThread): Loading chainer
2021-09-30 18:01:25.298990 (MainThread): Loading macOS
2021-09-30 18:01:25.804307 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-09-30 18:01:25.805824 (MainThread): Tracking: tracking
2021-09-30 18:01:25.806055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bf013dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c034ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c034a7c0>]}
2021-09-30 18:01:25.807549 (MainThread): Set downloads directory='/var/folders/20/4_8n98s56mg5y_0k74wgsqch0000gn/T/dbt-downloads-lou9wa47'
2021-09-30 18:01:25.807913 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-09-30 18:01:26.476537 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-09-30 18:01:26.476901 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-09-30 18:01:26.900477 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-09-30 18:01:26.905588 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.0.json
2021-09-30 18:01:27.325908 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.0.json 200
2021-09-30 18:01:27.326301 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-09-30 18:01:27.801175 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-09-30 18:01:27.805993 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.0.json
2021-09-30 18:01:28.247684 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.0.json 200
2021-09-30 18:01:28.248057 (MainThread): Installing fishtown-analytics/dbt_utils@0.6.0
2021-09-30 18:01:29.753030 (MainThread):   Installed from version 0.6.0
2021-09-30 18:01:29.753413 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '0bf80375-e3ca-4ea7-a9d4-74602e10e2d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c034ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c034a2e0>]}
2021-09-30 18:01:29.754832 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c0f37b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c0f56fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bf013dc0>]}
2021-09-30 18:01:29.755101 (MainThread): Flushing usage events
2021-09-30 18:08:20.368054 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:08:22.144579 (MainThread): Loading KWallet
2021-09-30 18:08:22.145571 (MainThread): Loading SecretService
2021-09-30 18:08:22.146418 (MainThread): Loading Windows
2021-09-30 18:08:22.147311 (MainThread): Loading chainer
2021-09-30 18:08:22.147984 (MainThread): Loading macOS
2021-09-30 18:08:23.021521 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.021641 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.021707 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.021768 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.060411 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-09-30 18:08:23.063876 (MainThread): Tracking: tracking
2021-09-30 18:08:23.064627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2c013be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d316a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d316640>]}
2021-09-30 18:08:23.072477 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.072867 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.073161 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.073437 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.084069 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.084695 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.085109 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.085288 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:08:23.101474 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2df8d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2df8daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2df8d970>]}
2021-09-30 18:08:23.101937 (MainThread): Flushing usage events
2021-09-30 18:08:25.331315 (MainThread): Encountered an error:
2021-09-30 18:08:25.331604 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils
2021-09-30 18:08:25.338114 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0-b1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/generate.py", line 204, in run
    compile_results = CompileTask.run(self)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils

2021-09-30 18:09:35.815074 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:09:36.942248 (MainThread): Loading KWallet
2021-09-30 18:09:36.943754 (MainThread): Loading SecretService
2021-09-30 18:09:36.945073 (MainThread): Loading Windows
2021-09-30 18:09:36.946471 (MainThread): Loading chainer
2021-09-30 18:09:36.947267 (MainThread): Loading macOS
2021-09-30 18:09:37.467678 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-09-30 18:09:37.468997 (MainThread): Tracking: tracking
2021-09-30 18:09:37.469284 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0da853d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dba2e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dba2e790>]}
2021-09-30 18:09:37.470564 (MainThread): Set downloads directory='/var/folders/20/4_8n98s56mg5y_0k74wgsqch0000gn/T/dbt-downloads-ms4wihqz'
2021-09-30 18:09:37.470914 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-09-30 18:09:38.366040 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-09-30 18:09:38.366440 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-09-30 18:09:38.824919 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-09-30 18:09:38.829640 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0da853d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc753d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dc770190>]}
2021-09-30 18:09:38.829966 (MainThread): Flushing usage events
2021-09-30 18:09:41.274068 (MainThread): Encountered an error:
2021-09-30 18:09:41.274311 (MainThread): Could not find a matching version for package fishtown-analytics/dbt_utils
  Requested range: =0.18.0, =0.18.0
  Available versions: ['0.1.9', '0.5.0', '0.6.3', '0.1.16', '0.1.5', '0.1.17', '0.1.25', '0.4.1', '0.1.13', '0.6.6', '0.5.1', '0.1.23', '0.2.5', '0.1.14', '0.4.0', '0.6.2', '0.2.1', '0.1.12', '0.6.5', '0.1.11', '0.6.4', '0.0.1', '0.7.0', '0.1.21', '0.3.0', '0.1.0', '0.1.3', '0.1.19', '0.1.10', '0.2.2', '0.2.3', '0.2.4', '0.1.6', '0.6.1', '0.1.24', '0.2.0', '0.1.8', '0.1.2', '0.1.4', '0.6.0', '0.1.18', '0.1.20', '0.1.22', '0.1.7', '0.1.15', '0.1.1']
2021-09-30 18:09:41.278513 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/deps.py", line 53, in run
    final_deps = resolve_packages(packages, self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/resolver.py", line 137, in resolve_packages
    target = final[package].resolved().fetch_metadata(config, renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/deps/registry.py", line 134, in resolved
    package_version_not_found(self.package, range_, installable)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 698, in package_version_not_found
    raise_dependency_error(base_msg.format(package_name,
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 452, in raise_dependency_error
    raise DependencyException(msg)
dbt.exceptions.DependencyException: Could not find a matching version for package fishtown-analytics/dbt_utils
  Requested range: =0.18.0, =0.18.0
  Available versions: ['0.1.9', '0.5.0', '0.6.3', '0.1.16', '0.1.5', '0.1.17', '0.1.25', '0.4.1', '0.1.13', '0.6.6', '0.5.1', '0.1.23', '0.2.5', '0.1.14', '0.4.0', '0.6.2', '0.2.1', '0.1.12', '0.6.5', '0.1.11', '0.6.4', '0.0.1', '0.7.0', '0.1.21', '0.3.0', '0.1.0', '0.1.3', '0.1.19', '0.1.10', '0.2.2', '0.2.3', '0.2.4', '0.1.6', '0.6.1', '0.1.24', '0.2.0', '0.1.8', '0.1.2', '0.1.4', '0.6.0', '0.1.18', '0.1.20', '0.1.22', '0.1.7', '0.1.15', '0.1.1']

2021-09-30 18:11:23.123559 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:11:24.013420 (MainThread): Loading KWallet
2021-09-30 18:11:24.014353 (MainThread): Loading SecretService
2021-09-30 18:11:24.015183 (MainThread): Loading Windows
2021-09-30 18:11:24.016173 (MainThread): Loading chainer
2021-09-30 18:11:24.016795 (MainThread): Loading macOS
2021-09-30 18:11:24.517045 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='generate', write_json=True)
2021-09-30 18:11:24.518659 (MainThread): Tracking: tracking
2021-09-30 18:11:24.518946 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9945f6c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9967453a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa995b16af0>]}
2021-09-30 18:11:24.544277 (MainThread): Partial parsing not enabled
2021-09-30 18:11:24.616425 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 18:11:24.617828 (MainThread): Parsing macros/catalog.sql
2021-09-30 18:11:24.620372 (MainThread): Parsing macros/adapters.sql
2021-09-30 18:11:24.671142 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 18:11:24.675653 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 18:11:24.682002 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 18:11:24.683935 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 18:11:24.688058 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 18:11:24.699964 (MainThread): Parsing macros/core.sql
2021-09-30 18:11:24.704359 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 18:11:24.712318 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 18:11:24.725087 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 18:11:24.727294 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 18:11:24.748329 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 18:11:24.784152 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 18:11:24.805823 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 18:11:24.807496 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 18:11:24.817324 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 18:11:24.840141 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 18:11:24.854817 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 18:11:24.863115 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 18:11:24.870312 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 18:11:24.873921 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 18:11:24.874723 (MainThread): Parsing macros/etc/query.sql
2021-09-30 18:11:24.875598 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 18:11:24.876974 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 18:11:24.884783 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 18:11:24.886499 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 18:11:24.888530 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 18:11:24.943227 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 18:11:24.944874 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 18:11:24.946013 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 18:11:24.947206 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 18:11:24.949117 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-09-30 18:11:24.950104 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-09-30 18:11:24.951270 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-09-30 18:11:24.953921 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-09-30 18:11:24.959702 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-09-30 18:11:24.960919 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-09-30 18:11:24.962168 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-09-30 18:11:24.964313 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-09-30 18:11:24.965320 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-09-30 18:11:24.967491 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-09-30 18:11:24.976672 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-09-30 18:11:24.978538 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-09-30 18:11:24.980014 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-09-30 18:11:24.981768 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-09-30 18:11:24.983561 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-09-30 18:11:24.984631 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-09-30 18:11:24.989288 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-09-30 18:11:24.994554 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-09-30 18:11:24.995350 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-09-30 18:11:24.997901 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-09-30 18:11:24.999701 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-09-30 18:11:25.001094 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-09-30 18:11:25.002881 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-09-30 18:11:25.025816 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-09-30 18:11:25.026739 (MainThread): Parsing macros/logger/pretty_time.sql
2021-09-30 18:11:25.027780 (MainThread): Parsing macros/logger/log_info.sql
2021-09-30 18:11:25.028513 (MainThread): Parsing macros/datetime/date_spine.sql
2021-09-30 18:11:25.031779 (MainThread): Parsing macros/web/get_url_host.sql
2021-09-30 18:11:25.033181 (MainThread): Parsing macros/web/get_url_path.sql
2021-09-30 18:11:25.035423 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-09-30 18:11:25.036374 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-09-30 18:11:25.037156 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-09-30 18:11:25.038260 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-09-30 18:11:25.040080 (MainThread): Parsing macros/schema_tests/recency.sql
2021-09-30 18:11:25.041529 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-09-30 18:11:25.042743 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-09-30 18:11:25.044136 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-09-30 18:11:25.044961 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-09-30 18:11:25.047131 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-09-30 18:11:25.048390 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-09-30 18:11:25.049285 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-09-30 18:11:25.050448 (MainThread): Parsing macros/schema_tests/equality.sql
2021-09-30 18:11:25.053992 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-09-30 18:11:25.059601 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-09-30 18:11:25.060634 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-09-30 18:11:25.062948 (MainThread): Parsing macros/sql/generate_series.sql
2021-09-30 18:11:25.066074 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-09-30 18:11:25.068391 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-09-30 18:11:25.069565 (MainThread): Parsing macros/sql/star.sql
2021-09-30 18:11:25.072010 (MainThread): Parsing macros/sql/unpivot.sql
2021-09-30 18:11:25.077855 (MainThread): Parsing macros/sql/union.sql
2021-09-30 18:11:25.084978 (MainThread): Parsing macros/sql/groupby.sql
2021-09-30 18:11:25.085767 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-09-30 18:11:25.088229 (MainThread): Parsing macros/sql/safe_add.sql
2021-09-30 18:11:25.089100 (MainThread): Parsing macros/sql/nullcheck.sql
2021-09-30 18:11:25.090122 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-09-30 18:11:25.092563 (MainThread): Parsing macros/sql/get_column_values.sql
2021-09-30 18:11:25.096375 (MainThread): Parsing macros/sql/pivot.sql
2021-09-30 18:11:25.098849 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-09-30 18:11:25.274171 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-09-30 18:11:25.274390 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b107ab9-a333-438e-bf84-ea5e7ff51b08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa99681cc70>]}
2021-09-30 18:11:25.386417 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 18:11:25.396371 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 18:11:25.453923 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 18:11:25.458608 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 18:11:25.545580 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b107ab9-a333-438e-bf84-ea5e7ff51b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa996714070>]}
2021-09-30 18:11:25.555455 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b107ab9-a333-438e-bf84-ea5e7ff51b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa996778b50>]}
2021-09-30 18:11:25.555804 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-09-30 18:11:25.558146 (MainThread): 
2021-09-30 18:11:25.558674 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 18:11:25.559914 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 18:11:25.575405 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 18:11:25.575624 (ThreadPoolExecutor-0_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 18:11:25.575781 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 18:11:28.297155 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 10 in 2.72 seconds
2021-09-30 18:11:28.299474 (ThreadPoolExecutor-0_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 18:11:29.342642 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 18:11:29.345504 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 18:11:29.345708 (ThreadPoolExecutor-0_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 18:11:29.345864 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 18:11:31.508309 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.16 seconds
2021-09-30 18:11:31.510028 (ThreadPoolExecutor-0_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 18:11:32.160513 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 18:11:32.162727 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 18:11:32.162909 (ThreadPoolExecutor-0_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 18:11:32.163057 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-09-30 18:11:34.305790 (ThreadPoolExecutor-0_0): Snowflake query id: 019f4cc3-0000-36dc-0000-cdb90001f48e
2021-09-30 18:11:34.306027 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 18:11:34.306239 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-09-30 18:11:34.306386 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-09-30 18:11:34.306581 (ThreadPoolExecutor-0_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 18:11:35.033105 (MainThread): 23:41:35 | Concurrency: 1 threads (target='dev')
2021-09-30 18:11:35.033379 (MainThread): 23:41:35 | 
2021-09-30 18:11:35.034375 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-09-30 18:11:35.035592 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 18:11:35.035777 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-09-30 18:11:35.038847 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-09-30 18:11:35.040265 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.040499 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.040882 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-09-30 18:11:35.041084 (Thread-1): Began running node model.dbt_demo_project.customer
2021-09-30 18:11:35.041598 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 18:11:35.042035 (Thread-1): Compiling model.dbt_demo_project.customer
2021-09-30 18:11:35.045614 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-09-30 18:11:35.046216 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.046434 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.046802 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-09-30 18:11:35.047000 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 18:11:35.047411 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 18:11:35.047596 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-09-30 18:11:35.050482 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-09-30 18:11:35.051116 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.051366 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.051772 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-09-30 18:11:35.051977 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-09-30 18:11:35.052423 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-09-30 18:11:35.052843 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-09-30 18:11:35.063957 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-09-30 18:11:35.065159 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.065625 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.066289 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-09-30 18:11:35.066618 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-09-30 18:11:35.067304 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-09-30 18:11:35.067705 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-09-30 18:11:35.076865 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-09-30 18:11:35.077611 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.077853 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.078310 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-09-30 18:11:35.078518 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 18:11:35.078944 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 18:11:35.079132 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-09-30 18:11:35.082032 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-09-30 18:11:35.083265 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.083503 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.083927 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-09-30 18:11:35.084148 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 18:11:35.084573 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-09-30 18:11:35.084891 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 18:11:35.089470 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-09-30 18:11:35.090460 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.090698 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.091106 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-09-30 18:11:35.091323 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 18:11:35.091751 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-09-30 18:11:35.091931 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 18:11:35.096616 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-09-30 18:11:35.097512 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.097734 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.098097 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-09-30 18:11:35.098296 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 18:11:35.098715 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-09-30 18:11:35.098900 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 18:11:35.103586 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-09-30 18:11:35.104194 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.104417 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.104831 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-09-30 18:11:35.105028 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 18:11:35.105429 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-09-30 18:11:35.105613 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 18:11:35.110182 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-09-30 18:11:35.110815 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.111035 (Thread-1): finished collecting timing info
2021-09-30 18:11:35.111402 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-09-30 18:11:35.112304 (MainThread): Connection 'master' was properly closed.
2021-09-30 18:11:35.112485 (MainThread): Connection 'test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570' was properly closed.
2021-09-30 18:11:35.120621 (MainThread): 23:41:35 | Done.
2021-09-30 18:11:35.124685 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-09-30 18:11:35.124921 (MainThread): 23:41:35 | Building catalog
2021-09-30 18:11:35.128009 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "DEMO_DB.information_schema".
2021-09-30 18:11:35.137565 (ThreadPoolExecutor-1_0): Using snowflake connection "DEMO_DB.information_schema".
2021-09-30 18:11:35.137783 (ThreadPoolExecutor-1_0): On DEMO_DB.information_schema: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "DEMO_DB.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from DEMO_DB.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from DEMO_DB.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_test__audit') or upper("table_schema") = upper('sales_schema') or upper("table_schema") = upper('public'))
      order by "column_index"
2021-09-30 18:11:35.137963 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-09-30 18:11:39.162070 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 48 in 4.02 seconds
2021-09-30 18:11:39.178118 (ThreadPoolExecutor-1_0): On DEMO_DB.information_schema: Close
2021-09-30 18:11:40.001368 (MainThread): 23:41:40 | Catalog written to /Users/pl465j/projects/dbt-demo/dbt-demo/target/catalog.json
2021-09-30 18:11:40.001744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9945f6c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9968cebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9968cec40>]}
2021-09-30 18:11:40.002011 (MainThread): Flushing usage events
2021-09-30 18:11:41.697436 (MainThread): Connection 'generate_catalog' was properly closed.
2021-09-30 18:11:41.697696 (MainThread): Connection 'DEMO_DB.information_schema' was properly closed.
2021-09-30 18:13:23.274933 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:13:24.194809 (MainThread): Loading KWallet
2021-09-30 18:13:24.196017 (MainThread): Loading SecretService
2021-09-30 18:13:24.197030 (MainThread): Loading Windows
2021-09-30 18:13:24.198175 (MainThread): Loading chainer
2021-09-30 18:13:24.199008 (MainThread): Loading macOS
2021-09-30 18:13:24.668040 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-09-30 18:13:24.670121 (MainThread): Tracking: tracking
2021-09-30 18:13:24.670562 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f8853d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f9a48d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f9a48af0>]}
2021-09-30 18:13:24.675027 (MainThread): Serving docs at 0.0.0.0:8080
2021-09-30 18:13:24.675464 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-09-30 18:13:24.675752 (MainThread): Press Ctrl+C to exit.


2021-09-30 18:14:28.096509 (MainThread): Flushing usage events
2021-09-30 18:14:36.383818 (MainThread): ctrl-c
2021-09-30 18:18:49.660071 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:18:50.699564 (MainThread): Loading KWallet
2021-09-30 18:18:50.700802 (MainThread): Loading SecretService
2021-09-30 18:18:50.701810 (MainThread): Loading Windows
2021-09-30 18:18:50.703081 (MainThread): Loading chainer
2021-09-30 18:18:50.703861 (MainThread): Loading macOS
2021-09-30 18:18:51.202700 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8085, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-09-30 18:18:51.205446 (MainThread): Tracking: tracking
2021-09-30 18:18:51.206420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fe5013d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fe6f69160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fe620c190>]}
2021-09-30 18:18:51.211920 (MainThread): Serving docs at 0.0.0.0:8085
2021-09-30 18:18:51.212326 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2021-09-30 18:18:51.212584 (MainThread): Press Ctrl+C to exit.


2021-09-30 18:19:43.491872 (MainThread): Flushing usage events
2021-09-30 18:19:45.977603 (MainThread): ctrl-c
2021-09-30 18:21:34.775567 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:21:35.710743 (MainThread): Loading KWallet
2021-09-30 18:21:35.712086 (MainThread): Loading SecretService
2021-09-30 18:21:35.713380 (MainThread): Loading Windows
2021-09-30 18:21:35.714656 (MainThread): Loading chainer
2021-09-30 18:21:35.715417 (MainThread): Loading macOS
2021-09-30 18:21:36.231253 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8085, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-09-30 18:21:36.233779 (MainThread): Tracking: tracking
2021-09-30 18:21:36.234361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb830f13bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb832f42160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb832348190>]}
2021-09-30 18:21:36.238921 (MainThread): Serving docs at 0.0.0.0:8085
2021-09-30 18:21:36.240102 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2021-09-30 18:21:36.240413 (MainThread): Press Ctrl+C to exit.


2021-09-30 18:22:42.226457 (MainThread): Flushing usage events
2021-09-30 18:22:43.795558 (MainThread): ctrl-c
2021-09-30 18:32:46.515241 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:32:47.593645 (MainThread): Loading KWallet
2021-09-30 18:32:47.594942 (MainThread): Loading SecretService
2021-09-30 18:32:47.596034 (MainThread): Loading Windows
2021-09-30 18:32:47.597353 (MainThread): Loading chainer
2021-09-30 18:32:47.598038 (MainThread): Loading macOS
2021-09-30 18:32:48.018704 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.018804 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.018878 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.018948 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.044339 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-09-30 18:32:48.046264 (MainThread): Tracking: tracking
2021-09-30 18:32:48.046825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6c6d4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6d9f9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6d9f99a0>]}
2021-09-30 18:32:48.051272 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.051506 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.051678 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.051831 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.058280 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.058529 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.058702 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.058852 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-09-30 18:32:48.067347 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6e851a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6e8519a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6e851af0>]}
2021-09-30 18:32:48.067781 (MainThread): Flushing usage events
2021-09-30 18:32:50.139938 (MainThread): Encountered an error:
2021-09-30 18:32:50.140218 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils
2021-09-30 18:32:50.145202 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0-b1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils

2021-09-30 18:33:05.326594 (MainThread): Running with dbt=0.21.0-b1
2021-09-30 18:33:06.019022 (MainThread): Loading KWallet
2021-09-30 18:33:06.019988 (MainThread): Loading SecretService
2021-09-30 18:33:06.020750 (MainThread): Loading Windows
2021-09-30 18:33:06.021837 (MainThread): Loading chainer
2021-09-30 18:33:06.022416 (MainThread): Loading macOS
2021-09-30 18:33:06.438737 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='seed', write_json=True)
2021-09-30 18:33:06.440618 (MainThread): Tracking: tracking
2021-09-30 18:33:06.441079 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a1053b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a2e657f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a2448d00>]}
2021-09-30 18:33:06.463576 (MainThread): Partial parsing not enabled
2021-09-30 18:33:06.522443 (MainThread): Parsing macros/generate_schema_name.sql
2021-09-30 18:33:06.524257 (MainThread): Parsing macros/catalog.sql
2021-09-30 18:33:06.526946 (MainThread): Parsing macros/adapters.sql
2021-09-30 18:33:06.584833 (MainThread): Parsing macros/materializations/merge.sql
2021-09-30 18:33:06.590063 (MainThread): Parsing macros/materializations/seed.sql
2021-09-30 18:33:06.595559 (MainThread): Parsing macros/materializations/view.sql
2021-09-30 18:33:06.597268 (MainThread): Parsing macros/materializations/table.sql
2021-09-30 18:33:06.601689 (MainThread): Parsing macros/materializations/incremental.sql
2021-09-30 18:33:06.613543 (MainThread): Parsing macros/core.sql
2021-09-30 18:33:06.618289 (MainThread): Parsing macros/materializations/test.sql
2021-09-30 18:33:06.626527 (MainThread): Parsing macros/materializations/helpers.sql
2021-09-30 18:33:06.638568 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-09-30 18:33:06.640656 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-09-30 18:33:06.661023 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-09-30 18:33:06.694871 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-09-30 18:33:06.716936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-09-30 18:33:06.718585 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-09-30 18:33:06.728353 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-09-30 18:33:06.748935 (MainThread): Parsing macros/materializations/common/merge.sql
2021-09-30 18:33:06.767749 (MainThread): Parsing macros/materializations/table/table.sql
2021-09-30 18:33:06.784609 (MainThread): Parsing macros/materializations/view/view.sql
2021-09-30 18:33:06.795657 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-09-30 18:33:06.801105 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-09-30 18:33:06.802427 (MainThread): Parsing macros/etc/query.sql
2021-09-30 18:33:06.804094 (MainThread): Parsing macros/etc/is_incremental.sql
2021-09-30 18:33:06.806477 (MainThread): Parsing macros/etc/datetime.sql
2021-09-30 18:33:06.818728 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-09-30 18:33:06.821482 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-09-30 18:33:06.823426 (MainThread): Parsing macros/adapters/common.sql
2021-09-30 18:33:06.890622 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-09-30 18:33:06.892444 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-09-30 18:33:06.893557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-09-30 18:33:06.894802 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-09-30 18:33:06.896843 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-09-30 18:33:06.897925 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-09-30 18:33:06.899133 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-09-30 18:33:06.901597 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-09-30 18:33:06.907101 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-09-30 18:33:06.908298 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-09-30 18:33:06.909574 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-09-30 18:33:06.911801 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-09-30 18:33:06.912846 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-09-30 18:33:06.914976 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-09-30 18:33:06.924332 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-09-30 18:33:06.926099 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-09-30 18:33:06.927429 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-09-30 18:33:06.929107 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-09-30 18:33:06.930568 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-09-30 18:33:06.931446 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-09-30 18:33:06.934539 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-09-30 18:33:06.940028 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-09-30 18:33:06.940924 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-09-30 18:33:06.943632 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-09-30 18:33:06.945345 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-09-30 18:33:06.946757 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-09-30 18:33:06.948613 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-09-30 18:33:06.972023 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-09-30 18:33:06.972780 (MainThread): Parsing macros/logger/pretty_time.sql
2021-09-30 18:33:06.973444 (MainThread): Parsing macros/logger/log_info.sql
2021-09-30 18:33:06.974021 (MainThread): Parsing macros/datetime/date_spine.sql
2021-09-30 18:33:06.976999 (MainThread): Parsing macros/web/get_url_host.sql
2021-09-30 18:33:06.978160 (MainThread): Parsing macros/web/get_url_path.sql
2021-09-30 18:33:06.980310 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-09-30 18:33:06.981432 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-09-30 18:33:06.982221 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-09-30 18:33:06.983544 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-09-30 18:33:06.985379 (MainThread): Parsing macros/schema_tests/recency.sql
2021-09-30 18:33:06.986493 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-09-30 18:33:06.987339 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-09-30 18:33:06.988715 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-09-30 18:33:06.989563 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-09-30 18:33:06.991802 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-09-30 18:33:06.993104 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-09-30 18:33:06.994010 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-09-30 18:33:06.995177 (MainThread): Parsing macros/schema_tests/equality.sql
2021-09-30 18:33:06.998541 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-09-30 18:33:07.003814 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-09-30 18:33:07.004857 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-09-30 18:33:07.007082 (MainThread): Parsing macros/sql/generate_series.sql
2021-09-30 18:33:07.010022 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-09-30 18:33:07.012363 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-09-30 18:33:07.013212 (MainThread): Parsing macros/sql/star.sql
2021-09-30 18:33:07.015662 (MainThread): Parsing macros/sql/unpivot.sql
2021-09-30 18:33:07.021637 (MainThread): Parsing macros/sql/union.sql
2021-09-30 18:33:07.028997 (MainThread): Parsing macros/sql/groupby.sql
2021-09-30 18:33:07.029909 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-09-30 18:33:07.032372 (MainThread): Parsing macros/sql/safe_add.sql
2021-09-30 18:33:07.033241 (MainThread): Parsing macros/sql/nullcheck.sql
2021-09-30 18:33:07.034426 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-09-30 18:33:07.037446 (MainThread): Parsing macros/sql/get_column_values.sql
2021-09-30 18:33:07.041488 (MainThread): Parsing macros/sql/pivot.sql
2021-09-30 18:33:07.043954 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-09-30 18:33:07.247707 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-09-30 18:33:07.248026 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f3b3de9-ab40-47a0-afaa-4495f756a0c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a3020550>]}
2021-09-30 18:33:07.406992 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-09-30 18:33:07.434529 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-09-30 18:33:07.561469 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-09-30 18:33:07.568279 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-09-30 18:33:07.696823 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f3b3de9-ab40-47a0-afaa-4495f756a0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a2e10d90>]}
2021-09-30 18:33:07.708955 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f3b3de9-ab40-47a0-afaa-4495f756a0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a2ef1e50>]}
2021-09-30 18:33:07.709338 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-09-30 18:33:07.711095 (MainThread): 
2021-09-30 18:33:07.711712 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 18:33:07.713054 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-09-30 18:33:07.743645 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-09-30 18:33:07.743935 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-09-30 18:33:07.744113 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-30 18:33:10.254628 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.51 seconds
2021-09-30 18:33:10.256690 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-09-30 18:33:11.040135 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 18:33:11.047238 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-09-30 18:33:11.047463 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-09-30 18:33:11.047617 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 18:33:13.065796 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.02 seconds
2021-09-30 18:33:13.067927 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-09-30 18:33:13.754338 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 18:33:13.756966 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-09-30 18:33:13.757157 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-09-30 18:33:13.757311 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 18:33:15.575620 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.82 seconds
2021-09-30 18:33:15.577325 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-09-30 18:33:16.203447 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 18:33:16.205885 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-09-30 18:33:16.206060 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-09-30 18:33:16.206209 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-09-30 18:33:18.210987 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4cd9-0000-36fb-0000-cdb90002215a
2021-09-30 18:33:18.211212 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-09-30 18:33:18.211402 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-09-30 18:33:18.211540 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-09-30 18:33:18.211723 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-09-30 18:33:18.880513 (MainThread): 00:03:18 | Concurrency: 1 threads (target='dev')
2021-09-30 18:33:18.881302 (MainThread): 00:03:18 | 
2021-09-30 18:33:18.883064 (Thread-1): Began running node seed.dbt_demo_project.locations
2021-09-30 18:33:18.883554 (Thread-1): 00:03:18 | 1 of 1 START seed file PUBLIC.locations.............................. [RUN]
2021-09-30 18:33:18.884292 (Thread-1): Acquiring new snowflake connection "seed.dbt_demo_project.locations".
2021-09-30 18:33:18.884663 (Thread-1): finished collecting timing info
2021-09-30 18:33:18.943038 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-09-30 18:33:18.943454 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f3b3de9-ab40-47a0-afaa-4495f756a0c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a38582b0>]}
2021-09-30 18:33:18.944601 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-09-30 18:33:18.944799 (Thread-1): On seed.dbt_demo_project.locations: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "seed.dbt_demo_project.locations"} */

    create table DEMO_DB.PUBLIC.locations (city text,state text,country text,pincode integer)
2021-09-30 18:33:18.944979 (Thread-1): Opening a new connection, currently in state closed
2021-09-30 18:33:21.104647 (Thread-1): SQL status: SUCCESS 1 in 2.16 seconds
2021-09-30 18:33:21.119253 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-09-30 18:33:21.119441 (Thread-1): On seed.dbt_demo_project.locations: BEGIN
2021-09-30 18:33:21.521423 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-09-30 18:33:21.522173 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-09-30 18:33:21.522372 (Thread-1): On seed.dbt_demo_project.locations: insert into DEMO_DB.PUBLIC.locations (city, state, country, pincode) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
2021-09-30 18:33:22.883689 (Thread-1): SQL status: SUCCESS 4 in 1.36 seconds
2021-09-30 18:33:22.884116 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-09-30 18:33:22.884275 (Thread-1): On seed.dbt_demo_project.locations: COMMIT
2021-09-30 18:33:23.596150 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-09-30 18:33:23.600026 (Thread-1): Writing runtime SQL for node "seed.dbt_demo_project.locations"
2021-09-30 18:33:23.611789 (Thread-1): finished collecting timing info
2021-09-30 18:33:23.612009 (Thread-1): On seed.dbt_demo_project.locations: Close
2021-09-30 18:33:24.416164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3b3de9-ab40-47a0-afaa-4495f756a0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a384a2b0>]}
2021-09-30 18:33:24.416581 (Thread-1): 00:03:24 | 1 of 1 OK loaded seed file PUBLIC.locations.......................... [INSERT 4 in 5.53s]
2021-09-30 18:33:24.416823 (Thread-1): Finished running node seed.dbt_demo_project.locations
2021-09-30 18:33:24.418001 (MainThread): Acquiring new snowflake connection "master".
2021-09-30 18:33:24.418342 (MainThread): 00:03:24 | 
2021-09-30 18:33:24.418528 (MainThread): 00:03:24 | Finished running 1 seed in 16.71s.
2021-09-30 18:33:24.418695 (MainThread): Connection 'master' was properly closed.
2021-09-30 18:33:24.418832 (MainThread): Connection 'seed.dbt_demo_project.locations' was properly closed.
2021-09-30 18:33:24.427237 (MainThread): 
2021-09-30 18:33:24.427604 (MainThread): Completed successfully
2021-09-30 18:33:24.427957 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-09-30 18:33:24.428285 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a2e79040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a3108250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89a33f1c40>]}
2021-09-30 18:33:24.428642 (MainThread): Flushing usage events
2021-10-01 05:37:01.607215 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 05:37:03.049770 (MainThread): Loading KWallet
2021-10-01 05:37:03.051102 (MainThread): Loading SecretService
2021-10-01 05:37:03.052286 (MainThread): Loading Windows
2021-10-01 05:37:03.053610 (MainThread): Loading chainer
2021-10-01 05:37:03.054396 (MainThread): Loading macOS
2021-10-01 05:37:03.607706 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 05:37:03.609892 (MainThread): Tracking: tracking
2021-10-01 05:37:03.610243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab0013df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab120c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab120c100>]}
2021-10-01 05:37:03.631319 (MainThread): Partial parsing not enabled
2021-10-01 05:37:03.692006 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 05:37:03.693196 (MainThread): Parsing macros/catalog.sql
2021-10-01 05:37:03.695203 (MainThread): Parsing macros/adapters.sql
2021-10-01 05:37:03.732952 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 05:37:03.737162 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 05:37:03.741765 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 05:37:03.743275 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 05:37:03.747102 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 05:37:03.757779 (MainThread): Parsing macros/core.sql
2021-10-01 05:37:03.762995 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 05:37:03.771794 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 05:37:03.783560 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 05:37:03.785554 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 05:37:03.805919 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 05:37:03.846596 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 05:37:03.867469 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 05:37:03.869205 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 05:37:03.879627 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 05:37:03.899953 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 05:37:03.913767 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 05:37:03.921694 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 05:37:03.928959 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 05:37:03.932672 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 05:37:03.933571 (MainThread): Parsing macros/etc/query.sql
2021-10-01 05:37:03.934524 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 05:37:03.935905 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 05:37:03.944182 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 05:37:03.946204 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 05:37:03.947618 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 05:37:04.002317 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 05:37:04.004387 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 05:37:04.005845 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 05:37:04.007073 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 05:37:04.009076 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 05:37:04.010189 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 05:37:04.011416 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 05:37:04.013992 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 05:37:04.019556 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 05:37:04.020717 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 05:37:04.021921 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 05:37:04.024140 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 05:37:04.025136 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 05:37:04.027271 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 05:37:04.036481 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 05:37:04.038238 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 05:37:04.039593 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 05:37:04.041124 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 05:37:04.042777 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 05:37:04.043655 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 05:37:04.046879 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 05:37:04.051943 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 05:37:04.052683 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 05:37:04.055290 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 05:37:04.057010 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 05:37:04.058669 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 05:37:04.060521 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 05:37:04.085052 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 05:37:04.085731 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 05:37:04.086368 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 05:37:04.087044 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 05:37:04.090085 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 05:37:04.091246 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 05:37:04.093260 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 05:37:04.094373 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 05:37:04.095323 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 05:37:04.096459 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 05:37:04.098340 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 05:37:04.099401 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 05:37:04.100397 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 05:37:04.101761 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 05:37:04.102600 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 05:37:04.104895 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 05:37:04.106593 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 05:37:04.107511 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 05:37:04.108882 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 05:37:04.112340 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 05:37:04.118623 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 05:37:04.120720 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 05:37:04.123758 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 05:37:04.127542 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 05:37:04.130454 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 05:37:04.131460 (MainThread): Parsing macros/sql/star.sql
2021-10-01 05:37:04.134352 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 05:37:04.142973 (MainThread): Parsing macros/sql/union.sql
2021-10-01 05:37:04.150425 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 05:37:04.151331 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 05:37:04.154180 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 05:37:04.155435 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 05:37:04.156767 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 05:37:04.159256 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 05:37:04.163040 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 05:37:04.165550 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 05:37:04.358549 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 05:37:04.358770 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab202b8e0>]}
2021-10-01 05:37:04.470925 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 05:37:04.480167 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 05:37:04.536656 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 05:37:04.541377 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 05:37:04.635631 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab1f17670>]}
2021-10-01 05:37:04.643777 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab21278e0>]}
2021-10-01 05:37:04.644132 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 05:37:04.645607 (MainThread): 
2021-10-01 05:37:04.646044 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 05:37:04.647031 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 05:37:04.660876 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 05:37:04.661088 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 05:37:04.661235 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 05:37:06.630474 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.97 seconds
2021-10-01 05:37:06.632354 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 05:37:07.206286 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 05:37:07.208722 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 05:37:07.208931 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 05:37:07.209086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-01 05:37:08.956472 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.75 seconds
2021-10-01 05:37:08.958102 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 05:37:09.527363 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 05:37:09.534767 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 05:37:09.534984 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 05:37:09.535155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 05:37:11.076479 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 1.54 seconds
2021-10-01 05:37:11.078644 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 05:37:11.624821 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 05:37:11.627641 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 05:37:11.627836 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 05:37:11.627993 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 05:37:13.223044 (ThreadPoolExecutor-1_0): Snowflake query id: 019f4f71-0000-36fb-0000-cdb9000221aa
2021-10-01 05:37:13.231295 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-10-01 05:37:13.231587 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-10-01 05:37:13.231894 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-10-01 05:37:13.232266 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 05:37:13.791314 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 05:37:13.793259 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 05:37:13.793579 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 05:37:13.793719 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 05:37:15.340727 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.55 seconds
2021-10-01 05:37:15.342250 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 05:37:15.951083 (MainThread): 11:07:15 | Concurrency: 1 threads (target='dev')
2021-10-01 05:37:15.951392 (MainThread): 11:07:15 | 
2021-10-01 05:37:15.952494 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 05:37:15.952821 (Thread-1): 11:07:15 | 1 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 05:37:15.953172 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 05:37:15.953358 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 05:37:15.956498 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 05:37:15.958258 (Thread-1): finished collecting timing info
2021-10-01 05:37:15.986954 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 05:37:15.989073 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 05:37:15.989340 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 05:37:15.989523 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 05:37:19.418040 (Thread-1): SQL status: SUCCESS 1 in 3.43 seconds
2021-10-01 05:37:19.429264 (Thread-1): finished collecting timing info
2021-10-01 05:37:19.429523 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 05:37:19.991784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab295c040>]}
2021-10-01 05:37:19.992229 (Thread-1): 11:07:19 | 1 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 4.04s]
2021-10-01 05:37:19.992442 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 05:37:19.992646 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-10-01 05:37:19.993009 (Thread-1): 11:07:19 | 2 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-10-01 05:37:19.993414 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 05:37:19.993588 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-10-01 05:37:19.996313 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-10-01 05:37:19.997269 (Thread-1): finished collecting timing info
2021-10-01 05:37:19.999713 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-10-01 05:37:20.001530 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 05:37:20.001765 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 05:37:20.001958 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 05:37:23.235334 (Thread-1): SQL status: SUCCESS 1 in 3.23 seconds
2021-10-01 05:37:23.236773 (Thread-1): finished collecting timing info
2021-10-01 05:37:23.236985 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-10-01 05:37:23.845056 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab295cb80>]}
2021-10-01 05:37:23.845508 (Thread-1): 11:07:23 | 2 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.85s]
2021-10-01 05:37:23.845717 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-10-01 05:37:23.845927 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 05:37:23.846278 (Thread-1): 11:07:23 | 3 of 4 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 05:37:23.846705 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 05:37:23.846898 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 05:37:23.851165 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 05:37:23.853136 (Thread-1): finished collecting timing info
2021-10-01 05:37:23.855355 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 05:37:23.856575 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 05:37:23.856800 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 05:37:23.856986 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 05:37:26.474058 (Thread-1): SQL status: SUCCESS 1 in 2.62 seconds
2021-10-01 05:37:26.475735 (Thread-1): finished collecting timing info
2021-10-01 05:37:26.475968 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 05:37:27.030687 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab295c2e0>]}
2021-10-01 05:37:27.031193 (Thread-1): 11:07:27 | 3 of 4 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.18s]
2021-10-01 05:37:27.031397 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 05:37:27.031606 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-10-01 05:37:27.031951 (Thread-1): 11:07:27 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-10-01 05:37:27.032270 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 05:37:27.032444 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-10-01 05:37:27.035141 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-10-01 05:37:27.036746 (Thread-1): finished collecting timing info
2021-10-01 05:37:27.053602 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-10-01 05:37:27.054773 (Thread-1): Using snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 05:37:27.054982 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-10-01 05:37:27.055147 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 05:37:28.745885 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-01 05:37:28.747760 (Thread-1): finished collecting timing info
2021-10-01 05:37:28.748033 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-10-01 05:37:29.318387 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8df1b914-609b-48fd-9204-050f4b7dbc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab29876d0>]}
2021-10-01 05:37:29.318856 (Thread-1): 11:07:29 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.29s]
2021-10-01 05:37:29.319069 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-10-01 05:37:29.320132 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 05:37:29.320498 (MainThread): 11:07:29 | 
2021-10-01 05:37:29.320691 (MainThread): 11:07:29 | Finished running 3 table models, 1 view model in 24.67s.
2021-10-01 05:37:29.320860 (MainThread): Connection 'master' was properly closed.
2021-10-01 05:37:29.320998 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-10-01 05:37:29.329293 (MainThread): 
2021-10-01 05:37:29.329581 (MainThread): Completed successfully
2021-10-01 05:37:29.329829 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-01 05:37:29.330181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab1f17040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab21092e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab1f73700>]}
2021-10-01 05:37:29.330490 (MainThread): Flushing usage events
2021-10-01 08:51:56.305513 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 08:51:58.116820 (MainThread): Loading KWallet
2021-10-01 08:51:58.118232 (MainThread): Loading SecretService
2021-10-01 08:51:58.119064 (MainThread): Loading Windows
2021-10-01 08:51:58.120128 (MainThread): Loading chainer
2021-10-01 08:51:58.120757 (MainThread): Loading macOS
2021-10-01 08:51:59.092120 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='seed', write_json=True)
2021-10-01 08:51:59.094503 (MainThread): Tracking: tracking
2021-10-01 08:51:59.095002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96b6f8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96cb49d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96cb499a0>]}
2021-10-01 08:51:59.117258 (MainThread): Partial parsing not enabled
2021-10-01 08:51:59.171983 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 08:51:59.173272 (MainThread): Parsing macros/catalog.sql
2021-10-01 08:51:59.175289 (MainThread): Parsing macros/adapters.sql
2021-10-01 08:51:59.217296 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 08:51:59.223387 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 08:51:59.230807 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 08:51:59.233214 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 08:51:59.238495 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 08:51:59.251169 (MainThread): Parsing macros/core.sql
2021-10-01 08:51:59.257344 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 08:51:59.267248 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 08:51:59.281047 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 08:51:59.283201 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 08:51:59.302961 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 08:51:59.338929 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 08:51:59.361246 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 08:51:59.363075 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 08:51:59.372814 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 08:51:59.393069 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 08:51:59.407126 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 08:51:59.415242 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 08:51:59.422269 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 08:51:59.425959 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 08:51:59.426745 (MainThread): Parsing macros/etc/query.sql
2021-10-01 08:51:59.427646 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 08:51:59.429238 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 08:51:59.437343 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 08:51:59.439299 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 08:51:59.441603 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 08:51:59.499925 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 08:51:59.502081 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 08:51:59.503406 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 08:51:59.504763 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 08:51:59.506902 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 08:51:59.507966 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 08:51:59.509197 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 08:51:59.511410 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 08:51:59.517748 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 08:51:59.518985 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 08:51:59.520249 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 08:51:59.522443 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 08:51:59.523506 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 08:51:59.525646 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 08:51:59.534830 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 08:51:59.536611 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 08:51:59.537999 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 08:51:59.539573 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 08:51:59.541033 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 08:51:59.541962 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 08:51:59.545072 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 08:51:59.550350 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 08:51:59.551115 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 08:51:59.553691 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 08:51:59.555512 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 08:51:59.556914 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 08:51:59.558712 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 08:51:59.580539 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 08:51:59.581140 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 08:51:59.581768 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 08:51:59.582334 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 08:51:59.585351 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 08:51:59.586585 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 08:51:59.588468 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 08:51:59.589396 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 08:51:59.590244 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 08:51:59.591342 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 08:51:59.593134 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 08:51:59.594445 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 08:51:59.595457 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 08:51:59.596811 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 08:51:59.597659 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 08:51:59.599884 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 08:51:59.601158 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 08:51:59.602060 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 08:51:59.603226 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 08:51:59.606502 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 08:51:59.611923 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 08:51:59.613201 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 08:51:59.615459 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 08:51:59.618307 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 08:51:59.620553 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 08:51:59.621354 (MainThread): Parsing macros/sql/star.sql
2021-10-01 08:51:59.623922 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 08:51:59.629559 (MainThread): Parsing macros/sql/union.sql
2021-10-01 08:51:59.638020 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 08:51:59.638984 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 08:51:59.641504 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 08:51:59.642385 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 08:51:59.643403 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 08:51:59.645907 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 08:51:59.649469 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 08:51:59.651791 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 08:51:59.823745 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 08:51:59.823961 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a159aa6-7ac7-4923-a2a2-e0a307525122', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96d91ee50>]}
2021-10-01 08:51:59.944536 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 08:51:59.954819 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 08:52:00.013090 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 08:52:00.018069 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 08:52:00.124926 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a159aa6-7ac7-4923-a2a2-e0a307525122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96d813310>]}
2021-10-01 08:52:00.133690 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a159aa6-7ac7-4923-a2a2-e0a307525122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96da265b0>]}
2021-10-01 08:52:00.134053 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 08:52:00.135467 (MainThread): 
2021-10-01 08:52:00.135932 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:52:00.136752 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 08:52:00.151003 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 08:52:00.151194 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 08:52:00.151341 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 08:52:02.328721 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.18 seconds
2021-10-01 08:52:02.330252 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 08:52:02.954839 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 08:52:02.961979 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 08:52:02.962193 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 08:52:02.962342 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 08:52:04.579227 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.62 seconds
2021-10-01 08:52:04.580599 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 08:52:05.140904 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 08:52:05.142879 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 08:52:05.143014 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 08:52:05.143126 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 08:52:06.893997 (ThreadPoolExecutor-1_0): Snowflake query id: 019f5034-0000-36fb-0000-cdb9000221d6
2021-10-01 08:52:06.894226 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-10-01 08:52:06.894424 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-10-01 08:52:06.894559 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-10-01 08:52:06.894746 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 08:52:07.464367 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 08:52:07.466070 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 08:52:07.466198 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 08:52:07.466308 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 08:52:08.994339 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.53 seconds
2021-10-01 08:52:08.996071 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 08:52:09.556001 (MainThread): 14:22:09 | Concurrency: 1 threads (target='dev')
2021-10-01 08:52:09.556195 (MainThread): 14:22:09 | 
2021-10-01 08:52:09.557096 (Thread-1): Began running node seed.dbt_demo_project.locations
2021-10-01 08:52:09.557360 (Thread-1): 14:22:09 | 1 of 1 START seed file SALES_SCHEMA.locations........................ [RUN]
2021-10-01 08:52:09.557630 (Thread-1): Acquiring new snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 08:52:09.557770 (Thread-1): finished collecting timing info
2021-10-01 08:52:09.583663 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-10-01 08:52:09.583866 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a159aa6-7ac7-4923-a2a2-e0a307525122', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96dee5310>]}
2021-10-01 08:52:09.585745 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 08:52:09.585870 (Thread-1): On seed.dbt_demo_project.locations: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "seed.dbt_demo_project.locations"} */

    create table DEMO_DB.SALES_SCHEMA.locations (city text,state text,country text,pincode integer)
2021-10-01 08:52:09.585980 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 08:52:11.291817 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-10-01 08:52:11.304578 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 08:52:11.304737 (Thread-1): On seed.dbt_demo_project.locations: BEGIN
2021-10-01 08:52:11.664363 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-01 08:52:11.664908 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 08:52:11.665064 (Thread-1): On seed.dbt_demo_project.locations: insert into DEMO_DB.SALES_SCHEMA.locations (city, state, country, pincode) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
2021-10-01 08:52:13.390840 (Thread-1): SQL status: SUCCESS 4 in 1.73 seconds
2021-10-01 08:52:13.391213 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 08:52:13.391388 (Thread-1): On seed.dbt_demo_project.locations: COMMIT
2021-10-01 08:52:13.998629 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-10-01 08:52:14.003274 (Thread-1): Writing runtime SQL for node "seed.dbt_demo_project.locations"
2021-10-01 08:52:14.016841 (Thread-1): finished collecting timing info
2021-10-01 08:52:14.017091 (Thread-1): On seed.dbt_demo_project.locations: Close
2021-10-01 08:52:14.596626 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a159aa6-7ac7-4923-a2a2-e0a307525122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96df428e0>]}
2021-10-01 08:52:14.597010 (Thread-1): 14:22:14 | 1 of 1 OK loaded seed file SALES_SCHEMA.locations.................... [INSERT 4 in 5.04s]
2021-10-01 08:52:14.597224 (Thread-1): Finished running node seed.dbt_demo_project.locations
2021-10-01 08:52:14.598316 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:52:14.598699 (MainThread): 14:22:14 | 
2021-10-01 08:52:14.598897 (MainThread): 14:22:14 | Finished running 1 seed in 14.46s.
2021-10-01 08:52:14.599064 (MainThread): Connection 'master' was properly closed.
2021-10-01 08:52:14.599200 (MainThread): Connection 'seed.dbt_demo_project.locations' was properly closed.
2021-10-01 08:52:14.607338 (MainThread): 
2021-10-01 08:52:14.607603 (MainThread): Completed successfully
2021-10-01 08:52:14.607796 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-01 08:52:14.608051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96da06f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96d9aa430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96dd2e3a0>]}
2021-10-01 08:52:14.608325 (MainThread): Flushing usage events
2021-10-01 09:11:15.625046 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 09:11:16.888293 (MainThread): Loading KWallet
2021-10-01 09:11:16.889471 (MainThread): Loading SecretService
2021-10-01 09:11:16.890300 (MainThread): Loading Windows
2021-10-01 09:11:16.891523 (MainThread): Loading chainer
2021-10-01 09:11:16.892176 (MainThread): Loading macOS
2021-10-01 09:11:17.750518 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='seed', write_json=True)
2021-10-01 09:11:17.752651 (MainThread): Tracking: tracking
2021-10-01 09:11:17.753142 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd720013c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7212d5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7212d5ac0>]}
2021-10-01 09:11:17.785217 (MainThread): Partial parsing not enabled
2021-10-01 09:11:17.889694 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 09:11:17.891416 (MainThread): Parsing macros/catalog.sql
2021-10-01 09:11:17.894490 (MainThread): Parsing macros/adapters.sql
2021-10-01 09:11:17.956476 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 09:11:17.965203 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 09:11:17.976699 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 09:11:17.981157 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 09:11:17.987554 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 09:11:18.003767 (MainThread): Parsing macros/core.sql
2021-10-01 09:11:18.011431 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 09:11:18.027646 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 09:11:18.044101 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 09:11:18.046660 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 09:11:18.088061 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 09:11:18.144042 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 09:11:18.171701 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 09:11:18.174109 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 09:11:18.189571 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 09:11:18.217152 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 09:11:18.235380 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 09:11:18.247464 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 09:11:18.258578 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 09:11:18.264089 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 09:11:18.265381 (MainThread): Parsing macros/etc/query.sql
2021-10-01 09:11:18.266578 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 09:11:18.268545 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 09:11:18.279782 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 09:11:18.282304 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 09:11:18.284279 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 09:11:18.367543 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 09:11:18.369714 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 09:11:18.371161 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 09:11:18.373144 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 09:11:18.375898 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 09:11:18.377313 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 09:11:18.379077 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 09:11:18.382195 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 09:11:18.390061 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 09:11:18.391812 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 09:11:18.394318 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 09:11:18.400237 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 09:11:18.401673 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 09:11:18.404725 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 09:11:18.417861 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 09:11:18.420530 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 09:11:18.423844 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 09:11:18.426644 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 09:11:18.430946 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 09:11:18.432264 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 09:11:18.436694 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 09:11:18.443828 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 09:11:18.445097 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 09:11:18.448753 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 09:11:18.451374 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 09:11:18.453573 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 09:11:18.455964 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 09:11:18.487323 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 09:11:18.488275 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 09:11:18.489148 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 09:11:18.489937 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 09:11:18.494070 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 09:11:18.495696 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 09:11:18.498366 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 09:11:18.499704 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 09:11:18.500897 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 09:11:18.502648 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 09:11:18.505044 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 09:11:18.506453 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 09:11:18.507568 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 09:11:18.509547 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 09:11:18.510691 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 09:11:18.513695 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 09:11:18.515755 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 09:11:18.517269 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 09:11:18.519019 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 09:11:18.523543 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 09:11:18.530830 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 09:11:18.532518 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 09:11:18.535527 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 09:11:18.539491 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 09:11:18.542638 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 09:11:18.543797 (MainThread): Parsing macros/sql/star.sql
2021-10-01 09:11:18.547006 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 09:11:18.554894 (MainThread): Parsing macros/sql/union.sql
2021-10-01 09:11:18.564141 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 09:11:18.565685 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 09:11:18.569061 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 09:11:18.570232 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 09:11:18.571554 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 09:11:18.574959 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 09:11:18.579666 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 09:11:18.583253 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 09:11:18.804089 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 09:11:18.804349 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '701c64a4-5941-4b68-a1ff-df78aad4a6c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd721ece340>]}
2021-10-01 09:11:18.943030 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 09:11:18.953598 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 09:11:19.013742 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '701c64a4-5941-4b68-a1ff-df78aad4a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd721d9bfa0>]}
2021-10-01 09:11:19.015367 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 09:11:19.020699 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 09:11:19.135943 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '701c64a4-5941-4b68-a1ff-df78aad4a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd721dd2d90>]}
2021-10-01 09:11:19.146545 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '701c64a4-5941-4b68-a1ff-df78aad4a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd721fe84f0>]}
2021-10-01 09:11:19.146942 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 09:11:19.148392 (MainThread): 
2021-10-01 09:11:19.148875 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:11:19.149757 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 09:11:19.164870 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 09:11:19.165122 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 09:11:19.165282 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 09:11:21.150741 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.99 seconds
2021-10-01 09:11:21.152352 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 09:11:21.719627 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:11:21.727580 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:11:21.727830 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 09:11:21.727988 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:11:23.370060 (ThreadPoolExecutor-1_0): Snowflake query id: 019f5047-0000-36dc-0000-cdb90001f586
2021-10-01 09:11:23.370278 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-10-01 09:11:23.370473 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-10-01 09:11:23.370612 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-10-01 09:11:23.370803 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 09:11:23.982058 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:11:23.984403 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:11:23.984595 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 09:11:23.984748 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:11:25.776861 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.79 seconds
2021-10-01 09:11:25.778686 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 09:11:26.345292 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:11:26.347628 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:11:26.347801 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 09:11:26.347959 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:11:28.018205 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.67 seconds
2021-10-01 09:11:28.020300 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 09:11:28.626341 (MainThread): 14:41:28 | Concurrency: 1 threads (target='dev')
2021-10-01 09:11:28.627290 (MainThread): 14:41:28 | 
2021-10-01 09:11:28.630045 (Thread-1): Began running node seed.dbt_demo_project.locations
2021-10-01 09:11:28.631369 (Thread-1): 14:41:28 | 1 of 1 START seed file SALES_SCHEMA.locations........................ [RUN]
2021-10-01 09:11:28.632236 (Thread-1): Acquiring new snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:28.632496 (Thread-1): finished collecting timing info
2021-10-01 09:11:28.672753 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:28.673001 (Thread-1): On seed.dbt_demo_project.locations: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "seed.dbt_demo_project.locations"} */
begin;
2021-10-01 09:11:28.673157 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:11:30.359569 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-01 09:11:30.359853 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:30.360008 (Thread-1): On seed.dbt_demo_project.locations: truncate table "DEMO_DB"."SALES_SCHEMA"."LOCATIONS"
  ;
2021-10-01 09:11:30.932923 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-10-01 09:11:30.933224 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:30.933393 (Thread-1): On seed.dbt_demo_project.locations: commit;
2021-10-01 09:11:31.583073 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-10-01 09:11:31.598709 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-10-01 09:11:31.598985 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '701c64a4-5941-4b68-a1ff-df78aad4a6c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7229d20d0>]}
2021-10-01 09:11:31.599605 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:31.599782 (Thread-1): On seed.dbt_demo_project.locations: BEGIN
2021-10-01 09:11:31.980847 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-01 09:11:31.981456 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:31.981626 (Thread-1): On seed.dbt_demo_project.locations: insert into DEMO_DB.SALES_SCHEMA.locations (city, state, country, pincode) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
2021-10-01 09:11:33.040671 (Thread-1): SQL status: SUCCESS 5 in 1.06 seconds
2021-10-01 09:11:33.041009 (Thread-1): Using snowflake connection "seed.dbt_demo_project.locations".
2021-10-01 09:11:33.041161 (Thread-1): On seed.dbt_demo_project.locations: COMMIT
2021-10-01 09:11:33.624893 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-10-01 09:11:33.629830 (Thread-1): Writing runtime SQL for node "seed.dbt_demo_project.locations"
2021-10-01 09:11:33.637662 (Thread-1): finished collecting timing info
2021-10-01 09:11:33.637917 (Thread-1): On seed.dbt_demo_project.locations: Close
2021-10-01 09:11:34.235582 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701c64a4-5941-4b68-a1ff-df78aad4a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7225fdb80>]}
2021-10-01 09:11:34.236004 (Thread-1): 14:41:34 | 1 of 1 OK loaded seed file SALES_SCHEMA.locations.................... [INSERT 5 in 5.60s]
2021-10-01 09:11:34.236400 (Thread-1): Finished running node seed.dbt_demo_project.locations
2021-10-01 09:11:34.237505 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:11:34.237862 (MainThread): 14:41:34 | 
2021-10-01 09:11:34.238049 (MainThread): 14:41:34 | Finished running 1 seed in 15.09s.
2021-10-01 09:11:34.238213 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:11:34.238348 (MainThread): Connection 'seed.dbt_demo_project.locations' was properly closed.
2021-10-01 09:11:34.247433 (MainThread): 
2021-10-01 09:11:34.247748 (MainThread): Completed successfully
2021-10-01 09:11:34.247995 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-01 09:11:34.248307 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd721eb4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd721f72100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72292d8e0>]}
2021-10-01 09:11:34.248583 (MainThread): Flushing usage events
2021-10-01 09:14:54.690868 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 09:14:56.701284 (MainThread): Loading KWallet
2021-10-01 09:14:56.702674 (MainThread): Loading SecretService
2021-10-01 09:14:56.703802 (MainThread): Loading Windows
2021-10-01 09:14:56.705233 (MainThread): Loading chainer
2021-10-01 09:14:56.706245 (MainThread): Loading macOS
2021-10-01 09:14:57.284623 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.284775 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.284873 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.284963 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.319687 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['example'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-10-01 09:14:57.322019 (MainThread): Tracking: tracking
2021-10-01 09:14:57.322577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f8f14c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fa315d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fa315af0>]}
2021-10-01 09:14:57.327310 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.327569 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.327736 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.327905 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.336129 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.336399 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.336574 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.336728 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-01 09:14:57.347430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fae8edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fae8ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0fae8e490>]}
2021-10-01 09:14:57.347980 (MainThread): Flushing usage events
2021-10-01 09:14:58.555409 (MainThread): Encountered an error:
2021-10-01 09:14:58.555733 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils
2021-10-01 09:14:58.560896 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0-b1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils

2021-10-01 09:15:14.221703 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 09:15:16.287943 (MainThread): Loading KWallet
2021-10-01 09:15:16.288999 (MainThread): Loading SecretService
2021-10-01 09:15:16.289772 (MainThread): Loading Windows
2021-10-01 09:15:16.290697 (MainThread): Loading chainer
2021-10-01 09:15:16.291240 (MainThread): Loading macOS
2021-10-01 09:15:17.303397 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['example'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 09:15:17.305384 (MainThread): Tracking: tracking
2021-10-01 09:15:17.305863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff20ff53c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff211215af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff211215ac0>]}
2021-10-01 09:15:17.330163 (MainThread): Partial parsing not enabled
2021-10-01 09:15:17.410357 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 09:15:17.413348 (MainThread): Parsing macros/catalog.sql
2021-10-01 09:15:17.416513 (MainThread): Parsing macros/adapters.sql
2021-10-01 09:15:17.469312 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 09:15:17.475060 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 09:15:17.482091 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 09:15:17.484304 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 09:15:17.488581 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 09:15:17.500090 (MainThread): Parsing macros/core.sql
2021-10-01 09:15:17.505420 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 09:15:17.515808 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 09:15:17.528349 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 09:15:17.530602 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 09:15:17.552741 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 09:15:17.602806 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 09:15:17.635565 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 09:15:17.637791 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 09:15:17.651543 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 09:15:17.680975 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 09:15:17.700019 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 09:15:17.712156 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 09:15:17.722008 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 09:15:17.726848 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 09:15:17.728006 (MainThread): Parsing macros/etc/query.sql
2021-10-01 09:15:17.729220 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 09:15:17.731081 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 09:15:17.741828 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 09:15:17.744112 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 09:15:17.745998 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 09:15:17.818503 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 09:15:17.820778 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 09:15:17.822236 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 09:15:17.823851 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 09:15:17.826490 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 09:15:17.827985 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 09:15:17.830371 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 09:15:17.833691 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 09:15:17.841418 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 09:15:17.843087 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 09:15:17.844768 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 09:15:17.849114 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 09:15:17.852501 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 09:15:17.856297 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 09:15:17.871120 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 09:15:17.873887 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 09:15:17.876048 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 09:15:17.878242 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 09:15:17.880472 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 09:15:17.881825 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 09:15:17.886934 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 09:15:17.894230 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 09:15:17.895336 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 09:15:17.899129 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 09:15:17.901886 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 09:15:17.904019 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 09:15:17.906479 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 09:15:17.937542 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 09:15:17.938477 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 09:15:17.939403 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 09:15:17.940297 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 09:15:17.944577 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 09:15:17.946248 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 09:15:17.948756 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 09:15:17.950137 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 09:15:17.951285 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 09:15:17.953007 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 09:15:17.955422 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 09:15:17.956965 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 09:15:17.958214 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 09:15:17.960336 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 09:15:17.962413 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 09:15:17.966868 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 09:15:17.969023 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 09:15:17.970520 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 09:15:17.972385 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 09:15:17.977171 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 09:15:17.985299 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 09:15:17.986889 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 09:15:17.989912 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 09:15:17.993783 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 09:15:17.996804 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 09:15:17.998094 (MainThread): Parsing macros/sql/star.sql
2021-10-01 09:15:18.001591 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 09:15:18.009683 (MainThread): Parsing macros/sql/union.sql
2021-10-01 09:15:18.020479 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 09:15:18.021638 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 09:15:18.024990 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 09:15:18.026189 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 09:15:18.027620 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 09:15:18.031447 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 09:15:18.036895 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 09:15:18.040782 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 09:15:18.289466 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 09:15:18.289735 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ec365031-cab6-4f67-b703-838d3104ecc8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff21200f340>]}
2021-10-01 09:15:18.455913 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 09:15:18.468751 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 09:15:18.538296 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 09:15:18.543464 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 09:15:18.659523 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec365031-cab6-4f67-b703-838d3104ecc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff211f14850>]}
2021-10-01 09:15:18.670640 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec365031-cab6-4f67-b703-838d3104ecc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2121284f0>]}
2021-10-01 09:15:18.671058 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 09:15:18.672892 (MainThread): 
2021-10-01 09:15:18.673540 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:15:18.675130 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:15:18.692548 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:15:18.692767 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 09:15:18.692921 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 09:15:21.121099 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.43 seconds
2021-10-01 09:15:21.123083 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 09:15:21.703993 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:15:21.706711 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:15:21.706944 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 09:15:21.707125 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:15:23.557765 (ThreadPoolExecutor-1_0): Snowflake query id: 019f504b-0000-36bc-0000-cdb900023052
2021-10-01 09:15:23.557978 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-10-01 09:15:23.558174 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-10-01 09:15:23.558314 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-10-01 09:15:23.558506 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 09:15:24.210043 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:15:24.213756 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:15:24.214005 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 09:15:24.214173 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:15:25.987109 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.77 seconds
2021-10-01 09:15:25.988843 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 09:15:26.553495 (MainThread): 14:45:26 | Concurrency: 1 threads (target='dev')
2021-10-01 09:15:26.553983 (MainThread): 14:45:26 | 
2021-10-01 09:15:26.556109 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-01 09:15:26.556444 (Thread-1): 14:45:26 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-01 09:15:26.556948 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-01 09:15:26.557146 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-01 09:15:26.571991 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-10-01 09:15:26.576218 (Thread-1): finished collecting timing info
2021-10-01 09:15:26.617712 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-10-01 09:15:26.620066 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-01 09:15:26.620320 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-01 09:15:26.620503 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:15:29.292043 (Thread-1): SQL status: SUCCESS 1 in 2.67 seconds
2021-10-01 09:15:29.295455 (Thread-1): finished collecting timing info
2021-10-01 09:15:29.295726 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-01 09:15:29.880636 (Thread-1): 14:45:29 | 1 of 4 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 3.32s]
2021-10-01 09:15:29.880921 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-01 09:15:29.881146 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-01 09:15:29.881436 (Thread-1): 14:45:29 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-01 09:15:29.881797 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-01 09:15:29.881985 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-01 09:15:29.887817 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-01 09:15:29.889381 (Thread-1): finished collecting timing info
2021-10-01 09:15:29.891970 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-01 09:15:30.127707 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-01 09:15:30.127958 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.PUBLIC.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-01 09:15:30.128204 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:15:32.058606 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2021-10-01 09:15:32.060170 (Thread-1): finished collecting timing info
2021-10-01 09:15:32.060392 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-01 09:15:32.619778 (Thread-1): 14:45:32 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 2.74s]
2021-10-01 09:15:32.620102 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-01 09:15:32.620343 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-01 09:15:32.620552 (Thread-1): 14:45:32 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-01 09:15:32.621090 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-01 09:15:32.621296 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-01 09:15:32.632531 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-01 09:15:32.633545 (Thread-1): finished collecting timing info
2021-10-01 09:15:32.636418 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-01 09:15:32.638032 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-01 09:15:32.638238 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-01 09:15:32.638437 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:15:35.455627 (Thread-1): SQL status: SUCCESS 1 in 2.82 seconds
2021-10-01 09:15:35.457123 (Thread-1): finished collecting timing info
2021-10-01 09:15:35.457342 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-01 09:15:36.063634 (Thread-1): 14:45:36 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 3.44s]
2021-10-01 09:15:36.064113 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-01 09:15:36.064485 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-01 09:15:36.065197 (Thread-1): 14:45:36 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-01 09:15:36.065897 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-01 09:15:36.066355 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-01 09:15:36.072724 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-10-01 09:15:36.074600 (Thread-1): finished collecting timing info
2021-10-01 09:15:36.078177 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-10-01 09:15:36.127086 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-01 09:15:36.127353 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-01 09:15:36.127522 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:15:38.204706 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2021-10-01 09:15:38.206304 (Thread-1): finished collecting timing info
2021-10-01 09:15:38.206577 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-01 09:15:38.807817 (Thread-1): 14:45:38 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 2.74s]
2021-10-01 09:15:38.808098 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-01 09:15:38.809130 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:15:38.809474 (MainThread): 14:45:38 | 
2021-10-01 09:15:38.809660 (MainThread): 14:45:38 | Finished running 4 tests in 20.14s.
2021-10-01 09:15:38.809824 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:15:38.809963 (MainThread): Connection 'test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570' was properly closed.
2021-10-01 09:15:38.819151 (MainThread): 
2021-10-01 09:15:38.819448 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 09:15:38.819645 (MainThread): 
2021-10-01 09:15:38.819848 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-10-01 09:15:38.820041 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-01 09:15:38.820284 (MainThread): 
2021-10-01 09:15:38.820466 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-10-01 09:15:38.820663 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-10-01 09:15:38.820927 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff20ff53c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2120af130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff212787700>]}
2021-10-01 09:15:38.821334 (MainThread): Flushing usage events
2021-10-01 09:16:02.368485 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 09:16:03.618599 (MainThread): Loading KWallet
2021-10-01 09:16:03.621241 (MainThread): Loading SecretService
2021-10-01 09:16:03.623205 (MainThread): Loading Windows
2021-10-01 09:16:03.626219 (MainThread): Loading chainer
2021-10-01 09:16:03.629402 (MainThread): Loading macOS
2021-10-01 09:16:04.270384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['example'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 09:16:04.272869 (MainThread): Tracking: tracking
2021-10-01 09:16:04.273604 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c27e13cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29318af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29318ac0>]}
2021-10-01 09:16:04.296154 (MainThread): Partial parsing not enabled
2021-10-01 09:16:04.381190 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 09:16:04.382771 (MainThread): Parsing macros/catalog.sql
2021-10-01 09:16:04.385377 (MainThread): Parsing macros/adapters.sql
2021-10-01 09:16:04.438438 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 09:16:04.443281 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 09:16:04.450022 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 09:16:04.452855 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 09:16:04.457309 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 09:16:04.473137 (MainThread): Parsing macros/core.sql
2021-10-01 09:16:04.478152 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 09:16:04.487116 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 09:16:04.500575 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 09:16:04.503288 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 09:16:04.532746 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 09:16:04.579606 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 09:16:04.615111 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 09:16:04.617630 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 09:16:04.632879 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 09:16:04.665038 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 09:16:04.687193 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 09:16:04.699810 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 09:16:04.715381 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 09:16:04.722173 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 09:16:04.726298 (MainThread): Parsing macros/etc/query.sql
2021-10-01 09:16:04.728864 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 09:16:04.732421 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 09:16:04.751645 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 09:16:04.755376 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 09:16:04.760515 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 09:16:04.862572 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 09:16:04.867227 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 09:16:04.869758 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 09:16:04.872513 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 09:16:04.876769 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 09:16:04.879859 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 09:16:04.882179 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 09:16:04.886010 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 09:16:04.898690 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 09:16:04.900624 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 09:16:04.904221 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 09:16:04.908260 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 09:16:04.909757 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 09:16:04.912830 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 09:16:04.925509 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 09:16:04.928534 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 09:16:04.930580 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 09:16:04.934872 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 09:16:04.937221 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 09:16:04.938507 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 09:16:04.942643 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 09:16:04.949224 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 09:16:04.950193 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 09:16:04.953533 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 09:16:04.955871 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 09:16:04.957816 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 09:16:04.960479 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 09:16:04.993317 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 09:16:04.994340 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 09:16:04.995895 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 09:16:04.997297 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 09:16:05.006399 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 09:16:05.008699 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 09:16:05.011493 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 09:16:05.012792 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 09:16:05.013884 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 09:16:05.015406 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 09:16:05.017772 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 09:16:05.019170 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 09:16:05.020295 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 09:16:05.022096 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 09:16:05.023200 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 09:16:05.026239 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 09:16:05.028415 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 09:16:05.030096 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 09:16:05.031927 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 09:16:05.040004 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 09:16:05.047170 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 09:16:05.048584 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 09:16:05.051517 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 09:16:05.055312 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 09:16:05.058339 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 09:16:05.059599 (MainThread): Parsing macros/sql/star.sql
2021-10-01 09:16:05.063188 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 09:16:05.072549 (MainThread): Parsing macros/sql/union.sql
2021-10-01 09:16:05.082191 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 09:16:05.083323 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 09:16:05.086684 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 09:16:05.087880 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 09:16:05.089478 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 09:16:05.092961 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 09:16:05.098549 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 09:16:05.102916 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 09:16:05.349204 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 09:16:05.349494 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de8874c3-54e3-46a0-8a50-ca56b6b41cbc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29de0340>]}
2021-10-01 09:16:05.539880 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 09:16:05.556554 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 09:16:05.671460 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 09:16:05.682421 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 09:16:05.823451 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de8874c3-54e3-46a0-8a50-ca56b6b41cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29ce2850>]}
2021-10-01 09:16:05.837179 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de8874c3-54e3-46a0-8a50-ca56b6b41cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29ef74f0>]}
2021-10-01 09:16:05.837816 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 09:16:05.839596 (MainThread): 
2021-10-01 09:16:05.840191 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:16:05.841261 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 09:16:05.856510 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 09:16:05.856752 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 09:16:05.856925 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 09:16:07.977901 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.12 seconds
2021-10-01 09:16:07.979741 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 09:16:08.570743 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_DEMO_DB_dbt_test__audit".
2021-10-01 09:16:08.571109 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_DEMO_DB_dbt_test__audit".
2021-10-01 09:16:08.571330 (ThreadPoolExecutor-0_0): Creating schema "DEMO_DB.dbt_test__audit"
2021-10-01 09:16:08.576446 (ThreadPoolExecutor-0_0): Using snowflake connection "create_DEMO_DB_dbt_test__audit".
2021-10-01 09:16:08.576612 (ThreadPoolExecutor-0_0): On create_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "create_DEMO_DB_dbt_test__audit"} */
create schema if not exists DEMO_DB.dbt_test__audit
2021-10-01 09:16:08.576758 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-01 09:16:10.483912 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.91 seconds
2021-10-01 09:16:10.485321 (ThreadPoolExecutor-0_0): On create_DEMO_DB_dbt_test__audit: Close
2021-10-01 09:16:11.099454 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:16:11.110189 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:16:11.110663 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 09:16:11.110901 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:16:12.811596 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.70 seconds
2021-10-01 09:16:12.814494 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 09:16:13.430528 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:16:13.439359 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:16:13.440503 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 09:16:13.440940 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:16:15.099867 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.66 seconds
2021-10-01 09:16:15.104903 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 09:16:15.681169 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:16:15.683564 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:16:15.683747 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 09:16:15.683903 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:16:17.532007 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.85 seconds
2021-10-01 09:16:17.533664 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 09:16:18.108976 (MainThread): 14:46:18 | Concurrency: 1 threads (target='dev')
2021-10-01 09:16:18.109300 (MainThread): 14:46:18 | 
2021-10-01 09:16:18.110889 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-01 09:16:18.111303 (Thread-1): 14:46:18 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-01 09:16:18.111833 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-01 09:16:18.112060 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-01 09:16:18.123826 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-10-01 09:16:18.124609 (Thread-1): finished collecting timing info
2021-10-01 09:16:18.158406 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-01 09:16:18.158657 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_my_first_dbt_model_id  as
      (
    
    

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id is null



      );
2021-10-01 09:16:18.158828 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:16:20.634772 (Thread-1): SQL status: SUCCESS 1 in 2.48 seconds
2021-10-01 09:16:20.643495 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-10-01 09:16:20.645418 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-01 09:16:20.645854 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_my_first_dbt_model_id
    
      
    ) dbt_internal_test
2021-10-01 09:16:21.132544 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-01 09:16:21.135140 (Thread-1): finished collecting timing info
2021-10-01 09:16:21.135450 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-01 09:16:21.751493 (Thread-1): 14:46:21 | 1 of 4 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 3.64s]
2021-10-01 09:16:21.751802 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-01 09:16:21.752022 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-01 09:16:21.752352 (Thread-1): 14:46:21 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-01 09:16:21.752825 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-01 09:16:21.753097 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-01 09:16:21.757916 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-01 09:16:21.759331 (Thread-1): finished collecting timing info
2021-10-01 09:16:21.762416 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-01 09:16:21.762775 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_my_second_dbt_model_id  as
      (
    
    

select *
from DEMO_DB.PUBLIC.my_second_dbt_model
where id is null



      );
2021-10-01 09:16:21.763022 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:16:24.088052 (Thread-1): SQL status: SUCCESS 1 in 2.33 seconds
2021-10-01 09:16:24.089423 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-01 09:16:24.090660 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-01 09:16:24.090851 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_my_second_dbt_model_id
    
      
    ) dbt_internal_test
2021-10-01 09:16:24.528775 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-01 09:16:24.530706 (Thread-1): finished collecting timing info
2021-10-01 09:16:24.531180 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-01 09:16:25.094140 (Thread-1): 14:46:25 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 3.34s]
2021-10-01 09:16:25.094437 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-01 09:16:25.094661 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-01 09:16:25.094931 (Thread-1): 14:46:25 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-01 09:16:25.095337 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-01 09:16:25.095544 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-01 09:16:25.106151 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-01 09:16:25.107415 (Thread-1): finished collecting timing info
2021-10-01 09:16:25.112353 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-01 09:16:25.112631 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_my_first_dbt_model_id  as
      (
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      );
2021-10-01 09:16:25.112813 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:16:27.503860 (Thread-1): SQL status: SUCCESS 1 in 2.39 seconds
2021-10-01 09:16:27.505223 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-01 09:16:27.506427 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-01 09:16:27.506609 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_my_first_dbt_model_id
    
      
    ) dbt_internal_test
2021-10-01 09:16:27.944399 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-01 09:16:27.946091 (Thread-1): finished collecting timing info
2021-10-01 09:16:27.946367 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-01 09:16:28.507766 (Thread-1): 14:46:28 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 3.41s]
2021-10-01 09:16:28.508281 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-01 09:16:28.508566 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-01 09:16:28.509010 (Thread-1): 14:46:28 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-01 09:16:28.509602 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-01 09:16:28.509851 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-01 09:16:28.515093 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-10-01 09:16:28.515796 (Thread-1): finished collecting timing info
2021-10-01 09:16:28.518811 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-01 09:16:28.519075 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_my_second_dbt_model_id  as
      (
    
    

select
    id,
    count(*) as n_records

from DEMO_DB.PUBLIC.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      );
2021-10-01 09:16:28.519249 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:16:30.743722 (Thread-1): SQL status: SUCCESS 1 in 2.22 seconds
2021-10-01 09:16:30.745207 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-10-01 09:16:30.746713 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-01 09:16:30.746927 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_my_second_dbt_model_id
    
      
    ) dbt_internal_test
2021-10-01 09:16:31.197690 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-10-01 09:16:31.199263 (Thread-1): finished collecting timing info
2021-10-01 09:16:31.199502 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-01 09:16:31.769318 (Thread-1): 14:46:31 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 3.26s]
2021-10-01 09:16:31.769696 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-01 09:16:31.771414 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:16:31.771850 (MainThread): 14:46:31 | 
2021-10-01 09:16:31.772077 (MainThread): 14:46:31 | Finished running 4 tests in 25.93s.
2021-10-01 09:16:31.772313 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:16:31.772486 (MainThread): Connection 'test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570' was properly closed.
2021-10-01 09:16:31.782597 (MainThread): 
2021-10-01 09:16:31.783091 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 09:16:31.783398 (MainThread): 
2021-10-01 09:16:31.783723 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-10-01 09:16:31.784017 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-01 09:16:31.784294 (MainThread): 
2021-10-01 09:16:31.784501 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-10-01 09:16:31.784702 (MainThread): 
2021-10-01 09:16:31.784875 (MainThread):   See test failures:
  --------------------------------------------------------------------
  select * from DEMO_DB.dbt_test__audit.not_null_my_first_dbt_model_id
  --------------------------------------------------------------------
2021-10-01 09:16:31.785063 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-10-01 09:16:31.785313 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29e13130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29d476a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29dc8970>]}
2021-10-01 09:16:31.785655 (MainThread): Flushing usage events
2021-10-01 09:45:34.263367 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 09:45:36.516662 (MainThread): Loading KWallet
2021-10-01 09:45:36.518201 (MainThread): Loading SecretService
2021-10-01 09:45:36.519506 (MainThread): Loading Windows
2021-10-01 09:45:36.521175 (MainThread): Loading chainer
2021-10-01 09:45:36.521996 (MainThread): Loading macOS
2021-10-01 09:45:37.127814 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 09:45:37.130682 (MainThread): Tracking: tracking
2021-10-01 09:45:37.131118 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd016713d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd018642190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd017b16190>]}
2021-10-01 09:45:37.156256 (MainThread): Partial parsing not enabled
2021-10-01 09:45:37.226377 (MainThread): Parsing macros/test_empty.sql
2021-10-01 09:45:37.227404 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 09:45:37.228523 (MainThread): Parsing macros/catalog.sql
2021-10-01 09:45:37.230967 (MainThread): Parsing macros/adapters.sql
2021-10-01 09:45:37.284951 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 09:45:37.290847 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 09:45:37.296775 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 09:45:37.298520 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 09:45:37.302339 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 09:45:37.313501 (MainThread): Parsing macros/core.sql
2021-10-01 09:45:37.318023 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 09:45:37.326205 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 09:45:37.338448 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 09:45:37.340473 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 09:45:37.361026 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 09:45:37.406157 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 09:45:37.436716 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 09:45:37.438795 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 09:45:37.450598 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 09:45:37.473740 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 09:45:37.489441 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 09:45:37.497918 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 09:45:37.505833 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 09:45:37.509871 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 09:45:37.510848 (MainThread): Parsing macros/etc/query.sql
2021-10-01 09:45:37.511918 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 09:45:37.513631 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 09:45:37.523318 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 09:45:37.525465 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 09:45:37.527217 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 09:45:37.591999 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 09:45:37.594018 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 09:45:37.595311 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 09:45:37.596750 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 09:45:37.599027 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 09:45:37.600202 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 09:45:37.601799 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 09:45:37.604706 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 09:45:37.611578 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 09:45:37.613123 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 09:45:37.614621 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 09:45:37.617322 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 09:45:37.618532 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 09:45:37.621317 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 09:45:37.631861 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 09:45:37.633951 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 09:45:37.635354 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 09:45:37.636960 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 09:45:37.638546 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 09:45:37.639547 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 09:45:37.643185 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 09:45:37.649205 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 09:45:37.650119 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 09:45:37.653150 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 09:45:37.655217 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 09:45:37.656955 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 09:45:37.659231 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 09:45:37.690389 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 09:45:37.691279 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 09:45:37.692169 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 09:45:37.693050 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 09:45:37.697005 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 09:45:37.698502 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 09:45:37.700968 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 09:45:37.702277 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 09:45:37.703333 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 09:45:37.705102 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 09:45:37.707420 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 09:45:37.708726 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 09:45:37.709758 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 09:45:37.711415 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 09:45:37.712474 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 09:45:37.715219 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 09:45:37.716810 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 09:45:37.717920 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 09:45:37.719372 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 09:45:37.723602 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 09:45:37.730384 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 09:45:37.731625 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 09:45:37.734282 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 09:45:37.737734 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 09:45:37.740533 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 09:45:37.741589 (MainThread): Parsing macros/sql/star.sql
2021-10-01 09:45:37.744629 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 09:45:37.752023 (MainThread): Parsing macros/sql/union.sql
2021-10-01 09:45:37.763051 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 09:45:37.764216 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 09:45:37.768382 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 09:45:37.769948 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 09:45:37.771343 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 09:45:37.774722 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 09:45:37.779667 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 09:45:37.782711 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 09:45:37.992799 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 09:45:37.993251 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e483c380-9bb0-4671-9a2a-6761a315c766', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd018825be0>]}
2021-10-01 09:45:38.162478 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 09:45:38.232516 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 09:45:38.237142 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 09:45:38.242398 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 09:45:38.364440 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e483c380-9bb0-4671-9a2a-6761a315c766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd018618b80>]}
2021-10-01 09:45:38.374918 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e483c380-9bb0-4671-9a2a-6761a315c766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd018629b50>]}
2021-10-01 09:45:38.375316 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 09:45:38.376979 (MainThread): 
2021-10-01 09:45:38.377529 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:45:38.378583 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 09:45:38.394935 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 09:45:38.395162 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 09:45:38.395321 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 09:45:40.438340 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.04 seconds
2021-10-01 09:45:40.440044 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 09:45:41.016184 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:45:41.023899 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:45:41.024134 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 09:45:41.024288 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:45:42.619361 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.60 seconds
2021-10-01 09:45:42.621805 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 09:45:43.243205 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:45:43.245733 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:45:43.245917 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 09:45:43.246068 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:45:45.165431 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.92 seconds
2021-10-01 09:45:45.166966 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 09:45:45.803929 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:45:45.806360 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:45:45.806562 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 09:45:45.806720 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:45:47.439655 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.63 seconds
2021-10-01 09:45:47.441310 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 09:45:48.041661 (MainThread): 15:15:48 | Concurrency: 1 threads (target='dev')
2021-10-01 09:45:48.041928 (MainThread): 15:15:48 | 
2021-10-01 09:45:48.043261 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 09:45:48.043555 (Thread-1): 15:15:48 | 1 of 3 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-01 09:45:48.043941 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 09:45:48.044119 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 09:45:48.048805 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 09:45:48.050003 (Thread-1): finished collecting timing info
2021-10-01 09:45:48.077025 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 09:45:48.077274 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_  as
      (

with validation as (

    select case when count(*)==0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.cust_count_by_state

)

select *
from validation


      );
2021-10-01 09:45:48.077442 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:45:49.846105 (Thread-1): Snowflake query id: 019f5069-0000-36fb-0000-cdb900022262
2021-10-01 09:45:49.846355 (Thread-1): Snowflake error: 002140 (42601): SQL compilation error:
Unknown function "=="
2021-10-01 09:45:49.846570 (Thread-1): finished collecting timing info
2021-10-01 09:45:49.846775 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-01 09:45:50.467401 (Thread-1): Database Error in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
  002140 (42601): SQL compilation error:
  Unknown function "=="
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002140 (42601): SQL compilation error:
Unknown function "=="

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 82, in execute_test
    macro_func()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 74, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
  002140 (42601): SQL compilation error:
  Unknown function "=="
2021-10-01 09:45:50.470187 (Thread-1): 15:15:50 | 1 of 3 ERROR is_not_empty_cust_count_by_state_....................... [ERROR in 2.43s]
2021-10-01 09:45:50.470436 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 09:45:50.470646 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 09:45:50.471019 (Thread-1): 15:15:50 | 2 of 3 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-01 09:45:50.471478 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:45:50.471664 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 09:45:50.479979 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 09:45:50.480992 (Thread-1): finished collecting timing info
2021-10-01 09:45:50.483963 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:45:50.484204 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      );
2021-10-01 09:45:50.484453 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:45:53.801016 (Thread-1): SQL status: SUCCESS 1 in 3.32 seconds
2021-10-01 09:45:53.806590 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 09:45:53.808960 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:45:53.809136 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 09:45:54.481001 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-10-01 09:45:54.483813 (Thread-1): finished collecting timing info
2021-10-01 09:45:54.484048 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-01 09:45:55.166143 (Thread-1): 15:15:55 | 2 of 3 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 4.69s]
2021-10-01 09:45:55.166417 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 09:45:55.166640 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 09:45:55.166931 (Thread-1): 15:15:55 | 3 of 3 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-01 09:45:55.167253 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:45:55.167430 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 09:45:55.176544 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 09:45:55.177314 (Thread-1): finished collecting timing info
2021-10-01 09:45:55.180256 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:45:55.180480 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      );
2021-10-01 09:45:55.180667 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:45:58.305580 (Thread-1): SQL status: SUCCESS 1 in 3.12 seconds
2021-10-01 09:45:58.306907 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 09:45:58.309083 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:45:58.309267 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 09:45:58.867397 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-10-01 09:45:58.869180 (Thread-1): finished collecting timing info
2021-10-01 09:45:58.869406 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-01 09:45:59.444566 (Thread-1): 15:15:59 | 3 of 3 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 4.28s]
2021-10-01 09:45:59.444836 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 09:45:59.445932 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:45:59.446279 (MainThread): 15:15:59 | 
2021-10-01 09:45:59.446467 (MainThread): 15:15:59 | Finished running 3 tests in 21.07s.
2021-10-01 09:45:59.446631 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:45:59.446768 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-01 09:45:59.455844 (MainThread): 
2021-10-01 09:45:59.456125 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 09:45:59.456311 (MainThread): 
2021-10-01 09:45:59.456539 (MainThread): Database Error in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
2021-10-01 09:45:59.456869 (MainThread):   002140 (42601): SQL compilation error:
2021-10-01 09:45:59.457147 (MainThread):   Unknown function "=="
2021-10-01 09:45:59.457339 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 09:45:59.457605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd019124eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0140a13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01866e6a0>]}
2021-10-01 09:45:59.458005 (MainThread): Flushing usage events
2021-10-01 09:46:19.615484 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 09:46:20.832911 (MainThread): Loading KWallet
2021-10-01 09:46:20.834068 (MainThread): Loading SecretService
2021-10-01 09:46:20.835153 (MainThread): Loading Windows
2021-10-01 09:46:20.836428 (MainThread): Loading chainer
2021-10-01 09:46:20.837276 (MainThread): Loading macOS
2021-10-01 09:46:21.351755 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 09:46:21.353705 (MainThread): Tracking: tracking
2021-10-01 09:46:21.354187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0c713c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0db16d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0db16af0>]}
2021-10-01 09:46:21.378721 (MainThread): Partial parsing not enabled
2021-10-01 09:46:21.442076 (MainThread): Parsing macros/test_empty.sql
2021-10-01 09:46:21.443115 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 09:46:21.444270 (MainThread): Parsing macros/catalog.sql
2021-10-01 09:46:21.447205 (MainThread): Parsing macros/adapters.sql
2021-10-01 09:46:21.498039 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 09:46:21.504472 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 09:46:21.511524 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 09:46:21.513675 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 09:46:21.517750 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 09:46:21.529135 (MainThread): Parsing macros/core.sql
2021-10-01 09:46:21.534675 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 09:46:21.544918 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 09:46:21.558312 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 09:46:21.560548 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 09:46:21.583803 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 09:46:21.626320 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 09:46:21.653460 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 09:46:21.655902 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 09:46:21.672479 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 09:46:21.698558 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 09:46:21.718788 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 09:46:21.728655 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 09:46:21.737854 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 09:46:21.743254 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 09:46:21.744491 (MainThread): Parsing macros/etc/query.sql
2021-10-01 09:46:21.745680 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 09:46:21.747557 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 09:46:21.759706 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 09:46:21.762767 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 09:46:21.765272 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 09:46:21.846859 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 09:46:21.849501 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 09:46:21.851013 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 09:46:21.852766 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 09:46:21.855687 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 09:46:21.857633 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 09:46:21.859399 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 09:46:21.863372 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 09:46:21.871601 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 09:46:21.873296 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 09:46:21.874934 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 09:46:21.877957 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 09:46:21.879332 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 09:46:21.882160 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 09:46:21.896168 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 09:46:21.898986 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 09:46:21.900917 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 09:46:21.903344 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 09:46:21.906370 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 09:46:21.907611 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 09:46:21.911727 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 09:46:21.918714 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 09:46:21.919709 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 09:46:21.923060 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 09:46:21.925256 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 09:46:21.927157 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 09:46:21.929519 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 09:46:21.958627 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 09:46:21.959457 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 09:46:21.960281 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 09:46:21.960998 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 09:46:21.965410 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 09:46:21.966894 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 09:46:21.969510 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 09:46:21.970766 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 09:46:21.971755 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 09:46:21.973120 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 09:46:21.975292 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 09:46:21.976634 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 09:46:21.977991 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 09:46:21.979692 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 09:46:21.980704 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 09:46:21.983375 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 09:46:21.985251 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 09:46:21.986428 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 09:46:21.988166 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 09:46:21.992442 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 09:46:21.999145 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 09:46:22.000432 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 09:46:22.003166 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 09:46:22.007031 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 09:46:22.010008 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 09:46:22.011224 (MainThread): Parsing macros/sql/star.sql
2021-10-01 09:46:22.014901 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 09:46:22.022210 (MainThread): Parsing macros/sql/union.sql
2021-10-01 09:46:22.031441 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 09:46:22.032672 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 09:46:22.036462 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 09:46:22.037819 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 09:46:22.039461 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 09:46:22.043106 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 09:46:22.048191 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 09:46:22.051561 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 09:46:22.265375 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 09:46:22.265627 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b0954c7-3cf6-42ce-b492-7f378bff026f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0e72c160>]}
2021-10-01 09:46:22.422229 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 09:46:22.495100 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 09:46:22.499525 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 09:46:22.504469 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 09:46:22.625073 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0954c7-3cf6-42ce-b492-7f378bff026f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0c724610>]}
2021-10-01 09:46:22.635151 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0954c7-3cf6-42ce-b492-7f378bff026f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0e817370>]}
2021-10-01 09:46:22.635518 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 09:46:22.636909 (MainThread): 
2021-10-01 09:46:22.637369 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:46:22.638335 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 09:46:22.653116 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 09:46:22.653365 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 09:46:22.653520 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 09:46:24.623030 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.97 seconds
2021-10-01 09:46:24.624683 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 09:46:25.205629 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:46:25.213149 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 09:46:25.213362 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 09:46:25.213511 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:46:26.966942 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.75 seconds
2021-10-01 09:46:26.968727 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 09:46:27.546828 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:46:27.549346 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 09:46:27.549529 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 09:46:27.549678 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:46:29.137039 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.59 seconds
2021-10-01 09:46:29.139028 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 09:46:29.707485 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:46:29.709879 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 09:46:29.710051 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 09:46:29.710197 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 09:46:31.430905 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.72 seconds
2021-10-01 09:46:31.432559 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 09:46:32.024164 (MainThread): 15:16:32 | Concurrency: 1 threads (target='dev')
2021-10-01 09:46:32.024426 (MainThread): 15:16:32 | 
2021-10-01 09:46:32.025566 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 09:46:32.025846 (Thread-1): 15:16:32 | 1 of 3 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-01 09:46:32.026235 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 09:46:32.026424 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 09:46:32.032443 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 09:46:32.033230 (Thread-1): finished collecting timing info
2021-10-01 09:46:32.071284 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 09:46:32.071705 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_  as
      (

with validation as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.cust_count_by_state

)

select *
from validation


      );
2021-10-01 09:46:32.071903 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:46:34.443628 (Thread-1): SQL status: SUCCESS 1 in 2.37 seconds
2021-10-01 09:46:34.449542 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 09:46:34.451205 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 09:46:34.451552 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_
    
      
    ) dbt_internal_test
2021-10-01 09:46:34.998056 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-10-01 09:46:35.016125 (Thread-1): finished collecting timing info
2021-10-01 09:46:35.016753 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-01 09:46:35.607312 (Thread-1): 15:16:35 | 1 of 3 FAIL 1 is_not_empty_cust_count_by_state_...................... [FAIL 1 in 3.58s]
2021-10-01 09:46:35.607884 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 09:46:35.608110 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 09:46:35.608407 (Thread-1): 15:16:35 | 2 of 3 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-01 09:46:35.608743 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:46:35.608919 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 09:46:35.616579 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 09:46:35.617227 (Thread-1): finished collecting timing info
2021-10-01 09:46:35.626268 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:46:35.626493 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."NOT_NULL_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 09:46:35.626663 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:46:37.656963 (Thread-1): SQL status: SUCCESS 1 in 2.03 seconds
2021-10-01 09:46:37.658906 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:46:37.659125 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      );
2021-10-01 09:46:38.613957 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-01 09:46:38.615250 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 09:46:38.616369 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 09:46:38.616547 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 09:46:39.204073 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-10-01 09:46:39.205929 (Thread-1): finished collecting timing info
2021-10-01 09:46:39.206163 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-01 09:46:39.803571 (Thread-1): 15:16:39 | 2 of 3 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 4.19s]
2021-10-01 09:46:39.803942 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 09:46:39.804364 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 09:46:39.804946 (Thread-1): 15:16:39 | 3 of 3 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-01 09:46:39.805576 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:46:39.805891 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 09:46:39.814432 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 09:46:39.815177 (Thread-1): finished collecting timing info
2021-10-01 09:46:39.819417 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:46:39.819653 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."UNIQUE_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 09:46:39.819809 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:46:41.441306 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-10-01 09:46:41.443312 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:46:41.443504 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      );
2021-10-01 09:46:42.418284 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-01 09:46:42.419785 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 09:46:42.421555 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 09:46:42.421800 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 09:46:42.859724 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-01 09:46:42.861288 (Thread-1): finished collecting timing info
2021-10-01 09:46:42.861529 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-01 09:46:43.462692 (Thread-1): 15:16:43 | 3 of 3 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 3.66s]
2021-10-01 09:46:43.463305 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 09:46:43.465273 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:46:43.466016 (MainThread): 15:16:43 | 
2021-10-01 09:46:43.466451 (MainThread): 15:16:43 | Finished running 3 tests in 20.83s.
2021-10-01 09:46:43.466729 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:46:43.466940 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-01 09:46:43.479385 (MainThread): 
2021-10-01 09:46:43.479798 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 09:46:43.480237 (MainThread): 
2021-10-01 09:46:43.480656 (MainThread): Failure in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
2021-10-01 09:46:43.480964 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-01 09:46:43.481277 (MainThread): 
2021-10-01 09:46:43.481640 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/snowflake_model_data/schema.yml/schema_test/is_not_empty_cust_count_by_state_.sql
2021-10-01 09:46:43.481933 (MainThread): 
2021-10-01 09:46:43.482223 (MainThread):   See test failures:
  -----------------------------------------------------------------------
  select * from DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_
  -----------------------------------------------------------------------
2021-10-01 09:46:43.482637 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 09:46:43.483142 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0c724610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0c713c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0e677700>]}
2021-10-01 09:46:43.483640 (MainThread): Flushing usage events
2021-10-01 10:01:06.834070 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 10:01:08.087924 (MainThread): Loading KWallet
2021-10-01 10:01:08.089269 (MainThread): Loading SecretService
2021-10-01 10:01:08.090294 (MainThread): Loading Windows
2021-10-01 10:01:08.091666 (MainThread): Loading chainer
2021-10-01 10:01:08.092311 (MainThread): Loading macOS
2021-10-01 10:01:08.646059 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 10:01:08.648070 (MainThread): Tracking: tracking
2021-10-01 10:01:08.648553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb712113eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7131f8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7131f8100>]}
2021-10-01 10:01:08.672755 (MainThread): Partial parsing not enabled
2021-10-01 10:01:08.738330 (MainThread): Parsing macros/test_empty.sql
2021-10-01 10:01:08.739271 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 10:01:08.740466 (MainThread): Parsing macros/catalog.sql
2021-10-01 10:01:08.742983 (MainThread): Parsing macros/adapters.sql
2021-10-01 10:01:08.783178 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 10:01:08.786885 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 10:01:08.791035 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 10:01:08.792329 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 10:01:08.795306 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 10:01:08.803296 (MainThread): Parsing macros/core.sql
2021-10-01 10:01:08.806930 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 10:01:08.813595 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 10:01:08.824658 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 10:01:08.827050 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 10:01:08.849544 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 10:01:08.893186 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 10:01:08.919200 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 10:01:08.921292 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 10:01:08.933439 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 10:01:08.957781 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 10:01:08.974420 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 10:01:08.984439 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 10:01:08.994140 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 10:01:08.999070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 10:01:09.000184 (MainThread): Parsing macros/etc/query.sql
2021-10-01 10:01:09.001310 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 10:01:09.003222 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 10:01:09.014166 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 10:01:09.016514 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 10:01:09.018605 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 10:01:09.082296 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 10:01:09.083978 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 10:01:09.085036 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 10:01:09.086233 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 10:01:09.088232 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 10:01:09.089268 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 10:01:09.090564 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 10:01:09.092817 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 10:01:09.098471 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 10:01:09.099708 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 10:01:09.100898 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 10:01:09.103046 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 10:01:09.104021 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 10:01:09.106257 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 10:01:09.115407 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 10:01:09.117285 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 10:01:09.118604 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 10:01:09.120237 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 10:01:09.122113 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 10:01:09.123007 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 10:01:09.126113 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 10:01:09.131255 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 10:01:09.132079 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 10:01:09.134628 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 10:01:09.136343 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 10:01:09.137851 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 10:01:09.139624 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 10:01:09.162286 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 10:01:09.162994 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 10:01:09.163638 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 10:01:09.164243 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 10:01:09.167212 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 10:01:09.168382 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 10:01:09.170254 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 10:01:09.171243 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 10:01:09.172061 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 10:01:09.173156 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 10:01:09.174988 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 10:01:09.176028 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 10:01:09.176855 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 10:01:09.178182 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 10:01:09.179029 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 10:01:09.181194 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 10:01:09.182453 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 10:01:09.183389 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 10:01:09.184626 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 10:01:09.188156 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 10:01:09.193731 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 10:01:09.194817 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 10:01:09.197068 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 10:01:09.199893 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 10:01:09.202263 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 10:01:09.203090 (MainThread): Parsing macros/sql/star.sql
2021-10-01 10:01:09.205604 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 10:01:09.211908 (MainThread): Parsing macros/sql/union.sql
2021-10-01 10:01:09.219226 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 10:01:09.220277 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 10:01:09.222828 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 10:01:09.223727 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 10:01:09.224879 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 10:01:09.227392 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 10:01:09.230969 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 10:01:09.233441 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 10:01:09.439279 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 10:01:09.439541 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '899b1a2f-db5c-454f-8d3d-62d02eea22be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7140b3dc0>]}
2021-10-01 10:01:09.596019 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 10:01:09.688114 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 10:01:09.693504 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:01:09.698884 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:01:09.816234 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '899b1a2f-db5c-454f-8d3d-62d02eea22be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb713fee5b0>]}
2021-10-01 10:01:09.828052 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '899b1a2f-db5c-454f-8d3d-62d02eea22be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7141d73a0>]}
2021-10-01 10:01:09.828417 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 10:01:09.829782 (MainThread): 
2021-10-01 10:01:09.830248 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:01:09.831193 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 10:01:09.845815 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 10:01:09.846049 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 10:01:09.846207 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 10:01:12.226925 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.38 seconds
2021-10-01 10:01:12.228591 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 10:01:12.818869 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:01:12.826610 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:01:12.826853 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 10:01:12.827012 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:01:14.757804 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.93 seconds
2021-10-01 10:01:14.759532 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 10:01:15.602276 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:01:15.604643 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:01:15.604818 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 10:01:15.604964 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:01:17.509362 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.90 seconds
2021-10-01 10:01:17.511218 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 10:01:18.405924 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:01:18.408169 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:01:18.408338 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 10:01:18.408485 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:01:20.213719 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.81 seconds
2021-10-01 10:01:20.215885 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 10:01:21.134780 (MainThread): 15:31:21 | Concurrency: 1 threads (target='dev')
2021-10-01 10:01:21.135043 (MainThread): 15:31:21 | 
2021-10-01 10:01:21.136085 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:01:21.136347 (Thread-1): 15:31:21 | 1 of 3 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-01 10:01:21.136681 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:01:21.136864 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:01:21.141434 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 10:01:21.142158 (Thread-1): finished collecting timing info
2021-10-01 10:01:21.162262 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:01:21.162494 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."IS_NOT_EMPTY_CUST_COUNT_BY_STATE_" cascade
2021-10-01 10:01:21.162653 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:01:23.806652 (Thread-1): SQL status: SUCCESS 1 in 2.64 seconds
2021-10-01 10:01:23.822591 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:01:23.822822 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_  as
      (

with validation as (

    select case when count(*)=0 then 1 else 0 end as rows
    from DEMO_DB.SALES_SCHEMA.cust_count_by_state

)

select *
from validation where rows=1


      );
2021-10-01 10:01:24.186510 (Thread-1): Snowflake query id: 019f5079-0000-36fb-0000-cdb9000222ba
2021-10-01 10:01:24.186737 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 53 unexpected 'rows'.
syntax error line 12 at position 22 unexpected 'rows'.
2021-10-01 10:01:24.186947 (Thread-1): finished collecting timing info
2021-10-01 10:01:24.187146 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-01 10:01:24.838095 (Thread-1): Database Error in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 53 unexpected 'rows'.
  syntax error line 12 at position 22 unexpected 'rows'.
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 53 unexpected 'rows'.
syntax error line 12 at position 22 unexpected 'rows'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 82, in execute_test
    macro_func()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 74, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 53 unexpected 'rows'.
  syntax error line 12 at position 22 unexpected 'rows'.
2021-10-01 10:01:24.840371 (Thread-1): 15:31:24 | 1 of 3 ERROR is_not_empty_cust_count_by_state_....................... [ERROR in 3.70s]
2021-10-01 10:01:24.840621 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:01:24.840839 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:01:24.841170 (Thread-1): 15:31:24 | 2 of 3 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-01 10:01:24.841524 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:01:24.841695 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:01:24.849492 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 10:01:24.850310 (Thread-1): finished collecting timing info
2021-10-01 10:01:24.856173 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:01:24.856401 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."NOT_NULL_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 10:01:24.856594 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:01:26.816803 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2021-10-01 10:01:26.818930 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:01:26.819200 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      );
2021-10-01 10:02:18.327233 (Thread-1): SQL status: SUCCESS 1 in 51.51 seconds
2021-10-01 10:02:18.333918 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 10:02:18.335099 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:02:18.335278 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 10:02:18.877969 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-10-01 10:02:18.883521 (Thread-1): finished collecting timing info
2021-10-01 10:02:18.883812 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-01 10:02:19.454509 (Thread-1): 15:32:19 | 2 of 3 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 54.61s]
2021-10-01 10:02:19.454845 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:02:19.455107 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:02:19.455449 (Thread-1): 15:32:19 | 3 of 3 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-01 10:02:19.455964 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:02:19.456167 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:02:19.464045 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 10:02:19.464887 (Thread-1): finished collecting timing info
2021-10-01 10:02:19.468632 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:02:19.468863 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."UNIQUE_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 10:02:19.469020 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:02:21.358476 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-10-01 10:02:21.360506 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:02:21.360867 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      );
2021-10-01 10:02:23.353753 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2021-10-01 10:02:23.355096 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 10:02:23.357124 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:02:23.357358 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 10:02:23.778527 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-01 10:02:23.780026 (Thread-1): finished collecting timing info
2021-10-01 10:02:23.780255 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-01 10:02:24.339335 (Thread-1): 15:32:24 | 3 of 3 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 4.88s]
2021-10-01 10:02:24.339696 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:02:24.341087 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:02:24.341486 (MainThread): 15:32:24 | 
2021-10-01 10:02:24.341685 (MainThread): 15:32:24 | Finished running 3 tests in 74.51s.
2021-10-01 10:02:24.341852 (MainThread): Connection 'master' was properly closed.
2021-10-01 10:02:24.341990 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-01 10:02:24.351984 (MainThread): 
2021-10-01 10:02:24.352548 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 10:02:24.353066 (MainThread): 
2021-10-01 10:02:24.353434 (MainThread): Database Error in test is_not_empty_cust_count_by_state_ (models/snowflake_model_data/schema.yml)
2021-10-01 10:02:24.353765 (MainThread):   001003 (42000): SQL compilation error:
2021-10-01 10:02:24.354061 (MainThread):   syntax error line 6 at position 53 unexpected 'rows'.
2021-10-01 10:02:24.354415 (MainThread):   syntax error line 12 at position 22 unexpected 'rows'.
2021-10-01 10:02:24.354735 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 10:02:24.355150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb712113eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb713fee190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb71430c340>]}
2021-10-01 10:02:24.355605 (MainThread): Flushing usage events
2021-10-01 10:09:28.230992 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 10:09:29.656457 (MainThread): Loading KWallet
2021-10-01 10:09:29.658333 (MainThread): Loading SecretService
2021-10-01 10:09:29.659954 (MainThread): Loading Windows
2021-10-01 10:09:29.661784 (MainThread): Loading chainer
2021-10-01 10:09:29.662884 (MainThread): Loading macOS
2021-10-01 10:09:30.325253 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 10:09:30.328532 (MainThread): Tracking: tracking
2021-10-01 10:09:30.329243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0b053bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0cf42730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0c216190>]}
2021-10-01 10:09:30.358625 (MainThread): Partial parsing not enabled
2021-10-01 10:09:30.447470 (MainThread): Parsing macros/test_empty.sql
2021-10-01 10:09:30.449164 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 10:09:30.451500 (MainThread): Parsing macros/catalog.sql
2021-10-01 10:09:30.455327 (MainThread): Parsing macros/adapters.sql
2021-10-01 10:09:30.512260 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 10:09:30.519201 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 10:09:30.525420 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 10:09:30.527689 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 10:09:30.532154 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 10:09:30.543948 (MainThread): Parsing macros/core.sql
2021-10-01 10:09:30.548746 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 10:09:30.557630 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 10:09:30.572417 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 10:09:30.574445 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 10:09:30.599391 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 10:09:30.647161 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 10:09:30.681796 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 10:09:30.684253 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 10:09:30.699385 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 10:09:30.730979 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 10:09:30.750252 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 10:09:30.761888 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 10:09:30.772868 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 10:09:30.779408 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 10:09:30.782092 (MainThread): Parsing macros/etc/query.sql
2021-10-01 10:09:30.784739 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 10:09:30.787101 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 10:09:30.800181 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 10:09:30.804160 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 10:09:30.806495 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 10:09:30.888393 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 10:09:30.890620 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 10:09:30.892050 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 10:09:30.893908 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 10:09:30.896679 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 10:09:30.898284 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 10:09:30.900629 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 10:09:30.904287 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 10:09:30.914127 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 10:09:30.917658 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 10:09:30.920170 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 10:09:30.924172 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 10:09:30.926011 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 10:09:30.929731 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 10:09:30.944023 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 10:09:30.947743 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 10:09:30.949831 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 10:09:30.952120 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 10:09:30.954359 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 10:09:30.955818 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 10:09:30.960251 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 10:09:30.971568 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 10:09:30.973128 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 10:09:30.977563 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 10:09:30.980509 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 10:09:30.984492 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 10:09:30.988660 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 10:09:31.022970 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 10:09:31.024134 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 10:09:31.025374 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 10:09:31.026554 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 10:09:31.033371 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 10:09:31.035654 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 10:09:31.038653 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 10:09:31.040264 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 10:09:31.041649 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 10:09:31.043992 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 10:09:31.047580 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 10:09:31.050287 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 10:09:31.053817 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 10:09:31.057739 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 10:09:31.060278 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 10:09:31.067167 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 10:09:31.070945 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 10:09:31.072631 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 10:09:31.074501 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 10:09:31.081551 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 10:09:31.090108 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 10:09:31.092420 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 10:09:31.096211 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 10:09:31.100965 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 10:09:31.105512 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 10:09:31.106931 (MainThread): Parsing macros/sql/star.sql
2021-10-01 10:09:31.110703 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 10:09:31.119397 (MainThread): Parsing macros/sql/union.sql
2021-10-01 10:09:31.130767 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 10:09:31.132710 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 10:09:31.136575 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 10:09:31.137949 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 10:09:31.139519 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 10:09:31.143156 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 10:09:31.148531 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 10:09:31.153292 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 10:09:31.403746 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 10:09:31.404035 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '517e87c0-93c6-40af-8724-48638ffec0ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0d125be0>]}
2021-10-01 10:09:31.575503 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 10:09:31.673328 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 10:09:31.678860 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:09:31.685656 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:09:31.821987 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '517e87c0-93c6-40af-8724-48638ffec0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0cf15670>]}
2021-10-01 10:09:31.833900 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '517e87c0-93c6-40af-8724-48638ffec0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0cf0ab50>]}
2021-10-01 10:09:31.834521 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 10:09:31.836521 (MainThread): 
2021-10-01 10:09:31.837762 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:09:31.838995 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 10:09:31.858082 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 10:09:31.858325 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 10:09:31.858491 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 10:09:33.900136 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.04 seconds
2021-10-01 10:09:33.901843 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 10:09:34.507998 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:09:34.515758 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:09:34.515984 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 10:09:34.516139 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:09:36.158274 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.64 seconds
2021-10-01 10:09:36.160089 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 10:09:36.770567 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:09:36.773209 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:09:36.773393 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 10:09:36.773563 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:09:38.549954 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.78 seconds
2021-10-01 10:09:38.551861 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 10:09:39.126312 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:09:39.129820 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:09:39.130090 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 10:09:39.130263 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:09:40.978522 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.85 seconds
2021-10-01 10:09:40.980508 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 10:09:41.657924 (MainThread): 15:39:41 | Concurrency: 1 threads (target='dev')
2021-10-01 10:09:41.658317 (MainThread): 15:39:41 | 
2021-10-01 10:09:41.659908 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:09:41.660241 (Thread-1): 15:39:41 | 1 of 3 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-01 10:09:41.660756 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:09:41.661079 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:09:41.666372 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 10:09:41.667597 (Thread-1): finished collecting timing info
2021-10-01 10:09:41.701914 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:09:41.702354 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_  as
      (

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.cust_count_by_state

)

select *
from validation where rw=1


      );
2021-10-01 10:09:41.702503 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:09:44.304716 (Thread-1): SQL status: SUCCESS 1 in 2.60 seconds
2021-10-01 10:09:44.311996 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 10:09:44.314557 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:09:44.314972 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_
    
      
    ) dbt_internal_test
2021-10-01 10:09:44.802436 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-01 10:09:44.809838 (Thread-1): finished collecting timing info
2021-10-01 10:09:44.810201 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-01 10:09:45.400029 (Thread-1): 15:39:45 | 1 of 3 PASS is_not_empty_cust_count_by_state_........................ [PASS in 3.74s]
2021-10-01 10:09:45.400321 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:09:45.400535 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:09:45.400735 (Thread-1): 15:39:45 | 2 of 3 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-01 10:09:45.401150 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:09:45.401318 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:09:45.408926 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 10:09:45.409681 (Thread-1): finished collecting timing info
2021-10-01 10:09:45.418873 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:09:45.419095 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."NOT_NULL_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 10:09:45.419248 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:09:47.160881 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-10-01 10:09:47.163101 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:09:47.163322 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      );
2021-10-01 10:09:48.177639 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-01 10:09:48.178926 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 10:09:48.180117 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:09:48.180303 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 10:09:48.578621 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-01 10:09:48.580358 (Thread-1): finished collecting timing info
2021-10-01 10:09:48.580631 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-01 10:09:49.157748 (Thread-1): 15:39:49 | 2 of 3 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 3.76s]
2021-10-01 10:09:49.158015 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:09:49.158217 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:09:49.158532 (Thread-1): 15:39:49 | 3 of 3 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-01 10:09:49.158902 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:09:49.159076 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:09:49.167199 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 10:09:49.167932 (Thread-1): finished collecting timing info
2021-10-01 10:09:49.171701 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:09:49.171930 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."UNIQUE_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 10:09:49.172083 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:09:50.920997 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-10-01 10:09:50.923035 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:09:50.923222 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      );
2021-10-01 10:09:51.901309 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-01 10:09:51.903021 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 10:09:51.904478 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:09:51.904688 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 10:09:52.297411 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-01 10:09:52.298925 (Thread-1): finished collecting timing info
2021-10-01 10:09:52.299143 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-01 10:09:52.883417 (Thread-1): 15:39:52 | 3 of 3 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 3.72s]
2021-10-01 10:09:52.883741 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:09:52.885060 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:09:52.885442 (MainThread): 15:39:52 | 
2021-10-01 10:09:52.885639 (MainThread): 15:39:52 | Finished running 3 tests in 21.05s.
2021-10-01 10:09:52.885809 (MainThread): Connection 'master' was properly closed.
2021-10-01 10:09:52.885948 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-01 10:09:52.894609 (MainThread): 
2021-10-01 10:09:52.894888 (MainThread): Completed successfully
2021-10-01 10:09:52.895163 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-01 10:09:52.895516 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0cf15670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c080a13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0cf695b0>]}
2021-10-01 10:09:52.895901 (MainThread): Flushing usage events
2021-10-01 10:24:46.691860 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 10:24:48.649920 (MainThread): Loading KWallet
2021-10-01 10:24:48.651684 (MainThread): Loading SecretService
2021-10-01 10:24:48.653300 (MainThread): Loading Windows
2021-10-01 10:24:48.654860 (MainThread): Loading chainer
2021-10-01 10:24:48.655882 (MainThread): Loading macOS
2021-10-01 10:24:49.296200 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 10:24:49.297917 (MainThread): Tracking: tracking
2021-10-01 10:24:49.298325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01713c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02b15af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02b15ac0>]}
2021-10-01 10:24:49.323776 (MainThread): Partial parsing not enabled
2021-10-01 10:24:49.399160 (MainThread): Parsing macros/test_empty.sql
2021-10-01 10:24:49.400171 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 10:24:49.401430 (MainThread): Parsing macros/catalog.sql
2021-10-01 10:24:49.403939 (MainThread): Parsing macros/adapters.sql
2021-10-01 10:24:49.456131 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 10:24:49.462825 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 10:24:49.472503 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 10:24:49.474582 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 10:24:49.479081 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 10:24:49.491406 (MainThread): Parsing macros/core.sql
2021-10-01 10:24:49.497022 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 10:24:49.505653 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 10:24:49.518650 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 10:24:49.520794 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 10:24:49.544063 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 10:24:49.590749 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 10:24:49.618911 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 10:24:49.621147 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 10:24:49.634470 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 10:24:49.662806 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 10:24:49.684040 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 10:24:49.696178 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 10:24:49.706432 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 10:24:49.711479 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 10:24:49.712600 (MainThread): Parsing macros/etc/query.sql
2021-10-01 10:24:49.713771 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 10:24:49.715687 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 10:24:49.727737 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 10:24:49.730604 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 10:24:49.732835 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 10:24:49.810004 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 10:24:49.812290 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 10:24:49.813748 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 10:24:49.815367 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 10:24:49.817950 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 10:24:49.819345 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 10:24:49.821044 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 10:24:49.825694 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 10:24:49.833964 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 10:24:49.835615 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 10:24:49.837279 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 10:24:49.841383 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 10:24:49.843007 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 10:24:49.847268 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 10:24:49.860285 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 10:24:49.864312 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 10:24:49.866820 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 10:24:49.869470 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 10:24:49.871844 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 10:24:49.873179 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 10:24:49.877389 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 10:24:49.886258 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 10:24:49.887394 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 10:24:49.890848 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 10:24:49.893126 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 10:24:49.895050 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 10:24:49.897447 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 10:24:49.927703 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 10:24:49.928813 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 10:24:49.930528 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 10:24:49.931748 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 10:24:49.937529 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 10:24:49.939285 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 10:24:49.941977 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 10:24:49.943328 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 10:24:49.944371 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 10:24:49.945860 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 10:24:49.948295 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 10:24:49.949734 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 10:24:49.950916 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 10:24:49.952923 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 10:24:49.954161 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 10:24:49.957386 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 10:24:49.959161 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 10:24:49.960413 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 10:24:49.962749 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 10:24:49.968988 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 10:24:49.976716 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 10:24:49.978395 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 10:24:49.983237 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 10:24:49.988110 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 10:24:49.991896 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 10:24:49.993137 (MainThread): Parsing macros/sql/star.sql
2021-10-01 10:24:49.996472 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 10:24:50.004258 (MainThread): Parsing macros/sql/union.sql
2021-10-01 10:24:50.014127 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 10:24:50.015393 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 10:24:50.019032 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 10:24:50.020653 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 10:24:50.022357 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 10:24:50.026366 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 10:24:50.032541 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 10:24:50.036786 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 10:24:50.335184 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 10:24:50.335514 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8497c024-b822-485d-8e93-18494e1e7316', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa03731af0>]}
2021-10-01 10:24:50.560912 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 10:24:50.655346 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 10:24:50.660281 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:24:50.667659 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:24:50.805083 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8497c024-b822-485d-8e93-18494e1e7316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa03623f70>]}
2021-10-01 10:24:50.815040 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8497c024-b822-485d-8e93-18494e1e7316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa03683a30>]}
2021-10-01 10:24:50.815384 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 10:24:50.816783 (MainThread): 
2021-10-01 10:24:50.817231 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:24:50.818653 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 10:24:50.835524 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 10:24:50.835780 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 10:24:50.835943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 10:24:52.975085 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.14 seconds
2021-10-01 10:24:52.976837 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 10:24:53.550740 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:24:53.559411 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:24:53.559651 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 10:24:53.559813 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:24:55.228429 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.67 seconds
2021-10-01 10:24:55.230451 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 10:24:55.837799 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:24:55.840141 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:24:55.840311 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 10:24:55.840454 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:24:57.686477 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.85 seconds
2021-10-01 10:24:57.688377 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 10:24:58.257104 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:24:58.260424 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:24:58.260691 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 10:24:58.260865 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:24:59.883135 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.62 seconds
2021-10-01 10:24:59.885046 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 10:25:00.466474 (MainThread): 15:55:00 | Concurrency: 1 threads (target='dev')
2021-10-01 10:25:00.466772 (MainThread): 15:55:00 | 
2021-10-01 10:25:00.467971 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:25:00.468281 (Thread-1): 15:55:00 | 1 of 4 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-01 10:25:00.468713 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:25:00.468907 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:25:00.474169 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 10:25:00.474907 (Thread-1): finished collecting timing info
2021-10-01 10:25:00.497369 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:25:00.497627 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."IS_NOT_EMPTY_CUST_COUNT_BY_STATE_" cascade
2021-10-01 10:25:00.497791 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:25:02.461958 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2021-10-01 10:25:02.475158 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:25:02.475382 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_  as
      (

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.cust_count_by_state

)

select *
from validation where rw=1


      );
2021-10-01 10:25:04.511293 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2021-10-01 10:25:04.517217 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 10:25:04.518579 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 10:25:04.518768 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.is_not_empty_cust_count_by_state_
    
      
    ) dbt_internal_test
2021-10-01 10:25:05.100908 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-10-01 10:25:05.103333 (Thread-1): finished collecting timing info
2021-10-01 10:25:05.103619 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-01 10:25:05.707501 (Thread-1): 15:55:05 | 1 of 4 PASS is_not_empty_cust_count_by_state_........................ [PASS in 5.24s]
2021-10-01 10:25:05.707803 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 10:25:05.708033 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_customer_.f481adb544
2021-10-01 10:25:05.708550 (Thread-1): 15:55:05 | 2 of 4 START test is_not_empty_customer_............................. [RUN]
2021-10-01 10:25:05.709087 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_customer_.f481adb544".
2021-10-01 10:25:05.709309 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_customer_.f481adb544
2021-10-01 10:25:05.715448 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_customer_.f481adb544"
2021-10-01 10:25:05.716208 (Thread-1): finished collecting timing info
2021-10-01 10:25:05.719019 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_customer_.f481adb544".
2021-10-01 10:25:05.719205 (Thread-1): On test.dbt_demo_project.is_not_empty_customer_.f481adb544: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_customer_.f481adb544"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.is_not_empty_customer_  as
      (

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.customer

)

select *
from validation where rw=1


      );
2021-10-01 10:25:05.719359 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:25:08.448955 (Thread-1): SQL status: SUCCESS 1 in 2.73 seconds
2021-10-01 10:25:08.450242 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_customer_.f481adb544"
2021-10-01 10:25:08.451291 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_customer_.f481adb544".
2021-10-01 10:25:08.451458 (Thread-1): On test.dbt_demo_project.is_not_empty_customer_.f481adb544: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_customer_.f481adb544"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.is_not_empty_customer_
    
      
    ) dbt_internal_test
2021-10-01 10:25:09.480729 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-01 10:25:09.482271 (Thread-1): finished collecting timing info
2021-10-01 10:25:09.482499 (Thread-1): On test.dbt_demo_project.is_not_empty_customer_.f481adb544: Close
2021-10-01 10:25:10.065839 (Thread-1): 15:55:10 | 2 of 4 PASS is_not_empty_customer_................................... [PASS in 4.36s]
2021-10-01 10:25:10.066108 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_customer_.f481adb544
2021-10-01 10:25:10.066323 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:25:10.066636 (Thread-1): 15:55:10 | 3 of 4 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-01 10:25:10.067022 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:25:10.067203 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:25:10.076945 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 10:25:10.077866 (Thread-1): finished collecting timing info
2021-10-01 10:25:10.081978 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:25:10.082209 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."NOT_NULL_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 10:25:10.082364 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:25:11.807318 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-10-01 10:25:11.809131 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:25:11.809307 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      );
2021-10-01 10:25:12.778723 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-01 10:25:12.780093 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 10:25:12.781286 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 10:25:12.781578 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.not_null_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 10:25:13.267552 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-01 10:25:13.269118 (Thread-1): finished collecting timing info
2021-10-01 10:25:13.269349 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-01 10:25:13.899535 (Thread-1): 15:55:13 | 3 of 4 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 3.83s]
2021-10-01 10:25:13.899904 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 10:25:13.900174 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:25:13.900678 (Thread-1): 15:55:13 | 4 of 4 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-01 10:25:13.901112 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:25:13.901302 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:25:13.910902 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 10:25:13.911665 (Thread-1): finished collecting timing info
2021-10-01 10:25:13.918407 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:25:13.919087 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
drop table if exists "DEMO_DB"."DBT_TEST__AUDIT"."UNIQUE_CUST_COUNT_BY_STATE_CUSTOMER_STATE" cascade
2021-10-01 10:25:13.919538 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:25:15.741438 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-10-01 10:25:15.743362 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:25:15.743533 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */

        

      create or replace transient table DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE  as
      (
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      );
2021-10-01 10:25:16.746936 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-01 10:25:16.749462 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 10:25:16.751050 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 10:25:16.751284 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from DEMO_DB.dbt_test__audit.unique_cust_count_by_state_CUSTOMER_STATE
    
      
    ) dbt_internal_test
2021-10-01 10:25:17.150083 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-01 10:25:17.152517 (Thread-1): finished collecting timing info
2021-10-01 10:25:17.152977 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-01 10:25:17.721310 (Thread-1): 15:55:17 | 4 of 4 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 3.82s]
2021-10-01 10:25:17.721632 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 10:25:17.722769 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:25:17.723126 (MainThread): 15:55:17 | 
2021-10-01 10:25:17.723320 (MainThread): 15:55:17 | Finished running 4 tests in 26.91s.
2021-10-01 10:25:17.723488 (MainThread): Connection 'master' was properly closed.
2021-10-01 10:25:17.723628 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-01 10:25:17.733937 (MainThread): 
2021-10-01 10:25:17.734223 (MainThread): Completed successfully
2021-10-01 10:25:17.734479 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-01 10:25:17.734885 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01713c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa03677400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa02b154f0>]}
2021-10-01 10:25:17.735254 (MainThread): Flushing usage events
2021-10-01 10:25:47.384488 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 10:25:48.554979 (MainThread): Loading KWallet
2021-10-01 10:25:48.556140 (MainThread): Loading SecretService
2021-10-01 10:25:48.557157 (MainThread): Loading Windows
2021-10-01 10:25:48.558382 (MainThread): Loading chainer
2021-10-01 10:25:48.559240 (MainThread): Loading macOS
2021-10-01 10:25:49.118667 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 10:25:49.120771 (MainThread): Tracking: tracking
2021-10-01 10:25:49.121132 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd83913b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84b0caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84b0cac0>]}
2021-10-01 10:25:49.148653 (MainThread): Partial parsing not enabled
2021-10-01 10:25:49.211250 (MainThread): Parsing macros/test_empty.sql
2021-10-01 10:25:49.212393 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 10:25:49.213798 (MainThread): Parsing macros/catalog.sql
2021-10-01 10:25:49.216401 (MainThread): Parsing macros/adapters.sql
2021-10-01 10:25:49.272560 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 10:25:49.277857 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 10:25:49.284820 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 10:25:49.286770 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 10:25:49.290890 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 10:25:49.302699 (MainThread): Parsing macros/core.sql
2021-10-01 10:25:49.307440 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 10:25:49.316199 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 10:25:49.329874 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 10:25:49.332254 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 10:25:49.355422 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 10:25:49.400166 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 10:25:49.429041 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 10:25:49.431343 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 10:25:49.444388 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 10:25:49.471312 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 10:25:49.488881 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 10:25:49.500101 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 10:25:49.509669 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 10:25:49.514772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 10:25:49.516058 (MainThread): Parsing macros/etc/query.sql
2021-10-01 10:25:49.517243 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 10:25:49.519073 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 10:25:49.530803 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 10:25:49.533227 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 10:25:49.535129 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 10:25:49.606816 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 10:25:49.609008 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 10:25:49.610566 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 10:25:49.612382 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 10:25:49.615293 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 10:25:49.616837 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 10:25:49.618644 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 10:25:49.621780 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 10:25:49.630530 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 10:25:49.632173 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 10:25:49.633779 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 10:25:49.636649 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 10:25:49.637957 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 10:25:49.640770 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 10:25:49.653130 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 10:25:49.655490 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 10:25:49.657350 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 10:25:49.660032 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 10:25:49.662344 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 10:25:49.663763 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 10:25:49.667832 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 10:25:49.674433 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 10:25:49.675447 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 10:25:49.678838 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 10:25:49.681275 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 10:25:49.683164 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 10:25:49.685552 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 10:25:49.715445 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 10:25:49.716449 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 10:25:49.717326 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 10:25:49.718089 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 10:25:49.722068 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 10:25:49.723696 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 10:25:49.726932 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 10:25:49.728547 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 10:25:49.729791 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 10:25:49.731439 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 10:25:49.733862 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 10:25:49.735288 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 10:25:49.736417 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 10:25:49.738232 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 10:25:49.739361 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 10:25:49.742547 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 10:25:49.744492 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 10:25:49.745843 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 10:25:49.747662 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 10:25:49.752198 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 10:25:49.759605 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 10:25:49.761336 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 10:25:49.764794 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 10:25:49.768879 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 10:25:49.771968 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 10:25:49.773103 (MainThread): Parsing macros/sql/star.sql
2021-10-01 10:25:49.776715 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 10:25:49.784526 (MainThread): Parsing macros/sql/union.sql
2021-10-01 10:25:49.794993 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 10:25:49.796447 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 10:25:49.800239 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 10:25:49.801612 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 10:25:49.803059 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 10:25:49.806558 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 10:25:49.811917 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 10:25:49.815434 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 10:25:50.058231 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 10:25:50.058662 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c220476-c1a0-4c0a-8d7f-8db80d6da2fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85731af0>]}
2021-10-01 10:25:50.227366 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 10:25:50.305865 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 10:25:50.310612 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:25:50.316127 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:25:50.454994 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c220476-c1a0-4c0a-8d7f-8db80d6da2fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85621f40>]}
2021-10-01 10:25:50.465750 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c220476-c1a0-4c0a-8d7f-8db80d6da2fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85687a30>]}
2021-10-01 10:25:50.466188 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 10:25:50.467616 (MainThread): 
2021-10-01 10:25:50.468396 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:25:50.469640 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 10:25:50.486126 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 10:25:50.486351 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 10:25:50.486508 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 10:25:52.526087 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.04 seconds
2021-10-01 10:25:52.527957 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 10:25:53.121068 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:25:53.130845 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:25:53.131087 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 10:25:53.131244 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:25:54.977618 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.85 seconds
2021-10-01 10:25:54.979738 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 10:25:55.542581 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:25:55.545784 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:25:55.546087 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 10:25:55.546264 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:25:57.219403 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.67 seconds
2021-10-01 10:25:57.221274 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 10:25:57.793559 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:25:57.796360 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:25:57.796647 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 10:25:57.796836 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:25:59.385643 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.59 seconds
2021-10-01 10:25:59.387310 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 10:25:59.944191 (MainThread): 15:55:59 | Concurrency: 1 threads (target='dev')
2021-10-01 10:25:59.944459 (MainThread): 15:55:59 | 
2021-10-01 10:25:59.945627 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 10:25:59.946052 (Thread-1): 15:55:59 | 1 of 2 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 10:25:59.946504 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:25:59.946690 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 10:25:59.950145 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 10:25:59.954003 (Thread-1): finished collecting timing info
2021-10-01 10:25:59.990016 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 10:25:59.992636 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:25:59.992892 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 10:25:59.993065 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:26:02.706469 (Thread-1): SQL status: SUCCESS 1 in 2.71 seconds
2021-10-01 10:26:02.718235 (Thread-1): finished collecting timing info
2021-10-01 10:26:02.718515 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 10:26:03.295164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c220476-c1a0-4c0a-8d7f-8db80d6da2fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85b78790>]}
2021-10-01 10:26:03.295760 (Thread-1): 15:56:03 | 1 of 2 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.35s]
2021-10-01 10:26:03.296044 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 10:26:03.296647 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 10:26:03.297069 (Thread-1): 15:56:03 | 2 of 2 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 10:26:03.297488 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:26:03.297690 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 10:26:03.300555 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 10:26:03.302299 (Thread-1): finished collecting timing info
2021-10-01 10:26:03.304543 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 10:26:03.305773 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:26:03.305974 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 10:26:03.306139 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:26:05.851947 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 54495), raddr=('52.228.75.102', 443)>
2021-10-01 10:26:05.852639 (Thread-1): SQL status: SUCCESS 1 in 2.55 seconds
2021-10-01 10:26:05.854370 (Thread-1): finished collecting timing info
2021-10-01 10:26:05.854609 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 10:26:07.486935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c220476-c1a0-4c0a-8d7f-8db80d6da2fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85dcd0d0>]}
2021-10-01 10:26:07.487698 (Thread-1): 15:56:07 | 2 of 2 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 4.19s]
2021-10-01 10:26:07.488214 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 10:26:07.489709 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:26:07.490225 (MainThread): 15:56:07 | 
2021-10-01 10:26:07.490489 (MainThread): 15:56:07 | Finished running 2 table models in 17.02s.
2021-10-01 10:26:07.490742 (MainThread): Connection 'master' was properly closed.
2021-10-01 10:26:07.490902 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 10:26:07.500524 (MainThread): 
2021-10-01 10:26:07.500859 (MainThread): Completed successfully
2021-10-01 10:26:07.501101 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-01 10:26:07.501516 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd83913b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84b0c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd85678a00>]}
2021-10-01 10:26:07.501906 (MainThread): Flushing usage events
2021-10-01 10:26:41.781447 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 10:26:42.621355 (MainThread): Loading KWallet
2021-10-01 10:26:42.622223 (MainThread): Loading SecretService
2021-10-01 10:26:42.622966 (MainThread): Loading Windows
2021-10-01 10:26:42.623811 (MainThread): Loading chainer
2021-10-01 10:26:42.624320 (MainThread): Loading macOS
2021-10-01 10:26:43.057379 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 10:26:43.059645 (MainThread): Tracking: tracking
2021-10-01 10:26:43.060069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19ff13b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a130c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a130ca00>]}
2021-10-01 10:26:43.082180 (MainThread): Partial parsing not enabled
2021-10-01 10:26:43.130291 (MainThread): Parsing macros/test_empty.sql
2021-10-01 10:26:43.131340 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 10:26:43.132605 (MainThread): Parsing macros/catalog.sql
2021-10-01 10:26:43.135265 (MainThread): Parsing macros/adapters.sql
2021-10-01 10:26:43.195019 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 10:26:43.200661 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 10:26:43.208125 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 10:26:43.211781 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 10:26:43.216679 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 10:26:43.228164 (MainThread): Parsing macros/core.sql
2021-10-01 10:26:43.232990 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 10:26:43.241960 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 10:26:43.260886 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 10:26:43.264962 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 10:26:43.305992 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 10:26:43.374670 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 10:26:43.419583 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 10:26:43.423944 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 10:26:43.447779 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 10:26:43.501027 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 10:26:43.524160 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 10:26:43.537717 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 10:26:43.552012 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 10:26:43.557769 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 10:26:43.559444 (MainThread): Parsing macros/etc/query.sql
2021-10-01 10:26:43.560933 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 10:26:43.563820 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 10:26:43.577350 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 10:26:43.580075 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 10:26:43.583161 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 10:26:43.664233 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 10:26:43.666669 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 10:26:43.668207 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 10:26:43.669825 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 10:26:43.672425 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 10:26:43.673962 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 10:26:43.675889 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 10:26:43.679077 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 10:26:43.687826 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 10:26:43.689652 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 10:26:43.691575 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 10:26:43.695068 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 10:26:43.696516 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 10:26:43.699799 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 10:26:43.712287 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 10:26:43.714746 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 10:26:43.716604 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 10:26:43.718847 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 10:26:43.720848 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 10:26:43.722033 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 10:26:43.726124 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 10:26:43.734157 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 10:26:43.735200 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 10:26:43.740013 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 10:26:43.743668 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 10:26:43.747302 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 10:26:43.750619 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 10:26:43.781671 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 10:26:43.782523 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 10:26:43.783348 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 10:26:43.784095 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 10:26:43.788113 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 10:26:43.789625 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 10:26:43.791935 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 10:26:43.793094 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 10:26:43.794086 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 10:26:43.795870 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 10:26:43.798180 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 10:26:43.799517 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 10:26:43.800536 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 10:26:43.802232 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 10:26:43.803542 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 10:26:43.806556 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 10:26:43.808182 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 10:26:43.809399 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 10:26:43.811049 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 10:26:43.815667 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 10:26:43.822825 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 10:26:43.824395 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 10:26:43.827742 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 10:26:43.831925 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 10:26:43.835274 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 10:26:43.836590 (MainThread): Parsing macros/sql/star.sql
2021-10-01 10:26:43.839991 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 10:26:43.847744 (MainThread): Parsing macros/sql/union.sql
2021-10-01 10:26:43.857783 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 10:26:43.858975 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 10:26:43.862629 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 10:26:43.863883 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 10:26:43.865318 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 10:26:43.868812 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 10:26:43.873761 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 10:26:43.877357 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 10:26:44.109785 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 10:26:44.110099 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50de4e5d-6eb1-48a2-a525-e65be4a541ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a1f2a250>]}
2021-10-01 10:26:44.267491 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 10:26:44.346242 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 10:26:44.351787 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:26:44.357127 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:26:44.479773 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50de4e5d-6eb1-48a2-a525-e65be4a541ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a1ce0eb0>]}
2021-10-01 10:26:44.489680 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50de4e5d-6eb1-48a2-a525-e65be4a541ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a1cd7400>]}
2021-10-01 10:26:44.490105 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-01 10:26:44.491449 (MainThread): 
2021-10-01 10:26:44.491914 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:26:44.492799 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 10:26:44.507445 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 10:26:44.507654 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 10:26:44.507801 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 10:26:46.460016 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.95 seconds
2021-10-01 10:26:46.461711 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 10:26:47.042251 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:26:47.050997 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 10:26:47.051227 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 10:26:47.051376 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:26:48.913014 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.86 seconds
2021-10-01 10:26:48.914902 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 10:26:49.514877 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:26:49.517337 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 10:26:49.517517 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 10:26:49.517669 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:26:51.269862 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.75 seconds
2021-10-01 10:26:51.272772 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 10:26:51.853918 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:26:51.856548 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 10:26:51.856732 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 10:26:51.856878 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 10:26:53.504531 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.65 seconds
2021-10-01 10:26:53.506058 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 10:26:54.104234 (MainThread): 15:56:54 | Concurrency: 1 threads (target='dev')
2021-10-01 10:26:54.104538 (MainThread): 15:56:54 | 
2021-10-01 10:26:54.105603 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 10:26:54.105932 (Thread-1): 15:56:54 | 1 of 2 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 10:26:54.106347 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:26:54.106566 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 10:26:54.109729 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 10:26:54.111110 (Thread-1): finished collecting timing info
2021-10-01 10:26:54.139490 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 10:26:54.141394 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 10:26:54.141734 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 10:26:54.141933 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:26:56.640663 (Thread-1): SQL status: SUCCESS 1 in 2.50 seconds
2021-10-01 10:26:56.651551 (Thread-1): finished collecting timing info
2021-10-01 10:26:56.651801 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 10:26:57.230240 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50de4e5d-6eb1-48a2-a525-e65be4a541ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a255aa00>]}
2021-10-01 10:26:57.230689 (Thread-1): 15:56:57 | 1 of 2 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.12s]
2021-10-01 10:26:57.230898 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 10:26:57.231490 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 10:26:57.231801 (Thread-1): 15:56:57 | 2 of 2 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 10:26:57.232126 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:26:57.232296 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 10:26:57.234984 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 10:26:57.235615 (Thread-1): finished collecting timing info
2021-10-01 10:26:57.238049 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 10:26:57.239312 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 10:26:57.239488 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 10:26:57.239639 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 10:26:59.902613 (Thread-1): SQL status: SUCCESS 1 in 2.66 seconds
2021-10-01 10:26:59.904047 (Thread-1): finished collecting timing info
2021-10-01 10:26:59.904258 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 10:27:00.511874 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50de4e5d-6eb1-48a2-a525-e65be4a541ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a27e9220>]}
2021-10-01 10:27:00.512310 (Thread-1): 15:57:00 | 2 of 2 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.28s]
2021-10-01 10:27:00.512518 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 10:27:00.513544 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 10:27:00.513900 (MainThread): 15:57:00 | 
2021-10-01 10:27:00.514084 (MainThread): 15:57:00 | Finished running 2 table models in 16.02s.
2021-10-01 10:27:00.514246 (MainThread): Connection 'master' was properly closed.
2021-10-01 10:27:00.514378 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 10:27:00.522585 (MainThread): 
2021-10-01 10:27:00.522832 (MainThread): Completed successfully
2021-10-01 10:27:00.523140 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-01 10:27:00.523388 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19ff13b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a1f2a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a1d45640>]}
2021-10-01 10:27:00.523669 (MainThread): Flushing usage events
2021-10-01 12:04:17.498867 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:04:19.138391 (MainThread): Loading KWallet
2021-10-01 12:04:19.139861 (MainThread): Loading SecretService
2021-10-01 12:04:19.141178 (MainThread): Loading Windows
2021-10-01 12:04:19.142741 (MainThread): Loading chainer
2021-10-01 12:04:19.143648 (MainThread): Loading macOS
2021-10-01 12:04:19.739091 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:04:19.742571 (MainThread): Tracking: tracking
2021-10-01 12:04:19.743191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffcf1ee5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffcf320c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffcf320c6a0>]}
2021-10-01 12:04:19.767668 (MainThread): Partial parsing not enabled
2021-10-01 12:04:19.780681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffcf3f7eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffcf3f83df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffcf3f83cd0>]}
2021-10-01 12:04:19.781008 (MainThread): Flushing usage events
2021-10-01 12:04:21.057602 (MainThread): Encountered an error:
2021-10-01 12:04:21.057881 (MainThread): Compilation Error
  Error reading dbt_demo_project: snowflake_model_data/schema.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |       - name: departments
    20 |         description: 'customer departments'
    21 | 
    22 |     - name: sales_schema
    23 |       description: "Snowflake Source Data"
    24 |       database: DEMO_DB
    25 |       schema: SALES_SCHEMA
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 22, column 5
2021-10-01 12:04:21.065976 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 22, column 5

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 22
  ------------------------------
  19 |       - name: departments
  20 |         description: 'customer departments'
  21 | 
  22 |     - name: sales_schema
  23 |       description: "Snowflake Source Data"
  24 |       database: DEMO_DB
  25 |       schema: SALES_SCHEMA
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 22, column 5

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 209, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_demo_project: snowflake_model_data/schema.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |       - name: departments
    20 |         description: 'customer departments'
    21 | 
    22 |     - name: sales_schema
    23 |       description: "Snowflake Source Data"
    24 |       database: DEMO_DB
    25 |       schema: SALES_SCHEMA
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 22, column 5

2021-10-01 12:10:50.851321 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:10:51.990585 (MainThread): Loading KWallet
2021-10-01 12:10:51.992026 (MainThread): Loading SecretService
2021-10-01 12:10:51.993300 (MainThread): Loading Windows
2021-10-01 12:10:51.994650 (MainThread): Loading chainer
2021-10-01 12:10:51.995425 (MainThread): Loading macOS
2021-10-01 12:10:52.503131 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:10:52.505309 (MainThread): Tracking: tracking
2021-10-01 12:10:52.505704 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1af53ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1ce46160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1c347d00>]}
2021-10-01 12:10:52.528964 (MainThread): Partial parsing not enabled
2021-10-01 12:10:52.587766 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:10:52.588637 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:10:52.589541 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:10:52.591388 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:10:52.633018 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:10:52.637963 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:10:52.643311 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:10:52.645019 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:10:52.648966 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:10:52.660552 (MainThread): Parsing macros/core.sql
2021-10-01 12:10:52.665175 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:10:52.674384 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:10:52.687447 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:10:52.689512 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:10:52.710801 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:10:52.753445 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:10:52.776690 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:10:52.778512 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:10:52.788306 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:10:52.808262 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:10:52.822035 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:10:52.829970 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:10:52.837206 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:10:52.840741 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:10:52.841530 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:10:52.842393 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:10:52.843873 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:10:52.852384 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:10:52.854195 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:10:52.855630 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:10:52.911778 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:10:52.913624 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:10:52.914753 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:10:52.915962 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:10:52.917948 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:10:52.918959 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:10:52.920231 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:10:52.922389 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:10:52.928446 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:10:52.929699 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:10:52.931005 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:10:52.933296 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:10:52.934540 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:10:52.936766 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:10:52.949022 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:10:52.951454 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:10:52.952804 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:10:52.954623 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:10:52.956195 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:10:52.957099 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:10:52.960223 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:10:52.965298 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:10:52.966026 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:10:52.968548 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:10:52.970608 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:10:52.972193 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:10:52.974194 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:10:53.001830 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:10:53.002703 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:10:53.003543 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:10:53.004303 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:10:53.008123 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:10:53.009615 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:10:53.011999 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:10:53.013224 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:10:53.014216 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:10:53.015719 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:10:53.017971 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:10:53.019289 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:10:53.020327 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:10:53.021983 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:10:53.022999 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:10:53.025648 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:10:53.027236 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:10:53.028379 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:10:53.029838 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:10:53.033619 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:10:53.039081 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:10:53.040307 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:10:53.042489 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:10:53.045549 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:10:53.047792 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:10:53.048686 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:10:53.051400 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:10:53.057211 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:10:53.064336 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:10:53.065126 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:10:53.067906 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:10:53.068799 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:10:53.069840 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:10:53.072297 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:10:53.075854 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:10:53.078500 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:10:53.267518 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:10:53.267774 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efbec88b-c85e-4bd7-b44a-0a70ac62cfae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1cf3cb20>]}
2021-10-01 12:10:53.414305 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:10:53.481374 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:10:53.485919 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:10:53.490550 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:10:53.494646 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:10:53.626071 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efbec88b-c85e-4bd7-b44a-0a70ac62cfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1cf16910>]}
2021-10-01 12:10:53.637101 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efbec88b-c85e-4bd7-b44a-0a70ac62cfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1ce66730>]}
2021-10-01 12:10:53.637522 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:10:53.639031 (MainThread): 
2021-10-01 12:10:53.639505 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:10:53.640529 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:10:53.655648 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:10:53.655864 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:10:53.656020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:10:55.812465 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.16 seconds
2021-10-01 12:10:55.814101 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:10:56.401515 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:10:56.408776 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:10:56.408975 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:10:56.409123 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:10:57.951847 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.54 seconds
2021-10-01 12:10:57.953605 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:10:58.527215 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:10:58.529767 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:10:58.529968 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:10:58.530125 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:11:00.282273 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.75 seconds
2021-10-01 12:11:00.284389 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:11:00.841901 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:11:00.844435 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:11:00.844621 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:11:00.844786 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:11:02.623191 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.78 seconds
2021-10-01 12:11:02.624942 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:11:03.231776 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 56562), raddr=('52.228.75.102', 443)>
2021-10-01 12:11:03.234788 (MainThread): 17:41:03 | Concurrency: 1 threads (target='dev')
2021-10-01 12:11:03.235021 (MainThread): 17:41:03 | 
2021-10-01 12:11:03.236019 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:11:03.236359 (Thread-1): 17:41:03 | 1 of 3 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:11:03.236734 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:11:03.236935 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:11:03.240402 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:11:03.242619 (Thread-1): finished collecting timing info
2021-10-01 12:11:03.275033 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:11:03.277636 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:11:03.277822 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:11:03.277983 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:11:06.376484 (Thread-1): SQL status: SUCCESS 1 in 3.10 seconds
2021-10-01 12:11:06.387951 (Thread-1): finished collecting timing info
2021-10-01 12:11:06.388224 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:11:06.957611 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbec88b-c85e-4bd7-b44a-0a70ac62cfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1d824a90>]}
2021-10-01 12:11:06.958136 (Thread-1): 17:41:06 | 1 of 3 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.72s]
2021-10-01 12:11:06.958390 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:11:06.958667 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:11:06.959084 (Thread-1): 17:41:06 | 2 of 3 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:11:06.959444 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:11:06.959736 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:11:06.963238 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:11:06.963851 (Thread-1): finished collecting timing info
2021-10-01 12:11:06.980578 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:11:06.981865 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:11:06.982054 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    

/*
with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customers
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
*/

select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );
2021-10-01 12:11:06.982214 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:11:08.556455 (Thread-1): Snowflake query id: 019f50fb-0000-36fb-0000-cdb9000224ee
2021-10-01 12:11:08.556682 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.SALES_SCHEMA.CUST' does not exist or not authorized.
2021-10-01 12:11:08.556908 (Thread-1): finished collecting timing info
2021-10-01 12:11:08.557114 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:11:09.211430 (Thread-1): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.SALES_SCHEMA.CUST' does not exist or not authorized.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.SALES_SCHEMA.CUST' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.SALES_SCHEMA.CUST' does not exist or not authorized.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:11:09.214043 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbec88b-c85e-4bd7-b44a-0a70ac62cfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1d824d60>]}
2021-10-01 12:11:09.214449 (Thread-1): 17:41:09 | 2 of 3 ERROR creating view model SALES_SCHEMA.orders_count_by_cust... [ERROR in 2.25s]
2021-10-01 12:11:09.214650 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:11:09.214851 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:11:09.215241 (Thread-1): 17:41:09 | 3 of 3 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:11:09.215582 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:11:09.215748 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:11:09.218564 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:11:09.219203 (Thread-1): finished collecting timing info
2021-10-01 12:11:09.221755 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:11:09.223458 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:11:09.223658 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:11:09.223818 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:11:13.052344 (Thread-1): SQL status: SUCCESS 1 in 3.83 seconds
2021-10-01 12:11:13.054235 (Thread-1): finished collecting timing info
2021-10-01 12:11:13.054521 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:11:13.616570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbec88b-c85e-4bd7-b44a-0a70ac62cfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1d3a67c0>]}
2021-10-01 12:11:13.617450 (Thread-1): 17:41:13 | 3 of 3 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 4.40s]
2021-10-01 12:11:13.617691 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:11:13.618776 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:11:13.619163 (MainThread): 17:41:13 | 
2021-10-01 12:11:13.619402 (MainThread): 17:41:13 | Finished running 2 table models, 1 view model in 19.98s.
2021-10-01 12:11:13.619584 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:11:13.619741 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 12:11:13.632850 (MainThread): 
2021-10-01 12:11:13.633229 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 12:11:13.633485 (MainThread): 
2021-10-01 12:11:13.633719 (MainThread): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
2021-10-01 12:11:13.633930 (MainThread):   002003 (42S02): SQL compilation error:
2021-10-01 12:11:13.634089 (MainThread):   Object 'DEMO_DB.SALES_SCHEMA.CUST' does not exist or not authorized.
2021-10-01 12:11:13.634321 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:11:13.634530 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 12:11:13.634906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf188a13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1c347d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1ce66700>]}
2021-10-01 12:11:13.635191 (MainThread): Flushing usage events
2021-10-01 12:13:13.094537 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:13:14.038709 (MainThread): Loading KWallet
2021-10-01 12:13:14.039911 (MainThread): Loading SecretService
2021-10-01 12:13:14.040911 (MainThread): Loading Windows
2021-10-01 12:13:14.041975 (MainThread): Loading chainer
2021-10-01 12:13:14.042962 (MainThread): Loading macOS
2021-10-01 12:13:14.604127 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:13:14.605978 (MainThread): Tracking: tracking
2021-10-01 12:13:14.606400 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a753b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4bb16d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4bb16af0>]}
2021-10-01 12:13:14.629741 (MainThread): Partial parsing not enabled
2021-10-01 12:13:14.692676 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:13:14.693626 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:13:14.694750 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:13:14.697048 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:13:14.743006 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:13:14.747712 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:13:14.753342 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:13:14.755233 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:13:14.759571 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:13:14.770183 (MainThread): Parsing macros/core.sql
2021-10-01 12:13:14.774410 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:13:14.782130 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:13:14.794885 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:13:14.796928 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:13:14.818504 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:13:14.858436 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:13:14.882940 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:13:14.884974 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:13:14.896377 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:13:14.917379 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:13:14.932652 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:13:14.941353 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:13:14.948839 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:13:14.952367 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:13:14.953164 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:13:14.954038 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:13:14.955410 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:13:14.963313 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:13:14.965219 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:13:14.966878 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:13:15.022490 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:13:15.024122 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:13:15.025232 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:13:15.026478 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:13:15.028406 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:13:15.029424 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:13:15.030603 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:13:15.032728 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:13:15.038703 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:13:15.040171 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:13:15.041689 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:13:15.044008 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:13:15.045051 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:13:15.047322 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:13:15.058064 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:13:15.060340 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:13:15.061971 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:13:15.063826 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:13:15.065553 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:13:15.066665 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:13:15.070292 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:13:15.076272 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:13:15.077116 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:13:15.080013 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:13:15.081940 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:13:15.083472 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:13:15.085452 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:13:15.107838 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:13:15.108530 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:13:15.109175 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:13:15.109840 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:13:15.112854 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:13:15.114019 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:13:15.115993 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:13:15.117319 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:13:15.118184 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:13:15.119314 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:13:15.121180 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:13:15.122305 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:13:15.123199 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:13:15.124758 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:13:15.125811 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:13:15.128530 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:13:15.130112 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:13:15.131275 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:13:15.132959 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:13:15.137260 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:13:15.143881 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:13:15.145187 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:13:15.147814 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:13:15.151305 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:13:15.153960 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:13:15.155017 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:13:15.157973 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:13:15.164464 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:13:15.172680 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:13:15.173646 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:13:15.176562 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:13:15.177586 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:13:15.178764 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:13:15.181372 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:13:15.185166 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:13:15.187815 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:13:15.370113 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:13:15.370377 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1752af7-49aa-48b4-a4dc-72bd852f9215', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c828580>]}
2021-10-01 12:13:15.497119 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:13:15.557282 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:13:15.561597 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:13:15.566094 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:13:15.570630 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:13:15.700107 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1752af7-49aa-48b4-a4dc-72bd852f9215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c8a6f40>]}
2021-10-01 12:13:15.710638 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1752af7-49aa-48b4-a4dc-72bd852f9215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c8a6520>]}
2021-10-01 12:13:15.710989 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:13:15.712397 (MainThread): 
2021-10-01 12:13:15.712858 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:13:15.713872 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:13:15.728141 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:13:15.728349 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:13:15.728498 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:13:17.698321 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.97 seconds
2021-10-01 12:13:17.699933 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:13:18.276420 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:13:18.284314 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:13:18.284545 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:13:18.284709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:13:19.826220 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.54 seconds
2021-10-01 12:13:19.828188 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:13:20.395815 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:13:20.398298 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:13:20.398469 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:13:20.398632 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:13:22.026827 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.63 seconds
2021-10-01 12:13:22.028845 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:13:22.624249 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:13:22.626606 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:13:22.626826 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:13:22.626997 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:13:24.387615 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.76 seconds
2021-10-01 12:13:24.389354 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:13:24.966612 (MainThread): 17:43:24 | Concurrency: 1 threads (target='dev')
2021-10-01 12:13:24.966898 (MainThread): 17:43:24 | 
2021-10-01 12:13:24.967896 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:13:24.968284 (Thread-1): 17:43:24 | 1 of 3 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:13:24.968676 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:13:24.968854 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:13:24.972167 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:13:24.972894 (Thread-1): finished collecting timing info
2021-10-01 12:13:25.004559 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:13:25.006440 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:13:25.006701 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:13:25.006875 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:13:27.633517 (Thread-1): SQL status: SUCCESS 1 in 2.63 seconds
2021-10-01 12:13:27.644629 (Thread-1): finished collecting timing info
2021-10-01 12:13:27.644959 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:13:28.212634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1752af7-49aa-48b4-a4dc-72bd852f9215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4cf130a0>]}
2021-10-01 12:13:28.213164 (Thread-1): 17:43:28 | 1 of 3 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.24s]
2021-10-01 12:13:28.213436 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:13:28.213636 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:13:28.214077 (Thread-1): 17:43:28 | 2 of 3 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:13:28.214440 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:13:28.214610 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:13:28.219135 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:13:28.219815 (Thread-1): finished collecting timing info
2021-10-01 12:13:28.236285 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:13:28.237830 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:13:28.238020 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    


with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customers
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)
select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );
2021-10-01 12:13:28.238175 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:13:29.845469 (Thread-1): Snowflake query id: 019f50fd-0000-36de-0000-cdb90002501a
2021-10-01 12:13:29.845707 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
2021-10-01 12:13:29.845956 (Thread-1): finished collecting timing info
2021-10-01 12:13:29.846161 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:13:30.105000 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 56618), raddr=('52.228.75.102', 443)>
2021-10-01 12:13:31.284169 (Thread-1): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:13:31.286163 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1752af7-49aa-48b4-a4dc-72bd852f9215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c8a6dc0>]}
2021-10-01 12:13:31.286577 (Thread-1): 17:43:31 | 2 of 3 ERROR creating view model SALES_SCHEMA.orders_count_by_cust... [ERROR in 3.07s]
2021-10-01 12:13:31.286784 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:13:31.287001 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:13:31.287443 (Thread-1): 17:43:31 | 3 of 3 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:13:31.287890 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:13:31.288097 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:13:31.290946 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:13:31.291736 (Thread-1): finished collecting timing info
2021-10-01 12:13:31.294905 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:13:31.296930 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:13:31.297350 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:13:31.297682 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:13:33.885404 (Thread-1): SQL status: SUCCESS 1 in 2.59 seconds
2021-10-01 12:13:33.887159 (Thread-1): finished collecting timing info
2021-10-01 12:13:33.887456 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:13:34.459285 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1752af7-49aa-48b4-a4dc-72bd852f9215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4cc97940>]}
2021-10-01 12:13:34.459765 (Thread-1): 17:43:34 | 3 of 3 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.17s]
2021-10-01 12:13:34.459972 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:13:34.460980 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:13:34.461338 (MainThread): 17:43:34 | 
2021-10-01 12:13:34.461522 (MainThread): 17:43:34 | Finished running 2 table models, 1 view model in 18.75s.
2021-10-01 12:13:34.461751 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:13:34.461898 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 12:13:34.471482 (MainThread): 
2021-10-01 12:13:34.471749 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 12:13:34.472003 (MainThread): 
2021-10-01 12:13:34.472301 (MainThread): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
2021-10-01 12:13:34.472482 (MainThread):   002003 (42S02): SQL compilation error:
2021-10-01 12:13:34.472641 (MainThread):   Object 'DEMO_DB.SALES_SCHEMA.CUSTOMERS' does not exist or not authorized.
2021-10-01 12:13:34.472793 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:13:34.472958 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 12:13:34.473200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c828850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a753b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c777640>]}
2021-10-01 12:13:34.473520 (MainThread): Flushing usage events
2021-10-01 12:16:27.258451 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:16:28.329755 (MainThread): Loading KWallet
2021-10-01 12:16:28.330683 (MainThread): Loading SecretService
2021-10-01 12:16:28.331524 (MainThread): Loading Windows
2021-10-01 12:16:28.332391 (MainThread): Loading chainer
2021-10-01 12:16:28.332907 (MainThread): Loading macOS
2021-10-01 12:16:28.764549 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:16:28.766215 (MainThread): Tracking: tracking
2021-10-01 12:16:28.766628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16a5cdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bc09700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bc09100>]}
2021-10-01 12:16:28.789953 (MainThread): Partial parsing not enabled
2021-10-01 12:16:28.836855 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:16:28.837989 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:16:28.839441 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:16:28.842089 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:16:28.890251 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:16:28.895493 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:16:28.901247 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:16:28.902960 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:16:28.906675 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:16:28.916804 (MainThread): Parsing macros/core.sql
2021-10-01 12:16:28.920936 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:16:28.927886 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:16:28.937603 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:16:28.939091 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:16:28.956632 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:16:28.994815 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:16:29.015616 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:16:29.017419 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:16:29.027661 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:16:29.048158 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:16:29.062947 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:16:29.070863 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:16:29.078270 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:16:29.081993 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:16:29.082796 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:16:29.083674 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:16:29.085095 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:16:29.093384 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:16:29.095225 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:16:29.096700 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:16:29.156728 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:16:29.158533 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:16:29.159749 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:16:29.161113 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:16:29.163290 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:16:29.164491 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:16:29.165922 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:16:29.168649 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:16:29.175470 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:16:29.176968 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:16:29.178560 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:16:29.181353 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:16:29.182727 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:16:29.185541 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:16:29.196670 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:16:29.198817 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:16:29.200394 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:16:29.202268 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:16:29.204010 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:16:29.205092 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:16:29.208806 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:16:29.214625 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:16:29.215433 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:16:29.218155 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:16:29.219881 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:16:29.221350 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:16:29.223310 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:16:29.246499 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:16:29.247186 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:16:29.247860 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:16:29.248479 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:16:29.251658 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:16:29.252848 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:16:29.254727 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:16:29.255651 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:16:29.256421 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:16:29.257526 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:16:29.259288 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:16:29.260329 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:16:29.261164 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:16:29.262549 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:16:29.263610 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:16:29.265976 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:16:29.267497 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:16:29.268473 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:16:29.269654 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:16:29.272932 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:16:29.278244 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:16:29.279262 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:16:29.281455 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:16:29.284315 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:16:29.286531 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:16:29.287419 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:16:29.289879 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:16:29.296049 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:16:29.303497 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:16:29.304343 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:16:29.307218 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:16:29.308223 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:16:29.309300 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:16:29.311777 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:16:29.315802 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:16:29.318203 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:16:29.492814 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:16:29.493028 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5adc8a5d-4386-475b-b750-f3eda986dec9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16c6ecd30>]}
2021-10-01 12:16:29.616745 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:16:29.680439 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:16:29.684690 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:16:29.689296 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:16:29.693614 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:16:29.811829 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5adc8a5d-4386-475b-b750-f3eda986dec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16c5e7c70>]}
2021-10-01 12:16:29.820899 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5adc8a5d-4386-475b-b750-f3eda986dec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16c5e7eb0>]}
2021-10-01 12:16:29.821229 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:16:29.822702 (MainThread): 
2021-10-01 12:16:29.823179 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:16:29.824118 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:16:29.837799 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:16:29.838007 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:16:29.838156 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:16:31.775208 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.94 seconds
2021-10-01 12:16:31.776946 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:16:32.354015 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:16:32.363181 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:16:32.363461 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:16:32.363634 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:16:33.928868 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.57 seconds
2021-10-01 12:16:33.930956 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:16:34.499164 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:16:34.501660 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:16:34.501864 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:16:34.502026 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:16:36.223048 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.72 seconds
2021-10-01 12:16:36.225507 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:16:36.793024 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:16:36.794975 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:16:36.795125 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:16:36.795242 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:16:38.188052 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 56683), raddr=('52.228.75.102', 443)>
2021-10-01 12:16:39.407541 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 2.61 seconds
2021-10-01 12:16:39.409114 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:16:39.992011 (MainThread): 17:46:39 | Concurrency: 1 threads (target='dev')
2021-10-01 12:16:39.992322 (MainThread): 17:46:39 | 
2021-10-01 12:16:39.993580 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:16:39.994016 (Thread-1): 17:46:39 | 1 of 3 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:16:39.994505 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:16:39.994746 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:16:39.998032 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:16:39.998715 (Thread-1): finished collecting timing info
2021-10-01 12:16:40.028263 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:16:40.029521 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:16:40.029711 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:16:40.029865 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:16:42.851226 (Thread-1): SQL status: SUCCESS 1 in 2.82 seconds
2021-10-01 12:16:42.862051 (Thread-1): finished collecting timing info
2021-10-01 12:16:42.862316 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:16:43.423947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adc8a5d-4386-475b-b750-f3eda986dec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16cd96ac0>]}
2021-10-01 12:16:43.424386 (Thread-1): 17:46:43 | 1 of 3 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.43s]
2021-10-01 12:16:43.424598 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:16:43.424816 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:16:43.425211 (Thread-1): 17:46:43 | 2 of 3 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:16:43.425670 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:16:43.425851 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:16:43.429384 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:16:43.430062 (Thread-1): finished collecting timing info
2021-10-01 12:16:43.446290 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:16:43.447845 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:16:43.448031 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    


with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)
select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );
2021-10-01 12:16:43.448183 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:16:45.068500 (Thread-1): Snowflake query id: 019f5100-0000-36de-0000-cdb90002505a
2021-10-01 12:16:45.068753 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-10-01 12:16:45.069012 (Thread-1): finished collecting timing info
2021-10-01 12:16:45.069222 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:16:45.674600 (Thread-1): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:16:45.675939 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adc8a5d-4386-475b-b750-f3eda986dec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16cd96c10>]}
2021-10-01 12:16:45.676323 (Thread-1): 17:46:45 | 2 of 3 ERROR creating view model SALES_SCHEMA.orders_count_by_cust... [ERROR in 2.25s]
2021-10-01 12:16:45.676523 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:16:45.676721 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:16:45.677097 (Thread-1): 17:46:45 | 3 of 3 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:16:45.677422 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:16:45.677587 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:16:45.680623 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:16:45.681327 (Thread-1): finished collecting timing info
2021-10-01 12:16:45.683882 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:16:45.685282 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:16:45.685509 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:16:45.685675 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:16:48.201851 (Thread-1): SQL status: SUCCESS 1 in 2.52 seconds
2021-10-01 12:16:48.203674 (Thread-1): finished collecting timing info
2021-10-01 12:16:48.203945 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:16:48.765016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5adc8a5d-4386-475b-b750-f3eda986dec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16cc5ceb0>]}
2021-10-01 12:16:48.765547 (Thread-1): 17:46:48 | 3 of 3 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.09s]
2021-10-01 12:16:48.765801 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:16:48.767041 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:16:48.767465 (MainThread): 17:46:48 | 
2021-10-01 12:16:48.767657 (MainThread): 17:46:48 | Finished running 2 table models, 1 view model in 18.94s.
2021-10-01 12:16:48.767823 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:16:48.767960 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 12:16:48.776687 (MainThread): 
2021-10-01 12:16:48.776961 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 12:16:48.777153 (MainThread): 
2021-10-01 12:16:48.777341 (MainThread): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
2021-10-01 12:16:48.777529 (MainThread):   002022 (42601): SQL compilation error:
2021-10-01 12:16:48.777695 (MainThread):   Missing column specification
2021-10-01 12:16:48.777847 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:16:48.778018 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 12:16:48.778351 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16a5cdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16c62e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16cc08640>]}
2021-10-01 12:16:48.778645 (MainThread): Flushing usage events
2021-10-01 12:22:26.463322 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:22:27.687453 (MainThread): Loading KWallet
2021-10-01 12:22:27.688799 (MainThread): Loading SecretService
2021-10-01 12:22:27.690132 (MainThread): Loading Windows
2021-10-01 12:22:27.691487 (MainThread): Loading chainer
2021-10-01 12:22:27.692245 (MainThread): Loading macOS
2021-10-01 12:22:28.222387 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:22:28.224591 (MainThread): Tracking: tracking
2021-10-01 12:22:28.224934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff287053bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff288f46310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff288348190>]}
2021-10-01 12:22:28.247860 (MainThread): Partial parsing not enabled
2021-10-01 12:22:28.330291 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:22:28.331652 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:22:28.333863 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:22:28.338319 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:22:28.394378 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:22:28.399284 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:22:28.405903 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:22:28.407693 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:22:28.411628 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:22:28.423313 (MainThread): Parsing macros/core.sql
2021-10-01 12:22:28.428167 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:22:28.436551 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:22:28.449589 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:22:28.451677 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:22:28.474224 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:22:28.515797 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:22:28.541299 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:22:28.543423 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:22:28.555978 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:22:28.582343 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:22:28.600268 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:22:28.610402 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:22:28.620125 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:22:28.624928 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:22:28.626130 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:22:28.627349 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:22:28.629232 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:22:28.639693 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:22:28.641964 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:22:28.643767 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:22:28.703162 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:22:28.705147 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:22:28.706436 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:22:28.707953 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:22:28.710293 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:22:28.711479 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:22:28.712803 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:22:28.715083 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:22:28.720754 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:22:28.722052 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:22:28.723346 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:22:28.725657 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:22:28.726863 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:22:28.729256 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:22:28.740142 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:22:28.741993 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:22:28.743460 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:22:28.745694 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:22:28.747236 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:22:28.748135 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:22:28.751205 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:22:28.756745 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:22:28.757595 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:22:28.760285 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:22:28.762258 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:22:28.763846 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:22:28.765825 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:22:28.789711 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:22:28.790439 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:22:28.791071 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:22:28.791643 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:22:28.795007 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:22:28.796278 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:22:28.798348 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:22:28.799417 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:22:28.800583 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:22:28.802228 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:22:28.804568 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:22:28.805943 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:22:28.807028 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:22:28.808880 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:22:28.810031 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:22:28.812874 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:22:28.814442 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:22:28.815550 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:22:28.817102 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:22:28.821524 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:22:28.829209 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:22:28.830689 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:22:28.833898 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:22:28.837950 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:22:28.841106 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:22:28.842398 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:22:28.845914 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:22:28.853740 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:22:28.865098 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:22:28.866425 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:22:28.869919 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:22:28.871306 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:22:28.872767 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:22:28.876194 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:22:28.881451 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:22:28.885172 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:22:29.101659 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:22:29.101931 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89f3bbe4-8c1f-4b16-a342-da80a468048f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28901b430>]}
2021-10-01 12:22:29.239585 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:22:29.304206 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:22:29.309492 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:22:29.314357 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:22:29.318610 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:22:29.447063 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89f3bbe4-8c1f-4b16-a342-da80a468048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff288f29f40>]}
2021-10-01 12:22:29.456814 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89f3bbe4-8c1f-4b16-a342-da80a468048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff288ffba90>]}
2021-10-01 12:22:29.457174 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:22:29.458748 (MainThread): 
2021-10-01 12:22:29.459215 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:22:29.460197 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:22:29.474860 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:22:29.475080 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:22:29.475233 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:22:31.583436 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.11 seconds
2021-10-01 12:22:31.585135 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:22:32.148342 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:22:32.155780 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:22:32.156002 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:22:32.156160 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:22:33.754677 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.60 seconds
2021-10-01 12:22:33.756698 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:22:34.350978 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:22:34.353779 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:22:34.354114 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:22:34.354280 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:22:35.956335 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.60 seconds
2021-10-01 12:22:35.959438 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:22:36.537245 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:22:36.541260 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:22:36.541675 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:22:36.541896 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:22:38.278266 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.74 seconds
2021-10-01 12:22:38.279927 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:22:38.843513 (MainThread): 17:52:38 | Concurrency: 1 threads (target='dev')
2021-10-01 12:22:38.843785 (MainThread): 17:52:38 | 
2021-10-01 12:22:38.844874 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:22:38.845187 (Thread-1): 17:52:38 | 1 of 3 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:22:38.845522 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:22:38.845696 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:22:38.849279 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:22:38.850065 (Thread-1): finished collecting timing info
2021-10-01 12:22:38.882462 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:22:38.884627 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:22:38.885163 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:22:38.885381 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:22:41.319034 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-10-01 12:22:41.330631 (Thread-1): finished collecting timing info
2021-10-01 12:22:41.330974 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:22:41.913027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f3bbe4-8c1f-4b16-a342-da80a468048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28981ce80>]}
2021-10-01 12:22:41.913785 (Thread-1): 17:52:41 | 1 of 3 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 3.07s]
2021-10-01 12:22:41.914067 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:22:41.914314 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:22:41.915135 (Thread-1): 17:52:41 | 2 of 3 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:22:41.916187 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:22:41.916961 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:22:41.921982 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:22:41.922858 (Thread-1): finished collecting timing info
2021-10-01 12:22:41.953122 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:22:41.955636 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:22:41.955854 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    


with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)
select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );
2021-10-01 12:22:41.956029 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:22:43.898761 (Thread-1): SQL status: SUCCESS 1 in 1.94 seconds
2021-10-01 12:22:43.901029 (Thread-1): finished collecting timing info
2021-10-01 12:22:43.901395 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:22:44.476685 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f3bbe4-8c1f-4b16-a342-da80a468048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28981c430>]}
2021-10-01 12:22:44.477138 (Thread-1): 17:52:44 | 2 of 3 OK created view model SALES_SCHEMA.orders_count_by_cust....... [SUCCESS 1 in 2.56s]
2021-10-01 12:22:44.477355 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:22:44.477555 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:22:44.477898 (Thread-1): 17:52:44 | 3 of 3 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:22:44.478222 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:22:44.478391 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:22:44.481242 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:22:44.481953 (Thread-1): finished collecting timing info
2021-10-01 12:22:44.484444 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:22:44.485784 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:22:44.486089 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:22:44.486337 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:22:46.900467 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 56823), raddr=('52.228.75.102', 443)>
2021-10-01 12:22:46.901241 (Thread-1): SQL status: SUCCESS 1 in 2.41 seconds
2021-10-01 12:22:46.903039 (Thread-1): finished collecting timing info
2021-10-01 12:22:46.903433 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:22:48.424521 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f3bbe4-8c1f-4b16-a342-da80a468048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff289592430>]}
2021-10-01 12:22:48.424988 (Thread-1): 17:52:48 | 3 of 3 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.95s]
2021-10-01 12:22:48.425194 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:22:48.426293 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:22:48.426667 (MainThread): 17:52:48 | 
2021-10-01 12:22:48.426859 (MainThread): 17:52:48 | Finished running 2 table models, 1 view model in 18.97s.
2021-10-01 12:22:48.427023 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:22:48.427158 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 12:22:48.435832 (MainThread): 
2021-10-01 12:22:48.436115 (MainThread): Completed successfully
2021-10-01 12:22:48.436306 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-01 12:22:48.436745 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff283fa13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff288f6b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff288f6b6a0>]}
2021-10-01 12:22:48.437024 (MainThread): Flushing usage events
2021-10-01 12:28:38.541280 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:28:39.425573 (MainThread): Loading KWallet
2021-10-01 12:28:39.426726 (MainThread): Loading SecretService
2021-10-01 12:28:39.427713 (MainThread): Loading Windows
2021-10-01 12:28:39.428987 (MainThread): Loading chainer
2021-10-01 12:28:39.429802 (MainThread): Loading macOS
2021-10-01 12:28:39.920871 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:28:39.922584 (MainThread): Tracking: tracking
2021-10-01 12:28:39.922920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe00f14d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02348d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02348af0>]}
2021-10-01 12:28:39.943512 (MainThread): Partial parsing not enabled
2021-10-01 12:28:39.997585 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:28:39.998314 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:28:39.999176 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:28:40.001135 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:28:40.038583 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:28:40.043088 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:28:40.048291 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:28:40.049868 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:28:40.053630 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:28:40.065697 (MainThread): Parsing macros/core.sql
2021-10-01 12:28:40.070334 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:28:40.078582 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:28:40.090872 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:28:40.093037 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:28:40.114399 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:28:40.151591 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:28:40.173323 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:28:40.174984 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:28:40.185656 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:28:40.206775 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:28:40.219798 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:28:40.227342 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:28:40.234467 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:28:40.238133 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:28:40.238937 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:28:40.239799 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:28:40.241239 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:28:40.249440 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:28:40.251333 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:28:40.252740 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:28:40.316485 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:28:40.318462 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:28:40.319576 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:28:40.320790 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:28:40.322698 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:28:40.323666 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:28:40.324861 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:28:40.327012 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:28:40.332378 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:28:40.333617 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:28:40.334801 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:28:40.336940 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:28:40.337971 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:28:40.340181 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:28:40.349606 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:28:40.351664 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:28:40.352978 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:28:40.354842 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:28:40.356493 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:28:40.357377 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:28:40.360428 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:28:40.366005 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:28:40.366811 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:28:40.369895 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:28:40.372036 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:28:40.373469 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:28:40.375424 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:28:40.401396 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:28:40.402248 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:28:40.403052 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:28:40.403755 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:28:40.407196 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:28:40.408439 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:28:40.410362 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:28:40.411285 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:28:40.412055 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:28:40.413161 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:28:40.414978 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:28:40.416113 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:28:40.416953 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:28:40.418532 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:28:40.419357 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:28:40.421744 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:28:40.423066 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:28:40.423975 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:28:40.425140 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:28:40.428552 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:28:40.434600 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:28:40.435729 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:28:40.438360 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:28:40.441353 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:28:40.443675 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:28:40.444555 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:28:40.447112 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:28:40.453031 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:28:40.460365 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:28:40.461172 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:28:40.464000 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:28:40.464889 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:28:40.466146 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:28:40.468877 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:28:40.472880 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:28:40.475419 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:28:40.686554 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:28:40.686827 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '429ff6d9-3fe4-41ae-8b04-f580535dd0b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe0303cb20>]}
2021-10-01 12:28:40.832821 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:28:40.902831 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:28:40.907434 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:28:40.912089 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:28:40.916391 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:28:41.028381 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '429ff6d9-3fe4-41ae-8b04-f580535dd0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02e10d60>]}
2021-10-01 12:28:41.037328 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '429ff6d9-3fe4-41ae-8b04-f580535dd0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe030a2ac0>]}
2021-10-01 12:28:41.037654 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:28:41.039086 (MainThread): 
2021-10-01 12:28:41.039551 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:28:41.040450 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:28:41.054400 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:28:41.054611 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:28:41.054763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:28:42.981593 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.93 seconds
2021-10-01 12:28:42.983721 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:28:43.560684 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:28:43.568533 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:28:43.568765 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:28:43.568939 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:28:45.983974 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 2.42 seconds
2021-10-01 12:28:45.986244 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:28:46.623967 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:28:46.626615 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:28:46.626800 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:28:46.626950 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:28:48.633998 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 2.01 seconds
2021-10-01 12:28:48.635976 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:28:49.260915 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:28:49.263343 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:28:49.263523 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:28:49.263675 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:28:51.472313 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 2.21 seconds
2021-10-01 12:28:51.474153 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:28:52.163075 (MainThread): 17:58:52 | Concurrency: 1 threads (target='dev')
2021-10-01 12:28:52.163351 (MainThread): 17:58:52 | 
2021-10-01 12:28:52.164555 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:28:52.164928 (Thread-1): 17:58:52 | 1 of 3 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:28:52.165283 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:28:52.165465 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:28:52.168641 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:28:52.169344 (Thread-1): finished collecting timing info
2021-10-01 12:28:52.197823 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:28:52.199296 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:28:52.199509 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:28:52.199697 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:28:56.444918 (Thread-1): SQL status: SUCCESS 1 in 4.25 seconds
2021-10-01 12:28:56.456410 (Thread-1): finished collecting timing info
2021-10-01 12:28:56.456687 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:28:57.116569 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429ff6d9-3fe4-41ae-8b04-f580535dd0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe035ea820>]}
2021-10-01 12:28:57.117108 (Thread-1): 17:58:57 | 1 of 3 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 4.95s]
2021-10-01 12:28:57.117366 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:28:57.117596 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:28:57.117850 (Thread-1): 17:58:57 | 2 of 3 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:28:57.118381 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:28:57.118568 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:28:57.123108 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:28:57.123744 (Thread-1): finished collecting timing info
2021-10-01 12:28:57.140531 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:28:57.142000 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:28:57.142183 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    
with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)

select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME ,count(*)  from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
/*
select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
*/
  );
2021-10-01 12:28:57.142338 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:28:59.068922 (Thread-1): Snowflake query id: 019f510c-0000-36dc-0000-cdb90001f8c2
2021-10-01 12:28:59.069156 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-10-01 12:28:59.069374 (Thread-1): finished collecting timing info
2021-10-01 12:28:59.069578 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:28:59.643084 (Thread-1): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:28:59.645972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429ff6d9-3fe4-41ae-8b04-f580535dd0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe035bd760>]}
2021-10-01 12:28:59.646404 (Thread-1): 17:58:59 | 2 of 3 ERROR creating view model SALES_SCHEMA.orders_count_by_cust... [ERROR in 2.53s]
2021-10-01 12:28:59.646606 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:28:59.646820 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:28:59.647315 (Thread-1): 17:58:59 | 3 of 3 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:28:59.647744 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:28:59.647927 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:28:59.650924 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:28:59.651561 (Thread-1): finished collecting timing info
2021-10-01 12:28:59.653939 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:28:59.655269 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:28:59.655490 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:28:59.655666 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:29:02.478175 (Thread-1): SQL status: SUCCESS 1 in 2.82 seconds
2021-10-01 12:29:02.480089 (Thread-1): finished collecting timing info
2021-10-01 12:29:02.480372 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:29:03.192961 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429ff6d9-3fe4-41ae-8b04-f580535dd0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe035ea940>]}
2021-10-01 12:29:03.193519 (Thread-1): 17:59:03 | 3 of 3 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.55s]
2021-10-01 12:29:03.193783 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:29:03.194959 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:29:03.195348 (MainThread): 17:59:03 | 
2021-10-01 12:29:03.195551 (MainThread): 17:59:03 | Finished running 2 table models, 1 view model in 22.16s.
2021-10-01 12:29:03.195725 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:29:03.195914 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 12:29:03.205665 (MainThread): 
2021-10-01 12:29:03.205937 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 12:29:03.206126 (MainThread): 
2021-10-01 12:29:03.206316 (MainThread): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
2021-10-01 12:29:03.206477 (MainThread):   002022 (42601): SQL compilation error:
2021-10-01 12:29:03.206628 (MainThread):   Missing column specification
2021-10-01 12:29:03.206940 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-01 12:29:03.207145 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 12:29:03.207390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe00f14d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02e77760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02e77700>]}
2021-10-01 12:29:03.207679 (MainThread): Flushing usage events
2021-10-01 12:29:51.798653 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:29:52.700908 (MainThread): Loading KWallet
2021-10-01 12:29:52.702024 (MainThread): Loading SecretService
2021-10-01 12:29:52.703014 (MainThread): Loading Windows
2021-10-01 12:29:52.704122 (MainThread): Loading chainer
2021-10-01 12:29:52.704928 (MainThread): Loading macOS
2021-10-01 12:29:53.208077 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:29:53.209578 (MainThread): Tracking: tracking
2021-10-01 12:29:53.209993 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e74153c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75215af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75215ac0>]}
2021-10-01 12:29:53.231403 (MainThread): Partial parsing not enabled
2021-10-01 12:29:53.295775 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:29:53.296771 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:29:53.298257 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:29:53.300695 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:29:53.347861 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:29:53.353101 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:29:53.358609 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:29:53.360225 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:29:53.363918 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:29:53.374741 (MainThread): Parsing macros/core.sql
2021-10-01 12:29:53.379495 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:29:53.387601 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:29:53.399742 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:29:53.401634 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:29:53.421322 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:29:53.458396 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:29:53.479539 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:29:53.481532 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:29:53.491496 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:29:53.510731 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:29:53.524386 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:29:53.534019 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:29:53.542465 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:29:53.547417 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:29:53.548583 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:29:53.549784 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:29:53.551654 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:29:53.563082 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:29:53.565281 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:29:53.567205 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:29:53.632770 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:29:53.635106 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:29:53.636557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:29:53.638233 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:29:53.640848 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:29:53.642184 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:29:53.643790 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:29:53.646964 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:29:53.654288 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:29:53.655828 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:29:53.657375 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:29:53.660115 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:29:53.661361 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:29:53.664044 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:29:53.675685 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:29:53.677962 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:29:53.679653 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:29:53.681650 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:29:53.683559 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:29:53.684696 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:29:53.688614 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:29:53.694945 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:29:53.695971 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:29:53.699270 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:29:53.701532 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:29:53.703354 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:29:53.705618 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:29:53.734478 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:29:53.735327 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:29:53.736126 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:29:53.736955 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:29:53.740718 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:29:53.742219 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:29:53.744435 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:29:53.745605 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:29:53.746632 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:29:53.747887 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:29:53.749858 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:29:53.751086 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:29:53.752069 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:29:53.753773 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:29:53.754633 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:29:53.756865 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:29:53.758121 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:29:53.759016 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:29:53.760172 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:29:53.763615 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:29:53.769030 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:29:53.770287 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:29:53.773037 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:29:53.776407 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:29:53.778854 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:29:53.780002 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:29:53.782861 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:29:53.788889 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:29:53.797038 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:29:53.798513 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:29:53.801421 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:29:53.802612 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:29:53.803831 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:29:53.806588 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:29:53.810989 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:29:53.814162 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:29:54.024412 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:29:54.024637 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b385fb41-d0db-437b-a895-84baef862bbf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7602b580>]}
2021-10-01 12:29:54.177837 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:29:54.247638 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:29:54.251969 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:29:54.256755 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:29:54.260856 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:29:54.385827 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b385fb41-d0db-437b-a895-84baef862bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75f25e50>]}
2021-10-01 12:29:54.396608 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b385fb41-d0db-437b-a895-84baef862bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75f776d0>]}
2021-10-01 12:29:54.396971 (MainThread): Found 5 models, 9 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:29:54.398458 (MainThread): 
2021-10-01 12:29:54.399146 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:29:54.400098 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:29:54.414428 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:29:54.414636 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:29:54.414785 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:29:56.384163 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.97 seconds
2021-10-01 12:29:56.386044 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:29:56.965002 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:29:56.972512 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:29:56.972725 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:29:56.972878 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:29:58.759866 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.79 seconds
2021-10-01 12:29:58.762096 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:29:59.325807 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:29:59.328330 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:29:59.328508 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:29:59.328658 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:30:00.874511 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.55 seconds
2021-10-01 12:30:00.876503 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:30:01.433193 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:30:01.435695 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:30:01.435878 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:30:01.436031 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:30:03.567757 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 2.13 seconds
2021-10-01 12:30:03.569782 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:30:04.251593 (MainThread): 18:00:04 | Concurrency: 1 threads (target='dev')
2021-10-01 12:30:04.251852 (MainThread): 18:00:04 | 
2021-10-01 12:30:04.253161 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:30:04.253523 (Thread-1): 18:00:04 | 1 of 3 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:30:04.253923 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:30:04.254111 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:30:04.257543 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:30:04.258206 (Thread-1): finished collecting timing info
2021-10-01 12:30:04.290794 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:30:04.292509 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:30:04.292886 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:30:04.293232 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:30:06.566407 (Thread-1): SQL status: SUCCESS 1 in 2.27 seconds
2021-10-01 12:30:06.579051 (Thread-1): finished collecting timing info
2021-10-01 12:30:06.579460 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:30:07.151798 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b385fb41-d0db-437b-a895-84baef862bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e76488ac0>]}
2021-10-01 12:30:07.152394 (Thread-1): 18:00:07 | 1 of 3 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 2.90s]
2021-10-01 12:30:07.152660 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:30:07.152958 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:30:07.153484 (Thread-1): 18:00:07 | 2 of 3 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:30:07.154150 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:30:07.154348 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:30:07.160284 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:30:07.161112 (Thread-1): finished collecting timing info
2021-10-01 12:30:07.180953 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:30:07.183058 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:30:07.183320 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    
with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );
2021-10-01 12:30:07.183492 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:30:08.942017 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-10-01 12:30:08.943523 (Thread-1): finished collecting timing info
2021-10-01 12:30:08.943749 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:30:09.524534 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b385fb41-d0db-437b-a895-84baef862bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e76488f70>]}
2021-10-01 12:30:09.525102 (Thread-1): 18:00:09 | 2 of 3 OK created view model SALES_SCHEMA.orders_count_by_cust....... [SUCCESS 1 in 2.37s]
2021-10-01 12:30:09.525377 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:30:09.525620 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:30:09.525941 (Thread-1): 18:00:09 | 3 of 3 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:30:09.526587 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:30:09.526813 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:30:09.530668 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:30:09.532619 (Thread-1): finished collecting timing info
2021-10-01 12:30:09.535446 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:30:09.537032 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:30:09.537287 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:30:09.537476 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:30:11.967732 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-10-01 12:30:11.969198 (Thread-1): finished collecting timing info
2021-10-01 12:30:11.969414 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:30:12.524240 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b385fb41-d0db-437b-a895-84baef862bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e76488520>]}
2021-10-01 12:30:12.524806 (Thread-1): 18:00:12 | 3 of 3 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.00s]
2021-10-01 12:30:12.525043 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:30:12.526220 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:30:12.526704 (MainThread): 18:00:12 | 
2021-10-01 12:30:12.526923 (MainThread): 18:00:12 | Finished running 2 table models, 1 view model in 18.13s.
2021-10-01 12:30:12.527096 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:30:12.527237 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-01 12:30:12.535984 (MainThread): 
2021-10-01 12:30:12.536270 (MainThread): Completed successfully
2021-10-01 12:30:12.536501 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-01 12:30:12.536959 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75f25d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75215c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75f06250>]}
2021-10-01 12:30:12.537702 (MainThread): Flushing usage events
2021-10-01 12:48:37.443854 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:48:38.952232 (MainThread): Loading KWallet
2021-10-01 12:48:38.953390 (MainThread): Loading SecretService
2021-10-01 12:48:38.954427 (MainThread): Loading Windows
2021-10-01 12:48:38.955742 (MainThread): Loading chainer
2021-10-01 12:48:38.956621 (MainThread): Loading macOS
2021-10-01 12:48:39.516646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:48:39.519093 (MainThread): Tracking: tracking
2021-10-01 12:48:39.519641 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5ff13d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61315af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61315ac0>]}
2021-10-01 12:48:39.545466 (MainThread): Partial parsing not enabled
2021-10-01 12:48:39.558133 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61e8e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61e8e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61e8e1c0>]}
2021-10-01 12:48:39.558518 (MainThread): Flushing usage events
2021-10-01 12:48:40.915458 (MainThread): Encountered an error:
2021-10-01 12:48:40.915751 (MainThread): Compilation Error
  Error reading dbt_demo_project: snowflake_model_data/schema.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |       - name: ORD_COUNT
    53 | 
    54 |   - name: cust_details_ord_counts
    55 |       tests:
    56 |         - is_not_empty
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 55, column 12
2021-10-01 12:48:40.924982 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 55, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 55
  ------------------------------
  52 |       - name: ORD_COUNT
  53 | 
  54 |   - name: cust_details_ord_counts
  55 |       tests:
  56 |         - is_not_empty
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 55, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 209, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_demo_project: snowflake_model_data/schema.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |       - name: ORD_COUNT
    53 | 
    54 |   - name: cust_details_ord_counts
    55 |       tests:
    56 |         - is_not_empty
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 55, column 12

2021-10-01 12:49:05.913980 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:49:06.820938 (MainThread): Loading KWallet
2021-10-01 12:49:06.822051 (MainThread): Loading SecretService
2021-10-01 12:49:06.823089 (MainThread): Loading Windows
2021-10-01 12:49:06.824209 (MainThread): Loading chainer
2021-10-01 12:49:06.824965 (MainThread): Loading macOS
2021-10-01 12:49:07.332795 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 12:49:07.334844 (MainThread): Tracking: tracking
2021-10-01 12:49:07.335177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac7853df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8a15700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8a15100>]}
2021-10-01 12:49:07.356582 (MainThread): Partial parsing not enabled
2021-10-01 12:49:07.411216 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:49:07.412015 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:49:07.412921 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:49:07.414820 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:49:07.454920 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:49:07.459806 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:49:07.465175 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:49:07.466873 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:49:07.470724 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:49:07.480715 (MainThread): Parsing macros/core.sql
2021-10-01 12:49:07.484734 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:49:07.493256 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:49:07.506838 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:49:07.508888 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:49:07.530355 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:49:07.568413 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:49:07.590806 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:49:07.592587 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:49:07.602627 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:49:07.624252 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:49:07.637834 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:49:07.646180 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:49:07.654756 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:49:07.660301 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:49:07.661448 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:49:07.662386 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:49:07.663863 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:49:07.673750 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:49:07.675846 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:49:07.677616 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:49:07.743541 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:49:07.745579 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:49:07.746869 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:49:07.748284 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:49:07.750432 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:49:07.751487 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:49:07.752701 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:49:07.754844 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:49:07.760370 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:49:07.761672 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:49:07.762869 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:49:07.765322 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:49:07.766375 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:49:07.768566 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:49:07.778364 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:49:07.780287 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:49:07.781666 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:49:07.783707 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:49:07.785164 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:49:07.786094 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:49:07.789453 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:49:07.795834 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:49:07.796744 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:49:07.799864 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:49:07.801964 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:49:07.803693 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:49:07.805880 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:49:07.830230 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:49:07.830883 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:49:07.831518 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:49:07.832154 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:49:07.835466 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:49:07.836624 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:49:07.838468 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:49:07.839460 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:49:07.840228 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:49:07.841401 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:49:07.843162 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:49:07.844204 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:49:07.845109 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:49:07.846449 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:49:07.847305 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:49:07.849497 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:49:07.850762 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:49:07.851661 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:49:07.853243 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:49:07.859128 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:49:07.865507 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:49:07.866642 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:49:07.869281 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:49:07.872599 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:49:07.875133 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:49:07.876095 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:49:07.878769 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:49:07.884386 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:49:07.891705 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:49:07.892515 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:49:07.895191 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:49:07.896078 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:49:07.897108 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:49:07.900155 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:49:07.904317 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:49:07.907185 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:49:08.081511 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:49:08.081744 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac98ef7f0>]}
2021-10-01 12:49:08.191691 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:49:08.252733 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:49:08.257064 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:49:08.261652 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-01 12:49:08.266575 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:49:08.270675 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:49:08.393784 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac9818d00>]}
2021-10-01 12:49:08.403642 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac98187f0>]}
2021-10-01 12:49:08.403993 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:49:08.405623 (MainThread): 
2021-10-01 12:49:08.406089 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:49:08.407106 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 12:49:08.421220 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 12:49:08.421420 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 12:49:08.421562 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 12:49:10.465361 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.04 seconds
2021-10-01 12:49:10.467503 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-10-01 12:49:11.152673 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:49:11.161099 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:49:11.161330 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:49:11.161564 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:49:12.971515 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.81 seconds
2021-10-01 12:49:12.974614 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:49:13.549571 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:49:13.552259 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:49:13.552482 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:49:13.552638 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:49:15.090650 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.54 seconds
2021-10-01 12:49:15.092067 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:49:15.647593 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:49:15.649850 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:49:15.650033 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:49:15.650184 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:49:17.161795 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.51 seconds
2021-10-01 12:49:17.163560 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:49:17.722572 (MainThread): 18:19:17 | Concurrency: 1 threads (target='dev')
2021-10-01 12:49:17.722827 (MainThread): 18:19:17 | 
2021-10-01 12:49:17.723780 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-01 12:49:17.724105 (Thread-1): 18:19:17 | 1 of 4 START table model SALES_SCHEMA.customer....................... [RUN]
2021-10-01 12:49:17.724450 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:49:17.724629 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-01 12:49:17.727768 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:49:17.728389 (Thread-1): finished collecting timing info
2021-10-01 12:49:17.757971 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-01 12:49:17.759303 (Thread-1): Using snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:49:17.759491 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.customer  as
      (/**/


with store_sales as (
    select * from DEMO_DB.PUBLIC.customers
),
final as (select * from store_sales)
select * from final
      );
2021-10-01 12:49:17.759642 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:49:20.778762 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.103', 57270), raddr=('52.228.75.102', 443)>
2021-10-01 12:49:20.779281 (Thread-1): SQL status: SUCCESS 1 in 3.02 seconds
2021-10-01 12:49:20.789691 (Thread-1): finished collecting timing info
2021-10-01 12:49:20.789960 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-01 12:49:22.242178 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac9cb02b0>]}
2021-10-01 12:49:22.242637 (Thread-1): 18:19:22 | 1 of 4 OK created table model SALES_SCHEMA.customer.................. [SUCCESS 1 in 4.52s]
2021-10-01 12:49:22.242844 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-01 12:49:22.243034 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:49:22.243414 (Thread-1): 18:19:22 | 2 of 4 START view model SALES_SCHEMA.orders_count_by_cust............ [RUN]
2021-10-01 12:49:22.243857 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:49:22.244029 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:49:22.247457 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:49:22.248769 (Thread-1): finished collecting timing info
2021-10-01 12:49:22.265161 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-01 12:49:22.267047 (Thread-1): Using snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:49:22.267247 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.orders_count_by_cust  as (
    
with cust as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),ord as (
    select * from DEMO_DB.PUBLIC.orders
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );
2021-10-01 12:49:22.267400 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:49:24.252667 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2021-10-01 12:49:24.254396 (Thread-1): finished collecting timing info
2021-10-01 12:49:24.254616 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-01 12:49:24.828745 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac9cb0c10>]}
2021-10-01 12:49:24.829219 (Thread-1): 18:19:24 | 2 of 4 OK created view model SALES_SCHEMA.orders_count_by_cust....... [SUCCESS 1 in 2.58s]
2021-10-01 12:49:24.829431 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-01 12:49:24.829634 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:49:24.830020 (Thread-1): 18:19:24 | 3 of 4 START table model SALES_SCHEMA.cust_count_by_state............ [RUN]
2021-10-01 12:49:24.830491 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:49:24.830676 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-01 12:49:24.833370 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:49:24.834009 (Thread-1): finished collecting timing info
2021-10-01 12:49:24.836314 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-01 12:49:24.837493 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:49:24.837669 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


      create or replace transient table DEMO_DB.SALES_SCHEMA.cust_count_by_state  as
      (with store_sales as (
    select * from DEMO_DB.SALES_SCHEMA.customer
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
      );
2021-10-01 12:49:24.837822 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:49:27.654750 (Thread-1): SQL status: SUCCESS 1 in 2.82 seconds
2021-10-01 12:49:27.656487 (Thread-1): finished collecting timing info
2021-10-01 12:49:27.656744 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-01 12:49:28.262193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac9cb0070>]}
2021-10-01 12:49:28.262713 (Thread-1): 18:19:28 | 3 of 4 OK created table model SALES_SCHEMA.cust_count_by_state....... [SUCCESS 1 in 3.43s]
2021-10-01 12:49:28.262954 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-01 12:49:28.263190 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-01 12:49:28.263621 (Thread-1): 18:19:28 | 4 of 4 START view model SALES_SCHEMA.cust_details_ord_counts......... [RUN]
2021-10-01 12:49:28.263979 (Thread-1): Acquiring new snowflake connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-01 12:49:28.264152 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-01 12:49:28.267348 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-01 12:49:28.267950 (Thread-1): finished collecting timing info
2021-10-01 12:49:28.270571 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-01 12:49:28.271822 (Thread-1): Using snowflake connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-01 12:49:28.272003 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create or replace  view DEMO_DB.SALES_SCHEMA.cust_details_ord_counts  as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT from DEMO_DB.SALES_SCHEMA.customer a,DEMO_DB.SALES_SCHEMA.orders_count_by_cust b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );
2021-10-01 12:49:28.272165 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:49:30.077852 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-10-01 12:49:30.079571 (Thread-1): finished collecting timing info
2021-10-01 12:49:30.079830 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-01 12:49:30.634453 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef0749b-333d-4c9d-8fb2-0cdc521d42b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaca033070>]}
2021-10-01 12:49:30.634886 (Thread-1): 18:19:30 | 4 of 4 OK created view model SALES_SCHEMA.cust_details_ord_counts.... [SUCCESS 1 in 2.37s]
2021-10-01 12:49:30.635087 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-01 12:49:30.636130 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:49:30.636518 (MainThread): 18:19:30 | 
2021-10-01 12:49:30.636712 (MainThread): 18:19:30 | Finished running 2 table models, 2 view models in 22.23s.
2021-10-01 12:49:30.636885 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:49:30.637026 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-10-01 12:49:30.646275 (MainThread): 
2021-10-01 12:49:30.646558 (MainThread): Completed successfully
2021-10-01 12:49:30.646766 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-01 12:49:30.647043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac98837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac7853df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8a157f0>]}
2021-10-01 12:49:30.647323 (MainThread): Flushing usage events
2021-10-01 12:49:56.629074 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 12:49:57.327366 (MainThread): Loading KWallet
2021-10-01 12:49:57.328159 (MainThread): Loading SecretService
2021-10-01 12:49:57.328879 (MainThread): Loading Windows
2021-10-01 12:49:57.329721 (MainThread): Loading chainer
2021-10-01 12:49:57.330207 (MainThread): Loading macOS
2021-10-01 12:49:57.728078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-01 12:49:57.729579 (MainThread): Tracking: tracking
2021-10-01 12:49:57.729928 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bc853c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bdb49670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bdb49ac0>]}
2021-10-01 12:49:57.750810 (MainThread): Partial parsing not enabled
2021-10-01 12:49:57.795172 (MainThread): Parsing macros/test_empty.sql
2021-10-01 12:49:57.796128 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 12:49:57.797331 (MainThread): Parsing macros/catalog.sql
2021-10-01 12:49:57.799738 (MainThread): Parsing macros/adapters.sql
2021-10-01 12:49:57.838708 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 12:49:57.845131 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 12:49:57.854795 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 12:49:57.856657 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 12:49:57.861239 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 12:49:57.873088 (MainThread): Parsing macros/core.sql
2021-10-01 12:49:57.878056 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 12:49:57.886595 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 12:49:57.899173 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 12:49:57.901155 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 12:49:57.922652 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 12:49:57.959381 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 12:49:57.980231 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 12:49:57.981943 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 12:49:57.992285 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 12:49:58.013384 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 12:49:58.027910 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 12:49:58.035888 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 12:49:58.042973 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 12:49:58.046629 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 12:49:58.047424 (MainThread): Parsing macros/etc/query.sql
2021-10-01 12:49:58.048328 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 12:49:58.049774 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 12:49:58.058044 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 12:49:58.059763 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 12:49:58.061440 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 12:49:58.114401 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 12:49:58.116026 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 12:49:58.117090 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 12:49:58.118317 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 12:49:58.120278 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 12:49:58.121274 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 12:49:58.122452 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 12:49:58.124592 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 12:49:58.129955 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 12:49:58.131114 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 12:49:58.132310 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 12:49:58.134663 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 12:49:58.135849 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 12:49:58.138090 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 12:49:58.146989 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 12:49:58.148848 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 12:49:58.150231 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 12:49:58.151951 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 12:49:58.153465 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 12:49:58.154567 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 12:49:58.157730 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 12:49:58.162976 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 12:49:58.163788 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 12:49:58.166345 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 12:49:58.168112 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 12:49:58.169608 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 12:49:58.171451 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 12:49:58.193699 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 12:49:58.194330 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 12:49:58.194953 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 12:49:58.195521 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 12:49:58.198465 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 12:49:58.199719 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 12:49:58.201595 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 12:49:58.202520 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 12:49:58.203289 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 12:49:58.204425 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 12:49:58.206187 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 12:49:58.207226 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 12:49:58.208059 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 12:49:58.209398 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 12:49:58.210263 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 12:49:58.212517 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 12:49:58.213783 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 12:49:58.214680 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 12:49:58.215854 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 12:49:58.219346 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 12:49:58.224584 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 12:49:58.225629 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 12:49:58.227967 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 12:49:58.230894 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 12:49:58.233061 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 12:49:58.233892 (MainThread): Parsing macros/sql/star.sql
2021-10-01 12:49:58.236810 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 12:49:58.242343 (MainThread): Parsing macros/sql/union.sql
2021-10-01 12:49:58.249450 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 12:49:58.250282 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 12:49:58.252912 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 12:49:58.253783 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 12:49:58.254796 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 12:49:58.257215 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 12:49:58.260737 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 12:49:58.263186 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 12:49:58.431671 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 12:49:58.431901 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ab32735e-b5c6-4d76-b18b-c5cd4d3884b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9be831130>]}
2021-10-01 12:49:58.543718 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 12:49:58.608496 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 12:49:58.612752 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 12:49:58.617280 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-01 12:49:58.622153 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 12:49:58.626741 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 12:49:58.630548 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'ab32735e-b5c6-4d76-b18b-c5cd4d3884b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9be89e250>]}
2021-10-01 12:49:58.750601 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab32735e-b5c6-4d76-b18b-c5cd4d3884b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9be9364c0>]}
2021-10-01 12:49:58.760694 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab32735e-b5c6-4d76-b18b-c5cd4d3884b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9be9364c0>]}
2021-10-01 12:49:58.761039 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 12:49:58.762747 (MainThread): 
2021-10-01 12:49:58.763192 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:49:58.764988 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:49:58.779483 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_dbt_test__audit".
2021-10-01 12:49:58.779692 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_dbt_test__audit"} */

    show terse objects in DEMO_DB.dbt_test__audit
2021-10-01 12:49:58.779848 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 12:50:00.651210 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.87 seconds
2021-10-01 12:50:00.653537 (ThreadPoolExecutor-1_0): On list_DEMO_DB_dbt_test__audit: Close
2021-10-01 12:50:01.254412 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:50:01.257021 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_SALES_SCHEMA".
2021-10-01 12:50:01.257203 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_SALES_SCHEMA"} */

    show terse objects in DEMO_DB.SALES_SCHEMA
2021-10-01 12:50:01.257355 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:50:03.201760 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.94 seconds
2021-10-01 12:50:03.203834 (ThreadPoolExecutor-1_0): On list_DEMO_DB_SALES_SCHEMA: Close
2021-10-01 12:50:03.819996 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:50:03.822489 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-10-01 12:50:03.822669 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-10-01 12:50:03.822818 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 12:50:05.343963 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 1.52 seconds
2021-10-01 12:50:05.345738 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-10-01 12:50:05.903763 (MainThread): 18:20:05 | Concurrency: 1 threads (target='dev')
2021-10-01 12:50:05.904035 (MainThread): 18:20:05 | 
2021-10-01 12:50:05.905202 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 12:50:05.905434 (Thread-1): 18:20:05 | 1 of 6 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-01 12:50:05.905788 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 12:50:05.906019 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 12:50:05.910696 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 12:50:05.911684 (Thread-1): finished collecting timing info
2021-10-01 12:50:05.929627 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-01 12:50:05.930982 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-01 12:50:05.931162 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.cust_count_by_state

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-01 12:50:05.931327 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:50:07.838468 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2021-10-01 12:50:07.840802 (Thread-1): finished collecting timing info
2021-10-01 12:50:07.841035 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-01 12:50:08.418812 (Thread-1): 18:20:08 | 1 of 6 PASS is_not_empty_cust_count_by_state_........................ [PASS in 2.51s]
2021-10-01 12:50:08.419151 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-01 12:50:08.419415 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-01 12:50:08.419805 (Thread-1): 18:20:08 | 2 of 6 START test is_not_empty_cust_details_ord_counts_.............. [RUN]
2021-10-01 12:50:08.420259 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-01 12:50:08.420486 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-01 12:50:08.426719 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-01 12:50:08.427429 (Thread-1): finished collecting timing info
2021-10-01 12:50:08.429424 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-01 12:50:08.430605 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-01 12:50:08.430808 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.cust_details_ord_counts

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-01 12:50:08.430990 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:50:10.533924 (Thread-1): SQL status: SUCCESS 1 in 2.10 seconds
2021-10-01 12:50:10.535474 (Thread-1): finished collecting timing info
2021-10-01 12:50:10.535694 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-10-01 12:50:11.182855 (Thread-1): 18:20:11 | 2 of 6 PASS is_not_empty_cust_details_ord_counts_.................... [PASS in 2.76s]
2021-10-01 12:50:11.183130 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-01 12:50:11.183341 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_customer_.f481adb544
2021-10-01 12:50:11.183616 (Thread-1): 18:20:11 | 3 of 6 START test is_not_empty_customer_............................. [RUN]
2021-10-01 12:50:11.183949 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_customer_.f481adb544".
2021-10-01 12:50:11.184122 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_customer_.f481adb544
2021-10-01 12:50:11.188590 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_customer_.f481adb544"
2021-10-01 12:50:11.190740 (Thread-1): finished collecting timing info
2021-10-01 12:50:11.192895 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_customer_.f481adb544"
2021-10-01 12:50:11.194245 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_customer_.f481adb544".
2021-10-01 12:50:11.194449 (Thread-1): On test.dbt_demo_project.is_not_empty_customer_.f481adb544: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_customer_.f481adb544"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.customer

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-01 12:50:11.194639 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:50:12.832521 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-10-01 12:50:12.834018 (Thread-1): finished collecting timing info
2021-10-01 12:50:12.834249 (Thread-1): On test.dbt_demo_project.is_not_empty_customer_.f481adb544: Close
2021-10-01 12:50:13.392680 (Thread-1): 18:20:13 | 3 of 6 PASS is_not_empty_customer_................................... [PASS in 2.21s]
2021-10-01 12:50:13.392997 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_customer_.f481adb544
2021-10-01 12:50:13.393243 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-01 12:50:13.393563 (Thread-1): 18:20:13 | 4 of 6 START test is_not_empty_orders_count_by_cust_................. [RUN]
2021-10-01 12:50:13.393968 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-01 12:50:13.394259 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-01 12:50:13.398717 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-01 12:50:13.399376 (Thread-1): finished collecting timing info
2021-10-01 12:50:13.401691 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-01 12:50:13.402918 (Thread-1): Using snowflake connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-01 12:50:13.403104 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from DEMO_DB.SALES_SCHEMA.orders_count_by_cust

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-01 12:50:13.403263 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:50:15.539252 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-10-01 12:50:15.540855 (Thread-1): finished collecting timing info
2021-10-01 12:50:15.541079 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-10-01 12:50:16.100382 (Thread-1): 18:20:16 | 4 of 6 PASS is_not_empty_orders_count_by_cust_....................... [PASS in 2.71s]
2021-10-01 12:50:16.100700 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-01 12:50:16.100949 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 12:50:16.101278 (Thread-1): 18:20:16 | 5 of 6 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-01 12:50:16.101672 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 12:50:16.101880 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 12:50:16.109166 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 12:50:16.109941 (Thread-1): finished collecting timing info
2021-10-01 12:50:16.111967 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-01 12:50:16.113075 (Thread-1): Using snowflake connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-01 12:50:16.113247 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-10-01 12:50:16.113400 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:50:17.998306 (Thread-1): SQL status: SUCCESS 1 in 1.88 seconds
2021-10-01 12:50:18.000050 (Thread-1): finished collecting timing info
2021-10-01 12:50:18.000330 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-01 12:50:18.566869 (Thread-1): 18:20:18 | 5 of 6 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 2.47s]
2021-10-01 12:50:18.567147 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-01 12:50:18.567359 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 12:50:18.567556 (Thread-1): 18:20:18 | 6 of 6 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-01 12:50:18.567892 (Thread-1): Acquiring new snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 12:50:18.568182 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 12:50:18.577456 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 12:50:18.578197 (Thread-1): finished collecting timing info
2021-10-01 12:50:18.580167 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-01 12:50:18.581477 (Thread-1): Using snowflake connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-01 12:50:18.581715 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from DEMO_DB.SALES_SCHEMA.cust_count_by_state
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-10-01 12:50:18.581882 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 12:50:20.234538 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-10-01 12:50:20.236035 (Thread-1): finished collecting timing info
2021-10-01 12:50:20.236268 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-01 12:50:20.798092 (Thread-1): 18:20:20 | 6 of 6 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 2.23s]
2021-10-01 12:50:20.798392 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-01 12:50:20.799401 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 12:50:20.799756 (MainThread): 18:20:20 | 
2021-10-01 12:50:20.799948 (MainThread): 18:20:20 | Finished running 6 tests in 22.04s.
2021-10-01 12:50:20.800157 (MainThread): Connection 'master' was properly closed.
2021-10-01 12:50:20.800339 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-01 12:50:20.809129 (MainThread): 
2021-10-01 12:50:20.809403 (MainThread): Completed successfully
2021-10-01 12:50:20.809606 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-01 12:50:20.809874 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bf06ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9be71cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bdb49760>]}
2021-10-01 12:50:20.810242 (MainThread): Flushing usage events
2021-10-01 17:36:51.960912 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 17:36:53.427304 (MainThread): Loading KWallet
2021-10-01 17:36:53.428534 (MainThread): Loading SecretService
2021-10-01 17:36:53.429386 (MainThread): Loading Windows
2021-10-01 17:36:53.430646 (MainThread): Loading chainer
2021-10-01 17:36:53.435221 (MainThread): Loading macOS
2021-10-01 17:36:54.096262 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 17:36:54.102242 (MainThread): Tracking: tracking
2021-10-01 17:36:54.102839 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53c053c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53d215d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53d215af0>]}
2021-10-01 17:36:54.128897 (MainThread): Partial parsing not enabled
2021-10-01 17:36:54.212672 (MainThread): Parsing macros/test_empty.sql
2021-10-01 17:36:54.214083 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 17:36:54.215877 (MainThread): Parsing macros/catalog.sql
2021-10-01 17:36:54.219266 (MainThread): Parsing macros/adapters.sql
2021-10-01 17:36:54.275793 (MainThread): Parsing macros/materializations/merge.sql
2021-10-01 17:36:54.282153 (MainThread): Parsing macros/materializations/seed.sql
2021-10-01 17:36:54.288668 (MainThread): Parsing macros/materializations/view.sql
2021-10-01 17:36:54.290508 (MainThread): Parsing macros/materializations/table.sql
2021-10-01 17:36:54.294716 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-01 17:36:54.308081 (MainThread): Parsing macros/core.sql
2021-10-01 17:36:54.314085 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 17:36:54.323530 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 17:36:54.337421 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 17:36:54.339556 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 17:36:54.361641 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 17:36:54.411005 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 17:36:54.440208 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 17:36:54.442596 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 17:36:54.457461 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 17:36:54.485670 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 17:36:54.505044 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 17:36:54.515628 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 17:36:54.525343 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 17:36:54.530863 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 17:36:54.532106 (MainThread): Parsing macros/etc/query.sql
2021-10-01 17:36:54.533290 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 17:36:54.535295 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 17:36:54.546390 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 17:36:54.548736 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 17:36:54.550658 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 17:36:54.619971 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 17:36:54.621974 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 17:36:54.623298 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 17:36:54.624792 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 17:36:54.627088 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 17:36:54.628210 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 17:36:54.629488 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 17:36:54.631819 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 17:36:54.637731 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 17:36:54.638941 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 17:36:54.640226 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 17:36:54.642545 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 17:36:54.643603 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 17:36:54.645925 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 17:36:54.657214 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 17:36:54.659423 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 17:36:54.661020 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 17:36:54.662783 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 17:36:54.664372 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 17:36:54.665341 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 17:36:54.668662 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 17:36:54.673729 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 17:36:54.674545 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 17:36:54.677192 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 17:36:54.678892 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 17:36:54.680256 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 17:36:54.682007 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 17:36:54.705453 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 17:36:54.706118 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 17:36:54.706749 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 17:36:54.707322 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 17:36:54.710298 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 17:36:54.711452 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 17:36:54.713493 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 17:36:54.714463 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 17:36:54.715340 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 17:36:54.716463 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 17:36:54.718284 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 17:36:54.719382 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 17:36:54.720225 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 17:36:54.721572 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 17:36:54.722403 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 17:36:54.724584 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 17:36:54.726047 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 17:36:54.727211 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 17:36:54.728476 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 17:36:54.733937 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 17:36:54.741123 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 17:36:54.742594 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 17:36:54.745960 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 17:36:54.750206 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 17:36:54.753377 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 17:36:54.754517 (MainThread): Parsing macros/sql/star.sql
2021-10-01 17:36:54.757619 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 17:36:54.766149 (MainThread): Parsing macros/sql/union.sql
2021-10-01 17:36:54.776182 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 17:36:54.777520 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 17:36:54.781173 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 17:36:54.782798 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 17:36:54.784361 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 17:36:54.790182 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 17:36:54.800012 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 17:36:54.806317 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 17:36:55.044917 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 17:36:55.045192 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '77f28e99-9668-42d5-9324-6b86fe492a0e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53e0e7df0>]}
2021-10-01 17:36:55.185189 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 17:36:55.251839 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 17:36:55.256195 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.customer".
2021-10-01 17:36:55.260827 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-01 17:36:55.266518 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 17:36:55.271164 (MainThread): Acquiring new snowflake connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 17:36:55.423313 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77f28e99-9668-42d5-9324-6b86fe492a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53e2198b0>]}
2021-10-01 17:36:55.435352 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77f28e99-9668-42d5-9324-6b86fe492a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53e219af0>]}
2021-10-01 17:36:55.435712 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 298 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 17:36:55.437438 (MainThread): 
2021-10-01 17:36:55.438053 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 17:36:55.439058 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-10-01 17:36:55.454225 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-10-01 17:36:55.454458 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 17:36:55.454622 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 17:36:58.138015 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250001 (08001): Failed to connect to DB: jd98257.canada-central.azure.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.'
2021-10-01 17:36:58.138249 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "my-snowflake-db", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-10-01 17:36:58.138387 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-10-01 17:36:58.138574 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-10-01 17:36:58.138703 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-10-01 17:36:58.138873 (ThreadPoolExecutor-0_0): On list_DEMO_DB: No close available on handle
2021-10-01 17:36:58.139489 (MainThread): Connection 'master' was properly closed.
2021-10-01 17:36:58.139656 (MainThread): Connection 'list_DEMO_DB' was properly closed.
2021-10-01 17:36:58.139868 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53e172e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53e2197f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53e228a60>]}
2021-10-01 17:36:58.140122 (MainThread): Flushing usage events
2021-10-01 17:37:00.089884 (MainThread): Encountered an error:
2021-10-01 17:37:00.090166 (MainThread): Runtime Error
  Database error while listing schemas in database "DEMO_DB"
  Database Error
    250001 (08001): Failed to connect to DB: jd98257.canada-central.azure.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.
2021-10-01 17:37:00.093854 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 220, in open
    handle = snowflake.connector.connect(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 50, in Connect
    return SnowflakeConnection(**kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 273, in __init__
    self.connect(**kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 484, in connect
    self.__open_connection()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 723, in __open_connection
    self._authenticate(auth_instance)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 984, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1003, in __authenticate
    auth.authenticate(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/auth.py", line 380, in authenticate
    Error.errorhandler_wrapper(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 261, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.DatabaseError: 250001 (08001): Failed to connect to DB: jd98257.canada-central.azure.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 102, in list_schemas
    results = self.execute_macro(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 350, in add_query
    connection, cursor = super().add_query(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 248, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250001 (08001): Failed to connect to DB: jd98257.canada-central.azure.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 427, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 385, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 516, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/utils.py", line 474, in connected
    return func(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 493, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 111, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "DEMO_DB"
  Database Error
    250001 (08001): Failed to connect to DB: jd98257.canada-central.azure.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.

2021-10-01 19:52:02.603098 (MainThread): Running with dbt=0.21.0-b1
2021-10-01 19:52:02.694572 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['example'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-01 19:52:02.696069 (MainThread): Tracking: tracking
2021-10-01 19:52:02.712038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e15f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e17f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e17f7c0>]}
2021-10-01 19:52:02.734841 (MainThread): Partial parsing not enabled
2021-10-01 19:52:02.793360 (MainThread): Parsing macros/test_empty.sql
2021-10-01 19:52:02.794130 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-01 19:52:02.795026 (MainThread): Parsing macros/catalog.sql
2021-10-01 19:52:02.799160 (MainThread): Parsing macros/relations.sql
2021-10-01 19:52:02.800511 (MainThread): Parsing macros/adapters.sql
2021-10-01 19:52:02.823966 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-01 19:52:02.825658 (MainThread): Parsing macros/core.sql
2021-10-01 19:52:02.829135 (MainThread): Parsing macros/materializations/test.sql
2021-10-01 19:52:02.835629 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-01 19:52:02.845160 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-01 19:52:02.846834 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-01 19:52:02.865835 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-01 19:52:02.903945 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-01 19:52:02.924547 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-01 19:52:02.926227 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-01 19:52:02.935903 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-01 19:52:02.955704 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-01 19:52:02.969245 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-01 19:52:02.976997 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-01 19:52:02.984869 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-01 19:52:02.988725 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-01 19:52:02.989628 (MainThread): Parsing macros/etc/query.sql
2021-10-01 19:52:02.990673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-01 19:52:02.992206 (MainThread): Parsing macros/etc/datetime.sql
2021-10-01 19:52:03.001532 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-01 19:52:03.003266 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-01 19:52:03.004990 (MainThread): Parsing macros/adapters/common.sql
2021-10-01 19:52:03.061159 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-01 19:52:03.062784 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-01 19:52:03.063892 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-01 19:52:03.065374 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-01 19:52:03.067408 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-01 19:52:03.068444 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-01 19:52:03.069781 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-01 19:52:03.071946 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-01 19:52:03.077687 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-01 19:52:03.078728 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-01 19:52:03.080149 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-01 19:52:03.082694 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-01 19:52:03.083695 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-01 19:52:03.085980 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-01 19:52:03.096309 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-01 19:52:03.098151 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-01 19:52:03.099541 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-01 19:52:03.101090 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-01 19:52:03.102649 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-01 19:52:03.103578 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-01 19:52:03.106572 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-01 19:52:03.111624 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-01 19:52:03.112358 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-01 19:52:03.114865 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-01 19:52:03.116655 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-01 19:52:03.118178 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-01 19:52:03.119946 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-01 19:52:03.143613 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-01 19:52:03.144304 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-01 19:52:03.145017 (MainThread): Parsing macros/logger/log_info.sql
2021-10-01 19:52:03.145588 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-01 19:52:03.148647 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-01 19:52:03.149790 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-01 19:52:03.151839 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-01 19:52:03.152758 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-01 19:52:03.153528 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-01 19:52:03.154627 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-01 19:52:03.156656 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-01 19:52:03.157697 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-01 19:52:03.158532 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-01 19:52:03.159915 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-01 19:52:03.160903 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-01 19:52:03.163084 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-01 19:52:03.164433 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-01 19:52:03.165614 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-01 19:52:03.167388 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-01 19:52:03.170942 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-01 19:52:03.176404 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-01 19:52:03.177556 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-01 19:52:03.179853 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-01 19:52:03.183491 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-01 19:52:03.185730 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-01 19:52:03.186610 (MainThread): Parsing macros/sql/star.sql
2021-10-01 19:52:03.189272 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-01 19:52:03.195630 (MainThread): Parsing macros/sql/union.sql
2021-10-01 19:52:03.203611 (MainThread): Parsing macros/sql/groupby.sql
2021-10-01 19:52:03.204587 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-01 19:52:03.207611 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-01 19:52:03.208923 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-01 19:52:03.210205 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-01 19:52:03.213368 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-01 19:52:03.218108 (MainThread): Parsing macros/sql/pivot.sql
2021-10-01 19:52:03.221383 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-01 19:52:03.380579 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-01 19:52:03.380844 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '877e4da7-20b5-4210-8d4f-c6558678255b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e204460>]}
2021-10-01 19:52:03.502881 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:03.514044 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:03.517953 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-01 19:52:03.522161 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-01 19:52:03.526973 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-01 19:52:03.530661 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-01 19:52:03.635595 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877e4da7-20b5-4210-8d4f-c6558678255b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e254dc0>]}
2021-10-01 19:52:03.644445 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877e4da7-20b5-4210-8d4f-c6558678255b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e2b9c40>]}
2021-10-01 19:52:03.644785 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-01 19:52:03.646503 (MainThread): 
2021-10-01 19:52:03.646973 (MainThread): Acquiring new postgres connection "master".
2021-10-01 19:52:03.647917 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-01 19:52:03.658090 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-01 19:52:03.658287 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-01 19:52:03.658441 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 19:52:05.780827 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.12 seconds
2021-10-01 19:52:05.782302 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-01 19:52:05.784189 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-01 19:52:05.790652 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-01 19:52:05.790856 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-01 19:52:05.790998 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 19:52:08.018062 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.23 seconds
2021-10-01 19:52:08.018305 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-01 19:52:08.018439 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-01 19:52:08.065205 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.05 seconds
2021-10-01 19:52:08.066309 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-01 19:52:08.068338 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-01 19:52:08.068893 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-01 19:52:08.070774 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-01 19:52:08.070918 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-01 19:52:08.071035 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-01 19:52:09.963399 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.89 seconds
2021-10-01 19:52:09.963634 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-01 19:52:09.963781 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-01 19:52:09.979218 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-01 19:52:09.980451 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-01 19:52:09.982245 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-01 19:52:09.987844 (MainThread): Using postgres connection "master".
2021-10-01 19:52:09.988048 (MainThread): On master: BEGIN
2021-10-01 19:52:09.988190 (MainThread): Opening a new connection, currently in state init
2021-10-01 19:52:12.212125 (MainThread): SQL status: BEGIN in 2.22 seconds
2021-10-01 19:52:12.212325 (MainThread): Using postgres connection "master".
2021-10-01 19:52:12.212450 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-01 19:52:12.245454 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2021-10-01 19:52:12.247090 (MainThread): On master: ROLLBACK
2021-10-01 19:52:12.249418 (MainThread): Using postgres connection "master".
2021-10-01 19:52:12.249653 (MainThread): On master: BEGIN
2021-10-01 19:52:12.253008 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-01 19:52:12.253233 (MainThread): On master: COMMIT
2021-10-01 19:52:12.253391 (MainThread): Using postgres connection "master".
2021-10-01 19:52:12.253530 (MainThread): On master: COMMIT
2021-10-01 19:52:12.255348 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-01 19:52:12.255559 (MainThread): On master: Close
2021-10-01 19:52:12.255959 (MainThread): 01:22:12 | Concurrency: 1 threads (target='dev')
2021-10-01 19:52:12.256161 (MainThread): 01:22:12 | 
2021-10-01 19:52:12.261232 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-10-01 19:52:12.262102 (Thread-1): 01:22:12 | 1 of 2 START table model dbtdemo.my_first_dbt_model.................. [RUN]
2021-10-01 19:52:12.262950 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:12.263281 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-10-01 19:52:12.266905 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-10-01 19:52:12.268538 (Thread-1): finished collecting timing info
2021-10-01 19:52:12.302842 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-10-01 19:52:12.303825 (Thread-1): Using postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:12.304130 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: BEGIN
2021-10-01 19:52:12.304413 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 19:52:13.766961 (Thread-1): SQL status: BEGIN in 1.46 seconds
2021-10-01 19:52:13.767223 (Thread-1): Using postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:13.767382 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */


  create  table "postgres"."dbtdemo"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-01 19:52:13.841584 (Thread-1): SQL status: SELECT 2 in 0.07 seconds
2021-10-01 19:52:13.846433 (Thread-1): Using postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:13.846577 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */
alter table "postgres"."dbtdemo"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-01 19:52:13.848821 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-01 19:52:13.857607 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: COMMIT
2021-10-01 19:52:13.857776 (Thread-1): Using postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:13.857893 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: COMMIT
2021-10-01 19:52:13.862059 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-01 19:52:13.866746 (Thread-1): Using postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-01 19:52:13.866892 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_first_dbt_model"} */
drop table if exists "postgres"."dbtdemo"."my_first_dbt_model__dbt_backup" cascade
2021-10-01 19:52:13.868155 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-01 19:52:13.869006 (Thread-1): finished collecting timing info
2021-10-01 19:52:13.869156 (Thread-1): On model.dbt_demo_project.my_first_dbt_model: Close
2021-10-01 19:52:13.869460 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877e4da7-20b5-4210-8d4f-c6558678255b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e5427f0>]}
2021-10-01 19:52:13.869866 (Thread-1): 01:22:13 | 1 of 2 OK created table model dbtdemo.my_first_dbt_model............. [SELECT 2 in 1.61s]
2021-10-01 19:52:13.870038 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-10-01 19:52:13.870787 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-10-01 19:52:13.871173 (Thread-1): 01:22:13 | 2 of 2 START view model dbtdemo.my_second_dbt_model.................. [RUN]
2021-10-01 19:52:13.871504 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:13.871637 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-10-01 19:52:13.906578 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-10-01 19:52:13.907681 (Thread-1): finished collecting timing info
2021-10-01 19:52:13.927367 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-10-01 19:52:13.928197 (Thread-1): Using postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:13.928377 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: BEGIN
2021-10-01 19:52:13.928532 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 19:52:15.384472 (Thread-1): SQL status: BEGIN in 1.46 seconds
2021-10-01 19:52:15.384690 (Thread-1): Using postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:15.384815 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */

  create view "postgres"."dbtdemo"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dbtdemo"."my_first_dbt_model"
where id = 1
  );

2021-10-01 19:52:15.408274 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-01 19:52:15.410269 (Thread-1): Using postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:15.410407 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */
alter table "postgres"."dbtdemo"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-01 19:52:15.415741 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-10-01 19:52:15.416780 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: COMMIT
2021-10-01 19:52:15.416923 (Thread-1): Using postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:15.417036 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: COMMIT
2021-10-01 19:52:15.419844 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-01 19:52:15.421331 (Thread-1): Using postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-01 19:52:15.421470 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.my_second_dbt_model"} */
drop view if exists "postgres"."dbtdemo"."my_second_dbt_model__dbt_backup" cascade
2021-10-01 19:52:15.423037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-01 19:52:15.423956 (Thread-1): finished collecting timing info
2021-10-01 19:52:15.424119 (Thread-1): On model.dbt_demo_project.my_second_dbt_model: Close
2021-10-01 19:52:15.424455 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877e4da7-20b5-4210-8d4f-c6558678255b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5dfb5e80>]}
2021-10-01 19:52:15.424770 (Thread-1): 01:22:15 | 2 of 2 OK created view model dbtdemo.my_second_dbt_model............. [CREATE VIEW in 1.55s]
2021-10-01 19:52:15.424927 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-10-01 19:52:15.425902 (MainThread): Acquiring new postgres connection "master".
2021-10-01 19:52:15.426074 (MainThread): Using postgres connection "master".
2021-10-01 19:52:15.426188 (MainThread): On master: BEGIN
2021-10-01 19:52:15.426302 (MainThread): Opening a new connection, currently in state closed
2021-10-01 19:52:17.334809 (MainThread): SQL status: BEGIN in 1.91 seconds
2021-10-01 19:52:17.335073 (MainThread): On master: COMMIT
2021-10-01 19:52:17.335232 (MainThread): Using postgres connection "master".
2021-10-01 19:52:17.335376 (MainThread): On master: COMMIT
2021-10-01 19:52:17.336995 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-01 19:52:17.337210 (MainThread): On master: Close
2021-10-01 19:52:17.337590 (MainThread): 01:22:17 | 
2021-10-01 19:52:17.337794 (MainThread): 01:22:17 | Finished running 1 table model, 1 view model in 13.69s.
2021-10-01 19:52:17.338001 (MainThread): Connection 'master' was properly closed.
2021-10-01 19:52:17.338188 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-10-01 19:52:17.348448 (MainThread): 
2021-10-01 19:52:17.348719 (MainThread): Completed successfully
2021-10-01 19:52:17.348949 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-01 19:52:17.349332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e5915e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e15f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5e11e070>]}
2021-10-01 19:52:17.349624 (MainThread): Flushing usage events
2021-10-02 09:34:12.500395 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 09:34:12.614618 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='seed', write_json=True)
2021-10-02 09:34:12.616294 (MainThread): Tracking: tracking
2021-10-02 09:34:12.802802 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bc9590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bc900520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bc900730>]}
2021-10-02 09:34:12.823876 (MainThread): Partial parsing not enabled
2021-10-02 09:34:12.885880 (MainThread): Parsing macros/test_empty.sql
2021-10-02 09:34:12.886646 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 09:34:12.887514 (MainThread): Parsing macros/catalog.sql
2021-10-02 09:34:12.890580 (MainThread): Parsing macros/relations.sql
2021-10-02 09:34:12.891825 (MainThread): Parsing macros/adapters.sql
2021-10-02 09:34:12.914210 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 09:34:12.916099 (MainThread): Parsing macros/core.sql
2021-10-02 09:34:12.919528 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 09:34:12.926126 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 09:34:12.935604 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 09:34:12.937157 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 09:34:12.953524 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 09:34:12.988849 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 09:34:13.009504 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 09:34:13.011123 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 09:34:13.021322 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 09:34:13.040944 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 09:34:13.054566 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 09:34:13.062265 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 09:34:13.070163 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 09:34:13.074260 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 09:34:13.075101 (MainThread): Parsing macros/etc/query.sql
2021-10-02 09:34:13.075987 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 09:34:13.077422 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 09:34:13.086501 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 09:34:13.088321 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 09:34:13.089795 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 09:34:13.147085 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 09:34:13.148722 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 09:34:13.149789 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 09:34:13.150974 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 09:34:13.152960 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 09:34:13.153963 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 09:34:13.155267 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 09:34:13.157249 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 09:34:13.163596 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 09:34:13.164717 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 09:34:13.165956 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 09:34:13.168191 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 09:34:13.169183 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 09:34:13.171320 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 09:34:13.181933 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 09:34:13.183800 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 09:34:13.185156 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 09:34:13.186769 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 09:34:13.188646 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 09:34:13.189568 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 09:34:13.192660 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 09:34:13.197838 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 09:34:13.198589 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 09:34:13.201083 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 09:34:13.202799 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 09:34:13.204195 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 09:34:13.205953 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 09:34:13.228562 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 09:34:13.229301 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 09:34:13.229949 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 09:34:13.230532 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 09:34:13.233656 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 09:34:13.234821 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 09:34:13.236891 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 09:34:13.237848 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 09:34:13.238639 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 09:34:13.239872 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 09:34:13.241779 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 09:34:13.242850 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 09:34:13.243746 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 09:34:13.245108 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 09:34:13.246008 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 09:34:13.248653 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 09:34:13.249938 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 09:34:13.250893 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 09:34:13.252228 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 09:34:13.255479 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 09:34:13.261030 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 09:34:13.262133 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 09:34:13.264565 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 09:34:13.267538 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 09:34:13.269925 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 09:34:13.270857 (MainThread): Parsing macros/sql/star.sql
2021-10-02 09:34:13.273482 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 09:34:13.279579 (MainThread): Parsing macros/sql/union.sql
2021-10-02 09:34:13.286929 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 09:34:13.287753 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 09:34:13.290243 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 09:34:13.291158 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 09:34:13.292395 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 09:34:13.294927 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 09:34:13.298690 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 09:34:13.301332 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 09:34:13.450568 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 09:34:13.450793 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5971f09-30c5-4749-9f79-77eb3d475d43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bca038e0>]}
2021-10-02 09:34:13.569888 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 09:34:13.580516 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 09:34:13.584340 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 09:34:13.588403 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 09:34:13.592911 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 09:34:13.596706 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 09:34:13.701641 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5971f09-30c5-4749-9f79-77eb3d475d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bca58d30>]}
2021-10-02 09:34:13.711481 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5971f09-30c5-4749-9f79-77eb3d475d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bcabcb50>]}
2021-10-02 09:34:13.711846 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-02 09:34:13.713653 (MainThread): 
2021-10-02 09:34:13.714193 (MainThread): Acquiring new postgres connection "master".
2021-10-02 09:34:13.715148 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 09:34:13.725595 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 09:34:13.725792 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 09:34:13.725944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 09:34:19.479205 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 5.75 seconds
2021-10-02 09:34:19.480530 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 09:34:19.482394 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 09:34:19.488346 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 09:34:19.488532 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 09:34:19.488665 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 09:34:20.903204 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-10-02 09:34:20.903440 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 09:34:20.903587 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 09:34:20.921711 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 09:34:20.922694 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 09:34:20.923939 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 09:34:20.924355 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 09:34:20.925729 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 09:34:20.925865 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 09:34:20.925975 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 09:34:22.296871 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.37 seconds
2021-10-02 09:34:22.297111 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 09:34:22.297279 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 09:34:22.310422 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.01 seconds
2021-10-02 09:34:22.311670 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 09:34:22.313566 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 09:34:22.319575 (MainThread): Using postgres connection "master".
2021-10-02 09:34:22.319784 (MainThread): On master: BEGIN
2021-10-02 09:34:22.319934 (MainThread): Opening a new connection, currently in state init
2021-10-02 09:34:23.760972 (MainThread): SQL status: BEGIN in 1.44 seconds
2021-10-02 09:34:23.761208 (MainThread): Using postgres connection "master".
2021-10-02 09:34:23.761348 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 09:34:23.821194 (MainThread): SQL status: SELECT 1 in 0.06 seconds
2021-10-02 09:34:23.822254 (MainThread): On master: ROLLBACK
2021-10-02 09:34:23.824158 (MainThread): Using postgres connection "master".
2021-10-02 09:34:23.824299 (MainThread): On master: BEGIN
2021-10-02 09:34:23.826403 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 09:34:23.826563 (MainThread): On master: COMMIT
2021-10-02 09:34:23.826684 (MainThread): Using postgres connection "master".
2021-10-02 09:34:23.826790 (MainThread): On master: COMMIT
2021-10-02 09:34:23.828045 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 09:34:23.828191 (MainThread): On master: Close
2021-10-02 09:34:23.828482 (MainThread): 15:04:23 | Concurrency: 1 threads (target='dev')
2021-10-02 09:34:23.828680 (MainThread): 15:04:23 | 
2021-10-02 09:34:23.831056 (Thread-1): Began running node seed.dbt_demo_project.locations
2021-10-02 09:34:23.831375 (Thread-1): 15:04:23 | 1 of 1 START seed file dbtdemo.locations............................. [RUN]
2021-10-02 09:34:23.831763 (Thread-1): Acquiring new postgres connection "seed.dbt_demo_project.locations".
2021-10-02 09:34:23.831993 (Thread-1): finished collecting timing info
2021-10-02 09:34:23.859452 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-10-02 09:34:23.859657 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5971f09-30c5-4749-9f79-77eb3d475d43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bcc46640>]}
2021-10-02 09:34:23.860184 (Thread-1): Using postgres connection "seed.dbt_demo_project.locations".
2021-10-02 09:34:23.860303 (Thread-1): On seed.dbt_demo_project.locations: BEGIN
2021-10-02 09:34:23.860410 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 09:34:25.411879 (Thread-1): SQL status: BEGIN in 1.55 seconds
2021-10-02 09:34:25.412131 (Thread-1): Using postgres connection "seed.dbt_demo_project.locations".
2021-10-02 09:34:25.412306 (Thread-1): On seed.dbt_demo_project.locations: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "seed.dbt_demo_project.locations"} */

    create table "postgres"."dbtdemo"."locations" (city text,state text,country text,pincode integer)
  
2021-10-02 09:34:25.445572 (Thread-1): SQL status: CREATE TABLE in 0.03 seconds
2021-10-02 09:34:25.457372 (Thread-1): Using postgres connection "seed.dbt_demo_project.locations".
2021-10-02 09:34:25.457530 (Thread-1): On seed.dbt_demo_project.locations: 
            insert into "postgres"."dbtdemo"."locations" (city, state, country, pincode) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
        ...
2021-10-02 09:34:25.468802 (Thread-1): SQL status: INSERT 0 5 in 0.01 seconds
2021-10-02 09:34:25.472393 (Thread-1): Writing runtime SQL for node "seed.dbt_demo_project.locations"
2021-10-02 09:34:25.486591 (Thread-1): On seed.dbt_demo_project.locations: COMMIT
2021-10-02 09:34:25.486783 (Thread-1): Using postgres connection "seed.dbt_demo_project.locations".
2021-10-02 09:34:25.486909 (Thread-1): On seed.dbt_demo_project.locations: COMMIT
2021-10-02 09:34:25.493137 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 09:34:25.493749 (Thread-1): finished collecting timing info
2021-10-02 09:34:25.493959 (Thread-1): On seed.dbt_demo_project.locations: Close
2021-10-02 09:34:25.494417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5971f09-30c5-4749-9f79-77eb3d475d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bcc32340>]}
2021-10-02 09:34:25.494730 (Thread-1): 15:04:25 | 1 of 1 OK loaded seed file dbtdemo.locations......................... [INSERT 5 in 1.66s]
2021-10-02 09:34:25.494959 (Thread-1): Finished running node seed.dbt_demo_project.locations
2021-10-02 09:34:25.496200 (MainThread): Acquiring new postgres connection "master".
2021-10-02 09:34:25.496424 (MainThread): Using postgres connection "master".
2021-10-02 09:34:25.496650 (MainThread): On master: BEGIN
2021-10-02 09:34:25.496801 (MainThread): Opening a new connection, currently in state closed
2021-10-02 09:34:27.026105 (MainThread): SQL status: BEGIN in 1.53 seconds
2021-10-02 09:34:27.026350 (MainThread): On master: COMMIT
2021-10-02 09:34:27.026478 (MainThread): Using postgres connection "master".
2021-10-02 09:34:27.026597 (MainThread): On master: COMMIT
2021-10-02 09:34:27.027737 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 09:34:27.027908 (MainThread): On master: Close
2021-10-02 09:34:27.028227 (MainThread): 15:04:27 | 
2021-10-02 09:34:27.028401 (MainThread): 15:04:27 | Finished running 1 seed in 13.31s.
2021-10-02 09:34:27.028539 (MainThread): Connection 'master' was properly closed.
2021-10-02 09:34:27.028645 (MainThread): Connection 'seed.dbt_demo_project.locations' was properly closed.
2021-10-02 09:34:27.071732 (MainThread): 
2021-10-02 09:34:27.072102 (MainThread): Completed successfully
2021-10-02 09:34:27.072381 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-02 09:34:27.072771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bc38fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb542c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb542be0>]}
2021-10-02 09:34:27.073328 (MainThread): Flushing usage events
2021-10-02 09:44:47.574120 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 09:44:47.657943 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 09:44:47.659808 (MainThread): Tracking: tracking
2021-10-02 09:44:47.676352 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7906c9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79066f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79066f790>]}
2021-10-02 09:44:47.697206 (MainThread): Partial parsing not enabled
2021-10-02 09:44:47.757836 (MainThread): Parsing macros/test_empty.sql
2021-10-02 09:44:47.758629 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 09:44:47.759525 (MainThread): Parsing macros/catalog.sql
2021-10-02 09:44:47.763464 (MainThread): Parsing macros/relations.sql
2021-10-02 09:44:47.765020 (MainThread): Parsing macros/adapters.sql
2021-10-02 09:44:47.789584 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 09:44:47.791295 (MainThread): Parsing macros/core.sql
2021-10-02 09:44:47.794912 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 09:44:47.801851 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 09:44:47.811793 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 09:44:47.813701 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 09:44:47.831306 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 09:44:47.866002 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 09:44:47.887168 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 09:44:47.888847 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 09:44:47.898763 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 09:44:47.918802 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 09:44:47.932989 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 09:44:47.941141 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 09:44:47.948240 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 09:44:47.951882 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 09:44:47.952665 (MainThread): Parsing macros/etc/query.sql
2021-10-02 09:44:47.953536 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 09:44:47.954936 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 09:44:47.962864 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 09:44:47.964597 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 09:44:47.966007 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 09:44:48.019610 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 09:44:48.021369 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 09:44:48.022511 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 09:44:48.023721 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 09:44:48.025787 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 09:44:48.026866 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 09:44:48.028301 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 09:44:48.030466 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 09:44:48.036539 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 09:44:48.037608 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 09:44:48.038895 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 09:44:48.041132 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 09:44:48.042249 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 09:44:48.044421 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 09:44:48.054618 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 09:44:48.056481 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 09:44:48.057984 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 09:44:48.059970 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 09:44:48.061640 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 09:44:48.063026 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 09:44:48.066970 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 09:44:48.073432 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 09:44:48.074304 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 09:44:48.076990 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 09:44:48.078804 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 09:44:48.080255 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 09:44:48.083200 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 09:44:48.112003 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 09:44:48.112708 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 09:44:48.113390 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 09:44:48.113993 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 09:44:48.117194 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 09:44:48.119019 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 09:44:48.122278 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 09:44:48.123803 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 09:44:48.124853 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 09:44:48.126157 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 09:44:48.129315 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 09:44:48.130877 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 09:44:48.132584 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 09:44:48.134624 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 09:44:48.135764 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 09:44:48.138557 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 09:44:48.139983 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 09:44:48.140887 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 09:44:48.142231 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 09:44:48.145498 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 09:44:48.151172 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 09:44:48.152228 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 09:44:48.154409 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 09:44:48.157274 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 09:44:48.159507 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 09:44:48.160340 (MainThread): Parsing macros/sql/star.sql
2021-10-02 09:44:48.162787 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 09:44:48.168341 (MainThread): Parsing macros/sql/union.sql
2021-10-02 09:44:48.175491 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 09:44:48.176269 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 09:44:48.178761 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 09:44:48.179676 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 09:44:48.180834 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 09:44:48.183442 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 09:44:48.187022 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 09:44:48.189498 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 09:44:48.339939 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 09:44:48.340173 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd3c5013-6a19-4847-82e7-16571f90fa0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79098ab50>]}
2021-10-02 09:44:48.452628 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 09:44:48.461874 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 09:44:48.464998 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 09:44:48.468379 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 09:44:48.472139 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 09:44:48.475088 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 09:44:48.579065 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd3c5013-6a19-4847-82e7-16571f90fa0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa790ac8f70>]}
2021-10-02 09:44:48.588083 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd3c5013-6a19-4847-82e7-16571f90fa0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa790a39c10>]}
2021-10-02 09:44:48.588434 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-10-02 09:44:48.589938 (MainThread): 
2021-10-02 09:44:48.590360 (MainThread): Acquiring new postgres connection "master".
2021-10-02 09:44:48.591387 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 09:44:48.600837 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 09:44:48.601038 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 09:44:48.601203 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 09:44:51.519543 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.92 seconds
2021-10-02 09:44:51.521094 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 09:44:51.523030 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 09:44:51.530217 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 09:44:51.530458 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 09:44:51.530694 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 09:44:52.998374 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-10-02 09:44:52.998570 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 09:44:52.998683 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 09:44:53.009948 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 09:44:53.010997 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 09:44:53.012245 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 09:44:53.012703 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 09:44:53.014184 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 09:44:53.014320 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 09:44:53.014430 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 09:44:54.511418 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.50 seconds
2021-10-02 09:44:54.511644 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 09:44:54.511781 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 09:44:54.521960 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 09:44:54.522914 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 09:44:54.524293 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 09:44:54.529329 (MainThread): Using postgres connection "master".
2021-10-02 09:44:54.529496 (MainThread): On master: BEGIN
2021-10-02 09:44:54.529611 (MainThread): Opening a new connection, currently in state init
2021-10-02 09:44:55.847251 (MainThread): SQL status: BEGIN in 1.32 seconds
2021-10-02 09:44:55.847494 (MainThread): Using postgres connection "master".
2021-10-02 09:44:55.847641 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 09:44:55.878424 (MainThread): SQL status: SELECT 1 in 0.03 seconds
2021-10-02 09:44:55.879447 (MainThread): On master: ROLLBACK
2021-10-02 09:44:55.880749 (MainThread): Using postgres connection "master".
2021-10-02 09:44:55.880901 (MainThread): On master: BEGIN
2021-10-02 09:44:55.883652 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 09:44:55.883811 (MainThread): On master: COMMIT
2021-10-02 09:44:55.883933 (MainThread): Using postgres connection "master".
2021-10-02 09:44:55.884039 (MainThread): On master: COMMIT
2021-10-02 09:44:55.885316 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 09:44:55.885455 (MainThread): On master: Close
2021-10-02 09:44:55.885738 (MainThread): 15:14:55 | Concurrency: 1 threads (target='dev')
2021-10-02 09:44:55.885890 (MainThread): 15:14:55 | 
2021-10-02 09:44:55.888767 (Thread-1): Began running node model.dbt_demo_project.customer
2021-10-02 09:44:55.889149 (Thread-1): 15:14:55 | 1 of 4 START table model dbtdemo.customer............................ [RUN]
2021-10-02 09:44:55.889541 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 09:44:55.889699 (Thread-1): Compiling model.dbt_demo_project.customer
2021-10-02 09:44:55.891971 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.customer"
2021-10-02 09:44:55.894383 (Thread-1): finished collecting timing info
2021-10-02 09:44:55.914707 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.customer"
2021-10-02 09:44:55.915406 (Thread-1): Using postgres connection "model.dbt_demo_project.customer".
2021-10-02 09:44:55.915652 (Thread-1): On model.dbt_demo_project.customer: BEGIN
2021-10-02 09:44:55.915841 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 09:44:57.271156 (Thread-1): SQL status: BEGIN in 1.36 seconds
2021-10-02 09:44:57.271390 (Thread-1): Using postgres connection "model.dbt_demo_project.customer".
2021-10-02 09:44:57.271535 (Thread-1): On model.dbt_demo_project.customer: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.customer"} */


  create  table "postgres"."dbtdemo"."customer__dbt_tmp"
  as (
    /**/


with store_sales as (
    select * from "DEMO_DB"."PUBLIC"."customers"
),
final as (select * from store_sales)
select * from final
  );
2021-10-02 09:44:57.274806 (Thread-1): Postgres error: cross-database references are not implemented: "DEMO_DB.PUBLIC.customers"
LINE 10:     select * from "DEMO_DB"."PUBLIC"."customers"
                           ^

2021-10-02 09:44:57.274980 (Thread-1): On model.dbt_demo_project.customer: ROLLBACK
2021-10-02 09:44:57.276664 (Thread-1): finished collecting timing info
2021-10-02 09:44:57.276878 (Thread-1): On model.dbt_demo_project.customer: Close
2021-10-02 09:44:57.277243 (Thread-1): Database Error in model customer (models/snowflake_model_data/customer.sql)
  cross-database references are not implemented: "DEMO_DB.PUBLIC.customers"
  LINE 10:     select * from "DEMO_DB"."PUBLIC"."customers"
                             ^
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/customer.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.FeatureNotSupported: cross-database references are not implemented: "DEMO_DB.PUBLIC.customers"
LINE 10:     select * from "DEMO_DB"."PUBLIC"."customers"
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/snowflake_model_data/customer.sql)
  cross-database references are not implemented: "DEMO_DB.PUBLIC.customers"
  LINE 10:     select * from "DEMO_DB"."PUBLIC"."customers"
                             ^
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/customer.sql
2021-10-02 09:44:57.286211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd3c5013-6a19-4847-82e7-16571f90fa0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa790ba4130>]}
2021-10-02 09:44:57.286539 (Thread-1): 15:14:57 | 1 of 4 ERROR creating table model dbtdemo.customer................... [ERROR in 1.40s]
2021-10-02 09:44:57.286698 (Thread-1): Finished running node model.dbt_demo_project.customer
2021-10-02 09:44:57.286850 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 09:44:57.287218 (Thread-1): 15:14:57 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 09:44:57.287567 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 09:44:57.287701 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 09:44:57.290397 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 09:44:57.291544 (Thread-1): finished collecting timing info
2021-10-02 09:44:57.308157 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 09:44:57.308816 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 09:44:57.308978 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 09:44:57.309113 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 09:44:58.931718 (Thread-1): SQL status: BEGIN in 1.62 seconds
2021-10-02 09:44:58.931953 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 09:44:58.932092 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "DEMO_DB"."SALES_SCHEMA"."customer"
),ord as (
    select * from "DEMO_DB"."PUBLIC"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 09:44:58.934217 (Thread-1): Postgres error: cross-database references are not implemented: "DEMO_DB.SALES_SCHEMA.customer"
LINE 6:     select * from "DEMO_DB"."SALES_SCHEMA"."customer"
                          ^

2021-10-02 09:44:58.934398 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: ROLLBACK
2021-10-02 09:44:58.935574 (Thread-1): finished collecting timing info
2021-10-02 09:44:58.935766 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 09:44:58.936114 (Thread-1): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  cross-database references are not implemented: "DEMO_DB.SALES_SCHEMA.customer"
  LINE 6:     select * from "DEMO_DB"."SALES_SCHEMA"."customer"
                            ^
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.FeatureNotSupported: cross-database references are not implemented: "DEMO_DB.SALES_SCHEMA.customer"
LINE 6:     select * from "DEMO_DB"."SALES_SCHEMA"."customer"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
  cross-database references are not implemented: "DEMO_DB.SALES_SCHEMA.customer"
  LINE 6:     select * from "DEMO_DB"."SALES_SCHEMA"."customer"
                            ^
  compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-02 09:44:58.936698 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd3c5013-6a19-4847-82e7-16571f90fa0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa790ca29d0>]}
2021-10-02 09:44:58.937038 (Thread-1): 15:14:58 | 2 of 4 ERROR creating view model dbtdemo.orders_count_by_cust........ [ERROR in 1.65s]
2021-10-02 09:44:58.937201 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 09:44:58.937360 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 09:44:58.937624 (Thread-1): 15:14:58 | 3 of 4 SKIP relation dbtdemo.cust_count_by_state..................... [SKIP]
2021-10-02 09:44:58.937869 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 09:44:58.938009 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 09:44:58.938189 (Thread-1): 15:14:58 | 4 of 4 SKIP relation dbtdemo.cust_details_ord_counts................. [SKIP]
2021-10-02 09:44:58.938322 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 09:44:58.939394 (MainThread): Acquiring new postgres connection "master".
2021-10-02 09:44:58.939573 (MainThread): Using postgres connection "master".
2021-10-02 09:44:58.939683 (MainThread): On master: BEGIN
2021-10-02 09:44:58.939789 (MainThread): Opening a new connection, currently in state closed
2021-10-02 09:45:00.350766 (MainThread): SQL status: BEGIN in 1.41 seconds
2021-10-02 09:45:00.351034 (MainThread): On master: COMMIT
2021-10-02 09:45:00.351194 (MainThread): Using postgres connection "master".
2021-10-02 09:45:00.351338 (MainThread): On master: COMMIT
2021-10-02 09:45:00.352636 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 09:45:00.352843 (MainThread): On master: Close
2021-10-02 09:45:00.353291 (MainThread): 15:15:00 | 
2021-10-02 09:45:00.353497 (MainThread): 15:15:00 | Finished running 2 table models, 2 view models in 11.76s.
2021-10-02 09:45:00.353671 (MainThread): Connection 'master' was properly closed.
2021-10-02 09:45:00.353808 (MainThread): Connection 'model.dbt_demo_project.orders_count_by_cust' was properly closed.
2021-10-02 09:45:00.397626 (MainThread): 
2021-10-02 09:45:00.397921 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-02 09:45:00.398114 (MainThread): 
2021-10-02 09:45:00.398293 (MainThread): Database Error in model customer (models/snowflake_model_data/customer.sql)
2021-10-02 09:45:00.398457 (MainThread):   cross-database references are not implemented: "DEMO_DB.PUBLIC.customers"
2021-10-02 09:45:00.398612 (MainThread):   LINE 10:     select * from "DEMO_DB"."PUBLIC"."customers"
2021-10-02 09:45:00.398784 (MainThread):                              ^
2021-10-02 09:45:00.398953 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/customer.sql
2021-10-02 09:45:00.399125 (MainThread): 
2021-10-02 09:45:00.399303 (MainThread): Database Error in model orders_count_by_cust (models/snowflake_model_data/orders_count_by_cust.sql)
2021-10-02 09:45:00.399465 (MainThread):   cross-database references are not implemented: "DEMO_DB.SALES_SCHEMA.customer"
2021-10-02 09:45:00.399617 (MainThread):   LINE 6:     select * from "DEMO_DB"."SALES_SCHEMA"."customer"
2021-10-02 09:45:00.399770 (MainThread):                             ^
2021-10-02 09:45:00.399916 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/snowflake_model_data/orders_count_by_cust.sql
2021-10-02 09:45:00.400077 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
2021-10-02 09:45:00.400320 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa790696100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79033bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78fdc6c70>]}
2021-10-02 09:45:00.400598 (MainThread): Flushing usage events
2021-10-02 10:04:53.201265 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:04:53.305638 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_model_data'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:04:53.307940 (MainThread): Tracking: tracking
2021-10-02 10:04:53.478987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d018cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d018340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d018be0>]}
2021-10-02 10:04:53.504083 (MainThread): Partial parsing not enabled
2021-10-02 10:04:53.569918 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:04:53.571063 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:04:53.571929 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:04:53.575623 (MainThread): Parsing macros/relations.sql
2021-10-02 10:04:53.576883 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:04:53.598408 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:04:53.600191 (MainThread): Parsing macros/core.sql
2021-10-02 10:04:53.603672 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:04:53.609935 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:04:53.619316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:04:53.620824 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:04:53.637703 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:04:53.670546 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:04:53.689984 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:04:53.691752 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:04:53.701539 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:04:53.721465 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:04:53.734743 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:04:53.742673 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:04:53.749873 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:04:53.753421 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:04:53.754422 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:04:53.756238 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:04:53.757724 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:04:53.765742 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:04:53.767528 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:04:53.768937 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:04:53.822583 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:04:53.824227 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:04:53.825400 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:04:53.826624 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:04:53.828542 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:04:53.829518 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:04:53.830824 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:04:53.832805 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:04:53.839307 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:04:53.840676 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:04:53.842027 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:04:53.844490 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:04:53.845718 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:04:53.847970 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:04:53.857156 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:04:53.858942 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:04:53.860233 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:04:53.861764 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:04:53.863184 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:04:53.864049 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:04:53.867187 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:04:53.872143 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:04:53.872864 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:04:53.875414 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:04:53.877096 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:04:53.878452 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:04:53.880227 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:04:53.902276 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:04:53.902965 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:04:53.903830 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:04:53.904535 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:04:53.907523 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:04:53.908663 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:04:53.910500 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:04:53.911442 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:04:53.912200 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:04:53.913296 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:04:53.915132 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:04:53.916166 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:04:53.917062 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:04:53.918391 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:04:53.919200 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:04:53.921361 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:04:53.922651 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:04:53.923565 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:04:53.924732 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:04:53.927859 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:04:53.933348 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:04:53.934351 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:04:53.936568 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:04:53.939538 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:04:53.941715 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:04:53.942540 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:04:53.945071 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:04:53.950655 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:04:53.957722 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:04:53.958502 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:04:53.961061 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:04:53.961944 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:04:53.962969 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:04:53.965424 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:04:53.969322 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:04:53.971768 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:04:54.128481 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:04:54.128744 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0da8f192-43f1-4e87-a29e-b6efd47710d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d20edc0>]}
2021-10-02 10:04:54.243308 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:04:54.252848 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:04:54.256560 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:04:54.260176 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:04:54.263114 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:04:54.266762 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:04:54.269902 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:04:54.273189 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:04:54.276628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d0575e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d2e1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd3d2e10d0>]}
2021-10-02 10:04:54.276895 (MainThread): Flushing usage events
2021-10-02 10:04:55.561665 (MainThread): Connection 'model.dbt_demo_project.customer' was properly closed.
2021-10-02 10:04:55.561953 (MainThread): Encountered an error:
2021-10-02 10:04:55.562161 (MainThread): Compilation Error
  dbt found two resources with the name "customer". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("customer") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.customer (models/snowflake_model_data/customer.sql)
  - model.dbt_demo_project.customer (models/postgres_model/customer.sql)
2021-10-02 10:04:55.568513 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "customer". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("customer") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.customer (models/snowflake_model_data/customer.sql)
  - model.dbt_demo_project.customer (models/postgres_model/customer.sql)

2021-10-02 10:05:50.625390 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:05:50.710483 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:05:50.712456 (MainThread): Tracking: tracking
2021-10-02 10:05:50.728684 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118000b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc117fc26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc117fc2e80>]}
2021-10-02 10:05:50.746514 (MainThread): Partial parsing not enabled
2021-10-02 10:05:51.188216 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:05:51.189020 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:05:51.189965 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:05:51.193001 (MainThread): Parsing macros/relations.sql
2021-10-02 10:05:51.194248 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:05:51.217543 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:05:51.219169 (MainThread): Parsing macros/core.sql
2021-10-02 10:05:51.222932 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:05:51.230590 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:05:51.240393 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:05:51.241986 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:05:51.258445 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:05:51.291997 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:05:51.313260 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:05:51.315051 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:05:51.324859 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:05:51.345053 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:05:51.359149 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:05:51.367873 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:05:51.375106 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:05:51.379233 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:05:51.380279 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:05:51.381279 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:05:51.382803 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:05:51.394262 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:05:51.396668 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:05:51.398259 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:05:51.450998 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:05:51.452678 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:05:51.453751 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:05:51.454959 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:05:51.456894 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:05:51.457899 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:05:51.459273 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:05:51.461352 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:05:51.467101 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:05:51.468148 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:05:51.469467 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:05:51.471776 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:05:51.472789 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:05:51.474986 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:05:51.484556 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:05:51.486364 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:05:51.487758 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:05:51.489389 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:05:51.490900 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:05:51.491815 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:05:51.495005 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:05:51.500234 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:05:51.500989 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:05:51.503604 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:05:51.505374 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:05:51.506837 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:05:51.508604 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:05:51.531619 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:05:51.532279 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:05:51.532919 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:05:51.533561 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:05:51.536613 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:05:51.537836 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:05:51.539812 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:05:51.540783 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:05:51.541570 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:05:51.542683 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:05:51.544541 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:05:51.545616 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:05:51.546458 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:05:51.547861 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:05:51.548731 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:05:51.551025 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:05:51.552282 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:05:51.553381 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:05:51.554796 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:05:51.558106 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:05:51.564162 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:05:51.565358 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:05:51.567689 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:05:51.570612 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:05:51.572826 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:05:51.573673 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:05:51.576191 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:05:51.582215 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:05:51.589771 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:05:51.590600 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:05:51.593045 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:05:51.594233 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:05:51.595455 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:05:51.598071 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:05:51.602206 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:05:51.604906 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:05:51.771694 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:05:51.771918 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d80448e-fffe-42c0-ae07-c5c25888e86f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1180cf850>]}
2021-10-02 10:05:51.884562 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:05:51.894184 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:05:51.898847 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:05:51.902480 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:05:51.905873 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:05:51.909706 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:05:51.912730 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:05:51.915971 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:05:51.919373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1180960d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1182a2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1182a2490>]}
2021-10-02 10:05:51.919602 (MainThread): Flushing usage events
2021-10-02 10:05:53.607057 (MainThread): Connection 'model.dbt_demo_project.customer' was properly closed.
2021-10-02 10:05:53.607375 (MainThread): Encountered an error:
2021-10-02 10:05:53.607620 (MainThread): Compilation Error
  dbt found two resources with the name "customer". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("customer") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.customer (models/snowflake_model_data/customer.sql)
  - model.dbt_demo_project.customer (models/postgres_model/customer.sql)
2021-10-02 10:05:53.614543 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "customer". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("customer") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.customer (models/snowflake_model_data/customer.sql)
  - model.dbt_demo_project.customer (models/postgres_model/customer.sql)

2021-10-02 10:12:56.455843 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:12:56.550502 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:12:56.552031 (MainThread): Tracking: tracking
2021-10-02 10:12:56.569467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a20813130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a207c36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a207c3e80>]}
2021-10-02 10:12:56.591341 (MainThread): Partial parsing not enabled
2021-10-02 10:12:56.655029 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:12:56.656021 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:12:56.657195 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:12:56.661288 (MainThread): Parsing macros/relations.sql
2021-10-02 10:12:56.663151 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:12:56.693115 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:12:56.695971 (MainThread): Parsing macros/core.sql
2021-10-02 10:12:56.700638 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:12:56.709773 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:12:56.723614 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:12:56.725995 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:12:56.748076 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:12:56.788623 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:12:56.810834 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:12:56.812676 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:12:56.823309 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:12:56.843558 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:12:56.857925 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:12:56.866343 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:12:56.874097 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:12:56.877683 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:12:56.879081 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:12:56.880077 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:12:56.881493 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:12:56.890172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:12:56.891891 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:12:56.893304 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:12:56.953225 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:12:56.954891 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:12:56.956035 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:12:56.957291 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:12:56.959815 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:12:56.960838 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:12:56.962215 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:12:56.964201 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:12:56.970314 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:12:56.971380 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:12:56.972579 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:12:56.974950 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:12:56.975955 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:12:56.978097 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:12:56.987911 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:12:56.989937 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:12:56.991365 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:12:56.993315 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:12:56.995208 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:12:56.996142 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:12:56.999719 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:12:57.005067 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:12:57.005820 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:12:57.008378 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:12:57.010127 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:12:57.011554 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:12:57.013336 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:12:57.035820 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:12:57.036574 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:12:57.037251 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:12:57.037822 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:12:57.041172 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:12:57.042341 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:12:57.044288 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:12:57.045219 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:12:57.046036 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:12:57.047484 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:12:57.049263 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:12:57.050307 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:12:57.051137 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:12:57.052480 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:12:57.053299 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:12:57.055712 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:12:57.057018 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:12:57.057911 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:12:57.059407 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:12:57.062657 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:12:57.068153 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:12:57.069357 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:12:57.071591 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:12:57.074502 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:12:57.076734 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:12:57.077624 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:12:57.080381 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:12:57.086271 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:12:57.094741 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:12:57.095682 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:12:57.098306 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:12:57.099300 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:12:57.100400 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:12:57.103146 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:12:57.107478 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:12:57.110517 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:12:57.268849 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:12:57.269063 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7e8b650e-88ac-4fae-87f7-03d2362ce142', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a208d1310>]}
2021-10-02 10:12:57.394444 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:12:57.408616 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:12:57.413686 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:12:57.417813 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:12:57.422859 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:12:57.427077 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:12:57.431164 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:12:57.436044 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:12:57.440992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a208a0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a209a2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a209a2460>]}
2021-10-02 10:12:57.441297 (MainThread): Flushing usage events
2021-10-02 10:12:58.773830 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-10-02 10:12:58.774152 (MainThread): Encountered an error:
2021-10-02 10:12:58.774399 (MainThread): Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:12:58.781265 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)

2021-10-02 10:16:46.089557 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:16:46.178687 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:16:46.179911 (MainThread): Tracking: tracking
2021-10-02 10:16:46.192024 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc579923e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc57991ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5797c2640>]}
2021-10-02 10:16:46.211882 (MainThread): Partial parsing not enabled
2021-10-02 10:16:46.252901 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:16:46.253685 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:16:46.254643 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:16:46.257563 (MainThread): Parsing macros/relations.sql
2021-10-02 10:16:46.258946 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:16:46.282420 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:16:46.284312 (MainThread): Parsing macros/core.sql
2021-10-02 10:16:46.287955 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:16:46.295306 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:16:46.305768 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:16:46.307648 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:16:46.328205 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:16:46.372273 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:16:46.398194 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:16:46.400485 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:16:46.412535 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:16:46.434628 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:16:46.448042 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:16:46.455730 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:16:46.462814 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:16:46.466436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:16:46.467227 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:16:46.468093 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:16:46.469574 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:16:46.477964 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:16:46.479716 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:16:46.481176 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:16:46.534792 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:16:46.536459 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:16:46.537517 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:16:46.538706 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:16:46.540641 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:16:46.541625 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:16:46.542932 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:16:46.544914 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:16:46.550529 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:16:46.551588 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:16:46.552811 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:16:46.555134 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:16:46.556249 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:16:46.558632 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:16:46.568013 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:16:46.569741 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:16:46.571088 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:16:46.572612 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:16:46.574193 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:16:46.575078 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:16:46.578222 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:16:46.583770 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:16:46.584497 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:16:46.587108 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:16:46.588826 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:16:46.590209 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:16:46.592014 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:16:46.614567 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:16:46.615186 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:16:46.615890 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:16:46.616470 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:16:46.619670 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:16:46.620934 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:16:46.622781 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:16:46.623728 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:16:46.624524 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:16:46.625637 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:16:46.627507 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:16:46.628572 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:16:46.629433 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:16:46.630911 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:16:46.631770 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:16:46.633981 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:16:46.635268 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:16:46.636181 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:16:46.637359 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:16:46.640487 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:16:46.645696 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:16:46.646705 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:16:46.648957 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:16:46.651843 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:16:46.654085 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:16:46.654937 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:16:46.657399 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:16:46.663204 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:16:46.670779 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:16:46.671571 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:16:46.674048 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:16:46.674935 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:16:46.675966 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:16:46.678426 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:16:46.681994 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:16:46.684398 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:16:46.837819 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:16:46.838037 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00392686-3dd5-4017-85ad-3fb813e35277', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5799d8160>]}
2021-10-02 10:16:46.947341 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:16:46.956740 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:16:46.960616 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:16:46.963587 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:16:46.967079 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:16:46.970307 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:16:46.973397 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:16:46.976761 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:16:46.980756 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc57998c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc579aa2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc579aa2520>]}
2021-10-02 10:16:46.981003 (MainThread): Flushing usage events
2021-10-02 10:16:48.360084 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-10-02 10:16:48.360353 (MainThread): Encountered an error:
2021-10-02 10:16:48.360551 (MainThread): Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:16:48.362939 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)

2021-10-02 10:17:51.561622 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:17:51.634422 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:17:51.636190 (MainThread): Tracking: tracking
2021-10-02 10:17:51.649639 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf2946cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf2946ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf29462b0>]}
2021-10-02 10:17:51.670953 (MainThread): Partial parsing not enabled
2021-10-02 10:17:51.715865 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:17:51.716631 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:17:51.717511 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:17:51.720542 (MainThread): Parsing macros/relations.sql
2021-10-02 10:17:51.721799 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:17:51.744211 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:17:51.745963 (MainThread): Parsing macros/core.sql
2021-10-02 10:17:51.749491 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:17:51.756888 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:17:51.768124 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:17:51.770027 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:17:51.788777 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:17:51.830241 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:17:51.855260 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:17:51.857289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:17:51.869402 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:17:51.892413 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:17:51.909230 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:17:51.918783 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:17:51.926496 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:17:51.930175 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:17:51.931078 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:17:51.932027 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:17:51.934153 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:17:51.943512 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:17:51.945318 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:17:51.946886 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:17:52.004341 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:17:52.006140 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:17:52.007267 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:17:52.008946 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:17:52.011006 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:17:52.012127 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:17:52.013974 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:17:52.016527 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:17:52.022578 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:17:52.023643 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:17:52.025283 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:17:52.027871 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:17:52.028892 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:17:52.031112 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:17:52.040871 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:17:52.042752 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:17:52.044230 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:17:52.046544 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:17:52.048160 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:17:52.049176 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:17:52.052797 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:17:52.059290 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:17:52.060362 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:17:52.063784 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:17:52.066152 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:17:52.068104 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:17:52.070449 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:17:52.097950 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:17:52.098935 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:17:52.099924 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:17:52.100814 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:17:52.105158 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:17:52.106911 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:17:52.109671 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:17:52.111079 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:17:52.112198 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:17:52.113681 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:17:52.116125 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:17:52.117565 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:17:52.118861 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:17:52.120783 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:17:52.122323 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:17:52.126948 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:17:52.129712 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:17:52.131152 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:17:52.133900 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:17:52.138976 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:17:52.147025 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:17:52.148614 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:17:52.152642 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:17:52.157089 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:17:52.161439 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:17:52.162892 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:17:52.167507 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:17:52.175632 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:17:52.185589 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:17:52.186729 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:17:52.189843 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:17:52.190872 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:17:52.192034 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:17:52.194607 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:17:52.198437 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:17:52.201064 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:17:52.367051 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:17:52.367295 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea9549f5-c4b0-47df-a8d2-691984b14819', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf2a195b0>]}
2021-10-02 10:17:52.509884 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:17:52.522225 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:17:52.527292 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:17:52.531288 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:17:52.536034 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:17:52.540121 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:17:52.544078 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:17:52.548563 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:17:52.553552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf29291f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf2ae2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf2ae2070>]}
2021-10-02 10:17:52.553862 (MainThread): Flushing usage events
2021-10-02 10:17:53.749948 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-10-02 10:17:53.750247 (MainThread): Encountered an error:
2021-10-02 10:17:53.750477 (MainThread): Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:17:53.753287 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)

2021-10-02 10:22:12.935434 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:22:13.017884 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:22:13.019593 (MainThread): Tracking: tracking
2021-10-02 10:22:13.034458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e6846d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e6855b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e6846bb0>]}
2021-10-02 10:22:13.055266 (MainThread): Partial parsing not enabled
2021-10-02 10:22:13.098370 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:22:13.099123 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:22:13.099997 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:22:13.102883 (MainThread): Parsing macros/relations.sql
2021-10-02 10:22:13.104264 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:22:13.133260 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:22:13.137008 (MainThread): Parsing macros/core.sql
2021-10-02 10:22:13.143580 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:22:13.156156 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:22:13.174994 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:22:13.177504 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:22:13.199848 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:22:13.237762 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:22:13.257772 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:22:13.259412 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:22:13.269467 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:22:13.288781 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:22:13.302910 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:22:13.311334 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:22:13.318826 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:22:13.322457 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:22:13.323264 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:22:13.324138 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:22:13.325508 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:22:13.333367 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:22:13.335050 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:22:13.336453 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:22:13.389836 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:22:13.391478 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:22:13.392557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:22:13.393800 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:22:13.395801 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:22:13.396876 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:22:13.398203 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:22:13.400360 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:22:13.406463 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:22:13.407511 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:22:13.408720 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:22:13.410950 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:22:13.411940 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:22:13.414070 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:22:13.424085 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:22:13.425882 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:22:13.427276 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:22:13.428817 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:22:13.430353 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:22:13.431294 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:22:13.434514 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:22:13.439635 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:22:13.440455 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:22:13.443111 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:22:13.444851 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:22:13.446245 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:22:13.448431 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:22:13.471933 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:22:13.472601 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:22:13.473243 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:22:13.473819 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:22:13.476785 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:22:13.477965 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:22:13.479974 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:22:13.480953 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:22:13.481802 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:22:13.482923 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:22:13.484957 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:22:13.486045 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:22:13.486877 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:22:13.488215 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:22:13.489029 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:22:13.491309 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:22:13.492579 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:22:13.493483 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:22:13.494654 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:22:13.497729 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:22:13.503393 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:22:13.504442 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:22:13.506777 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:22:13.509672 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:22:13.512065 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:22:13.512904 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:22:13.515659 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:22:13.521700 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:22:13.528953 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:22:13.529735 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:22:13.533260 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:22:13.534545 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:22:13.535834 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:22:13.538653 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:22:13.543229 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:22:13.546373 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:22:13.701916 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:22:13.702144 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bbdf841-335e-4ae6-94d1-8f7629643f3f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e690f940>]}
2021-10-02 10:22:13.812474 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:22:13.822489 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:22:13.826338 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:22:13.829351 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:22:13.833132 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:22:13.836221 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:22:13.839188 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:22:13.842728 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:22:13.847092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e68ab070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e69e2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e69e21f0>]}
2021-10-02 10:22:13.847372 (MainThread): Flushing usage events
2021-10-02 10:22:15.228272 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-10-02 10:22:15.228633 (MainThread): Encountered an error:
2021-10-02 10:22:15.228875 (MainThread): Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:22:15.231826 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "cust_details_ord_counts". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_details_ord_counts") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_details_ord_counts (models/snowflake_model_data/cust_details_ord_counts.sql)
  - model.dbt_demo_project.cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)

2021-10-02 10:26:15.791130 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:26:15.871850 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:26:15.873123 (MainThread): Tracking: tracking
2021-10-02 10:26:15.887050 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6b012c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6afc26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6afc2e80>]}
2021-10-02 10:26:15.908018 (MainThread): Partial parsing not enabled
2021-10-02 10:26:15.957004 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:26:15.957791 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:26:15.958680 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:26:15.961687 (MainThread): Parsing macros/relations.sql
2021-10-02 10:26:15.962922 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:26:15.986661 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:26:15.988469 (MainThread): Parsing macros/core.sql
2021-10-02 10:26:15.992569 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:26:16.000768 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:26:16.012165 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:26:16.014132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:26:16.035541 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:26:16.077299 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:26:16.101967 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:26:16.103878 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:26:16.116821 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:26:16.147930 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:26:16.166972 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:26:16.177294 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:26:16.185934 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:26:16.190091 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:26:16.190970 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:26:16.191888 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:26:16.193308 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:26:16.201061 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:26:16.202712 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:26:16.204087 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:26:16.257318 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:26:16.258965 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:26:16.260063 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:26:16.261248 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:26:16.263242 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:26:16.264230 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:26:16.265682 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:26:16.267691 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:26:16.273401 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:26:16.274591 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:26:16.275855 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:26:16.278090 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:26:16.279128 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:26:16.281284 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:26:16.290442 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:26:16.292277 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:26:16.293577 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:26:16.295079 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:26:16.296503 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:26:16.297408 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:26:16.300349 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:26:16.305264 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:26:16.306106 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:26:16.308711 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:26:16.310401 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:26:16.311773 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:26:16.313636 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:26:16.335704 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:26:16.336334 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:26:16.336961 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:26:16.337530 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:26:16.340862 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:26:16.342248 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:26:16.344095 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:26:16.345083 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:26:16.345893 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:26:16.347069 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:26:16.348902 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:26:16.349939 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:26:16.350839 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:26:16.352426 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:26:16.353331 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:26:16.355496 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:26:16.356753 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:26:16.357649 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:26:16.358904 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:26:16.362197 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:26:16.367356 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:26:16.368343 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:26:16.370523 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:26:16.373498 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:26:16.375669 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:26:16.376499 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:26:16.379117 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:26:16.384729 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:26:16.391647 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:26:16.392481 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:26:16.394928 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:26:16.395797 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:26:16.396812 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:26:16.399229 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:26:16.402822 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:26:16.405440 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:26:16.555611 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:26:16.555832 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53ab03d1-2d5a-465d-85aa-304517617b80', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6b0d7670>]}
2021-10-02 10:26:16.672767 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:26:16.682233 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:26:16.686070 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:26:16.689187 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:26:16.692858 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:26:16.695913 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:26:16.699069 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.customer".
2021-10-02 10:26:16.702609 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_details_ord_counts".
2021-10-02 10:26:16.707004 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:26:16.709430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6afe5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6b24bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6b24b0d0>]}
2021-10-02 10:26:16.709745 (MainThread): Flushing usage events
2021-10-02 10:26:17.882129 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-10-02 10:26:17.882440 (MainThread): Encountered an error:
2021-10-02 10:26:17.882631 (MainThread): Compilation Error
  dbt found two resources with the name "cust_count_by_state". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_count_by_state") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_count_by_state (models/snowflake_model_data/cust_count_by_state.sql)
  - model.dbt_demo_project.cust_count_by_state (models/postgres_model/cust_count_by_state.sql)
2021-10-02 10:26:17.884962 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 387, in parse_node
    self.add_result_node(block, result)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 369, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1055, in add_node
    self.add_node_nofile(node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1051, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1180, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 788, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "cust_count_by_state". Since these resources have the same name,
  dbt will be unable to find the correct resource when ref("cust_count_by_state") is used. To fix this,
  change the name of one of these resources:
  - model.dbt_demo_project.cust_count_by_state (models/snowflake_model_data/cust_count_by_state.sql)
  - model.dbt_demo_project.cust_count_by_state (models/postgres_model/cust_count_by_state.sql)

2021-10-02 10:28:56.744879 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:28:56.832159 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:28:56.833919 (MainThread): Tracking: tracking
2021-10-02 10:28:56.848906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe545ff9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe545ff9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe545ff9be0>]}
2021-10-02 10:28:56.869771 (MainThread): Partial parsing not enabled
2021-10-02 10:28:56.910202 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:28:56.910992 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:28:56.911893 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:28:56.914562 (MainThread): Parsing macros/relations.sql
2021-10-02 10:28:56.915815 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:28:56.938171 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:28:56.939880 (MainThread): Parsing macros/core.sql
2021-10-02 10:28:56.943454 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:28:56.950421 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:28:56.961278 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:28:56.963140 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:28:56.983221 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:28:57.028499 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:28:57.053979 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:28:57.056038 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:28:57.068860 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:28:57.092565 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:28:57.106838 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:28:57.114979 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:28:57.123488 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:28:57.128292 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:28:57.129477 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:28:57.130666 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:28:57.132366 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:28:57.141675 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:28:57.143545 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:28:57.145012 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:28:57.206240 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:28:57.207844 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:28:57.208909 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:28:57.210172 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:28:57.212138 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:28:57.213208 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:28:57.214605 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:28:57.216612 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:28:57.222709 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:28:57.223741 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:28:57.224938 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:28:57.227091 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:28:57.228110 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:28:57.230225 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:28:57.240109 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:28:57.241964 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:28:57.243500 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:28:57.245033 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:28:57.246473 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:28:57.247354 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:28:57.250334 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:28:57.255392 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:28:57.256112 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:28:57.258810 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:28:57.260540 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:28:57.261913 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:28:57.263725 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:28:57.286318 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:28:57.287134 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:28:57.287771 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:28:57.288386 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:28:57.291756 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:28:57.293022 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:28:57.294986 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:28:57.296136 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:28:57.297230 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:28:57.298695 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:28:57.300815 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:28:57.302116 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:28:57.303226 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:28:57.304938 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:28:57.305970 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:28:57.308684 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:28:57.310270 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:28:57.311390 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:28:57.312827 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:28:57.316624 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:28:57.322952 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:28:57.324097 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:28:57.326449 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:28:57.329358 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:28:57.331532 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:28:57.332368 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:28:57.334910 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:28:57.340610 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:28:57.347862 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:28:57.348716 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:28:57.351197 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:28:57.352072 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:28:57.353095 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:28:57.355700 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:28:57.359404 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:28:57.361963 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:28:57.513809 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:28:57.514030 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8d2de9e-3e80-4b89-a131-d2ee8d61feb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5460ae790>]}
2021-10-02 10:28:57.627055 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:28:57.636324 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:28:57.640370 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:28:57.643501 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:28:57.647096 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:28:57.650243 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:28:57.653471 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_orders_count_by_cust".
2021-10-02 10:28:57.657378 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_details_ord_counts".
2021-10-02 10:28:57.661634 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_count_by_state".
2021-10-02 10:28:57.664630 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_customer".
2021-10-02 10:28:57.755528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe546169460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5461d62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5461d94c0>]}
2021-10-02 10:28:57.755792 (MainThread): Flushing usage events
2021-10-02 10:28:59.094379 (MainThread): Connection 'model.dbt_demo_project.sf_customer' was properly closed.
2021-10-02 10:28:59.094622 (MainThread): Encountered an error:
2021-10-02 10:28:59.094787 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named cust_count_by_state. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for cust_count_by_state in one of these files:
   - models/snowflake_model_data/schema.yml
  models/postgres_model/schema.yml
2021-10-02 10:28:59.097826 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 517, in parse_file
    for test_block in parser.parse():
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 752, in parse
    self.parse_patch(node_block, refs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 799, in parse_patch
    self.manifest.add_patch(self.yaml.file, patch)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 743, in add_patch
    raise_duplicate_patch_name(patch, existing_file_path)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 865, in raise_duplicate_patch_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named cust_count_by_state. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for cust_count_by_state in one of these files:
   - models/snowflake_model_data/schema.yml
  models/postgres_model/schema.yml

2021-10-02 10:30:03.917246 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:30:04.000523 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:30:04.001445 (MainThread): Tracking: tracking
2021-10-02 10:30:04.015494 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03952a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f039026d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03902e80>]}
2021-10-02 10:30:04.036169 (MainThread): Partial parsing not enabled
2021-10-02 10:30:04.089349 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:30:04.090179 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:30:04.091088 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:30:04.094118 (MainThread): Parsing macros/relations.sql
2021-10-02 10:30:04.095345 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:30:04.120866 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:30:04.122853 (MainThread): Parsing macros/core.sql
2021-10-02 10:30:04.127622 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:30:04.136428 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:30:04.152196 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:30:04.155298 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:30:04.179272 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:30:04.216930 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:30:04.238496 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:30:04.240409 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:30:04.250386 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:30:04.270229 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:30:04.283778 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:30:04.292005 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:30:04.299484 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:30:04.303291 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:30:04.304153 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:30:04.305055 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:30:04.306501 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:30:04.314737 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:30:04.316409 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:30:04.317792 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:30:04.372490 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:30:04.374173 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:30:04.375341 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:30:04.376611 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:30:04.378616 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:30:04.379763 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:30:04.381224 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:30:04.383210 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:30:04.388908 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:30:04.389952 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:30:04.391160 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:30:04.393339 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:30:04.394333 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:30:04.396547 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:30:04.406324 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:30:04.408107 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:30:04.409508 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:30:04.411198 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:30:04.412725 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:30:04.413721 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:30:04.416770 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:30:04.422156 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:30:04.422966 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:30:04.425616 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:30:04.427422 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:30:04.428820 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:30:04.430590 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:30:04.452670 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:30:04.453293 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:30:04.453932 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:30:04.454509 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:30:04.457489 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:30:04.458609 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:30:04.460588 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:30:04.461583 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:30:04.462334 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:30:04.463412 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:30:04.465400 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:30:04.466413 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:30:04.467229 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:30:04.468543 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:30:04.469436 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:30:04.471719 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:30:04.473025 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:30:04.474415 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:30:04.475790 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:30:04.479136 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:30:04.484672 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:30:04.485706 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:30:04.487891 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:30:04.491081 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:30:04.493342 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:30:04.494208 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:30:04.496747 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:30:04.502331 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:30:04.509422 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:30:04.510190 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:30:04.513047 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:30:04.514064 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:30:04.515072 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:30:04.517708 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:30:04.521284 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:30:04.524091 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:30:04.678867 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:30:04.679103 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98bb2867-4732-4df4-be42-be812f61fca6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03a19460>]}
2021-10-02 10:30:04.788758 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:30:04.798053 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:30:04.801719 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:30:04.804858 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:30:04.808579 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:30:04.812105 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:30:04.814798 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '98bb2867-4732-4df4-be42-be812f61fca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03ad1250>]}
2021-10-02 10:30:04.815743 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_orders_count_by_cust".
2021-10-02 10:30:04.819363 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_details_ord_counts".
2021-10-02 10:30:04.823909 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_count_by_state".
2021-10-02 10:30:04.826847 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_customer".
2021-10-02 10:30:04.913036 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03a99550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03b322b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f03b372e0>]}
2021-10-02 10:30:04.913392 (MainThread): Flushing usage events
2021-10-02 10:30:06.071929 (MainThread): Connection 'model.dbt_demo_project.sf_customer' was properly closed.
2021-10-02 10:30:06.072215 (MainThread): Encountered an error:
2021-10-02 10:30:06.072407 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named cust_count_by_state. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for cust_count_by_state in one of these files:
   - models/snowflake_model_data/sf_schema.yml
  models/postgres_model/schema.yml
2021-10-02 10:30:06.079447 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 517, in parse_file
    for test_block in parser.parse():
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 752, in parse
    self.parse_patch(node_block, refs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 799, in parse_patch
    self.manifest.add_patch(self.yaml.file, patch)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 743, in add_patch
    raise_duplicate_patch_name(patch, existing_file_path)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 865, in raise_duplicate_patch_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named cust_count_by_state. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for cust_count_by_state in one of these files:
   - models/snowflake_model_data/sf_schema.yml
  models/postgres_model/schema.yml

2021-10-02 10:30:56.386155 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:30:56.472686 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:30:56.473994 (MainThread): Tracking: tracking
2021-10-02 10:30:56.487400 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff861917f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8619170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8619173d0>]}
2021-10-02 10:30:56.510129 (MainThread): Partial parsing not enabled
2021-10-02 10:30:56.564467 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:30:56.565384 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:30:56.566487 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:30:56.570397 (MainThread): Parsing macros/relations.sql
2021-10-02 10:30:56.572638 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:30:56.602114 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:30:56.604214 (MainThread): Parsing macros/core.sql
2021-10-02 10:30:56.608783 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:30:56.617136 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:30:56.629774 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:30:56.632444 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:30:56.655639 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:30:56.697567 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:30:56.720704 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:30:56.722343 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:30:56.732734 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:30:56.755734 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:30:56.772334 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:30:56.782873 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:30:56.792332 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:30:56.797194 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:30:56.798270 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:30:56.799413 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:30:56.801248 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:30:56.811662 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:30:56.813851 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:30:56.815621 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:30:56.875011 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:30:56.876630 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:30:56.877683 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:30:56.878866 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:30:56.880869 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:30:56.881865 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:30:56.883219 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:30:56.885420 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:30:56.891112 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:30:56.892155 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:30:56.893456 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:30:56.895956 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:30:56.897014 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:30:56.899198 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:30:56.908935 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:30:56.910733 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:30:56.912108 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:30:56.913997 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:30:56.915439 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:30:56.916361 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:30:56.919435 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:30:56.924700 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:30:56.925434 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:30:56.928287 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:30:56.930061 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:30:56.931509 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:30:56.933429 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:30:56.956451 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:30:56.957183 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:30:56.957817 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:30:56.958477 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:30:56.961574 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:30:56.962793 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:30:56.964831 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:30:56.965776 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:30:56.966639 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:30:56.967748 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:30:56.969675 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:30:56.970728 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:30:56.971602 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:30:56.973109 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:30:56.973949 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:30:56.976282 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:30:56.977556 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:30:56.978508 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:30:56.979723 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:30:56.982844 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:30:56.988196 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:30:56.989291 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:30:56.991479 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:30:56.994585 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:30:56.997031 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:30:56.997921 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:30:57.000543 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:30:57.006724 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:30:57.014944 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:30:57.015810 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:30:57.018355 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:30:57.019245 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:30:57.020290 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:30:57.022813 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:30:57.026481 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:30:57.028959 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:30:57.187727 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:30:57.187936 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47238510-0dae-4313-9435-54f1585e7aed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8619cc100>]}
2021-10-02 10:30:57.319962 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:30:57.331751 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:30:57.336592 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:30:57.340363 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:30:57.344799 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:30:57.348718 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:30:57.352806 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_orders_count_by_cust".
2021-10-02 10:30:57.357560 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_details_ord_counts".
2021-10-02 10:30:57.363436 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_count_by_state".
2021-10-02 10:30:57.366352 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '47238510-0dae-4313-9435-54f1585e7aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff861a94b50>]}
2021-10-02 10:30:57.367506 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_customer".
2021-10-02 10:30:57.453441 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff861ae8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff861ae8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff861ae8160>]}
2021-10-02 10:30:57.453691 (MainThread): Flushing usage events
2021-10-02 10:30:58.905160 (MainThread): Connection 'model.dbt_demo_project.sf_customer' was properly closed.
2021-10-02 10:30:58.905473 (MainThread): Encountered an error:
2021-10-02 10:30:58.905721 (MainThread): Compilation Error in model orders_count_by_cust (models/postgres_model/orders_count_by_cust.sql)
  Model 'model.dbt_demo_project.orders_count_by_cust' (models/postgres_model/orders_count_by_cust.sql) depends on a source named 'dims_data.customer' which was not found
2021-10-02 10:30:58.907830 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 317, in load
    self.process_sources(self.root_project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 731, in process_sources
    _process_sources_for_node(self.manifest, current_project, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 1036, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 776, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 606, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model orders_count_by_cust (models/postgres_model/orders_count_by_cust.sql)
  Model 'model.dbt_demo_project.orders_count_by_cust' (models/postgres_model/orders_count_by_cust.sql) depends on a source named 'dims_data.customer' which was not found

2021-10-02 10:31:33.085111 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:31:33.163614 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:31:33.165437 (MainThread): Tracking: tracking
2021-10-02 10:31:33.183349 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae212e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae2123d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae212910>]}
2021-10-02 10:31:33.204437 (MainThread): Partial parsing not enabled
2021-10-02 10:31:33.247769 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:31:33.248646 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:31:33.249638 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:31:33.252522 (MainThread): Parsing macros/relations.sql
2021-10-02 10:31:33.253795 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:31:33.275911 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:31:33.277719 (MainThread): Parsing macros/core.sql
2021-10-02 10:31:33.281887 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:31:33.289724 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:31:33.301271 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:31:33.303158 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:31:33.321140 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:31:33.357218 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:31:33.379170 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:31:33.380788 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:31:33.390425 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:31:33.410433 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:31:33.424595 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:31:33.432178 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:31:33.439384 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:31:33.443109 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:31:33.443890 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:31:33.444821 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:31:33.446247 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:31:33.454201 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:31:33.455932 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:31:33.457476 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:31:33.511332 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:31:33.512954 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:31:33.514132 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:31:33.515643 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:31:33.517563 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:31:33.518575 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:31:33.519922 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:31:33.521890 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:31:33.527684 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:31:33.528819 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:31:33.530054 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:31:33.532245 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:31:33.533222 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:31:33.535607 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:31:33.544983 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:31:33.546999 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:31:33.548476 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:31:33.550008 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:31:33.551447 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:31:33.552327 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:31:33.555299 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:31:33.560340 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:31:33.561087 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:31:33.563790 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:31:33.565489 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:31:33.566874 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:31:33.568952 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:31:33.591871 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:31:33.592605 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:31:33.593241 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:31:33.593952 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:31:33.597420 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:31:33.598662 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:31:33.600593 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:31:33.601610 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:31:33.602461 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:31:33.603576 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:31:33.605471 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:31:33.606591 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:31:33.607447 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:31:33.608788 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:31:33.609637 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:31:33.611846 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:31:33.613119 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:31:33.614024 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:31:33.615383 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:31:33.618680 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:31:33.624265 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:31:33.625397 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:31:33.627922 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:31:33.630972 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:31:33.633225 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:31:33.634094 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:31:33.636863 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:31:33.642852 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:31:33.651617 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:31:33.652630 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:31:33.655428 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:31:33.656373 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:31:33.657444 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:31:33.660175 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:31:33.664347 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:31:33.667090 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:31:33.831956 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:31:33.832232 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '92e72970-f628-493c-bdbb-ce0c5dcd6415', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae2e1e20>]}
2021-10-02 10:31:33.974102 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:31:33.986332 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:31:33.991352 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:31:33.995802 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:31:34.001658 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:31:34.005904 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:31:34.010053 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_orders_count_by_cust".
2021-10-02 10:31:34.014917 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_details_ord_counts".
2021-10-02 10:31:34.020780 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_cust_count_by_state".
2021-10-02 10:31:34.025282 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.sf_customer".
2021-10-02 10:31:34.127658 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae3f0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae3f0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ae3f0f10>]}
2021-10-02 10:31:34.128010 (MainThread): Flushing usage events
2021-10-02 10:31:35.361380 (MainThread): Connection 'model.dbt_demo_project.sf_customer' was properly closed.
2021-10-02 10:31:35.361692 (MainThread): Encountered an error:
2021-10-02 10:31:35.361934 (MainThread): Compilation Error in model sf_orders_count_by_cust (models/snowflake_model_data/sf_orders_count_by_cust.sql)
  Model 'model.dbt_demo_project.sf_orders_count_by_cust' (models/snowflake_model_data/sf_orders_count_by_cust.sql) depends on a source named 'sales_schema.customer' which was not found
2021-10-02 10:31:35.364058 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 317, in load
    self.process_sources(self.root_project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 731, in process_sources
    _process_sources_for_node(self.manifest, current_project, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 1036, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 776, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 606, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model sf_orders_count_by_cust (models/snowflake_model_data/sf_orders_count_by_cust.sql)
  Model 'model.dbt_demo_project.sf_orders_count_by_cust' (models/snowflake_model_data/sf_orders_count_by_cust.sql) depends on a source named 'sales_schema.customer' which was not found

2021-10-02 10:32:28.872602 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:32:28.952125 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:32:28.953350 (MainThread): Tracking: tracking
2021-10-02 10:32:28.970486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96952d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96961100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96961f40>]}
2021-10-02 10:32:28.992702 (MainThread): Partial parsing not enabled
2021-10-02 10:32:29.034464 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:32:29.035262 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:32:29.036129 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:32:29.039208 (MainThread): Parsing macros/relations.sql
2021-10-02 10:32:29.040452 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:32:29.062686 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:32:29.064460 (MainThread): Parsing macros/core.sql
2021-10-02 10:32:29.068222 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:32:29.075688 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:32:29.087380 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:32:29.089325 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:32:29.108695 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:32:29.154984 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:32:29.182816 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:32:29.185104 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:32:29.197304 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:32:29.218060 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:32:29.231068 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:32:29.238496 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:32:29.245525 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:32:29.248997 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:32:29.249778 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:32:29.250791 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:32:29.252154 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:32:29.260278 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:32:29.261903 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:32:29.263259 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:32:29.317541 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:32:29.319262 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:32:29.320501 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:32:29.321735 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:32:29.323793 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:32:29.324757 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:32:29.326032 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:32:29.327948 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:32:29.333333 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:32:29.334377 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:32:29.335623 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:32:29.337856 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:32:29.338814 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:32:29.341177 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:32:29.350279 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:32:29.352122 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:32:29.353594 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:32:29.355079 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:32:29.356714 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:32:29.357740 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:32:29.360790 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:32:29.366006 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:32:29.366809 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:32:29.369532 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:32:29.371276 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:32:29.372653 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:32:29.374384 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:32:29.396831 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:32:29.397474 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:32:29.398116 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:32:29.398689 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:32:29.401656 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:32:29.402802 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:32:29.404751 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:32:29.405824 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:32:29.406919 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:32:29.408070 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:32:29.409825 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:32:29.410865 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:32:29.411695 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:32:29.413039 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:32:29.413865 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:32:29.416501 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:32:29.417940 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:32:29.419059 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:32:29.420357 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:32:29.423648 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:32:29.429121 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:32:29.430152 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:32:29.432339 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:32:29.435187 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:32:29.437475 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:32:29.438316 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:32:29.440756 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:32:29.446302 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:32:29.453252 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:32:29.454021 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:32:29.456490 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:32:29.457417 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:32:29.458440 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:32:29.460964 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:32:29.464496 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:32:29.466883 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:32:29.615765 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:32:29.615985 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf736d8c-70ce-465e-8ddc-b152dd91143a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96a065b0>]}
2021-10-02 10:32:29.733720 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:32:29.743214 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:32:29.747065 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:32:29.750085 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:32:29.753751 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:32:29.756980 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:32:29.836890 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96a8e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96af8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda96afffa0>]}
2021-10-02 10:32:29.837158 (MainThread): Flushing usage events
2021-10-02 10:32:31.171285 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-10-02 10:32:31.171549 (MainThread): Encountered an error:
2021-10-02 10:32:31.171758 (MainThread): Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  Model 'model.dbt_demo_project.cust_details_ord_counts' (models/postgres_model/cust_details_ord_counts.sql) depends on a node named 'orders_count_by_cust' in package 'postgres_model' which was not found
2021-10-02 10:32:31.173716 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 318, in load
    self.process_refs(self.root_project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 669, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 980, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 753, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 575, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  Model 'model.dbt_demo_project.cust_details_ord_counts' (models/postgres_model/cust_details_ord_counts.sql) depends on a node named 'orders_count_by_cust' in package 'postgres_model' which was not found

2021-10-02 10:34:38.704572 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:34:38.793471 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:34:38.794801 (MainThread): Tracking: tracking
2021-10-02 10:34:38.810824 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273112f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273112ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273112940>]}
2021-10-02 10:34:38.833432 (MainThread): Partial parsing not enabled
2021-10-02 10:34:38.886553 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:34:38.887297 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:34:38.888162 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:34:38.891158 (MainThread): Parsing macros/relations.sql
2021-10-02 10:34:38.892380 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:34:38.916585 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:34:38.918491 (MainThread): Parsing macros/core.sql
2021-10-02 10:34:38.922471 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:34:38.930097 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:34:38.940905 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:34:38.942594 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:34:38.962700 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:34:38.999812 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:34:39.019711 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:34:39.021357 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:34:39.032095 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:34:39.053330 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:34:39.066451 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:34:39.074101 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:34:39.081822 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:34:39.086191 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:34:39.087072 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:34:39.088023 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:34:39.089464 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:34:39.097483 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:34:39.099164 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:34:39.100556 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:34:39.156881 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:34:39.159360 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:34:39.160567 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:34:39.161875 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:34:39.165085 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:34:39.166189 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:34:39.167625 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:34:39.169598 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:34:39.175387 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:34:39.176746 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:34:39.178280 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:34:39.180444 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:34:39.181524 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:34:39.183582 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:34:39.192682 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:34:39.194342 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:34:39.195797 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:34:39.197368 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:34:39.198756 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:34:39.199600 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:34:39.202666 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:34:39.207967 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:34:39.208816 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:34:39.211570 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:34:39.213320 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:34:39.214740 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:34:39.216518 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:34:39.238866 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:34:39.239507 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:34:39.240197 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:34:39.240742 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:34:39.243770 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:34:39.245293 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:34:39.247359 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:34:39.248322 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:34:39.249069 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:34:39.250376 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:34:39.252082 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:34:39.253082 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:34:39.253888 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:34:39.255322 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:34:39.256234 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:34:39.258700 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:34:39.260086 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:34:39.261121 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:34:39.262394 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:34:39.265510 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:34:39.270793 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:34:39.271804 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:34:39.273972 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:34:39.276883 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:34:39.279283 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:34:39.280131 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:34:39.282572 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:34:39.288110 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:34:39.295131 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:34:39.295945 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:34:39.298497 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:34:39.299378 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:34:39.300508 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:34:39.302942 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:34:39.306530 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:34:39.308957 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:34:39.460512 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:34:39.460727 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82731cb5b0>]}
2021-10-02 10:34:39.576917 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:34:39.586421 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:34:39.590419 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:39.593839 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:39.597537 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:34:39.601151 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:34:39.691815 (MainThread): [WARNING]: Test 'test.dbt_demo_project.is_not_empty_customer_.f481adb544' (models/postgres_model/schema.yml) depends on a node named 'customer' which was not found
2021-10-02 10:34:39.710270 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 10:34:39.715129 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827321f310>]}
2021-10-02 10:34:39.723455 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273112ee0>]}
2021-10-02 10:34:39.723788 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 10:34:39.725332 (MainThread): 
2021-10-02 10:34:39.725794 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:34:39.727183 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 10:34:39.737908 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 10:34:39.738121 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 10:34:39.738297 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 10:34:41.749268 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.01 seconds
2021-10-02 10:34:41.750503 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 10:34:41.752010 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 10:34:41.757563 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:34:41.757754 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 10:34:41.757877 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:34:43.361892 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.60 seconds
2021-10-02 10:34:43.362113 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:34:43.362259 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 10:34:43.375998 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 10:34:43.377497 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 10:34:43.379688 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 10:34:43.380463 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:34:43.382800 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:34:43.382980 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 10:34:43.383157 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:34:44.687224 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.30 seconds
2021-10-02 10:34:44.687485 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:34:44.687646 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 10:34:44.700981 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 10:34:44.702138 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 10:34:44.703605 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 10:34:44.709846 (MainThread): Using postgres connection "master".
2021-10-02 10:34:44.710057 (MainThread): On master: BEGIN
2021-10-02 10:34:44.710205 (MainThread): Opening a new connection, currently in state init
2021-10-02 10:34:46.289098 (MainThread): SQL status: BEGIN in 1.58 seconds
2021-10-02 10:34:46.289332 (MainThread): Using postgres connection "master".
2021-10-02 10:34:46.289477 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 10:34:46.332423 (MainThread): SQL status: SELECT 1 in 0.04 seconds
2021-10-02 10:34:46.333630 (MainThread): On master: ROLLBACK
2021-10-02 10:34:46.335172 (MainThread): Using postgres connection "master".
2021-10-02 10:34:46.335320 (MainThread): On master: BEGIN
2021-10-02 10:34:46.337664 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 10:34:46.337817 (MainThread): On master: COMMIT
2021-10-02 10:34:46.337936 (MainThread): Using postgres connection "master".
2021-10-02 10:34:46.338041 (MainThread): On master: COMMIT
2021-10-02 10:34:46.339205 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:34:46.339364 (MainThread): On master: Close
2021-10-02 10:34:46.339663 (MainThread): 16:04:46 | Concurrency: 1 threads (target='dev')
2021-10-02 10:34:46.339824 (MainThread): 16:04:46 | 
2021-10-02 10:34:46.344045 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:34:46.344328 (Thread-1): 16:04:46 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 10:34:46.344621 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:46.344768 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 10:34:46.346868 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:34:46.347798 (Thread-1): finished collecting timing info
2021-10-02 10:34:46.371243 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:34:46.372048 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:46.372215 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 10:34:46.372429 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:34:47.744938 (Thread-1): SQL status: BEGIN in 1.37 seconds
2021-10-02 10:34:47.745174 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:47.745319 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 10:34:47.815535 (Thread-1): SQL status: SELECT 44 in 0.07 seconds
2021-10-02 10:34:47.820417 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:47.820573 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 10:34:47.824763 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:34:47.833379 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:34:47.833555 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:47.833673 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:34:47.839075 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 10:34:47.843035 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:34:47.843179 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 10:34:47.848882 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 10:34:47.849815 (Thread-1): finished collecting timing info
2021-10-02 10:34:47.849977 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 10:34:47.850303 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273407cd0>]}
2021-10-02 10:34:47.850595 (Thread-1): 16:04:47 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.51s]
2021-10-02 10:34:47.850751 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:34:47.850898 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:34:47.851161 (Thread-1): 16:04:47 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 10:34:47.851409 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:47.851534 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:34:47.855272 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:34:47.855928 (Thread-1): finished collecting timing info
2021-10-02 10:34:47.913941 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:34:47.914664 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:47.914855 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 10:34:47.915013 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:34:49.459618 (Thread-1): SQL status: BEGIN in 1.54 seconds
2021-10-02 10:34:49.459853 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:49.459997 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 10:34:49.490397 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-02 10:34:49.492357 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:49.492497 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 10:34:49.494561 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:34:49.495410 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:34:49.495537 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:49.495646 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:34:49.498963 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:34:49.500498 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:34:49.500635 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 10:34:49.502143 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:34:49.503007 (Thread-1): finished collecting timing info
2021-10-02 10:34:49.503162 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 10:34:49.503467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8272cc3d30>]}
2021-10-02 10:34:49.503750 (Thread-1): 16:04:49 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.65s]
2021-10-02 10:34:49.503904 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:34:49.504356 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:34:49.504601 (Thread-1): 16:04:49 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 10:34:49.504897 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:34:49.505028 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:34:49.508228 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:34:49.508729 (Thread-1): finished collecting timing info
2021-10-02 10:34:49.510777 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:34:49.511246 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:34:49.511392 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 10:34:49.511507 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:34:50.898196 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-10-02 10:34:50.898431 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:34:50.898553 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:34:50.900635 (Thread-1): Postgres error: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^

2021-10-02 10:34:50.900815 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: ROLLBACK
2021-10-02 10:34:50.902008 (Thread-1): finished collecting timing info
2021-10-02 10:34:50.902170 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 10:34:50.902461 (Thread-1): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:34:50.910074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273290250>]}
2021-10-02 10:34:50.910396 (Thread-1): 16:04:50 | 3 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts..... [ERROR in 1.41s]
2021-10-02 10:34:50.910551 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:34:50.910707 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:34:50.911009 (Thread-1): 16:04:50 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 10:34:50.911289 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:34:50.911418 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:34:50.914052 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:34:50.914469 (Thread-1): finished collecting timing info
2021-10-02 10:34:50.916412 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:34:50.916860 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:34:50.916984 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 10:34:50.917096 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:34:52.193772 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-10-02 10:34:52.194011 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:34:52.194159 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:34:52.196228 (Thread-1): Postgres error: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^

2021-10-02 10:34:52.196402 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: ROLLBACK
2021-10-02 10:34:52.198440 (Thread-1): finished collecting timing info
2021-10-02 10:34:52.198664 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 10:34:52.199019 (Thread-1): Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
2021-10-02 10:34:52.199613 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d3216b-eb75-4b1e-ba65-70c17aec8515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273407cd0>]}
2021-10-02 10:34:52.199975 (Thread-1): 16:04:52 | 4 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts copy [ERROR in 1.29s]
2021-10-02 10:34:52.200160 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:34:52.201172 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:34:52.201372 (MainThread): Using postgres connection "master".
2021-10-02 10:34:52.201512 (MainThread): On master: BEGIN
2021-10-02 10:34:52.201644 (MainThread): Opening a new connection, currently in state closed
2021-10-02 10:34:53.667862 (MainThread): SQL status: BEGIN in 1.47 seconds
2021-10-02 10:34:53.668114 (MainThread): On master: COMMIT
2021-10-02 10:34:53.668262 (MainThread): Using postgres connection "master".
2021-10-02 10:34:53.668395 (MainThread): On master: COMMIT
2021-10-02 10:34:53.669880 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:34:53.670092 (MainThread): On master: Close
2021-10-02 10:34:53.670487 (MainThread): 16:04:53 | 
2021-10-02 10:34:53.670683 (MainThread): 16:04:53 | Finished running 1 table model, 3 view models in 13.94s.
2021-10-02 10:34:53.670847 (MainThread): Connection 'master' was properly closed.
2021-10-02 10:34:53.670975 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 10:34:53.682011 (MainThread): 
2021-10-02 10:34:53.682547 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-02 10:34:53.682988 (MainThread): 
2021-10-02 10:34:53.683310 (MainThread): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:34:53.683545 (MainThread):   column "ind" does not exist
2021-10-02 10:34:53.683775 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
2021-10-02 10:34:53.683964 (MainThread):                                                                ^
2021-10-02 10:34:53.684212 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:34:53.684574 (MainThread): 
2021-10-02 10:34:53.684984 (MainThread): Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 10:34:53.685576 (MainThread):   column "ind" does not exist
2021-10-02 10:34:53.685993 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
2021-10-02 10:34:53.686265 (MainThread):                                                                ^
2021-10-02 10:34:53.686568 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
2021-10-02 10:34:53.686780 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2021-10-02 10:34:53.687038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82708a1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82733521f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8273352700>]}
2021-10-02 10:34:53.687315 (MainThread): Flushing usage events
2021-10-02 10:36:47.714070 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:36:47.803805 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:36:47.805340 (MainThread): Tracking: tracking
2021-10-02 10:36:47.822344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f06abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f0016d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f001e80>]}
2021-10-02 10:36:47.843614 (MainThread): Partial parsing not enabled
2021-10-02 10:36:47.904709 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:36:47.905490 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:36:47.906400 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:36:47.909936 (MainThread): Parsing macros/relations.sql
2021-10-02 10:36:47.911330 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:36:47.935045 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:36:47.936905 (MainThread): Parsing macros/core.sql
2021-10-02 10:36:47.941201 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:36:47.949016 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:36:47.959227 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:36:47.961251 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:36:47.981729 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:36:48.016767 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:36:48.037111 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:36:48.038917 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:36:48.048987 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:36:48.068613 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:36:48.082189 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:36:48.090072 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:36:48.097696 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:36:48.101903 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:36:48.102759 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:36:48.103642 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:36:48.105042 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:36:48.115209 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:36:48.117654 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:36:48.119298 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:36:48.194099 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:36:48.195884 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:36:48.197013 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:36:48.198237 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:36:48.200242 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:36:48.201254 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:36:48.202574 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:36:48.204609 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:36:48.210477 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:36:48.211621 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:36:48.212837 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:36:48.215057 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:36:48.216069 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:36:48.218282 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:36:48.227963 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:36:48.229774 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:36:48.231084 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:36:48.232632 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:36:48.234142 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:36:48.235040 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:36:48.238217 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:36:48.243897 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:36:48.244669 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:36:48.247226 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:36:48.248985 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:36:48.250564 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:36:48.252457 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:36:48.274802 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:36:48.275499 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:36:48.276174 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:36:48.276751 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:36:48.279790 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:36:48.280949 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:36:48.282821 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:36:48.283838 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:36:48.284613 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:36:48.285722 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:36:48.287669 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:36:48.288726 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:36:48.289612 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:36:48.290973 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:36:48.291937 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:36:48.294350 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:36:48.295643 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:36:48.296641 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:36:48.297951 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:36:48.301882 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:36:48.307305 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:36:48.308528 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:36:48.310944 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:36:48.313860 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:36:48.316279 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:36:48.317241 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:36:48.319854 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:36:48.325735 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:36:48.334024 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:36:48.335004 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:36:48.338341 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:36:48.339312 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:36:48.340414 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:36:48.342875 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:36:48.346556 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:36:48.348994 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:36:48.515421 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:36:48.515685 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f20a1c0>]}
2021-10-02 10:36:48.627339 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:36:48.637178 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:36:48.641185 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:48.644193 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:48.647711 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:36:48.650708 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:36:48.732646 (MainThread): [WARNING]: Test 'test.dbt_demo_project.is_not_empty_customers_.802c79e055' (models/postgres_model/schema.yml) depends on a node named 'customers' which was not found
2021-10-02 10:36:48.746523 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 10:36:48.752195 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f289250>]}
2021-10-02 10:36:48.761050 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f2bcd00>]}
2021-10-02 10:36:48.761515 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 10:36:48.763084 (MainThread): 
2021-10-02 10:36:48.763597 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:36:48.764489 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 10:36:48.774951 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 10:36:48.775171 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 10:36:48.775328 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 10:36:50.387923 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.61 seconds
2021-10-02 10:36:50.389385 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 10:36:50.391285 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:36:50.397575 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:36:50.397777 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 10:36:50.397920 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:36:51.798887 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.40 seconds
2021-10-02 10:36:51.799118 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:36:51.799273 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 10:36:51.811348 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 10:36:51.812377 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 10:36:51.813665 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 10:36:51.814091 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 10:36:51.815461 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:36:51.815610 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 10:36:51.815726 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:36:53.055488 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.24 seconds
2021-10-02 10:36:53.055726 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:36:53.055871 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 10:36:53.067132 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2021-10-02 10:36:53.068213 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 10:36:53.069615 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 10:36:53.074444 (MainThread): Using postgres connection "master".
2021-10-02 10:36:53.074618 (MainThread): On master: BEGIN
2021-10-02 10:36:53.074734 (MainThread): Opening a new connection, currently in state init
2021-10-02 10:36:54.565676 (MainThread): SQL status: BEGIN in 1.49 seconds
2021-10-02 10:36:54.565920 (MainThread): Using postgres connection "master".
2021-10-02 10:36:54.566075 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 10:36:54.628322 (MainThread): SQL status: SELECT 3 in 0.06 seconds
2021-10-02 10:36:54.629732 (MainThread): On master: ROLLBACK
2021-10-02 10:36:54.631599 (MainThread): Using postgres connection "master".
2021-10-02 10:36:54.631797 (MainThread): On master: BEGIN
2021-10-02 10:36:54.634763 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 10:36:54.634965 (MainThread): On master: COMMIT
2021-10-02 10:36:54.635124 (MainThread): Using postgres connection "master".
2021-10-02 10:36:54.635266 (MainThread): On master: COMMIT
2021-10-02 10:36:54.636970 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:36:54.637203 (MainThread): On master: Close
2021-10-02 10:36:54.637613 (MainThread): 16:06:54 | Concurrency: 1 threads (target='dev')
2021-10-02 10:36:54.637830 (MainThread): 16:06:54 | 
2021-10-02 10:36:54.640522 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:36:54.640902 (Thread-1): 16:06:54 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 10:36:54.641428 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:54.641705 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 10:36:54.644649 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:36:54.645251 (Thread-1): finished collecting timing info
2021-10-02 10:36:54.671447 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:36:54.672231 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:54.672461 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 10:36:54.672622 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:36:55.904795 (Thread-1): SQL status: BEGIN in 1.23 seconds
2021-10-02 10:36:55.905006 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:55.905131 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 10:36:55.923479 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 10:36:55.928449 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:55.928592 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 10:36:55.930353 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:36:55.932404 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:55.932532 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 10:36:55.933867 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:36:55.942574 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:36:55.942753 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:55.942865 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:36:55.945941 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:36:55.950647 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:36:55.950796 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 10:36:55.971224 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-02 10:36:55.972313 (Thread-1): finished collecting timing info
2021-10-02 10:36:55.972539 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 10:36:55.972895 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f5862b0>]}
2021-10-02 10:36:55.973201 (Thread-1): 16:06:55 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.33s]
2021-10-02 10:36:55.973365 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:36:55.973528 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:36:55.973821 (Thread-1): 16:06:55 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 10:36:55.974104 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:55.974238 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:36:56.009572 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:36:56.010371 (Thread-1): finished collecting timing info
2021-10-02 10:36:56.029438 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:36:56.030487 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:56.030684 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 10:36:56.030848 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:36:57.306001 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-10-02 10:36:57.306244 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:57.306397 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 10:36:57.320250 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:36:57.322433 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:57.322590 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 10:36:57.324142 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:36:57.326453 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:57.326628 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 10:36:57.328939 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:36:57.330212 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:36:57.330360 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:57.330472 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:36:57.333217 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:36:57.334733 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:36:57.334870 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 10:36:57.338752 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:36:57.339716 (Thread-1): finished collecting timing info
2021-10-02 10:36:57.339880 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 10:36:57.340209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f06a6d0>]}
2021-10-02 10:36:57.340499 (Thread-1): 16:06:57 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.37s]
2021-10-02 10:36:57.340653 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:36:57.341128 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:36:57.341482 (Thread-1): 16:06:57 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 10:36:57.341765 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:36:57.341899 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:36:57.344979 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:36:57.345557 (Thread-1): finished collecting timing info
2021-10-02 10:36:57.347908 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:36:57.348516 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:36:57.348694 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 10:36:57.348850 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:36:58.668259 (Thread-1): SQL status: BEGIN in 1.32 seconds
2021-10-02 10:36:58.668514 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:36:58.668672 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:36:58.671007 (Thread-1): Postgres error: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^

2021-10-02 10:36:58.671209 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: ROLLBACK
2021-10-02 10:36:58.672829 (Thread-1): finished collecting timing info
2021-10-02 10:36:58.673042 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 10:36:58.673413 (Thread-1): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:36:58.681587 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f2cd490>]}
2021-10-02 10:36:58.681983 (Thread-1): 16:06:58 | 3 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts..... [ERROR in 1.34s]
2021-10-02 10:36:58.682178 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:36:58.682374 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:36:58.682746 (Thread-1): 16:06:58 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 10:36:58.683084 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:36:58.683253 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:36:58.686583 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:36:58.687107 (Thread-1): finished collecting timing info
2021-10-02 10:36:58.689380 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:36:58.690112 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:36:58.690306 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 10:36:58.690469 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:36:59.942549 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-10-02 10:36:59.942761 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:36:59.942889 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,\"IND\" as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:36:59.944237 (Thread-1): Postgres error: syntax error at or near "\"
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,\"IND\" as...
                                                             ^

2021-10-02 10:36:59.944411 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: ROLLBACK
2021-10-02 10:36:59.945789 (Thread-1): finished collecting timing info
2021-10-02 10:36:59.945963 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 10:36:59.946262 (Thread-1): Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  syntax error at or near "\"
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,\"IND\" as...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "\"
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,\"IND\" as...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  syntax error at or near "\"
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,\"IND\" as...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
2021-10-02 10:36:59.947208 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1371251e-6afd-44f7-8e7a-5c2be9fc0471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f2cd490>]}
2021-10-02 10:36:59.947548 (Thread-1): 16:06:59 | 4 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts copy [ERROR in 1.26s]
2021-10-02 10:36:59.947713 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:36:59.948581 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:36:59.948743 (MainThread): Using postgres connection "master".
2021-10-02 10:36:59.948858 (MainThread): On master: BEGIN
2021-10-02 10:36:59.949038 (MainThread): Opening a new connection, currently in state closed
2021-10-02 10:37:01.338110 (MainThread): SQL status: BEGIN in 1.39 seconds
2021-10-02 10:37:01.338366 (MainThread): On master: COMMIT
2021-10-02 10:37:01.338520 (MainThread): Using postgres connection "master".
2021-10-02 10:37:01.338660 (MainThread): On master: COMMIT
2021-10-02 10:37:01.340004 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:37:01.340226 (MainThread): On master: Close
2021-10-02 10:37:01.340649 (MainThread): 16:07:01 | 
2021-10-02 10:37:01.340849 (MainThread): 16:07:01 | Finished running 1 table model, 3 view models in 12.58s.
2021-10-02 10:37:01.341091 (MainThread): Connection 'master' was properly closed.
2021-10-02 10:37:01.341269 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 10:37:01.350110 (MainThread): 
2021-10-02 10:37:01.350360 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-02 10:37:01.350563 (MainThread): 
2021-10-02 10:37:01.350754 (MainThread): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:37:01.350927 (MainThread):   column "ind" does not exist
2021-10-02 10:37:01.351102 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
2021-10-02 10:37:01.351257 (MainThread):                                                                ^
2021-10-02 10:37:01.351400 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:37:01.351550 (MainThread): 
2021-10-02 10:37:01.351708 (MainThread): Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 10:37:01.351856 (MainThread):   syntax error at or near "\"
2021-10-02 10:37:01.351997 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,\"IND\" as...
2021-10-02 10:37:01.352138 (MainThread):                                                                ^
2021-10-02 10:37:01.352278 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
2021-10-02 10:37:01.352550 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2021-10-02 10:37:01.352872 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f4abb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f021dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29f435490>]}
2021-10-02 10:37:01.353150 (MainThread): Flushing usage events
2021-10-02 10:37:15.276144 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:37:15.355109 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:37:15.356581 (MainThread): Tracking: tracking
2021-10-02 10:37:15.371642 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470816fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470816e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470816910>]}
2021-10-02 10:37:15.392819 (MainThread): Partial parsing not enabled
2021-10-02 10:37:15.434381 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:37:15.435147 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:37:15.436089 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:37:15.438773 (MainThread): Parsing macros/relations.sql
2021-10-02 10:37:15.439998 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:37:15.462233 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:37:15.464001 (MainThread): Parsing macros/core.sql
2021-10-02 10:37:15.467717 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:37:15.475426 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:37:15.486266 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:37:15.488276 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:37:15.508544 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:37:15.544831 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:37:15.566809 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:37:15.568961 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:37:15.580284 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:37:15.599616 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:37:15.612687 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:37:15.620775 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:37:15.628023 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:37:15.631597 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:37:15.632421 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:37:15.633291 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:37:15.634653 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:37:15.642611 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:37:15.644279 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:37:15.645672 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:37:15.698789 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:37:15.700418 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:37:15.701500 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:37:15.702699 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:37:15.704639 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:37:15.705637 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:37:15.707154 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:37:15.709207 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:37:15.714727 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:37:15.715767 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:37:15.716970 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:37:15.719190 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:37:15.720181 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:37:15.722342 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:37:15.731576 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:37:15.733302 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:37:15.734610 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:37:15.736130 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:37:15.737644 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:37:15.738640 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:37:15.741617 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:37:15.746601 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:37:15.747551 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:37:15.750315 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:37:15.752101 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:37:15.753517 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:37:15.755384 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:37:15.778171 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:37:15.778792 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:37:15.779464 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:37:15.780039 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:37:15.783119 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:37:15.784283 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:37:15.786181 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:37:15.787120 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:37:15.788033 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:37:15.789158 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:37:15.790968 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:37:15.792052 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:37:15.792885 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:37:15.794232 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:37:15.795052 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:37:15.797399 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:37:15.798673 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:37:15.799744 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:37:15.801255 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:37:15.804811 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:37:15.810055 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:37:15.811142 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:37:15.814113 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:37:15.817572 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:37:15.819986 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:37:15.820895 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:37:15.823505 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:37:15.830528 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:37:15.838840 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:37:15.840289 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:37:15.843352 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:37:15.844278 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:37:15.845343 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:37:15.847992 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:37:15.853183 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:37:15.855985 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:37:16.011581 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:37:16.011811 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4708ca2e0>]}
2021-10-02 10:37:16.141275 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:37:16.155715 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:37:16.161244 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:16.165525 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:16.170176 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:37:16.174598 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:37:16.264675 (MainThread): [WARNING]: Test 'test.dbt_demo_project.is_not_empty_customers_.802c79e055' (models/postgres_model/schema.yml) depends on a node named 'customers' which was not found
2021-10-02 10:37:16.283888 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 10:37:16.290292 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470b07550>]}
2021-10-02 10:37:16.301573 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4705e5c40>]}
2021-10-02 10:37:16.302167 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 10:37:16.304515 (MainThread): 
2021-10-02 10:37:16.305133 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:37:16.306526 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 10:37:16.317911 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 10:37:16.318135 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 10:37:16.318294 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 10:37:17.831828 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.51 seconds
2021-10-02 10:37:17.833499 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 10:37:17.835811 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 10:37:17.842753 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:37:17.842966 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 10:37:17.843117 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:37:19.248240 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-10-02 10:37:19.248479 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:37:19.248623 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 10:37:19.262179 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2021-10-02 10:37:19.264025 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 10:37:19.266418 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 10:37:19.267087 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:37:19.269090 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:37:19.269277 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 10:37:19.269428 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:37:20.669734 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.40 seconds
2021-10-02 10:37:20.669972 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:37:20.670122 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 10:37:20.682798 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 10:37:20.683967 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 10:37:20.685488 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 10:37:20.691491 (MainThread): Using postgres connection "master".
2021-10-02 10:37:20.691718 (MainThread): On master: BEGIN
2021-10-02 10:37:20.691868 (MainThread): Opening a new connection, currently in state init
2021-10-02 10:37:21.917929 (MainThread): SQL status: BEGIN in 1.23 seconds
2021-10-02 10:37:21.918173 (MainThread): Using postgres connection "master".
2021-10-02 10:37:21.918316 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 10:37:21.952065 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2021-10-02 10:37:21.953152 (MainThread): On master: ROLLBACK
2021-10-02 10:37:21.954708 (MainThread): Using postgres connection "master".
2021-10-02 10:37:21.954881 (MainThread): On master: BEGIN
2021-10-02 10:37:21.957281 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 10:37:21.957442 (MainThread): On master: COMMIT
2021-10-02 10:37:21.957563 (MainThread): Using postgres connection "master".
2021-10-02 10:37:21.957671 (MainThread): On master: COMMIT
2021-10-02 10:37:21.958853 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:37:21.959000 (MainThread): On master: Close
2021-10-02 10:37:21.959302 (MainThread): 16:07:21 | Concurrency: 1 threads (target='dev')
2021-10-02 10:37:21.959479 (MainThread): 16:07:21 | 
2021-10-02 10:37:21.961209 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:37:21.961476 (Thread-1): 16:07:21 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 10:37:21.961767 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:21.961914 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 10:37:21.964368 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:37:21.964939 (Thread-1): finished collecting timing info
2021-10-02 10:37:21.986172 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:37:21.986846 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:21.987091 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 10:37:21.987302 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:37:23.258323 (Thread-1): SQL status: BEGIN in 1.27 seconds
2021-10-02 10:37:23.258565 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:23.258715 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 10:37:23.285294 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 10:37:23.292114 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:23.292335 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 10:37:23.294771 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:37:23.297482 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:23.297688 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 10:37:23.299921 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:37:23.313415 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:37:23.313649 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:23.313801 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:37:23.318286 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:37:23.324749 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:37:23.324967 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 10:37:23.341572 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-02 10:37:23.342826 (Thread-1): finished collecting timing info
2021-10-02 10:37:23.343043 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 10:37:23.343469 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470d78d00>]}
2021-10-02 10:37:23.343909 (Thread-1): 16:07:23 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.38s]
2021-10-02 10:37:23.344257 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:37:23.344614 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:37:23.345017 (Thread-1): 16:07:23 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 10:37:23.345438 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:23.345629 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:37:23.396089 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:37:23.397067 (Thread-1): finished collecting timing info
2021-10-02 10:37:23.416830 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:37:23.417662 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:23.417850 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 10:37:23.418001 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:37:24.975514 (Thread-1): SQL status: BEGIN in 1.56 seconds
2021-10-02 10:37:24.975728 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:24.975844 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 10:37:24.988077 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:37:24.990175 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:24.990312 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 10:37:24.991904 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:37:24.993670 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:24.993800 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 10:37:24.995353 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:37:24.996419 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:37:24.996582 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:24.996707 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:37:25.000002 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:37:25.001748 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:37:25.001908 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 10:37:25.006200 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:37:25.007352 (Thread-1): finished collecting timing info
2021-10-02 10:37:25.007551 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 10:37:25.007935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470a47c70>]}
2021-10-02 10:37:25.008290 (Thread-1): 16:07:25 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.66s]
2021-10-02 10:37:25.008480 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:37:25.009069 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:37:25.009402 (Thread-1): 16:07:25 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 10:37:25.009734 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:37:25.009907 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:37:25.014307 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:37:25.014929 (Thread-1): finished collecting timing info
2021-10-02 10:37:25.017599 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:37:25.018303 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:37:25.018481 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 10:37:25.018627 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:37:26.422985 (Thread-1): SQL status: BEGIN in 1.40 seconds
2021-10-02 10:37:26.423237 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:37:26.423388 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:37:26.425584 (Thread-1): Postgres error: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^

2021-10-02 10:37:26.425786 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: ROLLBACK
2021-10-02 10:37:26.427290 (Thread-1): finished collecting timing info
2021-10-02 10:37:26.427505 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 10:37:26.427872 (Thread-1): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:37:26.432719 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4705f84f0>]}
2021-10-02 10:37:26.433134 (Thread-1): 16:07:26 | 3 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts..... [ERROR in 1.42s]
2021-10-02 10:37:26.433328 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:37:26.433513 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:37:26.433864 (Thread-1): 16:07:26 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 10:37:26.434188 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:37:26.434346 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:37:26.437708 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:37:26.438278 (Thread-1): finished collecting timing info
2021-10-02 10:37:26.441330 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:37:26.442076 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:37:26.442256 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 10:37:26.442402 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:37:27.860754 (Thread-1): SQL status: BEGIN in 1.42 seconds
2021-10-02 10:37:27.860999 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:37:27.861136 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,"IND" as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:37:27.863112 (Thread-1): Postgres error: column "IND" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,"IND" as C...
                                                             ^

2021-10-02 10:37:27.863340 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: ROLLBACK
2021-10-02 10:37:27.864612 (Thread-1): finished collecting timing info
2021-10-02 10:37:27.864788 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 10:37:27.865105 (Thread-1): Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  column "IND" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,"IND" as C...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "IND" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,"IND" as C...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  column "IND" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,"IND" as C...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
2021-10-02 10:37:27.865664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1740b0-eb25-4390-98ed-84a73a127d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470b75100>]}
2021-10-02 10:37:27.865972 (Thread-1): 16:07:27 | 4 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts copy [ERROR in 1.43s]
2021-10-02 10:37:27.866131 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:37:27.867073 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:37:27.867251 (MainThread): Using postgres connection "master".
2021-10-02 10:37:27.867367 (MainThread): On master: BEGIN
2021-10-02 10:37:27.867495 (MainThread): Opening a new connection, currently in state closed
2021-10-02 10:37:29.296390 (MainThread): SQL status: BEGIN in 1.43 seconds
2021-10-02 10:37:29.296681 (MainThread): On master: COMMIT
2021-10-02 10:37:29.296838 (MainThread): Using postgres connection "master".
2021-10-02 10:37:29.296976 (MainThread): On master: COMMIT
2021-10-02 10:37:29.298399 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:37:29.298580 (MainThread): On master: Close
2021-10-02 10:37:29.299008 (MainThread): 16:07:29 | 
2021-10-02 10:37:29.299215 (MainThread): 16:07:29 | Finished running 1 table model, 3 view models in 12.99s.
2021-10-02 10:37:29.299486 (MainThread): Connection 'master' was properly closed.
2021-10-02 10:37:29.299693 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 10:37:29.310827 (MainThread): 
2021-10-02 10:37:29.311091 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-02 10:37:29.311292 (MainThread): 
2021-10-02 10:37:29.311483 (MainThread): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:37:29.311651 (MainThread):   column "ind" does not exist
2021-10-02 10:37:29.311802 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
2021-10-02 10:37:29.311952 (MainThread):                                                                ^
2021-10-02 10:37:29.312108 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:37:29.312277 (MainThread): 
2021-10-02 10:37:29.312448 (MainThread): Database Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 10:37:29.312723 (MainThread):   column "IND" does not exist
2021-10-02 10:37:29.312893 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,"IND" as C...
2021-10-02 10:37:29.313044 (MainThread):                                                                ^
2021-10-02 10:37:29.313188 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts copy.sql
2021-10-02 10:37:29.313349 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2021-10-02 10:37:29.313639 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470693910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470a17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc470a17a00>]}
2021-10-02 10:37:29.313920 (MainThread): Flushing usage events
2021-10-02 10:38:08.975915 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:38:09.071818 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:38:09.073818 (MainThread): Tracking: tracking
2021-10-02 10:38:09.093472 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa524145e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52416d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52416df10>]}
2021-10-02 10:38:09.118899 (MainThread): Partial parsing not enabled
2021-10-02 10:38:09.189211 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:38:09.190148 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:38:09.191283 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:38:09.195101 (MainThread): Parsing macros/relations.sql
2021-10-02 10:38:09.196914 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:38:09.225145 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:38:09.227140 (MainThread): Parsing macros/core.sql
2021-10-02 10:38:09.231399 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:38:09.238704 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:38:09.250440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:38:09.252619 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:38:09.271923 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:38:09.304424 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:38:09.324944 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:38:09.326608 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:38:09.336569 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:38:09.356139 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:38:09.369660 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:38:09.377584 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:38:09.384883 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:38:09.388806 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:38:09.389615 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:38:09.390501 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:38:09.391878 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:38:09.399804 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:38:09.401538 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:38:09.402954 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:38:09.456487 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:38:09.458140 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:38:09.459334 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:38:09.460923 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:38:09.463556 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:38:09.464659 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:38:09.466070 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:38:09.468233 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:38:09.474785 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:38:09.476113 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:38:09.477627 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:38:09.480400 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:38:09.481718 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:38:09.484607 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:38:09.497478 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:38:09.499872 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:38:09.501632 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:38:09.503671 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:38:09.505592 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:38:09.506753 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:38:09.510628 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:38:09.518237 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:38:09.519372 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:38:09.523728 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:38:09.526120 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:38:09.528051 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:38:09.530510 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:38:09.559104 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:38:09.559920 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:38:09.560725 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:38:09.561441 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:38:09.564947 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:38:09.566198 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:38:09.568180 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:38:09.569113 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:38:09.569897 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:38:09.571130 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:38:09.572984 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:38:09.574019 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:38:09.574849 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:38:09.576185 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:38:09.577041 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:38:09.579216 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:38:09.580483 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:38:09.581384 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:38:09.582547 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:38:09.585601 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:38:09.590988 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:38:09.592030 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:38:09.594239 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:38:09.597113 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:38:09.599492 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:38:09.600367 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:38:09.603009 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:38:09.608746 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:38:09.616244 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:38:09.617067 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:38:09.619812 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:38:09.620707 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:38:09.621742 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:38:09.624376 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:38:09.628156 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:38:09.630677 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:38:09.784684 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:38:09.784911 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa524206610>]}
2021-10-02 10:38:09.902125 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:38:09.912898 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:09.917981 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:09.922149 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:09.926537 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:38:09.930224 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:38:10.022048 (MainThread): [WARNING]: Test 'test.dbt_demo_project.is_not_empty_customers_.802c79e055' (models/postgres_model/schema.yml) depends on a node named 'customers' which was not found
2021-10-02 10:38:10.037430 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 10:38:10.042942 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa524348790>]}
2021-10-02 10:38:10.054191 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5242fa4f0>]}
2021-10-02 10:38:10.054591 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 10:38:10.056992 (MainThread): 
2021-10-02 10:38:10.058155 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:38:10.060450 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 10:38:10.074228 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 10:38:10.074445 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 10:38:10.074611 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 10:38:11.517580 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.44 seconds
2021-10-02 10:38:11.519130 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 10:38:11.521133 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:38:11.527544 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:38:11.527746 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 10:38:11.527891 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:38:12.908062 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.38 seconds
2021-10-02 10:38:12.908311 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:38:12.908463 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 10:38:12.923477 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 10:38:12.924760 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 10:38:12.926414 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 10:38:12.926984 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 10:38:12.928629 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:38:12.928793 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 10:38:12.928935 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:38:14.350417 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.42 seconds
2021-10-02 10:38:14.350659 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:38:14.350805 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 10:38:14.363062 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2021-10-02 10:38:14.364197 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 10:38:14.365845 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 10:38:14.372364 (MainThread): Using postgres connection "master".
2021-10-02 10:38:14.372572 (MainThread): On master: BEGIN
2021-10-02 10:38:14.372724 (MainThread): Opening a new connection, currently in state init
2021-10-02 10:38:15.648111 (MainThread): SQL status: BEGIN in 1.28 seconds
2021-10-02 10:38:15.648353 (MainThread): Using postgres connection "master".
2021-10-02 10:38:15.648496 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 10:38:15.683543 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2021-10-02 10:38:15.684733 (MainThread): On master: ROLLBACK
2021-10-02 10:38:15.686428 (MainThread): Using postgres connection "master".
2021-10-02 10:38:15.686637 (MainThread): On master: BEGIN
2021-10-02 10:38:15.688914 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 10:38:15.689075 (MainThread): On master: COMMIT
2021-10-02 10:38:15.689197 (MainThread): Using postgres connection "master".
2021-10-02 10:38:15.689306 (MainThread): On master: COMMIT
2021-10-02 10:38:15.690448 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:38:15.690613 (MainThread): On master: Close
2021-10-02 10:38:15.690926 (MainThread): 16:08:15 | Concurrency: 1 threads (target='dev')
2021-10-02 10:38:15.691099 (MainThread): 16:08:15 | 
2021-10-02 10:38:15.694209 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:38:15.694601 (Thread-1): 16:08:15 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 10:38:15.695057 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:15.695248 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 10:38:15.697371 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:38:15.697870 (Thread-1): finished collecting timing info
2021-10-02 10:38:15.718622 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:38:15.719376 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:15.719520 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 10:38:15.719658 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:38:17.080921 (Thread-1): SQL status: BEGIN in 1.36 seconds
2021-10-02 10:38:17.081168 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:17.081318 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 10:38:17.098906 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 10:38:17.103920 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:17.104070 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 10:38:17.105426 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:38:17.107227 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:17.107354 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 10:38:17.108633 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:38:17.119325 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:38:17.119607 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:17.119788 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:38:17.124780 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:38:17.133893 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:38:17.134119 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 10:38:17.149104 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 10:38:17.150571 (Thread-1): finished collecting timing info
2021-10-02 10:38:17.150820 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 10:38:17.151320 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52441cfa0>]}
2021-10-02 10:38:17.151804 (Thread-1): 16:08:17 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.46s]
2021-10-02 10:38:17.152162 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:38:17.152371 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:38:17.152786 (Thread-1): 16:08:17 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 10:38:17.153216 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:17.153466 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:38:17.205537 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:38:17.206259 (Thread-1): finished collecting timing info
2021-10-02 10:38:17.225762 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:38:17.226535 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:17.226720 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 10:38:17.226878 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:38:18.620067 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-10-02 10:38:18.620307 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:18.620450 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 10:38:18.634349 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:38:18.636620 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:18.636766 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 10:38:18.638323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:38:18.640094 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:18.640220 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 10:38:18.641494 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:38:18.642383 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:38:18.642509 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:18.642617 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:38:18.645113 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:38:18.646560 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:38:18.646693 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 10:38:18.650032 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:38:18.650934 (Thread-1): finished collecting timing info
2021-10-02 10:38:18.651100 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 10:38:18.651438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa524288cd0>]}
2021-10-02 10:38:18.651773 (Thread-1): 16:08:18 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.50s]
2021-10-02 10:38:18.651932 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:38:18.652483 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:38:18.652729 (Thread-1): 16:08:18 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 10:38:18.653000 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:38:18.653136 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:38:18.656268 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:38:18.656847 (Thread-1): finished collecting timing info
2021-10-02 10:38:18.659602 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:38:18.660281 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:38:18.660425 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 10:38:18.660544 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:38:19.876141 (Thread-1): SQL status: BEGIN in 1.22 seconds
2021-10-02 10:38:19.876390 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:38:19.876545 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:38:19.878680 (Thread-1): Postgres error: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^

2021-10-02 10:38:19.878907 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: ROLLBACK
2021-10-02 10:38:19.880356 (Thread-1): finished collecting timing info
2021-10-02 10:38:19.880576 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 10:38:19.880951 (Thread-1): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "ind" does not exist
LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  column "ind" does not exist
  LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
                                                               ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:38:19.891600 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52424db20>]}
2021-10-02 10:38:19.891992 (Thread-1): 16:08:19 | 3 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts..... [ERROR in 1.24s]
2021-10-02 10:38:19.892184 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:38:19.892382 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:38:19.892746 (Thread-1): 16:08:19 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 10:38:19.893076 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:19.893238 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:38:19.896579 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:38:19.897142 (Thread-1): finished collecting timing info
2021-10-02 10:38:19.899570 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:38:19.900255 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:19.900458 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 10:38:19.900611 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:38:21.303481 (Thread-1): SQL status: BEGIN in 1.40 seconds
2021-10-02 10:38:21.303740 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:21.303897 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:38:21.314258 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:38:21.316712 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:21.316899 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 10:38:21.318826 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:38:21.319964 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 10:38:21.320128 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:21.320266 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 10:38:21.323820 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:38:21.327027 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:38:21.327200 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 10:38:21.328857 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:38:21.329952 (Thread-1): finished collecting timing info
2021-10-02 10:38:21.330169 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 10:38:21.330562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35be6a7b-fe66-4719-aa3f-7d590e81dcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5243aff10>]}
2021-10-02 10:38:21.330928 (Thread-1): 16:08:21 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.44s]
2021-10-02 10:38:21.331117 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:38:21.332177 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:38:21.332380 (MainThread): Using postgres connection "master".
2021-10-02 10:38:21.332521 (MainThread): On master: BEGIN
2021-10-02 10:38:21.332661 (MainThread): Opening a new connection, currently in state closed
2021-10-02 10:38:22.704382 (MainThread): SQL status: BEGIN in 1.37 seconds
2021-10-02 10:38:22.704635 (MainThread): On master: COMMIT
2021-10-02 10:38:22.704785 (MainThread): Using postgres connection "master".
2021-10-02 10:38:22.704917 (MainThread): On master: COMMIT
2021-10-02 10:38:22.706185 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:38:22.706386 (MainThread): On master: Close
2021-10-02 10:38:22.706763 (MainThread): 16:08:22 | 
2021-10-02 10:38:22.706956 (MainThread): 16:08:22 | Finished running 1 table model, 3 view models in 12.65s.
2021-10-02 10:38:22.707125 (MainThread): Connection 'master' was properly closed.
2021-10-02 10:38:22.707273 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 10:38:22.715321 (MainThread): 
2021-10-02 10:38:22.715574 (MainThread): Completed with 1 error and 0 warnings:
2021-10-02 10:38:22.715759 (MainThread): 
2021-10-02 10:38:22.715945 (MainThread): Database Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 10:38:22.716102 (MainThread):   column "ind" does not exist
2021-10-02 10:38:22.716263 (MainThread):   LINE 5: ...elect b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,IND as CNT...
2021-10-02 10:38:22.716407 (MainThread):                                                                ^
2021-10-02 10:38:22.716545 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/cust_details_ord_counts.sql
2021-10-02 10:38:22.716765 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-10-02 10:38:22.717177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5242d9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa524341fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5241aaaf0>]}
2021-10-02 10:38:22.717457 (MainThread): Flushing usage events
2021-10-02 10:39:38.814539 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 10:39:38.898348 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 10:39:38.900183 (MainThread): Tracking: tracking
2021-10-02 10:39:38.922702 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247940d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247959c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247902640>]}
2021-10-02 10:39:38.942084 (MainThread): Partial parsing not enabled
2021-10-02 10:39:39.005253 (MainThread): Parsing macros/test_empty.sql
2021-10-02 10:39:39.006088 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 10:39:39.006990 (MainThread): Parsing macros/catalog.sql
2021-10-02 10:39:39.010121 (MainThread): Parsing macros/relations.sql
2021-10-02 10:39:39.011485 (MainThread): Parsing macros/adapters.sql
2021-10-02 10:39:39.039030 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 10:39:39.040892 (MainThread): Parsing macros/core.sql
2021-10-02 10:39:39.044942 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 10:39:39.052315 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 10:39:39.064224 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 10:39:39.067056 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 10:39:39.087667 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 10:39:39.121181 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 10:39:39.144545 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 10:39:39.146242 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 10:39:39.157010 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 10:39:39.178484 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 10:39:39.192209 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 10:39:39.200058 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 10:39:39.207278 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 10:39:39.210887 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 10:39:39.211927 (MainThread): Parsing macros/etc/query.sql
2021-10-02 10:39:39.212956 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 10:39:39.214333 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 10:39:39.222257 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 10:39:39.223934 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 10:39:39.225321 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 10:39:39.278490 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 10:39:39.280269 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 10:39:39.281496 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 10:39:39.282679 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 10:39:39.284612 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 10:39:39.285592 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 10:39:39.286896 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 10:39:39.289192 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 10:39:39.295375 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 10:39:39.296444 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 10:39:39.297664 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 10:39:39.300232 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 10:39:39.301228 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 10:39:39.303468 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 10:39:39.313737 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 10:39:39.315638 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 10:39:39.316957 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 10:39:39.318474 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 10:39:39.319907 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 10:39:39.320780 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 10:39:39.323758 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 10:39:39.328699 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 10:39:39.329484 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 10:39:39.332158 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 10:39:39.333943 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 10:39:39.335334 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 10:39:39.337143 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 10:39:39.359903 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 10:39:39.360548 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 10:39:39.361182 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 10:39:39.361752 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 10:39:39.365125 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 10:39:39.366298 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 10:39:39.368162 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 10:39:39.369138 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 10:39:39.369911 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 10:39:39.371048 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 10:39:39.372810 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 10:39:39.373856 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 10:39:39.374687 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 10:39:39.376054 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 10:39:39.376871 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 10:39:39.379339 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 10:39:39.380689 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 10:39:39.381598 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 10:39:39.383000 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 10:39:39.387113 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 10:39:39.393895 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 10:39:39.395014 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 10:39:39.398031 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 10:39:39.401466 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 10:39:39.404162 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 10:39:39.405036 (MainThread): Parsing macros/sql/star.sql
2021-10-02 10:39:39.407884 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 10:39:39.414850 (MainThread): Parsing macros/sql/union.sql
2021-10-02 10:39:39.422799 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 10:39:39.423683 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 10:39:39.426248 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 10:39:39.427154 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 10:39:39.428178 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 10:39:39.430760 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 10:39:39.434593 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 10:39:39.437066 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 10:39:39.589515 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 10:39:39.589775 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247a0a430>]}
2021-10-02 10:39:39.713985 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:39.726025 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:39.730755 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:39.734480 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:39.738725 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 10:39:39.742700 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 10:39:39.837992 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 10:39:39.844079 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247a88370>]}
2021-10-02 10:39:39.854145 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2479253d0>]}
2021-10-02 10:39:39.854504 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 10:39:39.856284 (MainThread): 
2021-10-02 10:39:39.856813 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:39:39.857899 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 10:39:39.868625 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 10:39:39.868834 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 10:39:39.868995 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 10:39:41.972399 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.10 seconds
2021-10-02 10:39:41.973866 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 10:39:41.975930 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:39:41.984158 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:39:41.984373 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 10:39:41.984519 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:39:43.585335 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.60 seconds
2021-10-02 10:39:43.585526 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 10:39:43.585643 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 10:39:43.596391 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 10:39:43.597429 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 10:39:43.598819 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 10:39:43.599272 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 10:39:43.600697 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:39:43.600830 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 10:39:43.600944 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 10:39:45.072528 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-10-02 10:39:45.072756 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 10:39:45.072897 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 10:39:45.084707 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-02 10:39:45.085979 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 10:39:45.087472 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 10:39:45.093242 (MainThread): Using postgres connection "master".
2021-10-02 10:39:45.093446 (MainThread): On master: BEGIN
2021-10-02 10:39:45.093587 (MainThread): Opening a new connection, currently in state init
2021-10-02 10:39:46.381345 (MainThread): SQL status: BEGIN in 1.29 seconds
2021-10-02 10:39:46.381541 (MainThread): Using postgres connection "master".
2021-10-02 10:39:46.381660 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 10:39:46.420377 (MainThread): SQL status: SELECT 5 in 0.04 seconds
2021-10-02 10:39:46.421780 (MainThread): On master: ROLLBACK
2021-10-02 10:39:46.423554 (MainThread): Using postgres connection "master".
2021-10-02 10:39:46.423753 (MainThread): On master: BEGIN
2021-10-02 10:39:46.427064 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 10:39:46.427260 (MainThread): On master: COMMIT
2021-10-02 10:39:46.427387 (MainThread): Using postgres connection "master".
2021-10-02 10:39:46.427498 (MainThread): On master: COMMIT
2021-10-02 10:39:46.428709 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:39:46.428882 (MainThread): On master: Close
2021-10-02 10:39:46.429211 (MainThread): 16:09:46 | Concurrency: 1 threads (target='dev')
2021-10-02 10:39:46.429374 (MainThread): 16:09:46 | 
2021-10-02 10:39:46.431706 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:39:46.432029 (Thread-1): 16:09:46 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 10:39:46.432543 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:46.432750 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 10:39:46.435329 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:39:46.435831 (Thread-1): finished collecting timing info
2021-10-02 10:39:46.458485 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 10:39:46.459149 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:46.459358 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 10:39:46.459532 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:39:47.855416 (Thread-1): SQL status: BEGIN in 1.40 seconds
2021-10-02 10:39:47.855674 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:47.855796 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 10:39:47.879916 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 10:39:47.886360 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:47.886570 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 10:39:47.888521 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:39:47.890948 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:47.891126 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 10:39:47.893076 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:39:47.904103 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:39:47.904317 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:47.904461 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 10:39:47.908040 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:39:47.913954 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 10:39:47.914143 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 10:39:47.926199 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 10:39:47.927395 (Thread-1): finished collecting timing info
2021-10-02 10:39:47.927603 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 10:39:47.928013 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247e8b790>]}
2021-10-02 10:39:47.928395 (Thread-1): 16:09:47 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.50s]
2021-10-02 10:39:47.928595 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 10:39:47.928800 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:39:47.929229 (Thread-1): 16:09:47 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 10:39:47.929654 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:47.929859 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:39:47.973413 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:39:47.974243 (Thread-1): finished collecting timing info
2021-10-02 10:39:47.994042 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 10:39:47.994847 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:47.995102 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 10:39:47.995294 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:39:49.261541 (Thread-1): SQL status: BEGIN in 1.27 seconds
2021-10-02 10:39:49.261802 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:49.261954 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 10:39:49.273696 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:39:49.276198 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:49.276393 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 10:39:49.278211 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:39:49.280331 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:49.280489 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 10:39:49.282292 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:39:49.283329 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:39:49.283479 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:49.283618 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 10:39:49.286058 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:39:49.287813 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 10:39:49.287970 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 10:39:49.291988 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:39:49.293065 (Thread-1): finished collecting timing info
2021-10-02 10:39:49.293260 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 10:39:49.293650 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2479401c0>]}
2021-10-02 10:39:49.293983 (Thread-1): 16:09:49 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.36s]
2021-10-02 10:39:49.294162 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 10:39:49.294734 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:39:49.295009 (Thread-1): 16:09:49 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 10:39:49.295318 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:49.295475 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:39:49.299191 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:39:49.299787 (Thread-1): finished collecting timing info
2021-10-02 10:39:49.302321 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 10:39:49.302987 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:49.303149 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 10:39:49.303288 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:39:50.555472 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-10-02 10:39:50.555711 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:50.555854 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:39:50.566276 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:39:50.568259 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:50.568392 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 10:39:50.570125 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:39:50.571059 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 10:39:50.571195 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:50.571309 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 10:39:50.573810 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:39:50.575121 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 10:39:50.575243 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 10:39:50.576314 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:39:50.577189 (Thread-1): finished collecting timing info
2021-10-02 10:39:50.577347 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 10:39:50.577654 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24795f490>]}
2021-10-02 10:39:50.577953 (Thread-1): 16:09:50 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.28s]
2021-10-02 10:39:50.578108 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 10:39:50.578276 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:39:50.578567 (Thread-1): 16:09:50 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 10:39:50.578830 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:50.578961 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:39:50.582377 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:39:50.582951 (Thread-1): finished collecting timing info
2021-10-02 10:39:50.586480 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 10:39:50.587166 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:50.587314 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 10:39:50.587427 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 10:39:52.247639 (Thread-1): SQL status: BEGIN in 1.66 seconds
2021-10-02 10:39:52.247874 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:52.248019 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 10:39:52.260239 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 10:39:52.262709 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:52.262904 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 10:39:52.264943 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 10:39:52.266118 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 10:39:52.266290 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:52.266425 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 10:39:52.269824 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:39:52.272082 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 10:39:52.272386 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 10:39:52.274282 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 10:39:52.275556 (Thread-1): finished collecting timing info
2021-10-02 10:39:52.275767 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 10:39:52.276164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5511aad6-da60-4221-ad41-ab11cdacdb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247ca6d90>]}
2021-10-02 10:39:52.276590 (Thread-1): 16:09:52 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.70s]
2021-10-02 10:39:52.276812 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 10:39:52.277836 (MainThread): Acquiring new postgres connection "master".
2021-10-02 10:39:52.278037 (MainThread): Using postgres connection "master".
2021-10-02 10:39:52.278185 (MainThread): On master: BEGIN
2021-10-02 10:39:52.278324 (MainThread): Opening a new connection, currently in state closed
2021-10-02 10:39:53.767531 (MainThread): SQL status: BEGIN in 1.49 seconds
2021-10-02 10:39:53.767772 (MainThread): On master: COMMIT
2021-10-02 10:39:53.767892 (MainThread): Using postgres connection "master".
2021-10-02 10:39:53.768000 (MainThread): On master: COMMIT
2021-10-02 10:39:53.769029 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 10:39:53.769192 (MainThread): On master: Close
2021-10-02 10:39:53.769540 (MainThread): 16:09:53 | 
2021-10-02 10:39:53.769698 (MainThread): 16:09:53 | Finished running 1 table model, 3 view models in 13.91s.
2021-10-02 10:39:53.769869 (MainThread): Connection 'master' was properly closed.
2021-10-02 10:39:53.769975 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 10:39:53.776988 (MainThread): 
2021-10-02 10:39:53.777241 (MainThread): Completed successfully
2021-10-02 10:39:53.777439 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 10:39:53.777685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247902850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247c7a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc247c7a190>]}
2021-10-02 10:39:53.777951 (MainThread): Flushing usage events
2021-10-02 12:06:28.623717 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:06:28.741225 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 12:06:28.742888 (MainThread): Tracking: tracking
2021-10-02 12:06:28.913033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd39017b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3900fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38fc4640>]}
2021-10-02 12:06:28.935382 (MainThread): Partial parsing not enabled
2021-10-02 12:06:29.003378 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:06:29.004146 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:06:29.005074 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:06:29.008488 (MainThread): Parsing macros/relations.sql
2021-10-02 12:06:29.009742 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:06:29.031618 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:06:29.033246 (MainThread): Parsing macros/core.sql
2021-10-02 12:06:29.036667 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:06:29.043654 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:06:29.053154 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:06:29.054730 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:06:29.072198 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:06:29.104489 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:06:29.124959 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:06:29.126491 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:06:29.136440 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:06:29.158349 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:06:29.171616 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:06:29.179571 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:06:29.187101 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:06:29.190910 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:06:29.191757 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:06:29.192712 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:06:29.194120 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:06:29.203758 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:06:29.205766 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:06:29.207723 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:06:29.263731 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:06:29.265542 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:06:29.266655 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:06:29.267836 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:06:29.269768 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:06:29.270850 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:06:29.272169 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:06:29.274249 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:06:29.279773 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:06:29.280808 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:06:29.282020 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:06:29.284228 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:06:29.285217 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:06:29.287317 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:06:29.296665 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:06:29.298548 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:06:29.300041 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:06:29.301660 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:06:29.303094 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:06:29.303966 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:06:29.307107 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:06:29.312138 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:06:29.312847 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:06:29.315507 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:06:29.317285 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:06:29.318705 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:06:29.320494 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:06:29.343560 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:06:29.344956 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:06:29.345626 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:06:29.346185 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:06:29.349402 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:06:29.350536 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:06:29.352396 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:06:29.353474 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:06:29.354237 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:06:29.355313 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:06:29.357072 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:06:29.358497 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:06:29.359373 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:06:29.360836 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:06:29.361639 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:06:29.363849 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:06:29.365176 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:06:29.366468 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:06:29.367643 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:06:29.370744 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:06:29.375956 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:06:29.376970 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:06:29.379174 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:06:29.382162 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:06:29.384285 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:06:29.385100 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:06:29.387515 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:06:29.393112 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:06:29.400607 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:06:29.401375 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:06:29.403996 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:06:29.404851 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:06:29.405893 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:06:29.408270 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:06:29.411850 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:06:29.414268 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:06:29.562113 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:06:29.562338 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd390cc430>]}
2021-10-02 12:06:29.677884 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:29.687080 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:29.690833 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:29.693985 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:29.697642 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:06:29.701018 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:06:29.791533 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:06:29.796389 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd39149220>]}
2021-10-02 12:06:29.804794 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38fe63d0>]}
2021-10-02 12:06:29.805117 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:06:29.806792 (MainThread): 
2021-10-02 12:06:29.807214 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:06:29.808130 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 12:06:29.816798 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 12:06:29.816969 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 12:06:29.817113 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 12:06:32.589974 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.77 seconds
2021-10-02 12:06:32.591526 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 12:06:32.593596 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:06:32.600525 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:06:32.600733 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:06:32.600877 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:06:33.924191 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.32 seconds
2021-10-02 12:06:33.924441 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:06:33.924593 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:06:33.941776 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2021-10-02 12:06:33.942970 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:06:33.944161 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:06:33.944619 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:06:33.946161 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:06:33.946295 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:06:33.946410 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:06:35.345808 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.40 seconds
2021-10-02 12:06:35.346028 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:06:35.346154 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:06:35.355825 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:06:35.356777 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:06:35.357982 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:06:35.362700 (MainThread): Using postgres connection "master".
2021-10-02 12:06:35.362966 (MainThread): On master: BEGIN
2021-10-02 12:06:35.363089 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:06:36.601218 (MainThread): SQL status: BEGIN in 1.24 seconds
2021-10-02 12:06:36.601560 (MainThread): Using postgres connection "master".
2021-10-02 12:06:36.601731 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:06:36.657732 (MainThread): SQL status: SELECT 7 in 0.06 seconds
2021-10-02 12:06:36.658948 (MainThread): On master: ROLLBACK
2021-10-02 12:06:36.660360 (MainThread): Using postgres connection "master".
2021-10-02 12:06:36.660501 (MainThread): On master: BEGIN
2021-10-02 12:06:36.662742 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 12:06:36.662896 (MainThread): On master: COMMIT
2021-10-02 12:06:36.663015 (MainThread): Using postgres connection "master".
2021-10-02 12:06:36.663119 (MainThread): On master: COMMIT
2021-10-02 12:06:36.664247 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:06:36.664397 (MainThread): On master: Close
2021-10-02 12:06:36.664697 (MainThread): 17:36:36 | Concurrency: 1 threads (target='dev')
2021-10-02 12:06:36.664872 (MainThread): 17:36:36 | 
2021-10-02 12:06:36.667766 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:06:36.668157 (Thread-1): 17:36:36 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 12:06:36.668670 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:36.668841 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 12:06:36.671074 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:06:36.672762 (Thread-1): finished collecting timing info
2021-10-02 12:06:36.698306 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:06:36.699001 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:36.699186 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 12:06:36.699347 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:06:38.112085 (Thread-1): SQL status: BEGIN in 1.41 seconds
2021-10-02 12:06:38.112327 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:38.112479 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 12:06:38.139378 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 12:06:38.144387 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:38.144548 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 12:06:38.146249 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:06:38.148133 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:38.148289 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 12:06:38.149643 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:06:38.157788 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:06:38.157943 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:38.158055 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:06:38.162780 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:06:38.167537 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:06:38.167711 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 12:06:38.181462 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 12:06:38.182626 (Thread-1): finished collecting timing info
2021-10-02 12:06:38.182828 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 12:06:38.183195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3947d5b0>]}
2021-10-02 12:06:38.183516 (Thread-1): 17:36:38 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.51s]
2021-10-02 12:06:38.183684 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:06:38.183843 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:06:38.184125 (Thread-1): 17:36:38 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 12:06:38.184400 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:38.184541 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:06:38.231662 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:06:38.232516 (Thread-1): finished collecting timing info
2021-10-02 12:06:38.255742 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:06:38.256536 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:38.256731 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 12:06:38.256948 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:06:39.650557 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-10-02 12:06:39.650869 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:39.651077 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 12:06:39.669430 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 12:06:39.671947 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:39.672113 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 12:06:39.675223 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:06:39.677400 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:39.677558 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 12:06:39.679079 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:06:39.680119 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:06:39.680281 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:39.680424 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:06:39.684159 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:06:39.685982 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:06:39.686157 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 12:06:39.693534 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 12:06:39.694675 (Thread-1): finished collecting timing info
2021-10-02 12:06:39.694883 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 12:06:39.695268 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd39017160>]}
2021-10-02 12:06:39.695643 (Thread-1): 17:36:39 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.51s]
2021-10-02 12:06:39.695861 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:06:39.696651 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:06:39.697076 (Thread-1): 17:36:39 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 12:06:39.697440 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:39.697614 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:06:39.702524 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:06:39.703578 (Thread-1): finished collecting timing info
2021-10-02 12:06:39.706307 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:06:39.707102 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:39.707277 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 12:06:39.707422 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:06:40.991541 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-10-02 12:06:40.991783 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:40.991934 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:06:41.004727 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:06:41.007260 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:41.007447 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 12:06:41.009582 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:06:41.010673 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:06:41.010843 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:41.010987 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:06:41.014854 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:06:41.016760 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:06:41.016947 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 12:06:41.018636 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:06:41.019678 (Thread-1): finished collecting timing info
2021-10-02 12:06:41.019873 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 12:06:41.020254 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd39100fd0>]}
2021-10-02 12:06:41.020635 (Thread-1): 17:36:41 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.32s]
2021-10-02 12:06:41.020819 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:06:41.021002 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:06:41.021429 (Thread-1): 17:36:41 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 12:06:41.021785 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:41.021959 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:06:41.026120 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:06:41.026791 (Thread-1): finished collecting timing info
2021-10-02 12:06:41.030619 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:06:41.031397 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:41.031658 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 12:06:41.031821 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:06:42.254357 (Thread-1): SQL status: BEGIN in 1.22 seconds
2021-10-02 12:06:42.254604 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:42.254755 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:06:42.280850 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-02 12:06:42.283242 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:42.283407 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 12:06:42.285537 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:06:42.286613 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:06:42.286768 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:42.286899 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:06:42.290307 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:06:42.291985 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:06:42.292148 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 12:06:42.293702 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:06:42.294761 (Thread-1): finished collecting timing info
2021-10-02 12:06:42.294958 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 12:06:42.295336 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e001f3-1e69-4250-883a-6f0dafce7136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3935ae50>]}
2021-10-02 12:06:42.295685 (Thread-1): 17:36:42 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.27s]
2021-10-02 12:06:42.295875 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:06:42.296799 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:06:42.296994 (MainThread): Using postgres connection "master".
2021-10-02 12:06:42.297130 (MainThread): On master: BEGIN
2021-10-02 12:06:42.297263 (MainThread): Opening a new connection, currently in state closed
2021-10-02 12:06:43.531777 (MainThread): SQL status: BEGIN in 1.23 seconds
2021-10-02 12:06:43.531989 (MainThread): On master: COMMIT
2021-10-02 12:06:43.532113 (MainThread): Using postgres connection "master".
2021-10-02 12:06:43.532220 (MainThread): On master: COMMIT
2021-10-02 12:06:43.533448 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:06:43.533618 (MainThread): On master: Close
2021-10-02 12:06:43.533954 (MainThread): 17:36:43 | 
2021-10-02 12:06:43.534113 (MainThread): 17:36:43 | Finished running 1 table model, 3 view models in 13.73s.
2021-10-02 12:06:43.534245 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:06:43.534353 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 12:06:43.543375 (MainThread): 
2021-10-02 12:06:43.543597 (MainThread): Completed successfully
2021-10-02 12:06:43.543812 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 12:06:43.544038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd38fc4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd390c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd393ae040>]}
2021-10-02 12:06:43.544280 (MainThread): Flushing usage events
2021-10-02 12:08:15.724774 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:08:15.810955 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 12:08:15.812977 (MainThread): Tracking: tracking
2021-10-02 12:08:15.828073 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a10ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a119b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb049f9d5e0>]}
2021-10-02 12:08:15.849436 (MainThread): Partial parsing not enabled
2021-10-02 12:08:15.905600 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:08:15.906544 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:08:15.907680 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:08:15.911327 (MainThread): Parsing macros/relations.sql
2021-10-02 12:08:15.913060 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:08:15.941830 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:08:15.943957 (MainThread): Parsing macros/core.sql
2021-10-02 12:08:15.948369 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:08:15.956693 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:08:15.970027 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:08:15.972277 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:08:15.995790 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:08:16.035788 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:08:16.056713 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:08:16.058696 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:08:16.068776 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:08:16.088972 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:08:16.102620 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:08:16.110541 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:08:16.118517 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:08:16.122393 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:08:16.123209 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:08:16.124084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:08:16.125683 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:08:16.133886 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:08:16.135604 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:08:16.137028 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:08:16.194191 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:08:16.196043 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:08:16.197586 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:08:16.199062 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:08:16.201341 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:08:16.202554 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:08:16.204252 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:08:16.207156 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:08:16.216255 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:08:16.217790 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:08:16.219697 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:08:16.224113 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:08:16.225549 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:08:16.228615 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:08:16.241520 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:08:16.243642 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:08:16.245155 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:08:16.247153 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:08:16.248820 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:08:16.249917 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:08:16.253948 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:08:16.259395 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:08:16.260166 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:08:16.263172 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:08:16.265170 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:08:16.266634 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:08:16.268431 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:08:16.291185 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:08:16.291841 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:08:16.292484 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:08:16.293060 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:08:16.296125 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:08:16.297327 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:08:16.299186 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:08:16.300121 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:08:16.300898 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:08:16.302017 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:08:16.303780 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:08:16.304819 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:08:16.305663 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:08:16.307026 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:08:16.307894 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:08:16.310098 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:08:16.311371 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:08:16.312282 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:08:16.313460 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:08:16.316556 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:08:16.322000 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:08:16.323201 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:08:16.325457 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:08:16.328676 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:08:16.330958 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:08:16.331799 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:08:16.334248 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:08:16.339909 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:08:16.346876 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:08:16.347652 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:08:16.350125 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:08:16.351003 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:08:16.352035 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:08:16.354558 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:08:16.358118 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:08:16.360632 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:08:16.515040 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:08:16.515263 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a1cc9d0>]}
2021-10-02 12:08:16.643132 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:16.654357 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:16.659569 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:16.663764 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:16.668399 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:08:16.672563 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:08:16.777720 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:08:16.783303 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a270640>]}
2021-10-02 12:08:16.791624 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb049fc6370>]}
2021-10-02 12:08:16.791957 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:08:16.793547 (MainThread): 
2021-10-02 12:08:16.794010 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:08:16.795115 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 12:08:16.805751 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 12:08:16.805978 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 12:08:16.806140 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 12:08:18.269018 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.46 seconds
2021-10-02 12:08:18.270810 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 12:08:18.274300 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:08:18.282723 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:08:18.282954 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:08:18.283104 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:08:19.615628 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.33 seconds
2021-10-02 12:08:19.616019 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:08:19.616215 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:08:19.638949 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 12:08:19.640206 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:08:19.642299 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:08:19.642881 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:08:19.644681 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:08:19.644899 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:08:19.645081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:08:20.965278 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.32 seconds
2021-10-02 12:08:20.965499 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:08:20.965637 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:08:20.975691 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-02 12:08:20.976762 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:08:20.978033 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:08:20.982707 (MainThread): Using postgres connection "master".
2021-10-02 12:08:20.982987 (MainThread): On master: BEGIN
2021-10-02 12:08:20.983133 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:08:22.247546 (MainThread): SQL status: BEGIN in 1.26 seconds
2021-10-02 12:08:22.247796 (MainThread): Using postgres connection "master".
2021-10-02 12:08:22.247943 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:08:22.285861 (MainThread): SQL status: SELECT 5 in 0.04 seconds
2021-10-02 12:08:22.287064 (MainThread): On master: ROLLBACK
2021-10-02 12:08:22.288350 (MainThread): Using postgres connection "master".
2021-10-02 12:08:22.288489 (MainThread): On master: BEGIN
2021-10-02 12:08:22.290615 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 12:08:22.290769 (MainThread): On master: COMMIT
2021-10-02 12:08:22.290889 (MainThread): Using postgres connection "master".
2021-10-02 12:08:22.290997 (MainThread): On master: COMMIT
2021-10-02 12:08:22.292183 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:08:22.292354 (MainThread): On master: Close
2021-10-02 12:08:22.292674 (MainThread): 17:38:22 | Concurrency: 1 threads (target='dev')
2021-10-02 12:08:22.292838 (MainThread): 17:38:22 | 
2021-10-02 12:08:22.294702 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:08:22.295029 (Thread-1): 17:38:22 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 12:08:22.295424 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:22.295626 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 12:08:22.298935 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:08:22.299692 (Thread-1): finished collecting timing info
2021-10-02 12:08:22.324567 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:08:22.325271 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:22.325455 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 12:08:22.325600 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:08:23.548541 (Thread-1): SQL status: BEGIN in 1.22 seconds
2021-10-02 12:08:23.548781 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:23.548927 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 12:08:23.572231 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 12:08:23.578610 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:23.578819 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 12:08:23.580870 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:08:23.583669 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:23.583887 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 12:08:23.585901 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:08:23.597746 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:08:23.597996 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:23.598164 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:08:23.603083 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:08:23.609008 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:08:23.609208 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 12:08:23.619013 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 12:08:23.620092 (Thread-1): finished collecting timing info
2021-10-02 12:08:23.620312 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 12:08:23.620659 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a445d90>]}
2021-10-02 12:08:23.621015 (Thread-1): 17:38:23 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.33s]
2021-10-02 12:08:23.621227 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:08:23.621464 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:08:23.621754 (Thread-1): 17:38:23 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 12:08:23.622016 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:23.622159 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:08:23.666482 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:08:23.667319 (Thread-1): finished collecting timing info
2021-10-02 12:08:23.686281 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:08:23.687088 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:23.687297 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 12:08:23.687561 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:08:25.032028 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-10-02 12:08:25.032218 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:25.032348 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 12:08:25.042617 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:08:25.044742 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:25.044882 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 12:08:25.046558 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:08:25.048302 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:25.048428 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 12:08:25.049954 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:08:25.050837 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:08:25.050969 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:25.051078 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:08:25.054468 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:08:25.055935 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:08:25.056069 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 12:08:25.060295 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:08:25.061197 (Thread-1): finished collecting timing info
2021-10-02 12:08:25.061360 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 12:08:25.061704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a10ac40>]}
2021-10-02 12:08:25.062006 (Thread-1): 17:38:25 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.44s]
2021-10-02 12:08:25.062166 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:08:25.062678 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:08:25.062945 (Thread-1): 17:38:25 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 12:08:25.063229 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:25.063366 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:08:25.066762 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:08:25.067242 (Thread-1): finished collecting timing info
2021-10-02 12:08:25.069333 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:08:25.069961 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:25.070099 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 12:08:25.070216 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:08:26.721764 (Thread-1): SQL status: BEGIN in 1.65 seconds
2021-10-02 12:08:26.722007 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:26.722165 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:08:26.742647 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 12:08:26.744954 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:26.745121 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 12:08:26.747086 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:08:26.748195 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:08:26.748357 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:26.748493 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:08:26.756174 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 12:08:26.757793 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:08:26.757954 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 12:08:26.759493 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:08:26.760422 (Thread-1): finished collecting timing info
2021-10-02 12:08:26.760595 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 12:08:26.760932 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a119280>]}
2021-10-02 12:08:26.761273 (Thread-1): 17:38:26 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.70s]
2021-10-02 12:08:26.761475 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:08:26.761726 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:08:26.762007 (Thread-1): 17:38:26 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 12:08:26.762283 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:26.762418 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:08:26.765703 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:08:26.766265 (Thread-1): finished collecting timing info
2021-10-02 12:08:26.769909 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:08:26.770507 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:26.770679 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 12:08:26.770822 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:08:28.218137 (Thread-1): SQL status: BEGIN in 1.45 seconds
2021-10-02 12:08:28.218566 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:28.218771 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:08:28.239744 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 12:08:28.242381 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:28.242574 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 12:08:28.244878 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:08:28.246336 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:08:28.246545 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:28.246727 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:08:28.251324 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:08:28.253665 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:08:28.253972 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 12:08:28.256032 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:08:28.257392 (Thread-1): finished collecting timing info
2021-10-02 12:08:28.257628 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 12:08:28.258105 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f5a75a3-9440-4f30-b46d-0f7aa760f038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a365d30>]}
2021-10-02 12:08:28.258538 (Thread-1): 17:38:28 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.50s]
2021-10-02 12:08:28.258751 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:08:28.259966 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:08:28.260351 (MainThread): Using postgres connection "master".
2021-10-02 12:08:28.260699 (MainThread): On master: BEGIN
2021-10-02 12:08:28.260948 (MainThread): Opening a new connection, currently in state closed
2021-10-02 12:08:29.726107 (MainThread): SQL status: BEGIN in 1.47 seconds
2021-10-02 12:08:29.726552 (MainThread): On master: COMMIT
2021-10-02 12:08:29.726814 (MainThread): Using postgres connection "master".
2021-10-02 12:08:29.726995 (MainThread): On master: COMMIT
2021-10-02 12:08:29.729032 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:08:29.729289 (MainThread): On master: Close
2021-10-02 12:08:29.729768 (MainThread): 17:38:29 | 
2021-10-02 12:08:29.729970 (MainThread): 17:38:29 | Finished running 1 table model, 3 view models in 12.94s.
2021-10-02 12:08:29.730176 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:08:29.730380 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 12:08:29.738834 (MainThread): 
2021-10-02 12:08:29.739161 (MainThread): Completed successfully
2021-10-02 12:08:29.739467 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 12:08:29.739818 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb049fb7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a307e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a365f70>]}
2021-10-02 12:08:29.740186 (MainThread): Flushing usage events
2021-10-02 12:09:47.682072 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:09:47.768968 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 12:09:47.771191 (MainThread): Tracking: tracking
2021-10-02 12:09:47.790152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f923850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f919eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f923c70>]}
2021-10-02 12:09:47.811635 (MainThread): Partial parsing not enabled
2021-10-02 12:09:47.852214 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:09:47.852947 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:09:47.853835 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:09:47.856570 (MainThread): Parsing macros/relations.sql
2021-10-02 12:09:47.857811 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:09:47.880392 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:09:47.882336 (MainThread): Parsing macros/core.sql
2021-10-02 12:09:47.886510 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:09:47.894100 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:09:47.906033 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:09:47.908112 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:09:47.930051 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:09:47.973235 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:09:47.996673 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:09:47.998306 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:09:48.008100 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:09:48.027883 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:09:48.040869 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:09:48.048365 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:09:48.055220 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:09:48.058935 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:09:48.059732 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:09:48.060905 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:09:48.062369 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:09:48.070271 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:09:48.071931 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:09:48.073313 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:09:48.126562 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:09:48.128404 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:09:48.129463 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:09:48.130701 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:09:48.132749 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:09:48.133837 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:09:48.135238 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:09:48.137382 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:09:48.143734 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:09:48.145008 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:09:48.146365 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:09:48.148833 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:09:48.149868 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:09:48.152072 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:09:48.161647 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:09:48.163418 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:09:48.164767 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:09:48.166288 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:09:48.167721 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:09:48.168669 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:09:48.171717 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:09:48.176951 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:09:48.177671 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:09:48.180255 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:09:48.181981 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:09:48.183639 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:09:48.185390 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:09:48.212570 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:09:48.213457 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:09:48.214536 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:09:48.216041 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:09:48.220603 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:09:48.222301 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:09:48.224768 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:09:48.225999 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:09:48.226983 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:09:48.228651 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:09:48.230932 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:09:48.232483 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:09:48.233818 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:09:48.235812 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:09:48.236889 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:09:48.239413 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:09:48.240789 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:09:48.241733 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:09:48.243076 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:09:48.246483 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:09:48.252454 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:09:48.253636 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:09:48.255840 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:09:48.258818 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:09:48.261119 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:09:48.262023 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:09:48.264844 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:09:48.276938 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:09:48.287191 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:09:48.288215 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:09:48.291480 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:09:48.292651 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:09:48.294065 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:09:48.297368 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:09:48.301688 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:09:48.304603 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:09:48.460242 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:09:48.460490 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f9cae80>]}
2021-10-02 12:09:48.577786 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:48.588407 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:09:48.593202 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:48.597232 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:48.601844 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:09:48.605503 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:09:48.696719 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:09:48.702412 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fb47430>]}
2021-10-02 12:09:48.710341 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f9a3970>]}
2021-10-02 12:09:48.710700 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:09:48.712320 (MainThread): 
2021-10-02 12:09:48.712793 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:09:48.713743 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 12:09:48.723413 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 12:09:48.723604 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 12:09:48.723748 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 12:09:50.103659 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.38 seconds
2021-10-02 12:09:50.105202 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 12:09:50.107076 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:09:50.113263 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:09:50.113474 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:09:50.113624 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:09:51.430808 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.32 seconds
2021-10-02 12:09:51.431048 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:09:51.431193 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:09:51.443127 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-10-02 12:09:51.444484 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:09:51.446054 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:09:51.446604 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:09:51.448559 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:09:51.448766 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:09:51.448912 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:09:52.877042 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.43 seconds
2021-10-02 12:09:52.877275 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:09:52.877420 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:09:52.889873 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:09:52.891030 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:09:52.892722 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:09:52.898845 (MainThread): Using postgres connection "master".
2021-10-02 12:09:52.899094 (MainThread): On master: BEGIN
2021-10-02 12:09:52.899331 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:09:54.212064 (MainThread): SQL status: BEGIN in 1.31 seconds
2021-10-02 12:09:54.212303 (MainThread): Using postgres connection "master".
2021-10-02 12:09:54.212451 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:09:54.269787 (MainThread): SQL status: SELECT 7 in 0.06 seconds
2021-10-02 12:09:54.271014 (MainThread): On master: ROLLBACK
2021-10-02 12:09:54.272860 (MainThread): Using postgres connection "master".
2021-10-02 12:09:54.273030 (MainThread): On master: BEGIN
2021-10-02 12:09:54.275091 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 12:09:54.275266 (MainThread): On master: COMMIT
2021-10-02 12:09:54.275389 (MainThread): Using postgres connection "master".
2021-10-02 12:09:54.275499 (MainThread): On master: COMMIT
2021-10-02 12:09:54.276525 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:09:54.276689 (MainThread): On master: Close
2021-10-02 12:09:54.276999 (MainThread): 17:39:54 | Concurrency: 1 threads (target='dev')
2021-10-02 12:09:54.277156 (MainThread): 17:39:54 | 
2021-10-02 12:09:54.278836 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:09:54.279118 (Thread-1): 17:39:54 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 12:09:54.279448 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:54.279615 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 12:09:54.282338 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:09:54.282868 (Thread-1): finished collecting timing info
2021-10-02 12:09:54.305898 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:09:54.306613 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:54.306792 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 12:09:54.306935 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:09:55.557730 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-10-02 12:09:55.557934 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:55.558052 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 12:09:55.574587 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 12:09:55.579686 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:55.579865 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 12:09:55.581955 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:09:55.584046 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:55.584229 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 12:09:55.586377 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:09:55.597285 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:09:55.597489 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:55.597633 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:09:55.601928 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:09:55.608200 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:09:55.608399 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 12:09:55.620820 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 12:09:55.621915 (Thread-1): finished collecting timing info
2021-10-02 12:09:55.622092 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 12:09:55.622478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fd3e5b0>]}
2021-10-02 12:09:55.622886 (Thread-1): 17:39:55 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.34s]
2021-10-02 12:09:55.623076 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:09:55.623267 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:09:55.623611 (Thread-1): 17:39:55 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 12:09:55.623958 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:55.624101 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:09:55.674611 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:09:55.675549 (Thread-1): finished collecting timing info
2021-10-02 12:09:55.697078 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:09:55.697910 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:55.698122 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 12:09:55.698320 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:09:57.209200 (Thread-1): SQL status: BEGIN in 1.51 seconds
2021-10-02 12:09:57.209509 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:57.209674 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 12:09:57.225381 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 12:09:57.228456 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:57.228654 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 12:09:57.230696 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:09:57.232888 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:57.233058 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 12:09:57.235567 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:09:57.237065 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:09:57.237251 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:57.237396 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:09:57.240595 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:09:57.242633 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:09:57.242833 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 12:09:57.249227 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 12:09:57.250542 (Thread-1): finished collecting timing info
2021-10-02 12:09:57.250774 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 12:09:57.251196 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f9237f0>]}
2021-10-02 12:09:57.251578 (Thread-1): 17:39:57 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.63s]
2021-10-02 12:09:57.251780 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:09:57.252362 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:09:57.252780 (Thread-1): 17:39:57 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 12:09:57.253134 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:57.253309 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:09:57.257609 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:09:57.258328 (Thread-1): finished collecting timing info
2021-10-02 12:09:57.261570 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:09:57.262309 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:57.262572 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 12:09:57.262753 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:09:58.643473 (Thread-1): SQL status: BEGIN in 1.38 seconds
2021-10-02 12:09:58.643707 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:58.643851 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'NA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:09:58.653419 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:09:58.655412 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:58.655565 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 12:09:58.657977 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:09:58.658838 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:09:58.658966 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:58.659075 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:09:58.661727 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:09:58.663085 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:09:58.663212 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 12:09:58.664592 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:09:58.665473 (Thread-1): finished collecting timing info
2021-10-02 12:09:58.665632 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 12:09:58.665947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f9ff0d0>]}
2021-10-02 12:09:58.666268 (Thread-1): 17:39:58 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.41s]
2021-10-02 12:09:58.666426 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:09:58.666577 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:09:58.666961 (Thread-1): 17:39:58 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 12:09:58.667258 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:09:58.667399 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:09:58.670395 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:09:58.671004 (Thread-1): finished collecting timing info
2021-10-02 12:09:58.674390 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:09:58.675056 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:09:58.675205 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 12:09:58.675331 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:10:00.061606 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-10-02 12:10:00.061859 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:10:00.062014 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'NA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:10:00.073215 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:10:00.075655 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:10:00.075821 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 12:10:00.077483 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:10:00.078583 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:10:00.078753 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:10:00.078896 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:10:00.082076 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:10:00.083710 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:10:00.083868 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 12:10:00.085398 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:10:00.086420 (Thread-1): finished collecting timing info
2021-10-02 12:10:00.086616 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 12:10:00.086987 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caef3a19-aec6-428b-a339-af89fead228d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fc3ae50>]}
2021-10-02 12:10:00.087336 (Thread-1): 17:40:00 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.42s]
2021-10-02 12:10:00.087527 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:10:00.088445 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:10:00.088640 (MainThread): Using postgres connection "master".
2021-10-02 12:10:00.088780 (MainThread): On master: BEGIN
2021-10-02 12:10:00.088914 (MainThread): Opening a new connection, currently in state closed
2021-10-02 12:10:01.380924 (MainThread): SQL status: BEGIN in 1.29 seconds
2021-10-02 12:10:01.381242 (MainThread): On master: COMMIT
2021-10-02 12:10:01.381404 (MainThread): Using postgres connection "master".
2021-10-02 12:10:01.381548 (MainThread): On master: COMMIT
2021-10-02 12:10:01.382998 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:10:01.383244 (MainThread): On master: Close
2021-10-02 12:10:01.383821 (MainThread): 17:40:01 | 
2021-10-02 12:10:01.384072 (MainThread): 17:40:01 | Finished running 1 table model, 3 view models in 12.67s.
2021-10-02 12:10:01.384353 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:10:01.384551 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 12:10:01.395461 (MainThread): 
2021-10-02 12:10:01.395804 (MainThread): Completed successfully
2021-10-02 12:10:01.396087 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 12:10:01.396513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fc3ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fc74af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fc6c1c0>]}
2021-10-02 12:10:01.396878 (MainThread): Flushing usage events
2021-10-02 12:10:40.754503 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:10:40.840986 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 12:10:40.843375 (MainThread): Tracking: tracking
2021-10-02 12:10:40.862703 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4677bcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4677bc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4677bc3d0>]}
2021-10-02 12:10:40.884656 (MainThread): Partial parsing not enabled
2021-10-02 12:10:40.937021 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:10:40.937816 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:10:40.938689 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:10:40.941690 (MainThread): Parsing macros/relations.sql
2021-10-02 12:10:40.943018 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:10:40.965688 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:10:40.967328 (MainThread): Parsing macros/core.sql
2021-10-02 12:10:40.970786 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:10:40.977892 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:10:40.987533 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:10:40.989335 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:10:41.008228 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:10:41.041597 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:10:41.061314 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:10:41.062958 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:10:41.073302 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:10:41.092856 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:10:41.108625 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:10:41.116609 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:10:41.124136 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:10:41.127733 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:10:41.128515 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:10:41.129381 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:10:41.130778 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:10:41.139135 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:10:41.140921 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:10:41.142317 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:10:41.196182 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:10:41.197905 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:10:41.199200 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:10:41.200751 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:10:41.202795 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:10:41.203858 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:10:41.205279 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:10:41.207735 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:10:41.214189 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:10:41.215637 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:10:41.216994 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:10:41.219631 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:10:41.220777 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:10:41.223023 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:10:41.232913 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:10:41.235304 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:10:41.236788 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:10:41.238495 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:10:41.240669 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:10:41.241862 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:10:41.245010 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:10:41.249957 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:10:41.250687 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:10:41.253280 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:10:41.254984 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:10:41.256384 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:10:41.258140 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:10:41.281248 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:10:41.281920 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:10:41.282593 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:10:41.283206 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:10:41.286350 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:10:41.287533 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:10:41.289383 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:10:41.290304 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:10:41.291077 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:10:41.292190 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:10:41.293940 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:10:41.294975 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:10:41.295812 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:10:41.297267 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:10:41.298085 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:10:41.300475 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:10:41.301879 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:10:41.302799 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:10:41.304303 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:10:41.307416 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:10:41.312707 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:10:41.313723 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:10:41.315914 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:10:41.318959 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:10:41.321212 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:10:41.322382 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:10:41.325464 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:10:41.331135 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:10:41.338514 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:10:41.339326 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:10:41.342715 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:10:41.343875 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:10:41.345189 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:10:41.348065 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:10:41.351927 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:10:41.354320 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:10:41.504375 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:10:41.504596 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4678804f0>]}
2021-10-02 12:10:41.621856 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:10:41.630840 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:10:41.635237 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:41.638800 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:41.642495 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:10:41.645788 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:10:41.737469 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:10:41.742549 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467964c70>]}
2021-10-02 12:10:41.750999 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46792ed00>]}
2021-10-02 12:10:41.751346 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:10:41.753003 (MainThread): 
2021-10-02 12:10:41.753464 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:10:41.754606 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 12:10:41.763651 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 12:10:41.763829 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 12:10:41.763968 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 12:10:43.270689 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.51 seconds
2021-10-02 12:10:43.271926 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 12:10:43.273391 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:10:43.278472 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:10:43.278632 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:10:43.278746 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:10:44.689514 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-10-02 12:10:44.689715 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:10:44.689827 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:10:44.702080 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-10-02 12:10:44.703255 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:10:44.704796 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:10:44.705231 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:10:44.706747 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:10:44.706878 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:10:44.706989 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:10:46.142395 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.44 seconds
2021-10-02 12:10:46.142640 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:10:46.142791 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:10:46.158502 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 12:10:46.159786 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:10:46.161405 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:10:46.167814 (MainThread): Using postgres connection "master".
2021-10-02 12:10:46.168071 (MainThread): On master: BEGIN
2021-10-02 12:10:46.168322 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:10:47.417407 (MainThread): SQL status: BEGIN in 1.25 seconds
2021-10-02 12:10:47.417648 (MainThread): Using postgres connection "master".
2021-10-02 12:10:47.417791 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:10:47.465084 (MainThread): SQL status: SELECT 7 in 0.05 seconds
2021-10-02 12:10:47.466271 (MainThread): On master: ROLLBACK
2021-10-02 12:10:47.468196 (MainThread): Using postgres connection "master".
2021-10-02 12:10:47.468341 (MainThread): On master: BEGIN
2021-10-02 12:10:47.470778 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 12:10:47.470954 (MainThread): On master: COMMIT
2021-10-02 12:10:47.471121 (MainThread): Using postgres connection "master".
2021-10-02 12:10:47.471268 (MainThread): On master: COMMIT
2021-10-02 12:10:47.472760 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:10:47.472911 (MainThread): On master: Close
2021-10-02 12:10:47.473209 (MainThread): 17:40:47 | Concurrency: 1 threads (target='dev')
2021-10-02 12:10:47.473364 (MainThread): 17:40:47 | 
2021-10-02 12:10:47.475935 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:10:47.476291 (Thread-1): 17:40:47 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 12:10:47.476688 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:47.476904 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 12:10:47.479122 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:10:47.479647 (Thread-1): finished collecting timing info
2021-10-02 12:10:47.500089 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:10:47.500683 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:47.500876 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 12:10:47.501026 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:10:48.778835 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-10-02 12:10:48.779082 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:48.779215 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 12:10:48.798113 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 12:10:48.803379 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:48.803571 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 12:10:48.806526 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:10:48.808496 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:48.808634 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 12:10:48.810105 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:10:48.820344 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:10:48.820608 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:48.820779 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:10:48.824603 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:10:48.830507 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:10:48.830691 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 12:10:48.840798 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 12:10:48.841870 (Thread-1): finished collecting timing info
2021-10-02 12:10:48.842066 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 12:10:48.842405 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467a8ffd0>]}
2021-10-02 12:10:48.842711 (Thread-1): 17:40:48 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.37s]
2021-10-02 12:10:48.842875 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:10:48.843045 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:10:48.843334 (Thread-1): 17:40:48 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 12:10:48.843614 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:48.843750 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:10:48.881241 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:10:48.882195 (Thread-1): finished collecting timing info
2021-10-02 12:10:48.901932 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:10:48.902638 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:48.902810 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 12:10:48.902958 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:10:50.215539 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-10-02 12:10:50.215790 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:50.215973 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 12:10:50.238322 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 12:10:50.241303 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:50.241531 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 12:10:50.244164 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:10:50.246492 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:50.246662 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 12:10:50.248329 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:10:50.249481 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:10:50.249659 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:50.249796 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:10:50.253885 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:10:50.256054 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:10:50.256258 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 12:10:50.262902 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 12:10:50.264187 (Thread-1): finished collecting timing info
2021-10-02 12:10:50.264409 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 12:10:50.264834 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467a993a0>]}
2021-10-02 12:10:50.265342 (Thread-1): 17:40:50 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.42s]
2021-10-02 12:10:50.265693 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:10:50.266399 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:10:50.266740 (Thread-1): 17:40:50 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 12:10:50.267108 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:10:50.267288 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:10:50.272327 (Thread-1): finished collecting timing info
2021-10-02 12:10:50.272816 (Thread-1): Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  Required var 'country' not found in config:
  Vars supplied to cust_details_ord_counts = {
      "postgres_model": {
          "country": "USA"
      },
      "snowflake_model_data": {
          "country": "USA"
      }
  }
  
  > in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  > called by model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  Required var 'country' not found in config:
  Vars supplied to cust_details_ord_counts = {
      "postgres_model": {
          "country": "USA"
      },
      "snowflake_model_data": {
          "country": "USA"
      }
  }
  
  > in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  > called by model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 12:10:50.280218 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467c716a0>]}
2021-10-02 12:10:50.280598 (Thread-1): 17:40:50 | 3 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts..... [ERROR in 0.01s]
2021-10-02 12:10:50.280788 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:10:50.280973 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:10:50.281320 (Thread-1): 17:40:50 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 12:10:50.281634 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:10:50.281794 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:10:50.284987 (Thread-1): finished collecting timing info
2021-10-02 12:10:50.285325 (Thread-1): Compilation Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  Required var 'country' not found in config:
  Vars supplied to cust_details_ord_counts copy = {
      "postgres_model": {
          "country": "USA"
      },
      "snowflake_model_data": {
          "country": "USA"
      }
  }
  
  > in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  > called by model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  Required var 'country' not found in config:
  Vars supplied to cust_details_ord_counts copy = {
      "postgres_model": {
          "country": "USA"
      },
      "snowflake_model_data": {
          "country": "USA"
      }
  }
  
  > in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
  > called by model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 12:10:50.285776 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bceaf2-07ca-4ba9-b2a7-0282203e33a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467a8fc70>]}
2021-10-02 12:10:50.286093 (Thread-1): 17:40:50 | 4 of 4 ERROR creating view model dbtdemo.cust_details_ord_counts copy [ERROR in 0.00s]
2021-10-02 12:10:50.286268 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:10:50.287244 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:10:50.287454 (MainThread): Using postgres connection "master".
2021-10-02 12:10:50.287617 (MainThread): On master: BEGIN
2021-10-02 12:10:50.287756 (MainThread): Opening a new connection, currently in state closed
2021-10-02 12:10:52.178594 (MainThread): SQL status: BEGIN in 1.89 seconds
2021-10-02 12:10:52.178859 (MainThread): On master: COMMIT
2021-10-02 12:10:52.179019 (MainThread): Using postgres connection "master".
2021-10-02 12:10:52.179160 (MainThread): On master: COMMIT
2021-10-02 12:10:52.180596 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:10:52.180816 (MainThread): On master: Close
2021-10-02 12:10:52.181229 (MainThread): 17:40:52 | 
2021-10-02 12:10:52.181437 (MainThread): 17:40:52 | Finished running 1 table model, 3 view models in 10.43s.
2021-10-02 12:10:52.181747 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:10:52.181908 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 12:10:52.192091 (MainThread): 
2021-10-02 12:10:52.192421 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-02 12:10:52.192655 (MainThread): 
2021-10-02 12:10:52.193031 (MainThread): Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 12:10:52.193289 (MainThread):   Required var 'country' not found in config:
2021-10-02 12:10:52.193471 (MainThread):   Vars supplied to cust_details_ord_counts = {
2021-10-02 12:10:52.193630 (MainThread):       "postgres_model": {
2021-10-02 12:10:52.193788 (MainThread):           "country": "USA"
2021-10-02 12:10:52.193945 (MainThread):       },
2021-10-02 12:10:52.194164 (MainThread):       "snowflake_model_data": {
2021-10-02 12:10:52.194366 (MainThread):           "country": "USA"
2021-10-02 12:10:52.194560 (MainThread):       }
2021-10-02 12:10:52.194750 (MainThread):   }
2021-10-02 12:10:52.194909 (MainThread):   
2021-10-02 12:10:52.195072 (MainThread):   > in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 12:10:52.195318 (MainThread):   > called by model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
2021-10-02 12:10:52.195508 (MainThread): 
2021-10-02 12:10:52.195774 (MainThread): Compilation Error in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 12:10:52.195995 (MainThread):   Required var 'country' not found in config:
2021-10-02 12:10:52.196214 (MainThread):   Vars supplied to cust_details_ord_counts copy = {
2021-10-02 12:10:52.196396 (MainThread):       "postgres_model": {
2021-10-02 12:10:52.196551 (MainThread):           "country": "USA"
2021-10-02 12:10:52.196737 (MainThread):       },
2021-10-02 12:10:52.197001 (MainThread):       "snowflake_model_data": {
2021-10-02 12:10:52.197252 (MainThread):           "country": "USA"
2021-10-02 12:10:52.197467 (MainThread):       }
2021-10-02 12:10:52.197628 (MainThread):   }
2021-10-02 12:10:52.197904 (MainThread):   
2021-10-02 12:10:52.198158 (MainThread):   > in model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 12:10:52.198411 (MainThread):   > called by model cust_details_ord_counts copy (models/postgres_model/cust_details_ord_counts copy.sql)
2021-10-02 12:10:52.198608 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2021-10-02 12:10:52.198856 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4677768e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467a2e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe467a2e790>]}
2021-10-02 12:10:52.199124 (MainThread): Flushing usage events
2021-10-02 12:13:27.090499 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:13:27.183246 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 12:13:27.184799 (MainThread): Tracking: tracking
2021-10-02 12:13:27.202693 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37780aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37783f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37783fe80>]}
2021-10-02 12:13:27.227527 (MainThread): Partial parsing not enabled
2021-10-02 12:13:27.297513 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:13:27.298448 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:13:27.299556 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:13:27.303654 (MainThread): Parsing macros/relations.sql
2021-10-02 12:13:27.305344 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:13:27.332855 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:13:27.335129 (MainThread): Parsing macros/core.sql
2021-10-02 12:13:27.340221 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:13:27.349277 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:13:27.361270 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:13:27.363308 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:13:27.383815 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:13:27.417448 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:13:27.438472 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:13:27.441493 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:13:27.452530 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:13:27.475711 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:13:27.489423 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:13:27.497350 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:13:27.504349 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:13:27.507995 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:13:27.508838 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:13:27.509782 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:13:27.511414 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:13:27.520217 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:13:27.521949 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:13:27.523365 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:13:27.576264 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:13:27.577959 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:13:27.579018 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:13:27.580207 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:13:27.582135 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:13:27.583128 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:13:27.584477 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:13:27.586496 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:13:27.592354 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:13:27.593430 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:13:27.594765 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:13:27.597023 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:13:27.598014 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:13:27.600169 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:13:27.609594 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:13:27.611352 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:13:27.612660 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:13:27.614188 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:13:27.615621 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:13:27.616534 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:13:27.619537 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:13:27.624583 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:13:27.625313 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:13:27.627979 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:13:27.630171 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:13:27.631717 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:13:27.633579 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:13:27.655570 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:13:27.656198 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:13:27.656843 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:13:27.657412 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:13:27.660394 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:13:27.661548 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:13:27.663398 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:13:27.664467 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:13:27.665240 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:13:27.666350 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:13:27.668116 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:13:27.669268 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:13:27.670108 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:13:27.671455 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:13:27.672277 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:13:27.674500 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:13:27.675805 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:13:27.676710 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:13:27.677926 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:13:27.681020 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:13:27.686332 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:13:27.687339 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:13:27.689721 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:13:27.692672 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:13:27.695028 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:13:27.695864 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:13:27.698594 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:13:27.704385 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:13:27.712126 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:13:27.713039 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:13:27.716209 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:13:27.717565 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:13:27.718879 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:13:27.721590 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:13:27.725823 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:13:27.728341 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:13:27.878861 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:13:27.879089 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3778ca4f0>]}
2021-10-02 12:13:27.993627 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:28.002850 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:28.006629 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:28.009680 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:28.013175 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:13:28.016465 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:13:28.107669 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:13:28.112936 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377a00400>]}
2021-10-02 12:13:28.121270 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377a7ad00>]}
2021-10-02 12:13:28.121560 (MainThread): Found 6 models, 9 tests, 0 snapshots, 0 analyses, 288 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:13:28.123287 (MainThread): 
2021-10-02 12:13:28.123886 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:13:28.124994 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 12:13:28.134474 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 12:13:28.134677 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 12:13:28.134826 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 12:13:29.776033 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.64 seconds
2021-10-02 12:13:29.777560 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 12:13:29.779411 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:13:29.785670 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:13:29.785862 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:13:29.786069 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:13:31.332509 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.55 seconds
2021-10-02 12:13:31.332766 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:13:31.332919 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:13:31.345929 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:13:31.347099 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:13:31.348635 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:13:31.349155 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:13:31.350826 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:13:31.350994 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:13:31.351137 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:13:32.771799 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.42 seconds
2021-10-02 12:13:32.772042 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:13:32.772198 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:13:32.784842 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2021-10-02 12:13:32.786138 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:13:32.787728 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:13:32.793380 (MainThread): Using postgres connection "master".
2021-10-02 12:13:32.793589 (MainThread): On master: BEGIN
2021-10-02 12:13:32.793740 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:13:34.062190 (MainThread): SQL status: BEGIN in 1.27 seconds
2021-10-02 12:13:34.062425 (MainThread): Using postgres connection "master".
2021-10-02 12:13:34.062572 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:13:34.099424 (MainThread): SQL status: SELECT 3 in 0.04 seconds
2021-10-02 12:13:34.100613 (MainThread): On master: ROLLBACK
2021-10-02 12:13:34.102488 (MainThread): Using postgres connection "master".
2021-10-02 12:13:34.102632 (MainThread): On master: BEGIN
2021-10-02 12:13:34.104832 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 12:13:34.104986 (MainThread): On master: COMMIT
2021-10-02 12:13:34.105106 (MainThread): Using postgres connection "master".
2021-10-02 12:13:34.105217 (MainThread): On master: COMMIT
2021-10-02 12:13:34.106312 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:13:34.106470 (MainThread): On master: Close
2021-10-02 12:13:34.106790 (MainThread): 17:43:34 | Concurrency: 1 threads (target='dev')
2021-10-02 12:13:34.106944 (MainThread): 17:43:34 | 
2021-10-02 12:13:34.109318 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:13:34.109621 (Thread-1): 17:43:34 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 12:13:34.109955 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:34.110113 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 12:13:34.112552 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:13:34.113033 (Thread-1): finished collecting timing info
2021-10-02 12:13:34.133032 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:13:34.133675 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:34.133896 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 12:13:34.134036 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:13:35.505181 (Thread-1): SQL status: BEGIN in 1.37 seconds
2021-10-02 12:13:35.505436 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:35.505590 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 12:13:35.534283 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 12:13:35.540518 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:35.540707 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 12:13:35.542991 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:13:35.545201 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:35.545364 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 12:13:35.547711 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:13:35.558423 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:13:35.558636 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:35.558780 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:13:35.562792 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:13:35.569474 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:13:35.569685 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 12:13:35.580600 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 12:13:35.581787 (Thread-1): finished collecting timing info
2021-10-02 12:13:35.581987 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 12:13:35.582386 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377d6ef10>]}
2021-10-02 12:13:35.582743 (Thread-1): 17:43:35 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.47s]
2021-10-02 12:13:35.582933 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:13:35.583217 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:13:35.583565 (Thread-1): 17:43:35 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 12:13:35.583874 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:35.584039 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:13:35.625891 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:13:35.626586 (Thread-1): finished collecting timing info
2021-10-02 12:13:35.646254 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:13:35.647037 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:35.647235 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 12:13:35.647391 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:13:36.936274 (Thread-1): SQL status: BEGIN in 1.29 seconds
2021-10-02 12:13:36.936526 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:36.936676 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 12:13:36.949813 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:13:36.952396 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:36.952571 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 12:13:36.954649 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:13:36.956874 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:36.957039 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 12:13:36.958786 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:13:36.959852 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:13:36.960011 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:36.960148 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:13:36.964258 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:13:36.965964 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:13:36.966122 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 12:13:36.969921 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:13:36.971059 (Thread-1): finished collecting timing info
2021-10-02 12:13:36.971265 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 12:13:36.971664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377abbd00>]}
2021-10-02 12:13:36.972022 (Thread-1): 17:43:36 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.39s]
2021-10-02 12:13:36.972229 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:13:36.972818 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:13:36.973184 (Thread-1): 17:43:36 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 12:13:36.973505 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:36.973673 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:13:36.977716 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:13:36.978330 (Thread-1): finished collecting timing info
2021-10-02 12:13:36.980904 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:13:36.981648 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:36.981830 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 12:13:36.981988 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:13:38.361235 (Thread-1): SQL status: BEGIN in 1.38 seconds
2021-10-02 12:13:38.361473 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:38.361619 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:13:38.373597 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:13:38.375706 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:38.375847 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 12:13:38.377385 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:13:38.378277 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:13:38.378403 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:38.378507 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:13:38.381320 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:13:38.382637 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:13:38.382764 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 12:13:38.384157 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:13:38.385004 (Thread-1): finished collecting timing info
2021-10-02 12:13:38.385162 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 12:13:38.385471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37780b820>]}
2021-10-02 12:13:38.385764 (Thread-1): 17:43:38 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.41s]
2021-10-02 12:13:38.385918 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:13:38.386068 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:13:38.386325 (Thread-1): 17:43:38 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 12:13:38.386572 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:38.386702 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:13:38.389653 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:13:38.390188 (Thread-1): finished collecting timing info
2021-10-02 12:13:38.393525 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:13:38.394320 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:38.394457 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 12:13:38.394576 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:13:39.737870 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-10-02 12:13:39.738123 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:39.738276 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:13:39.749687 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:13:39.751975 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:39.752154 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 12:13:39.754351 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:13:39.755326 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:13:39.755470 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:39.755585 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:13:39.759076 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:13:39.761089 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:13:39.761341 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 12:13:39.763728 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:13:39.764977 (Thread-1): finished collecting timing info
2021-10-02 12:13:39.765194 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 12:13:39.765644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48a6b98-cc35-4c15-93c9-20480582eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377b6d070>]}
2021-10-02 12:13:39.766027 (Thread-1): 17:43:39 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.38s]
2021-10-02 12:13:39.766254 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:13:39.767295 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:13:39.767515 (MainThread): Using postgres connection "master".
2021-10-02 12:13:39.767666 (MainThread): On master: BEGIN
2021-10-02 12:13:39.767818 (MainThread): Opening a new connection, currently in state closed
2021-10-02 12:13:41.130315 (MainThread): SQL status: BEGIN in 1.36 seconds
2021-10-02 12:13:41.130567 (MainThread): On master: COMMIT
2021-10-02 12:13:41.130721 (MainThread): Using postgres connection "master".
2021-10-02 12:13:41.130858 (MainThread): On master: COMMIT
2021-10-02 12:13:41.132384 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:13:41.132591 (MainThread): On master: Close
2021-10-02 12:13:41.132992 (MainThread): 17:43:41 | 
2021-10-02 12:13:41.133186 (MainThread): 17:43:41 | Finished running 1 table model, 3 view models in 13.01s.
2021-10-02 12:13:41.133354 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:13:41.133488 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 12:13:41.141833 (MainThread): 
2021-10-02 12:13:41.142085 (MainThread): Completed successfully
2021-10-02 12:13:41.142301 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 12:13:41.142583 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377b07f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd377b62c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3777e0dc0>]}
2021-10-02 12:13:41.142887 (MainThread): Flushing usage events
2021-10-02 12:28:26.482572 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:28:26.578785 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-02 12:28:26.580679 (MainThread): Tracking: tracking
2021-10-02 12:28:26.792889 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237154d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237154d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2371540a0>]}
2021-10-02 12:28:26.814437 (MainThread): Partial parsing not enabled
2021-10-02 12:28:26.873646 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:28:26.874402 (MainThread): Parsing macros/test_country.sql
2021-10-02 12:28:26.874934 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:28:26.875812 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:28:26.879134 (MainThread): Parsing macros/relations.sql
2021-10-02 12:28:26.880467 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:28:26.903263 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:28:26.904852 (MainThread): Parsing macros/core.sql
2021-10-02 12:28:26.908259 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:28:26.915235 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:28:26.925793 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:28:26.927432 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:28:26.945195 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:28:26.980533 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:28:27.001293 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:28:27.002927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:28:27.012576 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:28:27.032975 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:28:27.046368 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:28:27.054296 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:28:27.061539 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:28:27.065199 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:28:27.066003 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:28:27.066877 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:28:27.068420 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:28:27.076764 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:28:27.078606 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:28:27.080049 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:28:27.133889 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:28:27.135531 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:28:27.136625 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:28:27.137865 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:28:27.139861 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:28:27.140900 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:28:27.142292 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:28:27.144333 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:28:27.150018 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:28:27.151089 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:28:27.152306 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:28:27.154556 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:28:27.155560 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:28:27.157958 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:28:27.167836 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:28:27.169759 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:28:27.171350 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:28:27.173220 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:28:27.174694 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:28:27.175593 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:28:27.180716 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:28:27.187698 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:28:27.188815 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:28:27.192145 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:28:27.194636 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:28:27.196501 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:28:27.198857 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:28:27.233279 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:28:27.234332 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:28:27.235217 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:28:27.235993 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:28:27.241026 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:28:27.242672 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:28:27.245627 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:28:27.246897 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:28:27.247992 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:28:27.249500 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:28:27.251956 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:28:27.253590 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:28:27.255241 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:28:27.257418 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:28:27.258667 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:28:27.262044 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:28:27.265157 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:28:27.266494 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:28:27.268237 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:28:27.272610 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:28:27.279604 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:28:27.280969 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:28:27.283831 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:28:27.287584 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:28:27.290415 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:28:27.291532 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:28:27.294677 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:28:27.302068 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:28:27.311591 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:28:27.312702 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:28:27.315939 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:28:27.317087 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:28:27.318603 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:28:27.321883 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:28:27.326509 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:28:27.329791 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:28:27.490365 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:28:27.490579 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '818abb39-adcc-4850-a0f1-99267646ecbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2371bac10>]}
2021-10-02 12:28:27.631850 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:28:27.643950 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:28:27.648821 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:28:27.652724 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:28:27.657329 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:28:27.661218 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:28:27.708167 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237339550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2372fb160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2372fb130>]}
2021-10-02 12:28:27.708457 (MainThread): Flushing usage events
2021-10-02 12:28:29.227537 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-10-02 12:28:29.227829 (MainThread): Encountered an error:
2021-10-02 12:28:29.228031 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named cust_details_ord_counts. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for cust_details_ord_counts in this file:
   - models/postgres_model/schema.yml
  
2021-10-02 12:28:29.235769 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 517, in parse_file
    for test_block in parser.parse():
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 752, in parse
    self.parse_patch(node_block, refs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 799, in parse_patch
    self.manifest.add_patch(self.yaml.file, patch)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 743, in add_patch
    raise_duplicate_patch_name(patch, existing_file_path)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 865, in raise_duplicate_patch_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named cust_details_ord_counts. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for cust_details_ord_counts in this file:
   - models/postgres_model/schema.yml
  

2021-10-02 12:29:11.714761 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:29:11.795183 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-02 12:29:11.798383 (MainThread): Tracking: tracking
2021-10-02 12:29:11.813364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62c9221c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62c919be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62c7c05e0>]}
2021-10-02 12:29:11.831698 (MainThread): Partial parsing not enabled
2021-10-02 12:29:11.841978 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62c7e7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62c7e7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62c7e7820>]}
2021-10-02 12:29:11.842324 (MainThread): Flushing usage events
2021-10-02 12:29:13.231271 (MainThread): Encountered an error:
2021-10-02 12:29:13.231500 (MainThread): Compilation Error
  Error reading dbt_demo_project: postgres_model/schema.yml - Runtime Error
    Syntax error near line 53
    ------------------------------
    50 |   
    51 | 
    52 |   - name: cust_details_ord_counts
    53 |   tests:
    54 |       - is_not_empty
    55 |     columns:
    56 |       - name: cntry
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 30, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 53, column 3
2021-10-02 12:29:13.359795 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 853, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 30, column 3
did not find expected '-' indicator
  in "<unicode string>", line 53, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 53
  ------------------------------
  50 |   
  51 | 
  52 |   - name: cust_details_ord_counts
  53 |   tests:
  54 |       - is_not_empty
  55 |     columns:
  56 |       - name: cntry
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 30, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 53, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 209, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_demo_project: postgres_model/schema.yml - Runtime Error
    Syntax error near line 53
    ------------------------------
    50 |   
    51 | 
    52 |   - name: cust_details_ord_counts
    53 |   tests:
    54 |       - is_not_empty
    55 |     columns:
    56 |       - name: cntry
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 30, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 53, column 3

2021-10-02 12:29:29.055280 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:29:29.124608 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-02 12:29:29.125707 (MainThread): Tracking: tracking
2021-10-02 12:29:29.139922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98dd800be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98dd81abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98dd800490>]}
2021-10-02 12:29:29.162355 (MainThread): Partial parsing not enabled
2021-10-02 12:29:29.218257 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:29:29.219195 (MainThread): Parsing macros/test_country.sql
2021-10-02 12:29:29.219860 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:29:29.220926 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:29:29.224831 (MainThread): Parsing macros/relations.sql
2021-10-02 12:29:29.226985 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:29:29.259616 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:29:29.262073 (MainThread): Parsing macros/core.sql
2021-10-02 12:29:29.266061 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:29:29.273887 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:29:29.284482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:29:29.286292 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:29:29.306143 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:29:29.342000 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:29:29.367481 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:29:29.369588 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:29:29.381405 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:29:29.401462 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:29:29.414804 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:29:29.423114 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:29:29.430631 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:29:29.434279 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:29:29.435069 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:29:29.435942 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:29:29.437313 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:29:29.445397 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:29:29.447271 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:29:29.448684 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:29:29.500821 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:29:29.502380 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:29:29.503589 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:29:29.504731 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:29:29.506805 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:29:29.507787 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:29:29.509035 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:29:29.511019 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:29:29.517397 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:29:29.518412 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:29:29.519758 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:29:29.521866 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:29:29.522810 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:29:29.524873 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:29:29.533982 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:29:29.535670 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:29:29.536918 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:29:29.538378 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:29:29.539881 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:29:29.540784 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:29:29.543643 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:29:29.548545 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:29:29.549233 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:29:29.551799 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:29:29.553514 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:29:29.555417 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:29:29.557201 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:29:29.579644 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:29:29.580335 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:29:29.581171 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:29:29.581800 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:29:29.584919 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:29:29.586076 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:29:29.587960 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:29:29.588936 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:29:29.589713 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:29:29.590910 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:29:29.592851 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:29:29.594071 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:29:29.594893 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:29:29.596227 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:29:29.597037 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:29:29.599197 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:29:29.600626 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:29:29.601526 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:29:29.602682 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:29:29.605916 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:29:29.611379 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:29:29.612412 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:29:29.614826 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:29:29.617840 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:29:29.620054 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:29:29.620977 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:29:29.623504 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:29:29.629233 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:29:29.636507 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:29:29.637273 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:29:29.639932 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:29:29.640792 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:29:29.641851 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:29:29.644272 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:29:29.648097 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:29:29.650642 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:29:29.803171 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:29:29.803391 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0598fcd9-2760-461c-be97-f4bf8eab4be9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98dd8d37c0>]}
2021-10-02 12:29:29.917300 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:29:29.927229 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:29:29.931680 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:29:29.935348 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:29:29.939558 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:29:29.943126 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:29:30.012396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ddaf94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ddabbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ddabba00>]}
2021-10-02 12:29:30.012730 (MainThread): Flushing usage events
2021-10-02 12:29:31.176670 (MainThread): Connection 'model.dbt_demo_project.my_second_dbt_model' was properly closed.
2021-10-02 12:29:31.176977 (MainThread): Encountered an error:
2021-10-02 12:29:31.177215 (MainThread): Compilation Error in test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
  macro 'dbt_macro__test_is_usa' takes no keyword argument 'column_name'
  
  > in macro test_is_usa (macros/test_country.sql)
  > called by test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
2021-10-02 12:29:31.186704 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 305, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 663, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__test_is_usa' takes no keyword argument 'column_name'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 518, in parse_file
    self.parse_tests(test_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 485, in parse_tests
    self.parse_column_tests(block, column)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 214, in parse_column_tests
    self.parse_test(block, test, column)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 481, in parse_test
    self.parse_node(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 420, in parse_node
    node = self._parse_generic_test(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 340, in _parse_generic_test
    self.render_test_update(node, config, builder)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 406, in render_test_update
    get_rendered(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 262, in call_macro
    return e.value
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 307, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
  macro 'dbt_macro__test_is_usa' takes no keyword argument 'column_name'
  
  > in macro test_is_usa (macros/test_country.sql)
  > called by test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)

2021-10-02 12:31:59.643507 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:31:59.726072 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-02 12:31:59.728325 (MainThread): Tracking: tracking
2021-10-02 12:31:59.743722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc246116df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc246122730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc246122ee0>]}
2021-10-02 12:31:59.764758 (MainThread): Partial parsing not enabled
2021-10-02 12:31:59.803814 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:31:59.804560 (MainThread): Parsing macros/test_country.sql
2021-10-02 12:31:59.805087 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:31:59.806049 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:31:59.808696 (MainThread): Parsing macros/relations.sql
2021-10-02 12:31:59.809959 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:31:59.832716 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:31:59.834337 (MainThread): Parsing macros/core.sql
2021-10-02 12:31:59.837938 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:31:59.845026 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:31:59.855695 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:31:59.857585 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:31:59.875629 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:31:59.913174 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:31:59.933541 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:31:59.935218 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:31:59.944795 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:31:59.965375 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:31:59.979402 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:31:59.987554 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:31:59.995144 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:31:59.999001 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:31:59.999847 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:32:00.000767 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:32:00.002307 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:32:00.011269 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:32:00.013230 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:32:00.015053 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:32:00.067725 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:32:00.069550 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:32:00.070697 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:32:00.071986 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:32:00.073950 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:32:00.074986 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:32:00.076463 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:32:00.078446 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:32:00.084326 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:32:00.085406 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:32:00.086814 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:32:00.089040 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:32:00.090166 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:32:00.092543 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:32:00.102820 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:32:00.104612 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:32:00.105954 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:32:00.107622 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:32:00.109205 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:32:00.110085 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:32:00.113360 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:32:00.118572 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:32:00.119335 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:32:00.121978 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:32:00.123727 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:32:00.125143 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:32:00.126928 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:32:00.149552 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:32:00.150355 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:32:00.151283 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:32:00.151891 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:32:00.156271 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:32:00.157676 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:32:00.159541 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:32:00.160482 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:32:00.161431 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:32:00.162572 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:32:00.164352 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:32:00.165393 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:32:00.166264 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:32:00.167768 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:32:00.168653 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:32:00.170839 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:32:00.172107 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:32:00.173017 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:32:00.174183 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:32:00.177253 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:32:00.182532 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:32:00.183577 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:32:00.185808 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:32:00.188797 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:32:00.191071 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:32:00.192108 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:32:00.194781 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:32:00.200674 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:32:00.208046 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:32:00.208945 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:32:00.211631 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:32:00.212556 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:32:00.213620 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:32:00.217357 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:32:00.221668 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:32:00.224864 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:32:00.389057 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:32:00.389321 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df6c03a2-0b00-4801-a253-6417633d1974', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2461c6520>]}
2021-10-02 12:32:00.507083 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:32:00.518320 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:32:00.522744 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:32:00.526265 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:32:00.530284 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:32:00.533843 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:32:00.630022 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:32:00.635426 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df6c03a2-0b00-4801-a253-6417633d1974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2463ec070>]}
2021-10-02 12:32:00.643282 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df6c03a2-0b00-4801-a253-6417633d1974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24637f820>]}
2021-10-02 12:32:00.643591 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:32:00.645222 (MainThread): 
2021-10-02 12:32:00.645692 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:32:00.647475 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:32:00.657679 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:32:00.657875 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:32:00.658016 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-02 12:32:05.736003 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 5.08 seconds
2021-10-02 12:32:05.736317 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:32:05.736455 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:32:05.746896 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-10-02 12:32:05.748250 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:32:05.749371 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:32:05.749807 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:32:05.751174 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:32:05.751542 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:32:05.751687 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:32:06.972463 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.22 seconds
2021-10-02 12:32:06.972701 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:32:06.972848 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:32:06.985034 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:32:06.986178 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:32:06.987658 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:32:06.993265 (MainThread): Using postgres connection "master".
2021-10-02 12:32:06.993469 (MainThread): On master: BEGIN
2021-10-02 12:32:06.993609 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:32:08.414945 (MainThread): SQL status: BEGIN in 1.42 seconds
2021-10-02 12:32:08.415185 (MainThread): Using postgres connection "master".
2021-10-02 12:32:08.415335 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:32:08.474087 (MainThread): SQL status: SELECT 7 in 0.06 seconds
2021-10-02 12:32:08.475277 (MainThread): On master: ROLLBACK
2021-10-02 12:32:08.477049 (MainThread): On master: Close
2021-10-02 12:32:08.477389 (MainThread): 18:02:08 | Concurrency: 1 threads (target='dev')
2021-10-02 12:32:08.477547 (MainThread): 18:02:08 | 
2021-10-02 12:32:08.479899 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:32:08.480415 (Thread-1): 18:02:08 | 1 of 6 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-02 12:32:08.480867 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:32:08.481108 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:32:08.484700 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 12:32:08.485907 (Thread-1): finished collecting timing info
2021-10-02 12:32:08.500481 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 12:32:08.501279 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:32:08.501441 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: BEGIN
2021-10-02 12:32:08.501551 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:32:09.741730 (Thread-1): SQL status: BEGIN in 1.24 seconds
2021-10-02 12:32:09.741983 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:32:09.742130 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_count_by_state"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:32:09.749301 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 12:32:09.751771 (Thread-1): finished collecting timing info
2021-10-02 12:32:09.752032 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: ROLLBACK
2021-10-02 12:32:09.753859 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-02 12:32:09.754381 (Thread-1): 18:02:09 | 1 of 6 PASS is_not_empty_cust_count_by_state_........................ [PASS in 1.27s]
2021-10-02 12:32:09.754597 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:32:09.754836 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:32:09.755136 (Thread-1): 18:02:09 | 2 of 6 START test is_not_empty_cust_details_ord_counts_.............. [RUN]
2021-10-02 12:32:09.755467 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:32:09.755631 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:32:09.759867 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 12:32:09.760501 (Thread-1): finished collecting timing info
2021-10-02 12:32:09.762638 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 12:32:09.763198 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:32:09.763359 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: BEGIN
2021-10-02 12:32:09.763499 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:32:10.937170 (Thread-1): SQL status: BEGIN in 1.17 seconds
2021-10-02 12:32:10.937385 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:32:10.937514 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_details_ord_counts"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:32:11.004676 (Thread-1): SQL status: SELECT 1 in 0.07 seconds
2021-10-02 12:32:11.005989 (Thread-1): finished collecting timing info
2021-10-02 12:32:11.006155 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: ROLLBACK
2021-10-02 12:32:11.007733 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-10-02 12:32:11.008130 (Thread-1): 18:02:11 | 2 of 6 PASS is_not_empty_cust_details_ord_counts_.................... [PASS in 1.25s]
2021-10-02 12:32:11.008293 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:32:11.008448 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:32:11.008662 (Thread-1): 18:02:11 | 3 of 6 START test is_not_empty_orders_count_by_cust_................. [RUN]
2021-10-02 12:32:11.008931 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:32:11.009069 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:32:11.012755 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 12:32:11.013441 (Thread-1): finished collecting timing info
2021-10-02 12:32:11.015119 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 12:32:11.015619 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:32:11.015740 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: BEGIN
2021-10-02 12:32:11.015858 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:32:12.217862 (Thread-1): SQL status: BEGIN in 1.20 seconds
2021-10-02 12:32:12.218103 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:32:12.218250 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."orders_count_by_cust"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:32:12.298299 (Thread-1): SQL status: SELECT 1 in 0.08 seconds
2021-10-02 12:32:12.299712 (Thread-1): finished collecting timing info
2021-10-02 12:32:12.299916 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: ROLLBACK
2021-10-02 12:32:12.301529 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-10-02 12:32:12.301968 (Thread-1): 18:02:12 | 3 of 6 PASS is_not_empty_orders_count_by_cust_....................... [PASS in 1.29s]
2021-10-02 12:32:12.302176 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:32:12.302407 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:32:12.302675 (Thread-1): 18:02:12 | 4 of 6 START test is_usa_cust_details_ord_counts_cntry............... [RUN]
2021-10-02 12:32:12.302983 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:32:12.303146 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:32:12.309087 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 12:32:12.309742 (Thread-1): finished collecting timing info
2021-10-02 12:32:12.349275 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 12:32:12.350147 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:32:12.350394 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: BEGIN
2021-10-02 12:32:12.350555 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:32:13.585057 (Thread-1): SQL status: BEGIN in 1.23 seconds
2021-10-02 12:32:13.585296 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:32:13.585439 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select count(*) from "postgres"."dbtdemo"."cust_details_ord_counts" where  != 'USA'


      
    ) dbt_internal_test
2021-10-02 12:32:13.588179 (Thread-1): Postgres error: syntax error at or near "!="
LINE 11: ...ostgres"."dbtdemo"."cust_details_ord_counts" where  != 'USA'
                                                                ^

2021-10-02 12:32:13.588371 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: ROLLBACK
2021-10-02 12:32:13.590002 (Thread-1): finished collecting timing info
2021-10-02 12:32:13.590211 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: Close
2021-10-02 12:32:13.590570 (Thread-1): Database Error in test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
  syntax error at or near "!="
  LINE 11: ...ostgres"."dbtdemo"."cust_details_ord_counts" where  != 'USA'
                                                                  ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/schema.yml/schema_test/is_usa_cust_details_ord_counts_cntry.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "!="
LINE 11: ...ostgres"."dbtdemo"."cust_details_ord_counts" where  != 'USA'
                                                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/test.py", line 82, in execute_test
    macro_func()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
  syntax error at or near "!="
  LINE 11: ...ostgres"."dbtdemo"."cust_details_ord_counts" where  != 'USA'
                                                                  ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/schema.yml/schema_test/is_usa_cust_details_ord_counts_cntry.sql
2021-10-02 12:32:13.596762 (Thread-1): 18:02:13 | 4 of 6 ERROR is_usa_cust_details_ord_counts_cntry.................... [ERROR in 1.29s]
2021-10-02 12:32:13.596974 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:32:13.597171 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:32:13.597500 (Thread-1): 18:02:13 | 5 of 6 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-02 12:32:13.597837 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:32:13.597996 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:32:13.604656 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 12:32:13.605195 (Thread-1): finished collecting timing info
2021-10-02 12:32:13.607043 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 12:32:13.607606 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:32:13.607766 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: BEGIN
2021-10-02 12:32:13.607955 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:32:14.818116 (Thread-1): SQL status: BEGIN in 1.21 seconds
2021-10-02 12:32:14.818337 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:32:14.818474 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-10-02 12:32:14.821661 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:32:14.823029 (Thread-1): finished collecting timing info
2021-10-02 12:32:14.823287 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: ROLLBACK
2021-10-02 12:32:14.824857 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-02 12:32:14.825300 (Thread-1): 18:02:14 | 5 of 6 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 1.23s]
2021-10-02 12:32:14.825501 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:32:14.825785 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:32:14.826090 (Thread-1): 18:02:14 | 6 of 6 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-02 12:32:14.826424 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:32:14.826587 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:32:14.833896 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 12:32:14.834466 (Thread-1): finished collecting timing info
2021-10-02 12:32:14.836463 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 12:32:14.837070 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:32:14.837250 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: BEGIN
2021-10-02 12:32:14.837444 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:32:16.285481 (Thread-1): SQL status: BEGIN in 1.45 seconds
2021-10-02 12:32:16.285714 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:32:16.285858 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-10-02 12:32:16.289379 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:32:16.290677 (Thread-1): finished collecting timing info
2021-10-02 12:32:16.290874 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: ROLLBACK
2021-10-02 12:32:16.292316 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-02 12:32:16.292757 (Thread-1): 18:02:16 | 6 of 6 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 1.47s]
2021-10-02 12:32:16.292971 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:32:16.294033 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:32:16.294365 (MainThread): 18:02:16 | 
2021-10-02 12:32:16.294542 (MainThread): 18:02:16 | Finished running 6 tests in 15.65s.
2021-10-02 12:32:16.294695 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:32:16.294833 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-02 12:32:16.303288 (MainThread): 
2021-10-02 12:32:16.303538 (MainThread): Completed with 1 error and 0 warnings:
2021-10-02 12:32:16.303717 (MainThread): 
2021-10-02 12:32:16.303886 (MainThread): Database Error in test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
2021-10-02 12:32:16.304035 (MainThread):   syntax error at or near "!="
2021-10-02 12:32:16.304172 (MainThread):   LINE 11: ...ostgres"."dbtdemo"."cust_details_ord_counts" where  != 'USA'
2021-10-02 12:32:16.304310 (MainThread):                                                                   ^
2021-10-02 12:32:16.304498 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/schema.yml/schema_test/is_usa_cust_details_ord_counts_cntry.sql
2021-10-02 12:32:16.304721 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-10-02 12:32:16.304945 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2460c9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2460c9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2460c9d60>]}
2021-10-02 12:32:16.305194 (MainThread): Flushing usage events
2021-10-02 12:34:08.845580 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:34:08.945050 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-02 12:34:08.946609 (MainThread): Tracking: tracking
2021-10-02 12:34:08.964608 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d7014dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d7014a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d7014910>]}
2021-10-02 12:34:08.987710 (MainThread): Partial parsing not enabled
2021-10-02 12:34:09.041180 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:34:09.041945 (MainThread): Parsing macros/test_country.sql
2021-10-02 12:34:09.042505 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:34:09.043377 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:34:09.046749 (MainThread): Parsing macros/relations.sql
2021-10-02 12:34:09.048127 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:34:09.071897 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:34:09.073534 (MainThread): Parsing macros/core.sql
2021-10-02 12:34:09.077309 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:34:09.084254 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:34:09.094317 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:34:09.096046 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:34:09.114874 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:34:09.154288 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:34:09.176428 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:34:09.178066 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:34:09.187994 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:34:09.207806 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:34:09.222441 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:34:09.231734 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:34:09.242441 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:34:09.247954 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:34:09.249117 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:34:09.250234 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:34:09.252113 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:34:09.262830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:34:09.265103 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:34:09.266595 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:34:09.320650 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:34:09.322285 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:34:09.323374 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:34:09.324583 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:34:09.326705 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:34:09.327774 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:34:09.329105 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:34:09.331562 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:34:09.337665 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:34:09.338757 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:34:09.340043 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:34:09.342452 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:34:09.343475 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:34:09.345713 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:34:09.355267 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:34:09.357103 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:34:09.358467 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:34:09.360041 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:34:09.361560 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:34:09.362443 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:34:09.365469 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:34:09.370616 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:34:09.371382 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:34:09.373910 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:34:09.375768 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:34:09.377251 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:34:09.379057 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:34:09.402094 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:34:09.402718 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:34:09.403350 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:34:09.403967 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:34:09.406932 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:34:09.408127 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:34:09.410490 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:34:09.411483 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:34:09.412342 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:34:09.413450 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:34:09.415315 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:34:09.416354 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:34:09.417226 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:34:09.418745 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:34:09.419567 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:34:09.422155 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:34:09.423447 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:34:09.424361 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:34:09.425549 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:34:09.428747 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:34:09.434223 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:34:09.435236 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:34:09.437431 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:34:09.440299 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:34:09.442889 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:34:09.443739 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:34:09.446560 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:34:09.452266 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:34:09.459352 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:34:09.460143 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:34:09.462697 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:34:09.463605 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:34:09.464637 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:34:09.467088 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:34:09.470644 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:34:09.473038 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:34:09.625866 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:34:09.626124 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45fb6133-e28d-4858-a7ad-24c470012a4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d70ca910>]}
2021-10-02 12:34:09.750405 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:34:09.760266 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:34:09.764063 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:34:09.767207 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:34:09.770754 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:34:09.773866 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:34:09.870003 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:34:09.874856 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45fb6133-e28d-4858-a7ad-24c470012a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d7119250>]}
2021-10-02 12:34:09.883787 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45fb6133-e28d-4858-a7ad-24c470012a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d71bffa0>]}
2021-10-02 12:34:09.884109 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:34:09.886050 (MainThread): 
2021-10-02 12:34:09.886475 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:34:09.889526 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:34:09.902826 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:34:09.903084 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:34:09.903264 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-02 12:34:11.413551 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.51 seconds
2021-10-02 12:34:11.413818 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:34:11.413966 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:34:11.427094 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:34:11.428531 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:34:11.430196 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:34:11.430730 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:34:11.432460 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:34:11.432646 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:34:11.432795 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:34:12.697317 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-10-02 12:34:12.697544 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:34:12.697698 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:34:12.708248 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-10-02 12:34:12.709364 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:34:12.710611 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:34:12.715557 (MainThread): Using postgres connection "master".
2021-10-02 12:34:12.715755 (MainThread): On master: BEGIN
2021-10-02 12:34:12.715925 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:34:13.905884 (MainThread): SQL status: BEGIN in 1.19 seconds
2021-10-02 12:34:13.906104 (MainThread): Using postgres connection "master".
2021-10-02 12:34:13.906241 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:34:13.948103 (MainThread): SQL status: SELECT 7 in 0.04 seconds
2021-10-02 12:34:13.949393 (MainThread): On master: ROLLBACK
2021-10-02 12:34:13.950649 (MainThread): On master: Close
2021-10-02 12:34:13.950974 (MainThread): 18:04:13 | Concurrency: 1 threads (target='dev')
2021-10-02 12:34:13.951135 (MainThread): 18:04:13 | 
2021-10-02 12:34:13.953376 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:34:13.953840 (Thread-1): 18:04:13 | 1 of 6 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-02 12:34:13.954367 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:34:13.954626 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:34:13.958290 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 12:34:13.958885 (Thread-1): finished collecting timing info
2021-10-02 12:34:13.972997 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 12:34:13.973627 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:34:13.973853 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: BEGIN
2021-10-02 12:34:13.974009 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:34:15.285211 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-10-02 12:34:15.285569 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:34:15.285730 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_count_by_state"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:34:15.292710 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 12:34:15.295220 (Thread-1): finished collecting timing info
2021-10-02 12:34:15.295441 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: ROLLBACK
2021-10-02 12:34:15.297230 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-02 12:34:15.297774 (Thread-1): 18:04:15 | 1 of 6 PASS is_not_empty_cust_count_by_state_........................ [PASS in 1.34s]
2021-10-02 12:34:15.298032 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:34:15.298376 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:34:15.298652 (Thread-1): 18:04:15 | 2 of 6 START test is_not_empty_cust_details_ord_counts_.............. [RUN]
2021-10-02 12:34:15.298973 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:34:15.299144 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:34:15.303740 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 12:34:15.304543 (Thread-1): finished collecting timing info
2021-10-02 12:34:15.306626 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 12:34:15.307418 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:34:15.307630 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: BEGIN
2021-10-02 12:34:15.307822 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:34:16.613305 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-10-02 12:34:16.613853 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:34:16.614031 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_details_ord_counts"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:34:16.697190 (Thread-1): SQL status: SELECT 1 in 0.08 seconds
2021-10-02 12:34:16.698319 (Thread-1): finished collecting timing info
2021-10-02 12:34:16.698479 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: ROLLBACK
2021-10-02 12:34:16.700054 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-10-02 12:34:16.700397 (Thread-1): 18:04:16 | 2 of 6 PASS is_not_empty_cust_details_ord_counts_.................... [PASS in 1.40s]
2021-10-02 12:34:16.700557 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:34:16.700758 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:34:16.700986 (Thread-1): 18:04:16 | 3 of 6 START test is_not_empty_orders_count_by_cust_................. [RUN]
2021-10-02 12:34:16.701251 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:34:16.701383 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:34:16.705069 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 12:34:16.705703 (Thread-1): finished collecting timing info
2021-10-02 12:34:16.707441 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 12:34:16.708059 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:34:16.708236 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: BEGIN
2021-10-02 12:34:16.708378 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:34:17.960782 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-10-02 12:34:17.961029 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:34:17.961182 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."orders_count_by_cust"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:34:18.024272 (Thread-1): SQL status: SELECT 1 in 0.06 seconds
2021-10-02 12:34:18.025454 (Thread-1): finished collecting timing info
2021-10-02 12:34:18.025624 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: ROLLBACK
2021-10-02 12:34:18.027614 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-10-02 12:34:18.028120 (Thread-1): 18:04:18 | 3 of 6 PASS is_not_empty_orders_count_by_cust_....................... [PASS in 1.33s]
2021-10-02 12:34:18.028311 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:34:18.028557 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:34:18.028879 (Thread-1): 18:04:18 | 4 of 6 START test is_usa_cust_details_ord_counts_cntry............... [RUN]
2021-10-02 12:34:18.029164 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:34:18.029302 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:34:18.034049 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 12:34:18.034824 (Thread-1): finished collecting timing info
2021-10-02 12:34:18.074920 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 12:34:18.075808 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:34:18.076096 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: BEGIN
2021-10-02 12:34:18.076317 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:34:19.365998 (Thread-1): SQL status: BEGIN in 1.29 seconds
2021-10-02 12:34:19.366239 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:34:19.366377 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select count(*) from "postgres"."dbtdemo"."cust_details_ord_counts" where cntry != 'USA'


      
    ) dbt_internal_test
2021-10-02 12:34:19.375499 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 12:34:19.376641 (Thread-1): finished collecting timing info
2021-10-02 12:34:19.376820 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: ROLLBACK
2021-10-02 12:34:19.378305 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: Close
2021-10-02 12:34:19.378705 (Thread-1): 18:04:19 | 4 of 6 FAIL 1 is_usa_cust_details_ord_counts_cntry................... [FAIL 1 in 1.35s]
2021-10-02 12:34:19.378869 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:34:19.379065 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:34:19.379296 (Thread-1): 18:04:19 | 5 of 6 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-02 12:34:19.379663 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:34:19.379808 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:34:19.386787 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 12:34:19.387333 (Thread-1): finished collecting timing info
2021-10-02 12:34:19.389184 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 12:34:19.389873 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:34:19.390075 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: BEGIN
2021-10-02 12:34:19.390226 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:34:20.799677 (Thread-1): SQL status: BEGIN in 1.41 seconds
2021-10-02 12:34:20.799927 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:34:20.800079 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-10-02 12:34:20.802937 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:34:20.804279 (Thread-1): finished collecting timing info
2021-10-02 12:34:20.804484 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: ROLLBACK
2021-10-02 12:34:20.805868 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-02 12:34:20.806292 (Thread-1): 18:04:20 | 5 of 6 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 1.43s]
2021-10-02 12:34:20.806507 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:34:20.806719 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:34:20.807019 (Thread-1): 18:04:20 | 6 of 6 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-02 12:34:20.807365 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:34:20.807536 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:34:20.815877 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 12:34:20.816776 (Thread-1): finished collecting timing info
2021-10-02 12:34:20.819361 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 12:34:20.820130 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:34:20.820322 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: BEGIN
2021-10-02 12:34:20.820542 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:34:22.228307 (Thread-1): SQL status: BEGIN in 1.41 seconds
2021-10-02 12:34:22.228729 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:34:22.228893 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-10-02 12:34:22.232615 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:34:22.233984 (Thread-1): finished collecting timing info
2021-10-02 12:34:22.234200 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: ROLLBACK
2021-10-02 12:34:22.236328 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-02 12:34:22.237332 (Thread-1): 18:04:22 | 6 of 6 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 1.43s]
2021-10-02 12:34:22.237734 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:34:22.239570 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:34:22.240047 (MainThread): 18:04:22 | 
2021-10-02 12:34:22.240302 (MainThread): 18:04:22 | Finished running 6 tests in 12.35s.
2021-10-02 12:34:22.240578 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:34:22.240820 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-02 12:34:22.251137 (MainThread): 
2021-10-02 12:34:22.251658 (MainThread): Completed with 1 error and 0 warnings:
2021-10-02 12:34:22.251984 (MainThread): 
2021-10-02 12:34:22.252291 (MainThread): Failure in test is_usa_cust_details_ord_counts_cntry (models/postgres_model/schema.yml)
2021-10-02 12:34:22.252571 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-02 12:34:22.252752 (MainThread): 
2021-10-02 12:34:22.252957 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/postgres_model/schema.yml/schema_test/is_usa_cust_details_ord_counts_cntry.sql
2021-10-02 12:34:22.253306 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-10-02 12:34:22.253585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d7119b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d6fc9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d6fc9c70>]}
2021-10-02 12:34:22.253872 (MainThread): Flushing usage events
2021-10-02 12:36:02.651290 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:36:02.739554 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-10-02 12:36:02.741220 (MainThread): Tracking: tracking
2021-10-02 12:36:02.757271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d4167f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d415d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d415df10>]}
2021-10-02 12:36:02.778582 (MainThread): Partial parsing not enabled
2021-10-02 12:36:02.835400 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:36:02.836142 (MainThread): Parsing macros/test_country.sql
2021-10-02 12:36:02.836670 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:36:02.837518 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:36:02.840603 (MainThread): Parsing macros/relations.sql
2021-10-02 12:36:02.841916 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:36:02.867697 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:36:02.869715 (MainThread): Parsing macros/core.sql
2021-10-02 12:36:02.874034 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:36:02.881032 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:36:02.890688 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:36:02.892314 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:36:02.910596 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:36:02.944523 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:36:02.967785 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:36:02.969759 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:36:02.980045 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:36:02.999675 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:36:03.013214 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:36:03.020996 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:36:03.027956 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:36:03.031603 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:36:03.032383 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:36:03.033323 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:36:03.034695 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:36:03.042900 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:36:03.044604 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:36:03.046058 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:36:03.100031 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:36:03.101662 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:36:03.102845 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:36:03.104660 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:36:03.107322 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:36:03.108422 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:36:03.109779 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:36:03.111832 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:36:03.118497 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:36:03.120160 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:36:03.121723 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:36:03.124431 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:36:03.125752 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:36:03.128920 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:36:03.141887 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:36:03.144854 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:36:03.146888 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:36:03.149722 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:36:03.153395 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:36:03.155475 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:36:03.161709 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:36:03.173241 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:36:03.174839 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:36:03.178461 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:36:03.181162 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:36:03.183562 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:36:03.186382 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:36:03.217024 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:36:03.217999 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:36:03.219162 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:36:03.220122 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:36:03.224347 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:36:03.226000 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:36:03.228574 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:36:03.230136 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:36:03.231408 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:36:03.233124 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:36:03.235647 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:36:03.237155 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:36:03.238406 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:36:03.240341 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:36:03.241557 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:36:03.244728 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:36:03.246895 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:36:03.248155 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:36:03.249687 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:36:03.254023 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:36:03.261486 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:36:03.262826 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:36:03.266879 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:36:03.270757 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:36:03.273720 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:36:03.274915 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:36:03.278004 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:36:03.284491 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:36:03.293266 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:36:03.294160 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:36:03.297254 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:36:03.298206 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:36:03.299333 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:36:03.301878 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:36:03.305558 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:36:03.307978 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:36:03.461359 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:36:03.461587 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e954fca-a30b-4515-a0be-94d18cc11cf5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d4206520>]}
2021-10-02 12:36:03.585260 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:36:03.596882 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:36:03.601724 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:36:03.605503 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:36:03.609884 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:36:03.613636 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:36:03.732401 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:36:03.737534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e954fca-a30b-4515-a0be-94d18cc11cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d42524c0>]}
2021-10-02 12:36:03.747088 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e954fca-a30b-4515-a0be-94d18cc11cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d42bf760>]}
2021-10-02 12:36:03.747458 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:36:03.749274 (MainThread): 
2021-10-02 12:36:03.749740 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:36:03.751596 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:36:03.761940 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:36:03.762127 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:36:03.762272 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-02 12:36:05.234907 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-10-02 12:36:05.235190 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:36:05.235343 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:36:05.252374 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 12:36:05.253938 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:36:05.255673 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:36:05.256278 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:36:05.257973 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:36:05.258142 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:36:05.258282 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:36:06.653602 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.40 seconds
2021-10-02 12:36:06.653847 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:36:06.653999 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:36:06.667814 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-10-02 12:36:06.669186 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:36:06.670780 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:36:06.676800 (MainThread): Using postgres connection "master".
2021-10-02 12:36:06.677007 (MainThread): On master: BEGIN
2021-10-02 12:36:06.677153 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:36:08.016571 (MainThread): SQL status: BEGIN in 1.34 seconds
2021-10-02 12:36:08.016806 (MainThread): Using postgres connection "master".
2021-10-02 12:36:08.016949 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:36:08.059984 (MainThread): SQL status: SELECT 7 in 0.04 seconds
2021-10-02 12:36:08.061261 (MainThread): On master: ROLLBACK
2021-10-02 12:36:08.062909 (MainThread): On master: Close
2021-10-02 12:36:08.063262 (MainThread): 18:06:08 | Concurrency: 1 threads (target='dev')
2021-10-02 12:36:08.063440 (MainThread): 18:06:08 | 
2021-10-02 12:36:08.065901 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:36:08.066281 (Thread-1): 18:06:08 | 1 of 6 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-10-02 12:36:08.066718 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:36:08.066916 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:36:08.070482 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 12:36:08.071089 (Thread-1): finished collecting timing info
2021-10-02 12:36:08.084995 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 12:36:08.085762 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:36:08.085992 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: BEGIN
2021-10-02 12:36:08.086156 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:36:09.347576 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-10-02 12:36:09.347777 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 12:36:09.347893 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_count_by_state"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:36:09.351151 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:36:09.352749 (Thread-1): finished collecting timing info
2021-10-02 12:36:09.352913 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: ROLLBACK
2021-10-02 12:36:09.354112 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-10-02 12:36:09.354461 (Thread-1): 18:06:09 | 1 of 6 PASS is_not_empty_cust_count_by_state_........................ [PASS in 1.29s]
2021-10-02 12:36:09.354633 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 12:36:09.354848 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:36:09.355074 (Thread-1): 18:06:09 | 2 of 6 START test is_not_empty_cust_details_ord_counts_.............. [RUN]
2021-10-02 12:36:09.355346 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:36:09.355480 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:36:09.359099 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 12:36:09.359603 (Thread-1): finished collecting timing info
2021-10-02 12:36:09.361191 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 12:36:09.361859 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:36:09.362079 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: BEGIN
2021-10-02 12:36:09.362202 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:36:10.670008 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-10-02 12:36:10.670243 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 12:36:10.670386 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_details_ord_counts"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:36:10.733940 (Thread-1): SQL status: SELECT 1 in 0.06 seconds
2021-10-02 12:36:10.735079 (Thread-1): finished collecting timing info
2021-10-02 12:36:10.735241 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: ROLLBACK
2021-10-02 12:36:10.736657 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-10-02 12:36:10.737001 (Thread-1): 18:06:10 | 2 of 6 PASS is_not_empty_cust_details_ord_counts_.................... [PASS in 1.38s]
2021-10-02 12:36:10.737156 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 12:36:10.737350 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:36:10.737571 (Thread-1): 18:06:10 | 3 of 6 START test is_not_empty_orders_count_by_cust_................. [RUN]
2021-10-02 12:36:10.737839 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:36:10.737971 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:36:10.741831 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 12:36:10.742477 (Thread-1): finished collecting timing info
2021-10-02 12:36:10.744210 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 12:36:10.744865 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:36:10.745010 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: BEGIN
2021-10-02 12:36:10.745146 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:36:12.060742 (Thread-1): SQL status: BEGIN in 1.32 seconds
2021-10-02 12:36:12.060962 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 12:36:12.061098 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."orders_count_by_cust"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-10-02 12:36:12.111588 (Thread-1): SQL status: SELECT 1 in 0.05 seconds
2021-10-02 12:36:12.112934 (Thread-1): finished collecting timing info
2021-10-02 12:36:12.113104 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: ROLLBACK
2021-10-02 12:36:12.114903 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-10-02 12:36:12.115271 (Thread-1): 18:06:12 | 3 of 6 PASS is_not_empty_orders_count_by_cust_....................... [PASS in 1.38s]
2021-10-02 12:36:12.115432 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 12:36:12.115588 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:36:12.115860 (Thread-1): 18:06:12 | 4 of 6 START test is_usa_cust_details_ord_counts_cntry............... [RUN]
2021-10-02 12:36:12.116137 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:36:12.116273 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:36:12.121400 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 12:36:12.121917 (Thread-1): finished collecting timing info
2021-10-02 12:36:12.158091 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 12:36:12.158916 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:36:12.159100 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: BEGIN
2021-10-02 12:36:12.159255 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:36:13.432235 (Thread-1): SQL status: BEGIN in 1.27 seconds
2021-10-02 12:36:13.432477 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 12:36:13.432625 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select * from "postgres"."dbtdemo"."cust_details_ord_counts" where cntry != 'USA'


      
    ) dbt_internal_test
2021-10-02 12:36:13.439158 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 12:36:13.440271 (Thread-1): finished collecting timing info
2021-10-02 12:36:13.440435 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: ROLLBACK
2021-10-02 12:36:13.441708 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: Close
2021-10-02 12:36:13.442045 (Thread-1): 18:06:13 | 4 of 6 PASS is_usa_cust_details_ord_counts_cntry..................... [PASS in 1.33s]
2021-10-02 12:36:13.442203 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 12:36:13.442357 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:36:13.442601 (Thread-1): 18:06:13 | 5 of 6 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-10-02 12:36:13.442879 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:36:13.443015 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:36:13.448749 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 12:36:13.449277 (Thread-1): finished collecting timing info
2021-10-02 12:36:13.450962 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 12:36:13.451601 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:36:13.451757 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: BEGIN
2021-10-02 12:36:13.451880 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:36:14.643927 (Thread-1): SQL status: BEGIN in 1.19 seconds
2021-10-02 12:36:14.644174 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 12:36:14.644339 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-10-02 12:36:14.647964 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:36:14.649359 (Thread-1): finished collecting timing info
2021-10-02 12:36:14.649568 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: ROLLBACK
2021-10-02 12:36:14.651097 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-10-02 12:36:14.651656 (Thread-1): 18:06:14 | 5 of 6 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 1.21s]
2021-10-02 12:36:14.651861 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 12:36:14.652044 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:36:14.652218 (Thread-1): 18:06:14 | 6 of 6 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-10-02 12:36:14.652858 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:36:14.653135 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:36:14.661953 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 12:36:14.662709 (Thread-1): finished collecting timing info
2021-10-02 12:36:14.666381 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 12:36:14.667555 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:36:14.667731 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: BEGIN
2021-10-02 12:36:14.667939 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:36:16.007648 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-10-02 12:36:16.007900 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 12:36:16.008050 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-10-02 12:36:16.012132 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 12:36:16.013513 (Thread-1): finished collecting timing info
2021-10-02 12:36:16.013725 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: ROLLBACK
2021-10-02 12:36:16.015435 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-10-02 12:36:16.015887 (Thread-1): 18:06:16 | 6 of 6 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 1.36s]
2021-10-02 12:36:16.016090 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 12:36:16.017176 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:36:16.017536 (MainThread): 18:06:16 | 
2021-10-02 12:36:16.017729 (MainThread): 18:06:16 | Finished running 6 tests in 12.27s.
2021-10-02 12:36:16.017898 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:36:16.018036 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-10-02 12:36:16.026371 (MainThread): 
2021-10-02 12:36:16.026649 (MainThread): Completed successfully
2021-10-02 12:36:16.026867 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-02 12:36:16.027114 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d4252760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d4108a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d4108940>]}
2021-10-02 12:36:16.027459 (MainThread): Flushing usage events
2021-10-02 12:56:05.028451 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 12:56:05.139629 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 12:56:05.141358 (MainThread): Tracking: tracking
2021-10-02 12:56:05.358350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18f9239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18f915ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18f923eb0>]}
2021-10-02 12:56:05.383125 (MainThread): Partial parsing not enabled
2021-10-02 12:56:05.455717 (MainThread): Parsing macros/test_empty.sql
2021-10-02 12:56:05.456532 (MainThread): Parsing macros/test_country.sql
2021-10-02 12:56:05.457086 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 12:56:05.458076 (MainThread): Parsing macros/catalog.sql
2021-10-02 12:56:05.462385 (MainThread): Parsing macros/relations.sql
2021-10-02 12:56:05.463669 (MainThread): Parsing macros/adapters.sql
2021-10-02 12:56:05.491519 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 12:56:05.493598 (MainThread): Parsing macros/core.sql
2021-10-02 12:56:05.498150 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 12:56:05.506357 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 12:56:05.519289 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 12:56:05.521337 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 12:56:05.543368 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 12:56:05.584401 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 12:56:05.610288 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 12:56:05.612482 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 12:56:05.625821 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 12:56:05.651672 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 12:56:05.670547 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 12:56:05.681029 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 12:56:05.691336 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 12:56:05.696403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 12:56:05.697613 (MainThread): Parsing macros/etc/query.sql
2021-10-02 12:56:05.698829 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 12:56:05.700691 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 12:56:05.711468 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 12:56:05.713820 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 12:56:05.715824 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 12:56:05.787197 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 12:56:05.789241 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 12:56:05.790581 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 12:56:05.792081 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 12:56:05.794539 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 12:56:05.795818 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 12:56:05.797520 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 12:56:05.800022 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 12:56:05.807036 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 12:56:05.808350 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 12:56:05.809908 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 12:56:05.812672 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 12:56:05.813996 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 12:56:05.816770 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 12:56:05.828501 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 12:56:05.831150 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 12:56:05.832941 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 12:56:05.834950 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 12:56:05.836889 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 12:56:05.838124 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 12:56:05.842326 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 12:56:05.848635 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 12:56:05.849633 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 12:56:05.852950 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 12:56:05.855195 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 12:56:05.857020 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 12:56:05.859269 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 12:56:05.886664 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 12:56:05.887503 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 12:56:05.888316 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 12:56:05.889104 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 12:56:05.893044 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 12:56:05.894550 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 12:56:05.896909 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 12:56:05.898088 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 12:56:05.899082 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 12:56:05.900496 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 12:56:05.902744 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 12:56:05.904128 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 12:56:05.905205 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 12:56:05.906940 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 12:56:05.908014 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 12:56:05.910815 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 12:56:05.912464 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 12:56:05.913711 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 12:56:05.915314 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 12:56:05.919340 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 12:56:05.926122 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 12:56:05.927514 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 12:56:05.930633 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 12:56:05.934600 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 12:56:05.937820 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 12:56:05.939027 (MainThread): Parsing macros/sql/star.sql
2021-10-02 12:56:05.943051 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 12:56:05.950910 (MainThread): Parsing macros/sql/union.sql
2021-10-02 12:56:05.960554 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 12:56:05.961714 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 12:56:05.965042 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 12:56:05.966252 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 12:56:05.967615 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 12:56:05.970771 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 12:56:05.975420 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 12:56:05.978602 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 12:56:06.160930 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 12:56:06.161224 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18f9d3430>]}
2021-10-02 12:56:06.334217 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:06.347325 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:06.353602 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:06.358572 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:06.363987 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 12:56:06.368536 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 12:56:06.397693 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 12:56:06.401050 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 12:56:06.503960 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 12:56:06.509224 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18fa0af70>]}
2021-10-02 12:56:06.517321 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18fa0af70>]}
2021-10-02 12:56:06.517624 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 289 macros, 2 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 12:56:06.519065 (MainThread): 
2021-10-02 12:56:06.519421 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:56:06.520372 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 12:56:06.531093 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 12:56:06.531296 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 12:56:06.531443 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 12:56:12.457715 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 5.93 seconds
2021-10-02 12:56:12.459319 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 12:56:12.461413 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 12:56:12.468152 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 12:56:12.468365 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 12:56:12.468513 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:56:13.745028 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.28 seconds
2021-10-02 12:56:13.745257 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 12:56:13.745401 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 12:56:13.759667 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:56:13.760821 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 12:56:13.762327 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 12:56:13.762938 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 12:56:13.764566 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:56:13.764723 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 12:56:13.764863 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:56:15.397849 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.63 seconds
2021-10-02 12:56:15.398090 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 12:56:15.398237 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 12:56:15.410280 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 12:56:15.411620 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 12:56:15.412942 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 12:56:15.413437 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:56:15.415535 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:56:15.415782 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 12:56:15.416042 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 12:56:17.323479 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.91 seconds
2021-10-02 12:56:17.323679 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 12:56:17.323798 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 12:56:17.333451 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 12:56:17.334394 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 12:56:17.335563 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 12:56:17.340315 (MainThread): Using postgres connection "master".
2021-10-02 12:56:17.340503 (MainThread): On master: BEGIN
2021-10-02 12:56:17.340685 (MainThread): Opening a new connection, currently in state init
2021-10-02 12:56:19.152851 (MainThread): SQL status: BEGIN in 1.81 seconds
2021-10-02 12:56:19.153100 (MainThread): Using postgres connection "master".
2021-10-02 12:56:19.153256 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 12:56:19.206404 (MainThread): SQL status: SELECT 7 in 0.05 seconds
2021-10-02 12:56:19.207725 (MainThread): On master: ROLLBACK
2021-10-02 12:56:19.209134 (MainThread): Using postgres connection "master".
2021-10-02 12:56:19.209271 (MainThread): On master: BEGIN
2021-10-02 12:56:19.211730 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 12:56:19.211884 (MainThread): On master: COMMIT
2021-10-02 12:56:19.212006 (MainThread): Using postgres connection "master".
2021-10-02 12:56:19.212111 (MainThread): On master: COMMIT
2021-10-02 12:56:19.213071 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:56:19.213219 (MainThread): 18:26:19 | 
2021-10-02 12:56:19.213364 (MainThread): 18:26:19 | Running 1 on-run-start hook
2021-10-02 12:56:19.213506 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 12:56:19.214568 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 12:56:19.216235 (MainThread): 18:26:19 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 12:56:19.216483 (MainThread): Using postgres connection "master".
2021-10-02 12:56:19.216669 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
insert into dbtdemo.dbt_audit_table (action) values('BUILD_STARTED');commit;
2021-10-02 12:56:19.227509 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 12:56:19.228221 (MainThread): 18:26:19 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-10-02 12:56:19.228400 (MainThread): 18:26:19 | 
2021-10-02 12:56:19.228555 (MainThread): On master: Close
2021-10-02 12:56:19.228851 (MainThread): 18:26:19 | Concurrency: 1 threads (target='dev')
2021-10-02 12:56:19.228989 (MainThread): 18:26:19 | 
2021-10-02 12:56:19.231576 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:56:19.231932 (Thread-1): 18:26:19 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 12:56:19.232427 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:19.232585 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 12:56:19.235278 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:56:19.236181 (Thread-1): finished collecting timing info
2021-10-02 12:56:19.309210 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 12:56:19.310067 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:19.310253 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 12:56:19.310404 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:56:20.926319 (Thread-1): SQL status: BEGIN in 1.62 seconds
2021-10-02 12:56:20.926558 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:20.926701 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 12:56:20.948954 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 12:56:20.954054 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:20.954215 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 12:56:20.957161 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:56:20.959045 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:20.959173 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 12:56:20.960695 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:56:20.969451 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:56:20.969629 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:20.969739 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 12:56:20.974275 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:56:20.978273 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 12:56:20.978505 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 12:56:20.989395 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 12:56:20.990399 (Thread-1): finished collecting timing info
2021-10-02 12:56:20.990589 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 12:56:20.990913 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18f4c38b0>]}
2021-10-02 12:56:20.991231 (Thread-1): 18:26:20 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.76s]
2021-10-02 12:56:20.991400 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 12:56:20.991556 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:56:20.991925 (Thread-1): 18:26:20 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 12:56:20.992437 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:20.992624 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:56:20.997633 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:56:20.998280 (Thread-1): finished collecting timing info
2021-10-02 12:56:21.020057 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 12:56:21.020674 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:21.020841 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 12:56:21.020984 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:56:22.450714 (Thread-1): SQL status: BEGIN in 1.43 seconds
2021-10-02 12:56:22.451035 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:22.451216 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 12:56:22.469935 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 12:56:22.472565 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:22.472746 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 12:56:22.474819 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:56:22.477055 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:22.477213 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 12:56:22.478817 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:56:22.479923 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:56:22.480084 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:22.480221 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 12:56:22.483874 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:56:22.485678 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 12:56:22.485862 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 12:56:22.492066 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 12:56:22.493211 (Thread-1): finished collecting timing info
2021-10-02 12:56:22.493422 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 12:56:22.493834 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18fbb4310>]}
2021-10-02 12:56:22.494200 (Thread-1): 18:26:22 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.50s]
2021-10-02 12:56:22.494394 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 12:56:22.495052 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:56:22.495420 (Thread-1): 18:26:22 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 12:56:22.495761 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:22.495934 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:56:22.502041 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:56:22.502675 (Thread-1): finished collecting timing info
2021-10-02 12:56:22.505183 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 12:56:22.505894 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:22.506098 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 12:56:22.506254 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:56:23.987493 (Thread-1): SQL status: BEGIN in 1.48 seconds
2021-10-02 12:56:23.987742 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:23.987894 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:56:24.002982 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:56:24.005168 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:24.005312 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 12:56:24.006983 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:56:24.007956 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:56:24.008085 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:24.008192 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 12:56:24.010978 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:56:24.012357 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 12:56:24.012486 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 12:56:24.013896 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:56:24.014718 (Thread-1): finished collecting timing info
2021-10-02 12:56:24.014871 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 12:56:24.015182 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18fbdc340>]}
2021-10-02 12:56:24.015470 (Thread-1): 18:26:24 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.52s]
2021-10-02 12:56:24.015621 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 12:56:24.015769 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:56:24.016027 (Thread-1): 18:26:24 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 12:56:24.016278 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:24.016423 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:56:24.020490 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:56:24.021101 (Thread-1): finished collecting timing info
2021-10-02 12:56:24.023042 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 12:56:24.023609 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:24.023775 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 12:56:24.023893 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 12:56:25.664042 (Thread-1): SQL status: BEGIN in 1.64 seconds
2021-10-02 12:56:25.664291 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:25.664447 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 12:56:25.677216 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 12:56:25.679787 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:25.679972 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 12:56:25.682056 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 12:56:25.683289 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:56:25.683470 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:25.683618 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 12:56:25.687411 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:56:25.689301 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 12:56:25.689475 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 12:56:25.691199 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 12:56:25.692347 (Thread-1): finished collecting timing info
2021-10-02 12:56:25.692564 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 12:56:25.693034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42b86a62-49c5-4c21-b08b-498824e67969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18fa57700>]}
2021-10-02 12:56:25.693482 (Thread-1): 18:26:25 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.68s]
2021-10-02 12:56:25.693709 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 12:56:25.695021 (MainThread): Acquiring new postgres connection "master".
2021-10-02 12:56:25.695266 (MainThread): Using postgres connection "master".
2021-10-02 12:56:25.695425 (MainThread): On master: BEGIN
2021-10-02 12:56:25.695574 (MainThread): Opening a new connection, currently in state closed
2021-10-02 12:56:26.992695 (MainThread): SQL status: BEGIN in 1.30 seconds
2021-10-02 12:56:26.992950 (MainThread): On master: COMMIT
2021-10-02 12:56:26.993102 (MainThread): Using postgres connection "master".
2021-10-02 12:56:26.993236 (MainThread): On master: COMMIT
2021-10-02 12:56:26.994665 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 12:56:26.994872 (MainThread): 18:26:26 | 
2021-10-02 12:56:26.995074 (MainThread): 18:26:26 | Running 1 on-run-end hook
2021-10-02 12:56:26.995250 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 12:56:26.996750 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-02 12:56:26.997504 (MainThread): 18:26:26 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-02 12:56:26.997727 (MainThread): Using postgres connection "master".
2021-10-02 12:56:26.997876 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
insert into dbtdemo.dbt_audit_table (action) values('BUILD_ENDED'); commit;
2021-10-02 12:56:27.004336 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 12:56:27.005281 (MainThread): 18:26:27 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-10-02 12:56:27.005540 (MainThread): 18:26:27 | 
2021-10-02 12:56:27.005740 (MainThread): On master: Close
2021-10-02 12:56:27.006183 (MainThread): 18:26:27 | 
2021-10-02 12:56:27.006358 (MainThread): 18:26:27 | Finished running 1 table model, 3 view models, 2 hooks in 20.49s.
2021-10-02 12:56:27.006544 (MainThread): Connection 'master' was properly closed.
2021-10-02 12:56:27.006679 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 12:56:27.017251 (MainThread): 
2021-10-02 12:56:27.017530 (MainThread): Completed successfully
2021-10-02 12:56:27.017741 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 12:56:27.018018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18f7a4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18773ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18fbdec70>]}
2021-10-02 12:56:27.018347 (MainThread): Flushing usage events
2021-10-02 13:02:41.070784 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 13:02:41.155499 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 13:02:41.157227 (MainThread): Tracking: tracking
2021-10-02 13:02:41.172721 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd027152f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd027157790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd027157f40>]}
2021-10-02 13:02:41.190627 (MainThread): Partial parsing not enabled
2021-10-02 13:02:41.248991 (MainThread): Parsing macros/test_empty.sql
2021-10-02 13:02:41.249809 (MainThread): Parsing macros/test_country.sql
2021-10-02 13:02:41.250394 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 13:02:41.251375 (MainThread): Parsing macros/catalog.sql
2021-10-02 13:02:41.255195 (MainThread): Parsing macros/relations.sql
2021-10-02 13:02:41.256945 (MainThread): Parsing macros/adapters.sql
2021-10-02 13:02:41.287058 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 13:02:41.288673 (MainThread): Parsing macros/core.sql
2021-10-02 13:02:41.292555 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 13:02:41.299399 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 13:02:41.309779 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 13:02:41.311452 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 13:02:41.330690 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 13:02:41.365992 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 13:02:41.385893 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 13:02:41.387556 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 13:02:41.397389 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 13:02:41.417787 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 13:02:41.433585 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 13:02:41.441318 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 13:02:41.448482 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 13:02:41.452018 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 13:02:41.452804 (MainThread): Parsing macros/etc/query.sql
2021-10-02 13:02:41.453712 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 13:02:41.455076 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 13:02:41.463751 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 13:02:41.465475 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 13:02:41.466919 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 13:02:41.522084 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 13:02:41.523747 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 13:02:41.524830 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 13:02:41.526100 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 13:02:41.528065 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 13:02:41.529053 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 13:02:41.530349 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 13:02:41.532311 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 13:02:41.538375 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 13:02:41.539640 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 13:02:41.540952 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 13:02:41.543244 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 13:02:41.544237 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 13:02:41.546590 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 13:02:41.556488 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 13:02:41.558313 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 13:02:41.559652 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 13:02:41.561295 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 13:02:41.562981 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 13:02:41.563924 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 13:02:41.567033 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 13:02:41.572392 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 13:02:41.573149 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 13:02:41.575730 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 13:02:41.577650 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 13:02:41.579064 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 13:02:41.581196 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 13:02:41.603821 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 13:02:41.604543 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 13:02:41.605184 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 13:02:41.605915 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 13:02:41.609083 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 13:02:41.610376 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 13:02:41.612249 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 13:02:41.613222 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 13:02:41.614007 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 13:02:41.615175 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 13:02:41.617173 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 13:02:41.618400 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 13:02:41.619504 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 13:02:41.621323 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 13:02:41.622307 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 13:02:41.624611 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 13:02:41.625891 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 13:02:41.626956 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 13:02:41.628118 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 13:02:41.631317 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 13:02:41.637247 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 13:02:41.638356 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 13:02:41.640624 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 13:02:41.644048 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 13:02:41.646492 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 13:02:41.647397 (MainThread): Parsing macros/sql/star.sql
2021-10-02 13:02:41.650106 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 13:02:41.655886 (MainThread): Parsing macros/sql/union.sql
2021-10-02 13:02:41.664258 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 13:02:41.665087 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 13:02:41.667621 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 13:02:41.668509 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 13:02:41.669551 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 13:02:41.672060 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 13:02:41.675728 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 13:02:41.678340 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 13:02:41.834833 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 13:02:41.835044 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02730bd60>]}
2021-10-02 13:02:41.978737 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:41.991509 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:41.996992 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:42.001551 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:42.007099 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 13:02:42.012913 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 13:02:42.034042 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 13:02:42.038837 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 13:02:42.130588 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 13:02:42.135974 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0273b7250>]}
2021-10-02 13:02:42.145899 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0273406d0>]}
2021-10-02 13:02:42.146249 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 289 macros, 2 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 13:02:42.148127 (MainThread): 
2021-10-02 13:02:42.148635 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:02:42.149702 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 13:02:42.160067 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 13:02:42.160260 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 13:02:42.160407 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 13:02:44.304948 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.14 seconds
2021-10-02 13:02:44.306219 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 13:02:44.308215 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:02:44.347239 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:02:44.347446 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 13:02:44.347600 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:02:46.250667 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.90 seconds
2021-10-02 13:02:46.250891 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:02:46.251030 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 13:02:46.270821 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 13:02:46.272179 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 13:02:46.274089 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 13:02:46.274710 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 13:02:46.276443 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:02:46.276715 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 13:02:46.276885 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:02:47.804370 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.53 seconds
2021-10-02 13:02:47.804668 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:02:47.804841 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 13:02:47.816013 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 13:02:47.817547 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 13:02:47.819291 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 13:02:47.819817 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 13:02:47.821894 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:02:47.822104 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 13:02:47.822255 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:02:49.381775 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.56 seconds
2021-10-02 13:02:49.381970 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:02:49.382084 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 13:02:49.392613 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 13:02:49.393585 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 13:02:49.394818 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 13:02:49.399628 (MainThread): Using postgres connection "master".
2021-10-02 13:02:49.399807 (MainThread): On master: BEGIN
2021-10-02 13:02:49.399926 (MainThread): Opening a new connection, currently in state init
2021-10-02 13:02:51.366545 (MainThread): SQL status: BEGIN in 1.97 seconds
2021-10-02 13:02:51.366781 (MainThread): Using postgres connection "master".
2021-10-02 13:02:51.366921 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 13:02:51.425378 (MainThread): SQL status: SELECT 7 in 0.06 seconds
2021-10-02 13:02:51.426716 (MainThread): On master: ROLLBACK
2021-10-02 13:02:51.428176 (MainThread): Using postgres connection "master".
2021-10-02 13:02:51.428302 (MainThread): On master: BEGIN
2021-10-02 13:02:51.430408 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 13:02:51.430561 (MainThread): On master: COMMIT
2021-10-02 13:02:51.430677 (MainThread): Using postgres connection "master".
2021-10-02 13:02:51.430778 (MainThread): On master: COMMIT
2021-10-02 13:02:51.431862 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:51.432001 (MainThread): 18:32:51 | 
2021-10-02 13:02:51.432143 (MainThread): 18:32:51 | Running 1 on-run-start hook
2021-10-02 13:02:51.432277 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 13:02:51.433567 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 13:02:51.725202 (MainThread): 18:32:51 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 13:02:51.725495 (MainThread): Using postgres connection "master".
2021-10-02 13:02:51.725653 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
insert into dbtdemo.dbt_audit_table (action) values('BUILD_STARTED');commit;
2021-10-02 13:02:51.733109 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:02:51.734013 (MainThread): 18:32:51 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-10-02 13:02:51.734297 (MainThread): 18:32:51 | 
2021-10-02 13:02:51.734522 (MainThread): On master: Close
2021-10-02 13:02:51.734951 (MainThread): 18:32:51 | Concurrency: 1 threads (target='dev')
2021-10-02 13:02:51.735154 (MainThread): 18:32:51 | 
2021-10-02 13:02:51.738860 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:02:51.739234 (Thread-1): 18:32:51 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 13:02:51.739635 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:51.739831 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 13:02:51.743520 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:02:51.744673 (Thread-1): finished collecting timing info
2021-10-02 13:02:51.771509 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:51.771733 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 13:02:51.771888 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:02:53.750749 (Thread-1): SQL status: BEGIN in 1.98 seconds
2021-10-02 13:02:53.751025 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.751217 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_STARTED');commit;
      
2021-10-02 13:02:53.759589 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:02:53.766835 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:02:53.767506 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.767678 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 13:02:53.804865 (Thread-1): SQL status: SELECT 44 in 0.04 seconds
2021-10-02 13:02:53.813043 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.813309 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 13:02:53.817680 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:02:53.820390 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.820727 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 13:02:53.824410 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:02:53.834403 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.834642 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_ENDED'); commit;
      
2021-10-02 13:02:53.839013 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:53.848477 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:02:53.848796 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.848962 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:02:53.851925 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:53.858828 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:02:53.859071 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 13:02:53.873612 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 13:02:53.875408 (Thread-1): finished collecting timing info
2021-10-02 13:02:53.875736 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 13:02:53.876380 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd027302970>]}
2021-10-02 13:02:53.877015 (Thread-1): 18:32:53 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 2.14s]
2021-10-02 13:02:53.877382 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:02:53.877888 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:02:53.878399 (Thread-1): 18:32:53 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 13:02:53.878910 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:53.879108 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:02:53.884740 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:02:53.885661 (Thread-1): finished collecting timing info
2021-10-02 13:02:53.906458 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:53.906789 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 13:02:53.906950 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:02:55.576780 (Thread-1): SQL status: BEGIN in 1.67 seconds
2021-10-02 13:02:55.577167 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.577357 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_STARTED');commit;
      
2021-10-02 13:02:55.582960 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:02:55.587805 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:02:55.588411 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.588544 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 13:02:55.646470 (Thread-1): SQL status: CREATE VIEW in 0.06 seconds
2021-10-02 13:02:55.648990 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.649181 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 13:02:55.653046 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:02:55.655125 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.655260 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 13:02:55.657800 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:02:55.659045 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.659382 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_ENDED'); commit;
      
2021-10-02 13:02:55.663315 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:55.664967 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:02:55.665183 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.665353 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:02:55.667533 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:55.670267 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:02:55.670554 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 13:02:55.679476 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 13:02:55.681591 (Thread-1): finished collecting timing info
2021-10-02 13:02:55.682261 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 13:02:55.682867 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0274457f0>]}
2021-10-02 13:02:55.683292 (Thread-1): 18:32:55 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.80s]
2021-10-02 13:02:55.683562 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:02:55.684405 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:02:55.684934 (Thread-1): 18:32:55 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 13:02:55.685396 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:55.685581 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:02:55.689931 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:02:55.690735 (Thread-1): finished collecting timing info
2021-10-02 13:02:55.694129 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:55.694885 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 13:02:55.695242 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:02:57.037965 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-10-02 13:02:57.038211 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:57.038358 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_STARTED');commit;
      
2021-10-02 13:02:57.044622 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:02:57.045997 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:02:57.046756 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:57.046936 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:02:57.064126 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 13:02:57.066609 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:57.066778 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 13:02:57.070223 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:02:57.071483 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:57.071647 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_ENDED'); commit;
      
2021-10-02 13:02:57.074555 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:57.075495 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:02:57.075744 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:57.075904 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:02:57.077574 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:57.080930 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:02:57.081141 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 13:02:57.083071 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:02:57.084224 (Thread-1): finished collecting timing info
2021-10-02 13:02:57.084441 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 13:02:57.084875 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0273d5340>]}
2021-10-02 13:02:57.085288 (Thread-1): 18:32:57 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.40s]
2021-10-02 13:02:57.085497 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:02:57.085701 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:02:57.086086 (Thread-1): 18:32:57 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 13:02:57.086508 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:57.086695 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:02:57.091608 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:02:57.092287 (Thread-1): finished collecting timing info
2021-10-02 13:02:57.095132 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:57.095363 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 13:02:57.095604 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:02:58.901709 (Thread-1): SQL status: BEGIN in 1.81 seconds
2021-10-02 13:02:58.901961 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:58.902113 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_STARTED');commit;
      
2021-10-02 13:02:58.907984 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:02:58.909380 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:02:58.910222 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:58.910444 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:02:58.928336 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 13:02:58.930973 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:58.931188 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 13:02:58.934252 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:02:58.935635 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:58.935833 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action) values('MODEL_ENDED'); commit;
      
2021-10-02 13:02:58.939219 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:58.940168 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:02:58.940348 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:58.940490 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:02:58.942765 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:02:58.944711 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:02:58.944942 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 13:02:58.947238 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:02:58.948664 (Thread-1): finished collecting timing info
2021-10-02 13:02:58.948907 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 13:02:58.949369 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd43ea84-c0c3-41d2-a08c-600f9663ea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0274c1880>]}
2021-10-02 13:02:58.949750 (Thread-1): 18:32:58 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.86s]
2021-10-02 13:02:58.949953 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:02:58.950919 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:02:58.951148 (MainThread): Using postgres connection "master".
2021-10-02 13:02:58.951298 (MainThread): On master: BEGIN
2021-10-02 13:02:58.951448 (MainThread): Opening a new connection, currently in state closed
2021-10-02 13:03:00.730761 (MainThread): SQL status: BEGIN in 1.78 seconds
2021-10-02 13:03:00.731035 (MainThread): On master: COMMIT
2021-10-02 13:03:00.731188 (MainThread): Using postgres connection "master".
2021-10-02 13:03:00.731329 (MainThread): On master: COMMIT
2021-10-02 13:03:00.732882 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:03:00.733070 (MainThread): 18:33:00 | 
2021-10-02 13:03:00.733256 (MainThread): 18:33:00 | Running 1 on-run-end hook
2021-10-02 13:03:00.733429 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 13:03:00.734823 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-02 13:03:00.735815 (MainThread): 18:33:00 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-02 13:03:00.736036 (MainThread): Using postgres connection "master".
2021-10-02 13:03:00.736186 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
insert into dbtdemo.dbt_audit_table (action) values('BUILD_ENDED'); commit;
2021-10-02 13:03:00.743124 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:03:00.744045 (MainThread): 18:33:00 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-10-02 13:03:00.744265 (MainThread): 18:33:00 | 
2021-10-02 13:03:00.744461 (MainThread): On master: Close
2021-10-02 13:03:00.744897 (MainThread): 18:33:00 | 
2021-10-02 13:03:00.745085 (MainThread): 18:33:00 | Finished running 1 table model, 3 view models, 2 hooks in 18.60s.
2021-10-02 13:03:00.745253 (MainThread): Connection 'master' was properly closed.
2021-10-02 13:03:00.745389 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 13:03:00.754493 (MainThread): 
2021-10-02 13:03:00.755009 (MainThread): Completed successfully
2021-10-02 13:03:00.755265 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 13:03:00.755578 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0274457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0273b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0271079a0>]}
2021-10-02 13:03:00.755971 (MainThread): Flushing usage events
2021-10-02 13:11:48.456211 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 13:11:48.553034 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 13:11:48.554606 (MainThread): Tracking: tracking
2021-10-02 13:11:48.570811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06a12d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06a12c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06a129d0>]}
2021-10-02 13:11:48.592696 (MainThread): Partial parsing not enabled
2021-10-02 13:11:48.662037 (MainThread): Parsing macros/test_empty.sql
2021-10-02 13:11:48.662972 (MainThread): Parsing macros/audits.sql
2021-10-02 13:11:48.663567 (MainThread): Parsing macros/test_country.sql
2021-10-02 13:11:48.664222 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 13:11:48.665339 (MainThread): Parsing macros/catalog.sql
2021-10-02 13:11:48.669296 (MainThread): Parsing macros/relations.sql
2021-10-02 13:11:48.671025 (MainThread): Parsing macros/adapters.sql
2021-10-02 13:11:48.699770 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 13:11:48.701945 (MainThread): Parsing macros/core.sql
2021-10-02 13:11:48.706318 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 13:11:48.714360 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 13:11:48.726951 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 13:11:48.729018 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 13:11:48.749206 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 13:11:48.784444 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 13:11:48.805853 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 13:11:48.807572 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 13:11:48.817613 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 13:11:48.837527 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 13:11:48.850731 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 13:11:48.858176 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 13:11:48.865187 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 13:11:48.868742 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 13:11:48.869666 (MainThread): Parsing macros/etc/query.sql
2021-10-02 13:11:48.870577 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 13:11:48.871963 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 13:11:48.880348 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 13:11:48.882031 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 13:11:48.883419 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 13:11:48.941968 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 13:11:48.944125 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 13:11:48.945534 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 13:11:48.947155 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 13:11:48.949628 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 13:11:48.950855 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 13:11:48.952487 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 13:11:48.954947 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 13:11:48.962045 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 13:11:48.963356 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 13:11:48.964816 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 13:11:48.967294 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 13:11:48.968375 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 13:11:48.970597 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 13:11:48.980363 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 13:11:48.982139 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 13:11:48.983454 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 13:11:48.984982 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 13:11:48.986473 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 13:11:48.987432 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 13:11:48.990544 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 13:11:48.995540 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 13:11:48.996484 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 13:11:48.998989 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 13:11:49.000773 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 13:11:49.002164 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 13:11:49.003911 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 13:11:49.027215 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 13:11:49.027873 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 13:11:49.028518 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 13:11:49.029101 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 13:11:49.032184 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 13:11:49.033505 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 13:11:49.035380 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 13:11:49.036313 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 13:11:49.037129 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 13:11:49.038235 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 13:11:49.040142 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 13:11:49.041305 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 13:11:49.042141 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 13:11:49.043841 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 13:11:49.044675 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 13:11:49.046975 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 13:11:49.048496 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 13:11:49.049447 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 13:11:49.050608 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 13:11:49.053698 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 13:11:49.058950 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 13:11:49.060032 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 13:11:49.062203 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 13:11:49.065138 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 13:11:49.067403 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 13:11:49.068281 (MainThread): Parsing macros/sql/star.sql
2021-10-02 13:11:49.071233 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 13:11:49.077135 (MainThread): Parsing macros/sql/union.sql
2021-10-02 13:11:49.084380 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 13:11:49.085179 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 13:11:49.087647 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 13:11:49.088519 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 13:11:49.089546 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 13:11:49.091982 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 13:11:49.095839 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 13:11:49.098405 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 13:11:49.252017 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 13:11:49.252238 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06ac50a0>]}
2021-10-02 13:11:49.388618 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:11:49.402965 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:11:49.409559 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:11:49.415408 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:11:49.421644 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 13:11:49.427576 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 13:11:49.449726 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 13:11:49.541482 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 13:11:49.546886 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06bae370>]}
2021-10-02 13:11:49.555412 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06bae580>]}
2021-10-02 13:11:49.555862 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 1 operation, 1 seed file, 6 sources, 0 exposures
2021-10-02 13:11:49.557535 (MainThread): 
2021-10-02 13:11:49.558002 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:11:49.559084 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 13:11:49.569400 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 13:11:49.569606 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 13:11:49.569763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 13:11:54.736660 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 5.17 seconds
2021-10-02 13:11:54.738212 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 13:11:54.740336 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 13:11:54.747141 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:11:54.747358 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 13:11:54.747508 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:11:56.193604 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.45 seconds
2021-10-02 13:11:56.193848 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:11:56.194011 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 13:11:56.210207 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 13:11:56.211244 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 13:11:56.212566 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 13:11:56.212969 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:11:56.249893 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:11:56.250158 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 13:11:56.250328 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:11:57.705576 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.46 seconds
2021-10-02 13:11:57.705871 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:11:57.706021 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 13:11:57.718229 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 13:11:57.719367 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 13:11:57.721112 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 13:11:57.721623 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 13:11:57.723214 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:11:57.723371 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 13:11:57.723506 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:11:59.575414 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.85 seconds
2021-10-02 13:11:59.575650 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:11:59.575787 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 13:11:59.591840 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 13:11:59.593253 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 13:11:59.594677 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 13:11:59.600303 (MainThread): Using postgres connection "master".
2021-10-02 13:11:59.600505 (MainThread): On master: BEGIN
2021-10-02 13:11:59.600638 (MainThread): Opening a new connection, currently in state init
2021-10-02 13:12:01.561889 (MainThread): SQL status: BEGIN in 1.96 seconds
2021-10-02 13:12:01.562089 (MainThread): Using postgres connection "master".
2021-10-02 13:12:01.562205 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 13:12:01.610772 (MainThread): SQL status: SELECT 7 in 0.05 seconds
2021-10-02 13:12:01.612013 (MainThread): On master: ROLLBACK
2021-10-02 13:12:01.613563 (MainThread): Using postgres connection "master".
2021-10-02 13:12:01.613684 (MainThread): On master: BEGIN
2021-10-02 13:12:01.616164 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 13:12:01.616323 (MainThread): On master: COMMIT
2021-10-02 13:12:01.616441 (MainThread): Using postgres connection "master".
2021-10-02 13:12:01.616546 (MainThread): On master: COMMIT
2021-10-02 13:12:01.617724 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:12:01.617882 (MainThread): 18:42:01 | 
2021-10-02 13:12:01.618029 (MainThread): 18:42:01 | Running 1 on-run-start hook
2021-10-02 13:12:01.618164 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 13:12:01.619995 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 13:12:01.621235 (MainThread): 18:42:01 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 13:12:01.621413 (MainThread): Using postgres connection "master".
2021-10-02 13:12:01.621526 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action) 
	values('BUILD_ENDED')


2021-10-02 13:12:01.636287 (MainThread): SQL status: INSERT 0 1 in 0.01 seconds
2021-10-02 13:12:01.637009 (MainThread): 18:42:01 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [INSERT 0 1 in 0.02s]
2021-10-02 13:12:01.637181 (MainThread): 18:42:01 | 
2021-10-02 13:12:01.637334 (MainThread): On master: Close
2021-10-02 13:12:01.637626 (MainThread): 18:42:01 | Concurrency: 1 threads (target='dev')
2021-10-02 13:12:01.637771 (MainThread): 18:42:01 | 
2021-10-02 13:12:01.639750 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:12:01.640044 (Thread-1): 18:42:01 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 13:12:01.640399 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:01.640638 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 13:12:01.643787 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:12:01.644395 (Thread-1): finished collecting timing info
2021-10-02 13:12:01.665977 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:01.666253 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 13:12:01.666433 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:12:03.511315 (Thread-1): SQL status: BEGIN in 1.84 seconds
2021-10-02 13:12:03.511563 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:03.511712 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:12:03.515769 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:12:03.521549 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:12:03.522266 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:03.522429 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 13:12:03.554291 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 13:12:03.560723 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:03.560933 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 13:12:03.562604 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:12:03.564915 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:03.565074 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 13:12:03.566905 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:12:03.577450 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:12:03.577681 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:03.577823 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:12:03.581547 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:12:03.587521 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:12:03.587709 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 13:12:03.598762 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 13:12:03.599839 (Thread-1): finished collecting timing info
2021-10-02 13:12:03.600033 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 13:12:03.600403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06813280>]}
2021-10-02 13:12:03.600734 (Thread-1): 18:42:03 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.96s]
2021-10-02 13:12:03.600915 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:12:03.601076 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:12:03.601351 (Thread-1): 18:42:03 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 13:12:03.601607 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:03.601742 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:12:03.605165 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:12:03.605697 (Thread-1): finished collecting timing info
2021-10-02 13:12:03.620375 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:03.620589 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 13:12:03.620732 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:12:05.049368 (Thread-1): SQL status: BEGIN in 1.43 seconds
2021-10-02 13:12:05.049633 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:05.050062 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:12:05.055272 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:12:05.059964 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:12:05.060934 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:05.061138 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 13:12:05.084453 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 13:12:05.087245 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:05.087437 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 13:12:05.089768 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:12:05.092216 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:05.092401 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 13:12:05.094458 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:12:05.095596 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:12:05.095766 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:05.095910 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:12:05.100074 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:12:05.101999 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:12:05.102184 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 13:12:05.107364 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:12:05.108520 (Thread-1): finished collecting timing info
2021-10-02 13:12:05.108727 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 13:12:05.109128 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06c59880>]}
2021-10-02 13:12:05.109512 (Thread-1): 18:42:05 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.51s]
2021-10-02 13:12:05.109740 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:12:05.110833 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:12:05.111186 (Thread-1): 18:42:05 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 13:12:05.111544 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:05.111720 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:12:05.116136 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:12:05.116822 (Thread-1): finished collecting timing info
2021-10-02 13:12:05.120921 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:05.121392 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 13:12:05.121562 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:12:06.686301 (Thread-1): SQL status: BEGIN in 1.56 seconds
2021-10-02 13:12:06.686558 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:06.686705 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:12:06.691093 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:12:06.692289 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:12:06.692889 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:06.693041 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:12:06.705537 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:12:06.708594 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:06.708793 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 13:12:06.711512 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:12:06.712940 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:12:06.713122 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:06.713378 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:12:06.718214 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:12:06.720372 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:12:06.720578 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 13:12:06.722814 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:12:06.724020 (Thread-1): finished collecting timing info
2021-10-02 13:12:06.724235 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 13:12:06.724687 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06813280>]}
2021-10-02 13:12:06.725165 (Thread-1): 18:42:06 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.61s]
2021-10-02 13:12:06.725452 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:12:06.725694 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:12:06.726155 (Thread-1): 18:42:06 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 13:12:06.726575 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:06.726759 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:12:06.733456 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:12:06.734138 (Thread-1): finished collecting timing info
2021-10-02 13:12:06.737966 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:06.738221 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 13:12:06.738382 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:12:08.329517 (Thread-1): SQL status: BEGIN in 1.59 seconds
2021-10-02 13:12:08.329788 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:08.329940 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:12:08.334516 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:12:08.335765 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:12:08.336429 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:08.336649 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:12:08.350927 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:12:08.353532 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:08.353708 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 13:12:08.355870 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:12:08.357089 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:12:08.357263 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:08.357407 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:12:08.361055 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:12:08.362960 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:12:08.363127 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 13:12:08.365213 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:12:08.366533 (Thread-1): finished collecting timing info
2021-10-02 13:12:08.366832 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 13:12:08.367310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c999870a-2519-497f-82ca-4c1138df4b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0113e340>]}
2021-10-02 13:12:08.367712 (Thread-1): 18:42:08 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.64s]
2021-10-02 13:12:08.367958 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:12:08.369237 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:12:08.369468 (MainThread): Using postgres connection "master".
2021-10-02 13:12:08.369619 (MainThread): On master: BEGIN
2021-10-02 13:12:08.369764 (MainThread): Opening a new connection, currently in state closed
2021-10-02 13:12:10.165794 (MainThread): SQL status: BEGIN in 1.80 seconds
2021-10-02 13:12:10.166043 (MainThread): On master: COMMIT
2021-10-02 13:12:10.166191 (MainThread): Using postgres connection "master".
2021-10-02 13:12:10.166324 (MainThread): On master: COMMIT
2021-10-02 13:12:10.167931 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:12:10.168136 (MainThread): On master: Close
2021-10-02 13:12:10.168536 (MainThread): 18:42:10 | 
2021-10-02 13:12:10.168721 (MainThread): 18:42:10 | Finished running 1 table model, 3 view models, 1 hook in 20.61s.
2021-10-02 13:12:10.168879 (MainThread): Connection 'master' was properly closed.
2021-10-02 13:12:10.169012 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 13:12:10.177564 (MainThread): 
2021-10-02 13:12:10.177820 (MainThread): Completed successfully
2021-10-02 13:12:10.178123 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 13:12:10.178484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06856460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb06a12c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb068e4190>]}
2021-10-02 13:12:10.178844 (MainThread): Flushing usage events
2021-10-02 13:13:55.793252 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 13:13:55.893980 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 13:13:55.895769 (MainThread): Tracking: tracking
2021-10-02 13:13:55.912560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e9125f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e91406a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e9140e50>]}
2021-10-02 13:13:55.933471 (MainThread): Partial parsing not enabled
2021-10-02 13:13:55.993913 (MainThread): Parsing macros/test_empty.sql
2021-10-02 13:13:55.994789 (MainThread): Parsing macros/audits.sql
2021-10-02 13:13:55.995325 (MainThread): Parsing macros/test_country.sql
2021-10-02 13:13:55.995921 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 13:13:55.996872 (MainThread): Parsing macros/catalog.sql
2021-10-02 13:13:56.000303 (MainThread): Parsing macros/relations.sql
2021-10-02 13:13:56.002001 (MainThread): Parsing macros/adapters.sql
2021-10-02 13:13:56.025395 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 13:13:56.026945 (MainThread): Parsing macros/core.sql
2021-10-02 13:13:56.030466 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 13:13:56.037157 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 13:13:56.046893 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 13:13:56.048538 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 13:13:56.065786 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 13:13:56.101436 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 13:13:56.121540 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 13:13:56.123170 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 13:13:56.132926 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 13:13:56.153554 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 13:13:56.168005 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 13:13:56.175885 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 13:13:56.182999 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 13:13:56.186713 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 13:13:56.187608 (MainThread): Parsing macros/etc/query.sql
2021-10-02 13:13:56.188561 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 13:13:56.189972 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 13:13:56.197894 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 13:13:56.199657 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 13:13:56.201063 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 13:13:56.255730 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 13:13:56.257390 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 13:13:56.258530 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 13:13:56.259728 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 13:13:56.261675 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 13:13:56.262745 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 13:13:56.264429 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 13:13:56.266838 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 13:13:56.277891 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 13:13:56.279934 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 13:13:56.283022 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 13:13:56.289094 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 13:13:56.290436 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 13:13:56.294868 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 13:13:56.310707 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 13:13:56.313780 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 13:13:56.315474 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 13:13:56.317549 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 13:13:56.320437 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 13:13:56.321905 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 13:13:56.326879 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 13:13:56.334361 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 13:13:56.335736 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 13:13:56.340382 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 13:13:56.343817 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 13:13:56.345768 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 13:13:56.348224 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 13:13:56.376328 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 13:13:56.377068 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 13:13:56.377706 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 13:13:56.378378 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 13:13:56.381810 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 13:13:56.382965 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 13:13:56.384843 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 13:13:56.385816 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 13:13:56.386695 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 13:13:56.387813 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 13:13:56.389586 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 13:13:56.390667 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 13:13:56.391546 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 13:13:56.392899 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 13:13:56.393722 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 13:13:56.396086 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 13:13:56.397409 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 13:13:56.398313 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 13:13:56.399677 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 13:13:56.402934 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 13:13:56.408901 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 13:13:56.409923 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 13:13:56.412194 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 13:13:56.415179 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 13:13:56.417407 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 13:13:56.418281 (MainThread): Parsing macros/sql/star.sql
2021-10-02 13:13:56.420781 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 13:13:56.426334 (MainThread): Parsing macros/sql/union.sql
2021-10-02 13:13:56.433460 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 13:13:56.434404 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 13:13:56.437194 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 13:13:56.438088 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 13:13:56.439126 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 13:13:56.441683 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 13:13:56.445762 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 13:13:56.448209 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 13:13:56.599741 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 13:13:56.599964 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e91d55b0>]}
2021-10-02 13:13:56.713535 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:13:56.725572 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:13:56.731023 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:13:56.736162 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:13:56.741665 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 13:13:56.747484 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 13:13:56.768627 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 13:13:56.858972 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 13:13:56.864098 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e92fd640>]}
2021-10-02 13:13:56.872537 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e921bb80>]}
2021-10-02 13:13:56.872826 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 1 operation, 1 seed file, 6 sources, 0 exposures
2021-10-02 13:13:56.874252 (MainThread): 
2021-10-02 13:13:56.874752 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:13:56.875663 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 13:13:56.883575 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 13:13:56.883743 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 13:13:56.883861 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 13:13:58.403425 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.52 seconds
2021-10-02 13:13:58.405054 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 13:13:58.407305 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:13:58.414924 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:13:58.415371 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 13:13:58.415620 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:14:00.049032 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.63 seconds
2021-10-02 13:14:00.049288 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:14:00.049444 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 13:14:00.063710 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 13:14:00.064917 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 13:14:00.066670 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 13:14:00.067427 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 13:14:00.104997 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:14:00.105209 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 13:14:00.105361 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:14:01.579356 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-10-02 13:14:01.579636 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:14:01.579801 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 13:14:01.595357 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 13:14:01.596737 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 13:14:01.598923 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 13:14:01.599670 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 13:14:01.601522 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:14:01.601736 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 13:14:01.601896 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:14:03.154587 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.55 seconds
2021-10-02 13:14:03.154905 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:14:03.155103 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 13:14:03.173256 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 13:14:03.175238 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 13:14:03.177404 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 13:14:03.185423 (MainThread): Using postgres connection "master".
2021-10-02 13:14:03.185731 (MainThread): On master: BEGIN
2021-10-02 13:14:03.185906 (MainThread): Opening a new connection, currently in state init
2021-10-02 13:14:04.775956 (MainThread): SQL status: BEGIN in 1.59 seconds
2021-10-02 13:14:04.776192 (MainThread): Using postgres connection "master".
2021-10-02 13:14:04.776334 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 13:14:04.829609 (MainThread): SQL status: SELECT 7 in 0.05 seconds
2021-10-02 13:14:04.830833 (MainThread): On master: ROLLBACK
2021-10-02 13:14:04.832391 (MainThread): Using postgres connection "master".
2021-10-02 13:14:04.832542 (MainThread): On master: BEGIN
2021-10-02 13:14:04.835061 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 13:14:04.835253 (MainThread): On master: COMMIT
2021-10-02 13:14:04.835375 (MainThread): Using postgres connection "master".
2021-10-02 13:14:04.835478 (MainThread): On master: COMMIT
2021-10-02 13:14:04.836594 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:14:04.836760 (MainThread): 18:44:04 | 
2021-10-02 13:14:04.836912 (MainThread): 18:44:04 | Running 1 on-run-start hook
2021-10-02 13:14:04.837051 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 13:14:04.838943 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 13:14:04.840213 (MainThread): 18:44:04 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 13:14:04.840422 (MainThread): Using postgres connection "master".
2021-10-02 13:14:04.840548 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action) 
	values('BUILD_ENDED')


2021-10-02 13:14:04.845837 (MainThread): SQL status: INSERT 0 1 in 0.01 seconds
2021-10-02 13:14:04.846562 (MainThread): 18:44:04 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [INSERT 0 1 in 0.01s]
2021-10-02 13:14:04.846735 (MainThread): 18:44:04 | 
2021-10-02 13:14:04.846888 (MainThread): On master: Close
2021-10-02 13:14:04.847181 (MainThread): 18:44:04 | Concurrency: 1 threads (target='dev')
2021-10-02 13:14:04.847321 (MainThread): 18:44:04 | 
2021-10-02 13:14:04.849823 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:14:04.850265 (Thread-1): 18:44:04 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 13:14:04.850823 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:04.851122 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 13:14:04.853509 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:14:04.854335 (Thread-1): finished collecting timing info
2021-10-02 13:14:04.877467 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:04.877742 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 13:14:04.877912 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:14:06.708055 (Thread-1): SQL status: BEGIN in 1.83 seconds
2021-10-02 13:14:06.708307 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:06.708475 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:14:06.713321 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:14:06.719838 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:14:06.720803 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:06.721043 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 13:14:06.747894 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 13:14:06.755963 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:06.756204 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 13:14:06.758549 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:14:06.761187 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:06.761434 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 13:14:06.763801 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:14:06.776727 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:14:06.776953 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:06.777102 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:14:06.780632 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:14:06.788198 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:14:06.788449 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 13:14:06.802153 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 13:14:06.803511 (Thread-1): finished collecting timing info
2021-10-02 13:14:06.803787 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 13:14:06.804292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e91684c0>]}
2021-10-02 13:14:06.804755 (Thread-1): 18:44:06 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.95s]
2021-10-02 13:14:06.804984 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:14:06.805223 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:14:06.805636 (Thread-1): 18:44:06 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 13:14:06.806006 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:06.806221 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:14:06.810934 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:14:06.812169 (Thread-1): finished collecting timing info
2021-10-02 13:14:06.830226 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:06.830451 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 13:14:06.830605 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:14:08.644325 (Thread-1): SQL status: BEGIN in 1.81 seconds
2021-10-02 13:14:08.645283 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:08.645455 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:14:08.649100 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:14:08.653694 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:14:08.654739 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:08.654913 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 13:14:08.666859 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:14:08.669389 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:08.669559 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 13:14:08.671440 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:14:08.673626 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:08.673788 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 13:14:08.675487 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:14:08.676585 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:14:08.676750 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:08.676882 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:14:08.679773 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:14:08.681538 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:14:08.681694 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 13:14:08.686534 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:14:08.687702 (Thread-1): finished collecting timing info
2021-10-02 13:14:08.687910 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 13:14:08.688294 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e93a1520>]}
2021-10-02 13:14:08.688650 (Thread-1): 18:44:08 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.88s]
2021-10-02 13:14:08.688842 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:14:08.689514 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:14:08.689855 (Thread-1): 18:44:08 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 13:14:08.690228 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:08.690404 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:14:08.694621 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:14:08.695286 (Thread-1): finished collecting timing info
2021-10-02 13:14:08.698502 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:08.698884 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 13:14:08.699041 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:14:10.178476 (Thread-1): SQL status: BEGIN in 1.48 seconds
2021-10-02 13:14:10.178724 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:10.178876 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:14:10.182571 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:14:10.183787 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:14:10.184454 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:10.184653 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:14:10.197372 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:14:10.199782 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:10.199955 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 13:14:10.201532 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:14:10.202588 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:14:10.202746 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:10.202877 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:14:10.205901 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:14:10.207655 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:14:10.207821 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 13:14:10.209940 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:14:10.211019 (Thread-1): finished collecting timing info
2021-10-02 13:14:10.211221 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 13:14:10.211614 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e92321f0>]}
2021-10-02 13:14:10.211978 (Thread-1): 18:44:10 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.52s]
2021-10-02 13:14:10.212169 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:14:10.212363 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:14:10.212705 (Thread-1): 18:44:10 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 13:14:10.213044 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:10.213214 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:14:10.218970 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:14:10.219629 (Thread-1): finished collecting timing info
2021-10-02 13:14:10.223445 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:10.223691 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 13:14:10.223857 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:14:11.834937 (Thread-1): SQL status: BEGIN in 1.61 seconds
2021-10-02 13:14:11.835209 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:11.835367 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:14:11.839906 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:14:11.841155 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:14:11.841792 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:11.841955 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:14:11.854354 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:14:11.857026 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:11.857230 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 13:14:11.859174 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:14:11.860317 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:14:11.860511 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:11.860655 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:14:11.864462 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:14:11.866395 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:14:11.866598 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 13:14:11.868833 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:14:11.870309 (Thread-1): finished collecting timing info
2021-10-02 13:14:11.870567 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 13:14:11.870992 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b24f9d4-f780-497c-ab7e-3fc56f70870b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e9232d00>]}
2021-10-02 13:14:11.871491 (Thread-1): 18:44:11 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.66s]
2021-10-02 13:14:11.871713 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:14:11.872863 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:14:11.873090 (MainThread): Using postgres connection "master".
2021-10-02 13:14:11.873249 (MainThread): On master: BEGIN
2021-10-02 13:14:11.873396 (MainThread): Opening a new connection, currently in state closed
2021-10-02 13:14:13.462966 (MainThread): SQL status: BEGIN in 1.59 seconds
2021-10-02 13:14:13.463264 (MainThread): On master: COMMIT
2021-10-02 13:14:13.463432 (MainThread): Using postgres connection "master".
2021-10-02 13:14:13.463575 (MainThread): On master: COMMIT
2021-10-02 13:14:13.465204 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:14:13.465440 (MainThread): On master: Close
2021-10-02 13:14:13.465874 (MainThread): 18:44:13 | 
2021-10-02 13:14:13.466121 (MainThread): 18:44:13 | Finished running 1 table model, 3 view models, 1 hook in 16.59s.
2021-10-02 13:14:13.466362 (MainThread): Connection 'master' was properly closed.
2021-10-02 13:14:13.466552 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 13:14:13.475572 (MainThread): 
2021-10-02 13:14:13.476082 (MainThread): Completed successfully
2021-10-02 13:14:13.476432 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 13:14:13.476795 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e92a8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e91408b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e9232250>]}
2021-10-02 13:14:13.477102 (MainThread): Flushing usage events
2021-10-02 13:20:10.767355 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 13:20:10.868720 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 13:20:10.870556 (MainThread): Tracking: tracking
2021-10-02 13:20:10.889191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a92b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a93f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a93fe50>]}
2021-10-02 13:20:10.913463 (MainThread): Partial parsing not enabled
2021-10-02 13:20:10.980819 (MainThread): Parsing macros/test_empty.sql
2021-10-02 13:20:10.981628 (MainThread): Parsing macros/audits.sql
2021-10-02 13:20:10.982480 (MainThread): Parsing macros/test_country.sql
2021-10-02 13:20:10.983892 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 13:20:10.985273 (MainThread): Parsing macros/catalog.sql
2021-10-02 13:20:10.990020 (MainThread): Parsing macros/relations.sql
2021-10-02 13:20:10.991404 (MainThread): Parsing macros/adapters.sql
2021-10-02 13:20:11.016232 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 13:20:11.018280 (MainThread): Parsing macros/core.sql
2021-10-02 13:20:11.022914 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 13:20:11.032198 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 13:20:11.044792 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 13:20:11.046763 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 13:20:11.065494 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 13:20:11.100564 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 13:20:11.126603 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 13:20:11.129573 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 13:20:11.141327 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 13:20:11.160425 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 13:20:11.174473 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 13:20:11.182114 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 13:20:11.189107 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 13:20:11.192775 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 13:20:11.193622 (MainThread): Parsing macros/etc/query.sql
2021-10-02 13:20:11.194500 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 13:20:11.195949 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 13:20:11.204022 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 13:20:11.205880 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 13:20:11.207320 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 13:20:11.261366 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 13:20:11.263231 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 13:20:11.264360 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 13:20:11.267553 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 13:20:11.271656 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 13:20:11.273628 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 13:20:11.275872 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 13:20:11.279190 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 13:20:11.285168 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 13:20:11.286287 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 13:20:11.288421 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 13:20:11.291942 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 13:20:11.293734 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 13:20:11.297234 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 13:20:11.307582 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 13:20:11.309342 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 13:20:11.310652 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 13:20:11.312206 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 13:20:11.313734 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 13:20:11.314621 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 13:20:11.318015 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 13:20:11.323077 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 13:20:11.323849 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 13:20:11.326378 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 13:20:11.328400 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 13:20:11.329839 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 13:20:11.331605 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 13:20:11.353827 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 13:20:11.354501 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 13:20:11.355126 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 13:20:11.355740 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 13:20:11.358862 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 13:20:11.360048 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 13:20:11.361923 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 13:20:11.362844 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 13:20:11.363647 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 13:20:11.364933 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 13:20:11.366958 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 13:20:11.368018 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 13:20:11.368857 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 13:20:11.370243 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 13:20:11.371135 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 13:20:11.373494 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 13:20:11.374757 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 13:20:11.375652 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 13:20:11.376852 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 13:20:11.379955 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 13:20:11.385323 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 13:20:11.386350 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 13:20:11.389069 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 13:20:11.392582 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 13:20:11.395117 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 13:20:11.395973 (MainThread): Parsing macros/sql/star.sql
2021-10-02 13:20:11.398672 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 13:20:11.404410 (MainThread): Parsing macros/sql/union.sql
2021-10-02 13:20:11.411466 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 13:20:11.412240 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 13:20:11.414691 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 13:20:11.415563 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 13:20:11.416578 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 13:20:11.419004 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 13:20:11.422515 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 13:20:11.424945 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 13:20:11.573753 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 13:20:11.573979 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a9d8580>]}
2021-10-02 13:20:11.691327 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:11.709806 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:11.718045 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:11.725316 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:11.734278 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 13:20:11.741691 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 13:20:11.767310 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 13:20:11.773495 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 13:20:11.857553 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 13:20:11.862658 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7aa5db50>]}
2021-10-02 13:20:11.871280 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7aa5db80>]}
2021-10-02 13:20:11.871745 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 13:20:11.873745 (MainThread): 
2021-10-02 13:20:11.874223 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:20:11.875276 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 13:20:11.925150 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 13:20:11.925391 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 13:20:11.925557 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 13:20:13.499227 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.57 seconds
2021-10-02 13:20:13.500769 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 13:20:13.503065 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 13:20:13.510135 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:20:13.510348 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 13:20:13.510501 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:20:15.024814 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.51 seconds
2021-10-02 13:20:15.025056 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 13:20:15.025236 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 13:20:15.037700 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 13:20:15.038733 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 13:20:15.040191 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 13:20:15.040658 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:20:15.042204 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:20:15.042354 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 13:20:15.042488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:20:16.780397 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.74 seconds
2021-10-02 13:20:16.780641 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 13:20:16.780800 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 13:20:16.793686 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 13:20:16.794840 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 13:20:16.796435 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 13:20:16.796945 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 13:20:16.798619 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:20:16.798787 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 13:20:16.798928 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 13:20:18.818833 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.02 seconds
2021-10-02 13:20:18.819079 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 13:20:18.819235 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 13:20:18.832294 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 13:20:18.833780 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 13:20:18.835276 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 13:20:18.841523 (MainThread): Using postgres connection "master".
2021-10-02 13:20:18.841741 (MainThread): On master: BEGIN
2021-10-02 13:20:18.841890 (MainThread): Opening a new connection, currently in state init
2021-10-02 13:20:20.725890 (MainThread): SQL status: BEGIN in 1.88 seconds
2021-10-02 13:20:20.726177 (MainThread): Using postgres connection "master".
2021-10-02 13:20:20.726344 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 13:20:20.788543 (MainThread): SQL status: SELECT 7 in 0.06 seconds
2021-10-02 13:20:20.789730 (MainThread): On master: ROLLBACK
2021-10-02 13:20:20.791089 (MainThread): Using postgres connection "master".
2021-10-02 13:20:20.791229 (MainThread): On master: BEGIN
2021-10-02 13:20:20.793716 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 13:20:20.793896 (MainThread): On master: COMMIT
2021-10-02 13:20:20.794016 (MainThread): Using postgres connection "master".
2021-10-02 13:20:20.794127 (MainThread): On master: COMMIT
2021-10-02 13:20:20.795379 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:20:20.795528 (MainThread): 18:50:20 | 
2021-10-02 13:20:20.795701 (MainThread): 18:50:20 | Running 1 on-run-start hook
2021-10-02 13:20:20.795838 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 13:20:20.797725 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 13:20:20.799270 (MainThread): 18:50:20 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 13:20:20.799457 (MainThread): Using postgres connection "master".
2021-10-02 13:20:20.799572 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action) 
	values('BUILD_STARTED')


2021-10-02 13:20:20.804949 (MainThread): SQL status: INSERT 0 1 in 0.01 seconds
2021-10-02 13:20:20.805706 (MainThread): 18:50:20 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [INSERT 0 1 in 0.01s]
2021-10-02 13:20:20.805885 (MainThread): 18:50:20 | 
2021-10-02 13:20:20.806062 (MainThread): On master: Close
2021-10-02 13:20:20.806372 (MainThread): 18:50:20 | Concurrency: 1 threads (target='dev')
2021-10-02 13:20:20.806531 (MainThread): 18:50:20 | 
2021-10-02 13:20:20.809572 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:20:20.809934 (Thread-1): 18:50:20 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 13:20:20.810392 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:20.810665 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 13:20:20.813274 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:20:20.814120 (Thread-1): finished collecting timing info
2021-10-02 13:20:20.836343 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:20.836618 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 13:20:20.836778 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:20:22.359587 (Thread-1): SQL status: BEGIN in 1.52 seconds
2021-10-02 13:20:22.359827 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.359972 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_STARTED')
      
2021-10-02 13:20:22.363369 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:22.368678 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 13:20:22.369302 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.369440 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 13:20:22.389441 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-10-02 13:20:22.394416 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.394561 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 13:20:22.396576 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:20:22.399526 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.399670 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 13:20:22.401069 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:20:22.405916 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.406073 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:20:22.407683 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:22.412925 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:20:22.413080 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.413194 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 13:20:22.416654 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:20:22.420569 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 13:20:22.420711 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 13:20:22.429494 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 13:20:22.430480 (Thread-1): finished collecting timing info
2021-10-02 13:20:22.430645 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 13:20:22.430964 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7aabdb80>]}
2021-10-02 13:20:22.431254 (Thread-1): 18:50:22 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.62s]
2021-10-02 13:20:22.431403 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 13:20:22.431554 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:20:22.431811 (Thread-1): 18:50:22 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 13:20:22.432052 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:22.432180 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:20:22.435268 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:20:22.435850 (Thread-1): finished collecting timing info
2021-10-02 13:20:22.449731 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:22.449939 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 13:20:22.450095 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:20:23.822627 (Thread-1): SQL status: BEGIN in 1.37 seconds
2021-10-02 13:20:23.822977 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.823230 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_STARTED')
      
2021-10-02 13:20:23.833608 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-10-02 13:20:23.840577 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 13:20:23.841408 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.841607 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 13:20:23.879478 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-10-02 13:20:23.883682 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.884048 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 13:20:23.887877 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:20:23.891078 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.891310 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 13:20:23.894838 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:20:23.897209 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.897425 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:20:23.899964 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:23.900915 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:20:23.901109 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.901267 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 13:20:23.907275 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 13:20:23.909616 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 13:20:23.909904 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 13:20:23.918713 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 13:20:23.920070 (Thread-1): finished collecting timing info
2021-10-02 13:20:23.920333 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 13:20:23.920942 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a9c4a90>]}
2021-10-02 13:20:23.921482 (Thread-1): 18:50:23 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.49s]
2021-10-02 13:20:23.921841 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 13:20:23.923350 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:20:23.923988 (Thread-1): 18:50:23 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 13:20:23.924485 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:23.924763 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:20:23.932063 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:20:23.933268 (Thread-1): finished collecting timing info
2021-10-02 13:20:23.939288 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:23.939613 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 13:20:23.939850 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:20:25.815521 (Thread-1): SQL status: BEGIN in 1.88 seconds
2021-10-02 13:20:25.815783 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:25.815943 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_STARTED')
      
2021-10-02 13:20:25.820509 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:25.821698 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 13:20:25.822380 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:25.822560 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:20:25.834555 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:20:25.838391 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:25.838588 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 13:20:25.840518 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:20:25.842598 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:25.842771 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:20:25.844431 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:25.845236 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:20:25.845406 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:25.845549 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 13:20:25.849035 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:20:25.850811 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 13:20:25.850971 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 13:20:25.852571 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:20:25.853624 (Thread-1): finished collecting timing info
2021-10-02 13:20:25.853819 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 13:20:25.854222 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ab55d30>]}
2021-10-02 13:20:25.854579 (Thread-1): 18:50:25 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.93s]
2021-10-02 13:20:25.854775 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 13:20:25.854980 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:20:25.855289 (Thread-1): 18:50:25 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 13:20:25.855597 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:25.855762 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:20:25.859530 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:20:25.860133 (Thread-1): finished collecting timing info
2021-10-02 13:20:25.863539 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:25.863774 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 13:20:25.863928 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 13:20:28.106618 (Thread-1): SQL status: BEGIN in 2.24 seconds
2021-10-02 13:20:28.106820 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:28.106940 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_STARTED')
      
2021-10-02 13:20:28.110071 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:28.111045 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 13:20:28.111582 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:28.111724 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 13:20:28.121728 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 13:20:28.124489 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:28.124704 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 13:20:28.127096 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 13:20:28.129251 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:28.129431 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action) 
	values('MODEL_ENDED')
      
2021-10-02 13:20:28.131101 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-02 13:20:28.132103 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:20:28.132273 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:28.132410 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 13:20:28.136484 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:20:28.138284 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 13:20:28.138459 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 13:20:28.140076 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 13:20:28.141187 (Thread-1): finished collecting timing info
2021-10-02 13:20:28.141381 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 13:20:28.141761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd7c9b2-e95a-4c2d-9f5a-3d55d8735a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7ab54fa0>]}
2021-10-02 13:20:28.142112 (Thread-1): 18:50:28 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 2.29s]
2021-10-02 13:20:28.142293 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 13:20:28.143233 (MainThread): Acquiring new postgres connection "master".
2021-10-02 13:20:28.143429 (MainThread): Using postgres connection "master".
2021-10-02 13:20:28.143565 (MainThread): On master: BEGIN
2021-10-02 13:20:28.143696 (MainThread): Opening a new connection, currently in state closed
2021-10-02 13:20:29.714146 (MainThread): SQL status: BEGIN in 1.57 seconds
2021-10-02 13:20:29.714439 (MainThread): On master: COMMIT
2021-10-02 13:20:29.714619 (MainThread): Using postgres connection "master".
2021-10-02 13:20:29.714766 (MainThread): On master: COMMIT
2021-10-02 13:20:29.716264 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 13:20:29.716516 (MainThread): 18:50:29 | 
2021-10-02 13:20:29.716722 (MainThread): 18:50:29 | Running 1 on-run-end hook
2021-10-02 13:20:29.716903 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 13:20:29.719674 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-02 13:20:29.720869 (MainThread): 18:50:29 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-02 13:20:29.721278 (MainThread): Using postgres connection "master".
2021-10-02 13:20:29.721613 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action) 
	values('BUILD_ENDED')


2021-10-02 13:20:29.729569 (MainThread): SQL status: INSERT 0 1 in 0.01 seconds
2021-10-02 13:20:29.730517 (MainThread): 18:50:29 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [INSERT 0 1 in 0.01s]
2021-10-02 13:20:29.730791 (MainThread): 18:50:29 | 
2021-10-02 13:20:29.731010 (MainThread): On master: Close
2021-10-02 13:20:29.731505 (MainThread): 18:50:29 | 
2021-10-02 13:20:29.731698 (MainThread): 18:50:29 | Finished running 1 table model, 3 view models, 2 hooks in 17.86s.
2021-10-02 13:20:29.731873 (MainThread): Connection 'master' was properly closed.
2021-10-02 13:20:29.732052 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 13:20:29.742898 (MainThread): 
2021-10-02 13:20:29.743244 (MainThread): Completed successfully
2021-10-02 13:20:29.743493 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 13:20:29.743854 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a7c4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7aae3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a7ac8b0>]}
2021-10-02 13:20:29.744207 (MainThread): Flushing usage events
2021-10-02 14:20:59.657100 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:20:59.763322 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:20:59.763500 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:20:59.763662 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:20:59.763824 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:20:59.810109 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-10-02 14:20:59.812452 (MainThread): Tracking: tracking
2021-10-02 14:21:00.066282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9013cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9101cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9101d00>]}
2021-10-02 14:21:00.073107 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.073372 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.073544 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.073702 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.080102 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.080432 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.080740 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.081213 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-02 14:21:00.092048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f90ff2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f90ff550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f90ff3d0>]}
2021-10-02 14:21:00.092371 (MainThread): Flushing usage events
2021-10-02 14:21:01.525044 (MainThread): Encountered an error:
2021-10-02 14:21:01.525328 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils
2021-10-02 14:21:01.531317 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0-b1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/generate.py", line 204, in run
    compile_results = CompileTask.run(self)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils

2021-10-02 14:21:30.068822 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:21:30.176061 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='generate', write_json=True)
2021-10-02 14:21:30.177508 (MainThread): Tracking: tracking
2021-10-02 14:21:30.192148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d11e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d12bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d013c40>]}
2021-10-02 14:21:30.217041 (MainThread): Partial parsing not enabled
2021-10-02 14:21:30.288097 (MainThread): Parsing macros/test_empty.sql
2021-10-02 14:21:30.288881 (MainThread): Parsing macros/audits.sql
2021-10-02 14:21:30.289396 (MainThread): Parsing macros/test_country.sql
2021-10-02 14:21:30.289960 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 14:21:30.290837 (MainThread): Parsing macros/catalog.sql
2021-10-02 14:21:30.294374 (MainThread): Parsing macros/relations.sql
2021-10-02 14:21:30.295679 (MainThread): Parsing macros/adapters.sql
2021-10-02 14:21:30.328098 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 14:21:30.330256 (MainThread): Parsing macros/core.sql
2021-10-02 14:21:30.335325 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 14:21:30.346828 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 14:21:30.361599 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 14:21:30.364024 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 14:21:30.390394 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 14:21:30.431073 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 14:21:30.455676 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 14:21:30.457886 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 14:21:30.477106 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 14:21:30.509324 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 14:21:30.528056 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 14:21:30.538539 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 14:21:30.549048 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 14:21:30.553901 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 14:21:30.554992 (MainThread): Parsing macros/etc/query.sql
2021-10-02 14:21:30.556170 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 14:21:30.558051 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 14:21:30.569011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 14:21:30.571432 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 14:21:30.573415 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 14:21:30.644904 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 14:21:30.647316 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 14:21:30.648851 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 14:21:30.650462 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 14:21:30.653121 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 14:21:30.654487 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 14:21:30.656465 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 14:21:30.659202 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 14:21:30.668319 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 14:21:30.669834 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 14:21:30.672670 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 14:21:30.676288 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 14:21:30.677703 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 14:21:30.681298 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 14:21:30.693884 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 14:21:30.697129 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 14:21:30.698980 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 14:21:30.701044 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 14:21:30.702957 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 14:21:30.704125 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 14:21:30.708163 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 14:21:30.714982 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 14:21:30.716013 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 14:21:30.719522 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 14:21:30.722046 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 14:21:30.723984 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 14:21:30.726464 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 14:21:30.760444 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 14:21:30.761365 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 14:21:30.762367 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 14:21:30.763453 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 14:21:30.767559 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 14:21:30.769159 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 14:21:30.771682 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 14:21:30.772969 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 14:21:30.774027 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 14:21:30.775529 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 14:21:30.777913 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 14:21:30.779347 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 14:21:30.780529 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 14:21:30.782355 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 14:21:30.783477 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 14:21:30.786477 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 14:21:30.788224 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 14:21:30.789470 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 14:21:30.791133 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 14:21:30.796264 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 14:21:30.803906 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 14:21:30.805361 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 14:21:30.808557 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 14:21:30.812907 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 14:21:30.816072 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 14:21:30.817400 (MainThread): Parsing macros/sql/star.sql
2021-10-02 14:21:30.820822 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 14:21:30.828531 (MainThread): Parsing macros/sql/union.sql
2021-10-02 14:21:30.838687 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 14:21:30.839871 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 14:21:30.843318 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 14:21:30.844555 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 14:21:30.846088 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 14:21:30.849727 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 14:21:30.854605 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 14:21:30.858035 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 14:21:31.061456 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 14:21:31.061730 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7eb5d51-fe18-47c3-aadd-7def0e7d03ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d1cd610>]}
2021-10-02 14:21:31.212330 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:21:31.229112 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:21:31.237613 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:21:31.245796 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:21:31.255113 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 14:21:31.262017 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 14:21:31.288289 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 14:21:31.296536 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 14:21:31.424451 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 14:21:31.432154 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7eb5d51-fe18-47c3-aadd-7def0e7d03ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d2e9d00>]}
2021-10-02 14:21:31.443954 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7eb5d51-fe18-47c3-aadd-7def0e7d03ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d215e50>]}
2021-10-02 14:21:31.444395 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 14:21:31.447385 (MainThread): 
2021-10-02 14:21:31.447876 (MainThread): Acquiring new postgres connection "master".
2021-10-02 14:21:31.449976 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:21:31.506205 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:21:31.506465 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 14:21:31.506640 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 14:21:36.497221 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 4.99 seconds
2021-10-02 14:21:36.498075 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:21:36.498277 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 14:21:36.535793 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.04 seconds
2021-10-02 14:21:36.537315 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 14:21:36.538876 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 14:21:36.539466 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 14:21:36.542011 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 14:21:36.542295 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 14:21:36.542450 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 14:21:38.222884 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.68 seconds
2021-10-02 14:21:38.223144 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 14:21:38.223304 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 14:21:38.237917 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 14:21:38.239530 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 14:21:38.242048 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 14:21:38.242725 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 14:21:38.244875 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 14:21:38.245118 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 14:21:38.245322 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 14:21:39.811292 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.57 seconds
2021-10-02 14:21:39.811533 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 14:21:39.811683 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 14:21:39.825976 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 14:21:39.827397 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 14:21:39.829327 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 14:21:39.835939 (MainThread): Using postgres connection "master".
2021-10-02 14:21:39.836172 (MainThread): On master: BEGIN
2021-10-02 14:21:39.836336 (MainThread): Opening a new connection, currently in state init
2021-10-02 14:21:41.262456 (MainThread): SQL status: BEGIN in 1.43 seconds
2021-10-02 14:21:41.262782 (MainThread): Using postgres connection "master".
2021-10-02 14:21:41.262932 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 14:21:41.344655 (MainThread): SQL status: SELECT 7 in 0.08 seconds
2021-10-02 14:21:41.346562 (MainThread): On master: ROLLBACK
2021-10-02 14:21:41.348612 (MainThread): On master: Close
2021-10-02 14:21:41.349057 (MainThread): 19:51:41 | Concurrency: 1 threads (target='dev')
2021-10-02 14:21:41.349276 (MainThread): 19:51:41 | 
2021-10-02 14:21:41.354442 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 14:21:41.355244 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:21:41.355473 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 14:21:41.359528 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 14:21:41.361113 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.361421 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.361886 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 14:21:41.362233 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-10-02 14:21:41.363015 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 14:21:41.363452 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-10-02 14:21:41.367533 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-10-02 14:21:41.369640 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.370195 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.370910 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-10-02 14:21:41.371276 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:21:41.371800 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:21:41.372226 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:21:41.377431 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 14:21:41.378246 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.378581 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.379023 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:21:41.379231 (Thread-1): Began running node operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 14:21:41.379936 (Thread-1): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 14:21:41.380134 (Thread-1): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 14:21:41.382971 (Thread-1): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-02 14:21:41.383828 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.384459 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.385400 (Thread-1): Finished running node operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 14:21:41.385927 (Thread-1): Began running node operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 14:21:41.386791 (Thread-1): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 14:21:41.387186 (Thread-1): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 14:21:41.392191 (Thread-1): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 14:21:41.393548 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.393865 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.395011 (Thread-1): Finished running node operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 14:21:41.395455 (Thread-1): Began running node seed.dbt_demo_project.locations
2021-10-02 14:21:41.396281 (Thread-1): Acquiring new postgres connection "seed.dbt_demo_project.locations".
2021-10-02 14:21:41.396572 (Thread-1): Compiling seed.dbt_demo_project.locations
2021-10-02 14:21:41.400723 (Thread-1): Writing injected SQL for node "seed.dbt_demo_project.locations"
2021-10-02 14:21:41.401016 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.401282 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.401684 (Thread-1): Finished running node seed.dbt_demo_project.locations
2021-10-02 14:21:41.401952 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 14:21:41.402405 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-02 14:21:41.402592 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 14:21:41.407651 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-02 14:21:41.408799 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.409166 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.409715 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-02 14:21:41.410011 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 14:21:41.410471 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-02 14:21:41.410658 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 14:21:41.418164 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-02 14:21:41.418839 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.419056 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.419415 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-02 14:21:41.419691 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 14:21:41.420197 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-02 14:21:41.420586 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 14:21:41.429572 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-02 14:21:41.430412 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.430834 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.431437 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-02 14:21:41.431661 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-10-02 14:21:41.432108 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 14:21:41.432290 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-10-02 14:21:41.435504 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-10-02 14:21:41.436483 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.436743 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.437156 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-10-02 14:21:41.437395 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-02 14:21:41.437952 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-02 14:21:41.438325 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-02 14:21:41.443896 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-10-02 14:21:41.445966 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.446444 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.447224 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-02 14:21:41.447443 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-02 14:21:41.447854 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-02 14:21:41.448029 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-02 14:21:41.452528 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-02 14:21:41.453548 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.453786 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.454336 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-02 14:21:41.454637 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:21:41.455188 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:21:41.455385 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:21:41.459173 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 14:21:41.460315 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.460803 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.461435 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:21:41.461752 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:21:41.462552 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:21:41.463038 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:21:41.467513 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 14:21:41.468307 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.468610 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.469024 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:21:41.469248 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 14:21:41.469764 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-02 14:21:41.470031 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 14:21:41.474677 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-02 14:21:41.475373 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.475608 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.475985 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-02 14:21:41.476185 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-02 14:21:41.476702 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-02 14:21:41.476895 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-02 14:21:41.481359 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-02 14:21:41.482115 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.482344 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.482725 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-02 14:21:41.482928 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-02 14:21:41.485083 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-02 14:21:41.485284 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-02 14:21:41.490055 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-10-02 14:21:41.490711 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.490931 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.491304 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-02 14:21:41.491506 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 14:21:41.491901 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-02 14:21:41.492069 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 14:21:41.496799 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-02 14:21:41.497519 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.497738 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.498102 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-02 14:21:41.498304 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 14:21:41.498738 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-02 14:21:41.498920 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 14:21:41.503702 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-02 14:21:41.504393 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.504631 (Thread-1): finished collecting timing info
2021-10-02 14:21:41.505119 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-02 14:21:41.506250 (MainThread): Connection 'master' was properly closed.
2021-10-02 14:21:41.506418 (MainThread): Connection 'test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a' was properly closed.
2021-10-02 14:21:41.515835 (MainThread): 19:51:41 | Done.
2021-10-02 14:21:41.521166 (MainThread): Acquiring new postgres connection "generate_catalog".
2021-10-02 14:21:41.521401 (MainThread): 19:51:41 | Building catalog
2021-10-02 14:21:41.526496 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "postgres.information_schema".
2021-10-02 14:21:41.534617 (ThreadPoolExecutor-1_0): Using postgres connection "postgres.information_schema".
2021-10-02 14:21:41.534858 (ThreadPoolExecutor-1_0): On postgres.information_schema: BEGIN
2021-10-02 14:21:41.535098 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-02 14:21:43.037864 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.50 seconds
2021-10-02 14:21:43.038104 (ThreadPoolExecutor-1_0): Using postgres connection "postgres.information_schema".
2021-10-02 14:21:43.038253 (ThreadPoolExecutor-1_0): On postgres.information_schema: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('facts') or upper(sch.nspname) = upper('dims') or upper(sch.nspname) = upper('dbtdemo') or upper(sch.nspname) = upper('public') or upper(sch.nspname) = upper('dbt_test__audit'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2021-10-02 14:21:43.099272 (ThreadPoolExecutor-1_0): SQL status: SELECT 51 in 0.06 seconds
2021-10-02 14:21:43.110074 (ThreadPoolExecutor-1_0): On postgres.information_schema: ROLLBACK
2021-10-02 14:21:43.111822 (ThreadPoolExecutor-1_0): On postgres.information_schema: Close
2021-10-02 14:21:43.126487 (MainThread): 19:51:43 | Catalog written to /Users/pl465j/projects/dbt-demo/dbt-demo/target/catalog.json
2021-10-02 14:21:43.126826 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d19aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d1fa340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965d1fad90>]}
2021-10-02 14:21:43.127093 (MainThread): Flushing usage events
2021-10-02 14:21:44.921462 (MainThread): Connection 'generate_catalog' was properly closed.
2021-10-02 14:21:44.922017 (MainThread): Connection 'postgres.information_schema' was properly closed.
2021-10-02 14:22:46.912905 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:22:47.026540 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-10-02 14:22:47.028940 (MainThread): Tracking: tracking
2021-10-02 14:22:47.049587 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a5822850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a5714cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a58316d0>]}
2021-10-02 14:22:47.054079 (MainThread): Serving docs at 0.0.0.0:8080
2021-10-02 14:22:47.054373 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-10-02 14:22:47.054546 (MainThread): Press Ctrl+C to exit.


2021-10-02 14:23:52.689178 (MainThread): Flushing usage events
2021-10-02 14:23:54.142562 (MainThread): ctrl-c
2021-10-02 14:34:29.584218 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:34:30.127827 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:34:30.130521 (MainThread): Tracking: tracking
2021-10-02 14:34:30.150005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b9713a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b9713c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b9713b50>]}
2021-10-02 14:34:30.172434 (MainThread): Partial parsing not enabled
2021-10-02 14:34:30.185882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b9713dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b96f01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b96f0160>]}
2021-10-02 14:34:30.186198 (MainThread): Flushing usage events
2021-10-02 14:34:32.243531 (MainThread): Encountered an error:
2021-10-02 14:34:32.243870 (MainThread): Compilation Error
  Error reading dbt_demo_project: postgres_model/cust_details_ord_counts.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - models:
    4  |   - name: cust_details_ord_counts
    5  |     description: Consolidated Orders count 
    6  | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1
2021-10-02 14:34:32.255268 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1
did not find expected key
  in "<unicode string>", line 3, column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 3
  ------------------------------
  1  | version: 2
  2  | 
  3  | - models:
  4  |   - name: cust_details_ord_counts
  5  |     description: Consolidated Orders count 
  6  | 
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 3, column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 209, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_demo_project: postgres_model/cust_details_ord_counts.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - models:
    4  |   - name: cust_details_ord_counts
    5  |     description: Consolidated Orders count 
    6  | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1

2021-10-02 14:36:01.202723 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:36:01.296735 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:36:01.298649 (MainThread): Tracking: tracking
2021-10-02 14:36:01.315229 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d16ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d14feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d16a850>]}
2021-10-02 14:36:01.339492 (MainThread): Partial parsing not enabled
2021-10-02 14:36:01.356690 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d16ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d108cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44d108ca0>]}
2021-10-02 14:36:01.357151 (MainThread): Flushing usage events
2021-10-02 14:36:02.857435 (MainThread): Encountered an error:
2021-10-02 14:36:02.857722 (MainThread): Compilation Error
  Error reading dbt_demo_project: postgres_model/cust_details_ord_counts.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - models:
    4  |   - name: cust_details_ord_counts
    5  |     description: > 
    6  |       Consolidated Orders count 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1
2021-10-02 14:36:02.864956 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1
did not find expected key
  in "<unicode string>", line 3, column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 3
  ------------------------------
  1  | version: 2
  2  | 
  3  | - models:
  4  |   - name: cust_details_ord_counts
  5  |     description: > 
  6  |       Consolidated Orders count 
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 3, column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 209, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_demo_project: postgres_model/cust_details_ord_counts.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - models:
    4  |   - name: cust_details_ord_counts
    5  |     description: > 
    6  |       Consolidated Orders count 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1

2021-10-02 14:36:28.468225 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:36:28.576375 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:36:28.578592 (MainThread): Tracking: tracking
2021-10-02 14:36:28.594811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3591073a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3591072b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe359107b50>]}
2021-10-02 14:36:28.617904 (MainThread): Partial parsing not enabled
2021-10-02 14:36:28.631752 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe359107ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3590f01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3590f0160>]}
2021-10-02 14:36:28.632078 (MainThread): Flushing usage events
2021-10-02 14:36:30.361683 (MainThread): Encountered an error:
2021-10-02 14:36:30.361997 (MainThread): Compilation Error
  Error reading dbt_demo_project: postgres_model/cust_details_ord_counts.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - models:
    4  |   - name: cust_details_ord_counts
    5  |     
    6  | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1
2021-10-02 14:36:30.370001 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1
did not find expected key
  in "<unicode string>", line 3, column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 3
  ------------------------------
  1  | version: 2
  2  | 
  3  | - models:
  4  |   - name: cust_details_ord_counts
  5  |     
  6  | 
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 3, column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 209, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_demo_project: postgres_model/cust_details_ord_counts.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - models:
    4  |   - name: cust_details_ord_counts
    5  |     
    6  | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1

2021-10-02 14:37:08.396774 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:37:08.488679 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:37:08.490284 (MainThread): Tracking: tracking
2021-10-02 14:37:08.506023 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fd814370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fd840670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fd840e20>]}
2021-10-02 14:37:08.528628 (MainThread): Partial parsing not enabled
2021-10-02 14:37:08.593751 (MainThread): Parsing macros/test_empty.sql
2021-10-02 14:37:08.594537 (MainThread): Parsing macros/audits.sql
2021-10-02 14:37:08.595013 (MainThread): Parsing macros/test_country.sql
2021-10-02 14:37:08.595512 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 14:37:08.596645 (MainThread): Parsing macros/catalog.sql
2021-10-02 14:37:08.601359 (MainThread): Parsing macros/relations.sql
2021-10-02 14:37:08.602645 (MainThread): Parsing macros/adapters.sql
2021-10-02 14:37:08.626515 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 14:37:08.628484 (MainThread): Parsing macros/core.sql
2021-10-02 14:37:08.632329 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 14:37:08.638802 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 14:37:08.647612 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 14:37:08.649390 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 14:37:08.667140 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 14:37:08.701109 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 14:37:08.720774 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 14:37:08.722415 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 14:37:08.732277 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 14:37:08.750980 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 14:37:08.765090 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 14:37:08.772791 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 14:37:08.780417 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 14:37:08.784005 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 14:37:08.784803 (MainThread): Parsing macros/etc/query.sql
2021-10-02 14:37:08.785662 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 14:37:08.787034 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 14:37:08.794844 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 14:37:08.796628 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 14:37:08.798030 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 14:37:08.853481 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 14:37:08.855126 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 14:37:08.856167 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 14:37:08.857421 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 14:37:08.859421 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 14:37:08.860403 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 14:37:08.861679 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 14:37:08.863943 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 14:37:08.869465 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 14:37:08.870497 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 14:37:08.871684 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 14:37:08.873808 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 14:37:08.874768 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 14:37:08.876863 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 14:37:08.885884 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 14:37:08.887562 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 14:37:08.888833 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 14:37:08.890327 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 14:37:08.891735 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 14:37:08.892727 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 14:37:08.895724 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 14:37:08.900902 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 14:37:08.901684 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 14:37:08.904370 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 14:37:08.906077 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 14:37:08.907686 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 14:37:08.909625 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 14:37:08.932768 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 14:37:08.933413 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 14:37:08.934039 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 14:37:08.934610 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 14:37:08.937664 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 14:37:08.939035 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 14:37:08.940855 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 14:37:08.941761 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 14:37:08.942586 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 14:37:08.943663 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 14:37:08.945384 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 14:37:08.946521 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 14:37:08.947336 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 14:37:08.948723 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 14:37:08.949525 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 14:37:08.951833 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 14:37:08.953362 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 14:37:08.954249 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 14:37:08.955507 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 14:37:08.958897 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 14:37:08.964443 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 14:37:08.965460 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 14:37:08.967617 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 14:37:08.970442 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 14:37:08.972609 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 14:37:08.973431 (MainThread): Parsing macros/sql/star.sql
2021-10-02 14:37:08.975873 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 14:37:08.981487 (MainThread): Parsing macros/sql/union.sql
2021-10-02 14:37:08.988728 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 14:37:08.989503 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 14:37:08.992057 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 14:37:08.992985 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 14:37:08.994002 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 14:37:08.996492 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 14:37:09.000259 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 14:37:09.002635 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 14:37:09.155042 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 14:37:09.155258 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '400236c0-540d-4ac7-8654-68d0ab0c3aee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fd8cfbe0>]}
2021-10-02 14:37:09.285195 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:37:09.302524 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:37:09.311509 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:37:09.320562 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:37:09.332109 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 14:37:09.340060 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 14:37:09.372539 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 14:37:09.382081 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 14:37:09.463595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fdb4d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fd99d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fdb469d0>]}
2021-10-02 14:37:09.463890 (MainThread): Flushing usage events
2021-10-02 14:37:11.627862 (MainThread): Connection 'operation.dbt_demo_project.dbt_demo_project-on-run-end-0' was properly closed.
2021-10-02 14:37:11.628121 (MainThread): Encountered an error:
2021-10-02 14:37:11.628308 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named cust_details_ord_counts. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for cust_details_ord_counts in one of these files:
   - models/postgres_model/cust_details_ord_counts.yml
  models/postgres_model/schema.yml
2021-10-02 14:37:11.634502 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 517, in parse_file
    for test_block in parser.parse():
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 752, in parse
    self.parse_patch(node_block, refs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 799, in parse_patch
    self.manifest.add_patch(self.yaml.file, patch)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 743, in add_patch
    raise_duplicate_patch_name(patch, existing_file_path)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 865, in raise_duplicate_patch_name
    raise_compiler_error(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named cust_details_ord_counts. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for cust_details_ord_counts in one of these files:
   - models/postgres_model/cust_details_ord_counts.yml
  models/postgres_model/schema.yml

2021-10-02 14:37:58.464342 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:37:58.560685 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:37:58.562822 (MainThread): Tracking: tracking
2021-10-02 14:37:58.579151 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd29006eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd29006d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd290069a0>]}
2021-10-02 14:37:58.601471 (MainThread): Partial parsing not enabled
2021-10-02 14:37:58.660855 (MainThread): Parsing macros/test_empty.sql
2021-10-02 14:37:58.661718 (MainThread): Parsing macros/audits.sql
2021-10-02 14:37:58.662276 (MainThread): Parsing macros/test_country.sql
2021-10-02 14:37:58.662889 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 14:37:58.664037 (MainThread): Parsing macros/catalog.sql
2021-10-02 14:37:58.668044 (MainThread): Parsing macros/relations.sql
2021-10-02 14:37:58.669715 (MainThread): Parsing macros/adapters.sql
2021-10-02 14:37:58.696738 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 14:37:58.698731 (MainThread): Parsing macros/core.sql
2021-10-02 14:37:58.702882 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 14:37:58.711194 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 14:37:58.723330 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 14:37:58.725880 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 14:37:58.747780 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 14:37:58.785259 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 14:37:58.805335 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 14:37:58.806960 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 14:37:58.817133 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 14:37:58.837045 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 14:37:58.851115 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 14:37:58.858864 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 14:37:58.865934 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 14:37:58.869508 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 14:37:58.870292 (MainThread): Parsing macros/etc/query.sql
2021-10-02 14:37:58.871146 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 14:37:58.872495 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 14:37:58.880219 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 14:37:58.881882 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 14:37:58.883452 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 14:37:58.937338 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 14:37:58.938953 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 14:37:58.939995 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 14:37:58.941176 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 14:37:58.943093 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 14:37:58.944090 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 14:37:58.945388 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 14:37:58.947483 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 14:37:58.953237 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 14:37:58.954308 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 14:37:58.955521 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 14:37:58.957677 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 14:37:58.958712 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 14:37:58.960899 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 14:37:58.970355 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 14:37:58.972099 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 14:37:58.973404 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 14:37:58.974923 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 14:37:58.976360 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 14:37:58.977235 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 14:37:58.980295 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 14:37:58.985400 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 14:37:58.986131 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 14:37:58.988608 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 14:37:58.990297 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 14:37:58.991669 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 14:37:58.993410 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 14:37:59.016421 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 14:37:59.017175 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 14:37:59.017814 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 14:37:59.018385 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 14:37:59.021659 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 14:37:59.022896 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 14:37:59.024849 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 14:37:59.025912 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 14:37:59.026991 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 14:37:59.028139 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 14:37:59.029885 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 14:37:59.030919 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 14:37:59.031787 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 14:37:59.033117 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 14:37:59.033934 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 14:37:59.036147 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 14:37:59.037482 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 14:37:59.038425 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 14:37:59.039581 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 14:37:59.042641 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 14:37:59.048214 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 14:37:59.049262 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 14:37:59.051549 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 14:37:59.054690 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 14:37:59.057140 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 14:37:59.057993 (MainThread): Parsing macros/sql/star.sql
2021-10-02 14:37:59.061067 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 14:37:59.066721 (MainThread): Parsing macros/sql/union.sql
2021-10-02 14:37:59.075639 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 14:37:59.076690 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 14:37:59.079362 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 14:37:59.080275 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 14:37:59.081341 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 14:37:59.083880 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 14:37:59.087694 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 14:37:59.090174 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 14:37:59.241509 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 14:37:59.241736 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd290d6490>]}
2021-10-02 14:37:59.384519 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:37:59.401153 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:37:59.409426 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:37:59.417138 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:37:59.426411 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 14:37:59.433666 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 14:37:59.460198 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 14:37:59.468612 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 14:37:59.564382 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 14:37:59.570015 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd29128640>]}
2021-10-02 14:37:59.579344 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd291280d0>]}
2021-10-02 14:37:59.579728 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 14:37:59.581514 (MainThread): 
2021-10-02 14:37:59.582035 (MainThread): Acquiring new postgres connection "master".
2021-10-02 14:37:59.583459 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 14:37:59.643987 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 14:37:59.644220 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 14:37:59.644376 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 14:38:15.351357 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 15.71 seconds
2021-10-02 14:38:15.353075 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 14:38:15.355227 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 14:38:15.362340 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 14:38:15.362544 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 14:38:15.362686 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 14:38:17.035575 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.67 seconds
2021-10-02 14:38:17.035801 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 14:38:17.035935 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 14:38:17.046559 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 14:38:17.047564 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 14:38:17.048824 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 14:38:17.049213 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:38:17.050521 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:38:17.050648 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 14:38:17.050759 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 14:38:19.954886 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.90 seconds
2021-10-02 14:38:19.955128 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:38:19.955265 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 14:38:19.966474 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 14:38:19.967444 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 14:38:19.968487 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 14:38:19.968904 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 14:38:19.970208 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 14:38:19.970338 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 14:38:19.970447 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 14:38:21.697398 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.73 seconds
2021-10-02 14:38:21.697623 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 14:38:21.697761 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 14:38:21.708403 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 14:38:21.709603 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 14:38:21.710678 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 14:38:21.715645 (MainThread): Using postgres connection "master".
2021-10-02 14:38:21.715821 (MainThread): On master: BEGIN
2021-10-02 14:38:21.715938 (MainThread): Opening a new connection, currently in state init
2021-10-02 14:38:23.634888 (MainThread): SQL status: BEGIN in 1.92 seconds
2021-10-02 14:38:23.635086 (MainThread): Using postgres connection "master".
2021-10-02 14:38:23.635200 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 14:38:23.683318 (MainThread): SQL status: SELECT 7 in 0.05 seconds
2021-10-02 14:38:23.684555 (MainThread): On master: ROLLBACK
2021-10-02 14:38:23.686027 (MainThread): Using postgres connection "master".
2021-10-02 14:38:23.686172 (MainThread): On master: BEGIN
2021-10-02 14:38:23.688553 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 14:38:23.688695 (MainThread): On master: COMMIT
2021-10-02 14:38:23.688811 (MainThread): Using postgres connection "master".
2021-10-02 14:38:23.688914 (MainThread): On master: COMMIT
2021-10-02 14:38:23.689870 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:23.690031 (MainThread): 20:08:23 | 
2021-10-02 14:38:23.690182 (MainThread): 20:08:23 | Running 1 on-run-start hook
2021-10-02 14:38:23.690317 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 14:38:23.692173 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 14:38:23.693765 (MainThread): 20:08:23 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 14:38:23.693956 (MainThread): Using postgres connection "master".
2021-10-02 14:38:23.694083 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_STARTED');
    commit;


2021-10-02 14:38:23.706375 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:38:23.707083 (MainThread): 20:08:23 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-10-02 14:38:23.707252 (MainThread): 20:08:23 | 
2021-10-02 14:38:23.707412 (MainThread): On master: Close
2021-10-02 14:38:23.707712 (MainThread): 20:08:23 | Concurrency: 1 threads (target='dev')
2021-10-02 14:38:23.707855 (MainThread): 20:08:23 | 
2021-10-02 14:38:23.711637 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 14:38:23.712089 (Thread-1): 20:08:23 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 14:38:23.712424 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:23.712632 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 14:38:23.714784 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 14:38:23.715655 (Thread-1): finished collecting timing info
2021-10-02 14:38:23.736817 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:23.737060 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 14:38:23.737218 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:38:25.585988 (Thread-1): SQL status: BEGIN in 1.85 seconds
2021-10-02 14:38:25.586245 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.586392 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:38:25.592520 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:38:25.598012 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 14:38:25.599453 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.599631 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 14:38:25.633523 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 14:38:25.638455 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.638607 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 14:38:25.641491 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:38:25.644477 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.644635 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 14:38:25.647841 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:38:25.654231 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.654438 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:38:25.657421 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:25.663815 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 14:38:25.664017 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.664149 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 14:38:25.665844 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:25.670524 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:38:25.670689 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 14:38:25.682950 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-02 14:38:25.684104 (Thread-1): finished collecting timing info
2021-10-02 14:38:25.684298 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 14:38:25.684715 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd29239e80>]}
2021-10-02 14:38:25.685091 (Thread-1): 20:08:25 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.97s]
2021-10-02 14:38:25.685294 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 14:38:25.685477 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:38:25.685786 (Thread-1): 20:08:25 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 14:38:25.686118 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:25.686281 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:38:25.689752 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 14:38:25.690567 (Thread-1): finished collecting timing info
2021-10-02 14:38:25.705770 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:25.705988 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 14:38:25.706129 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:38:27.328137 (Thread-1): SQL status: BEGIN in 1.62 seconds
2021-10-02 14:38:27.328391 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.328544 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:38:27.335151 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:38:27.340288 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 14:38:27.341129 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.341312 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 14:38:27.366251 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 14:38:27.368912 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.369093 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 14:38:27.372331 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:38:27.374663 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.374825 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 14:38:27.379835 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:38:27.382405 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.382622 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:38:27.385966 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:27.386934 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 14:38:27.387121 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.387265 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 14:38:27.389252 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:27.391151 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:38:27.391329 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 14:38:27.398449 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 14:38:27.399652 (Thread-1): finished collecting timing info
2021-10-02 14:38:27.399855 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 14:38:27.400258 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd2922d8b0>]}
2021-10-02 14:38:27.400611 (Thread-1): 20:08:27 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.71s]
2021-10-02 14:38:27.400799 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:38:27.401425 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:38:27.401777 (Thread-1): 20:08:27 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 14:38:27.402099 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:27.402281 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:38:27.407137 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 14:38:27.413670 (Thread-1): finished collecting timing info
2021-10-02 14:38:27.417499 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:27.417730 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 14:38:27.417880 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:38:29.854793 (Thread-1): SQL status: BEGIN in 2.44 seconds
2021-10-02 14:38:29.855035 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:29.855207 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:38:29.861573 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:38:29.862733 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 14:38:29.864316 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:29.864496 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 14:38:29.878141 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 14:38:29.881947 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:29.882158 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 14:38:29.885492 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:38:29.887527 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:29.887698 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:38:29.890372 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:29.891158 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 14:38:29.891313 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:29.891446 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 14:38:29.892941 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:29.894622 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:38:29.894772 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 14:38:29.896241 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 14:38:29.897316 (Thread-1): finished collecting timing info
2021-10-02 14:38:29.897546 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 14:38:29.897971 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd2928df70>]}
2021-10-02 14:38:29.898346 (Thread-1): 20:08:29 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 2.50s]
2021-10-02 14:38:29.898543 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:38:29.898742 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:38:29.899083 (Thread-1): 20:08:29 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 14:38:29.899499 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:29.899664 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:38:29.903333 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 14:38:29.904353 (Thread-1): finished collecting timing info
2021-10-02 14:38:29.907988 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:29.908244 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 14:38:29.908391 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:38:31.647422 (Thread-1): SQL status: BEGIN in 1.74 seconds
2021-10-02 14:38:31.647684 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:31.647835 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:38:31.653134 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:38:31.654304 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 14:38:31.655247 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:31.655404 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 14:38:31.667839 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 14:38:31.670283 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:31.670449 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 14:38:31.673388 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:38:31.675305 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:31.675460 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:38:31.678337 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:31.679310 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 14:38:31.679472 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:31.679637 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 14:38:31.681459 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:31.683180 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:38:31.683329 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 14:38:31.684894 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 14:38:31.685951 (Thread-1): finished collecting timing info
2021-10-02 14:38:31.686146 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 14:38:31.686518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5d0896-e33d-4a93-a60d-e4f0490d1aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd28fb1940>]}
2021-10-02 14:38:31.686865 (Thread-1): 20:08:31 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.79s]
2021-10-02 14:38:31.687050 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:38:31.688105 (MainThread): Acquiring new postgres connection "master".
2021-10-02 14:38:31.688313 (MainThread): Using postgres connection "master".
2021-10-02 14:38:31.688457 (MainThread): On master: BEGIN
2021-10-02 14:38:31.688593 (MainThread): Opening a new connection, currently in state closed
2021-10-02 14:38:33.112326 (MainThread): SQL status: BEGIN in 1.42 seconds
2021-10-02 14:38:33.112579 (MainThread): On master: COMMIT
2021-10-02 14:38:33.112722 (MainThread): Using postgres connection "master".
2021-10-02 14:38:33.112853 (MainThread): On master: COMMIT
2021-10-02 14:38:33.114233 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:38:33.114443 (MainThread): 20:08:33 | 
2021-10-02 14:38:33.114628 (MainThread): 20:08:33 | Running 1 on-run-end hook
2021-10-02 14:38:33.114790 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 14:38:33.117202 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-02 14:38:33.118038 (MainThread): 20:08:33 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-02 14:38:33.118298 (MainThread): Using postgres connection "master".
2021-10-02 14:38:33.118455 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_ENDED');
    commit;


2021-10-02 14:38:33.126078 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:38:33.127038 (MainThread): 20:08:33 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-10-02 14:38:33.127274 (MainThread): 20:08:33 | 
2021-10-02 14:38:33.127517 (MainThread): On master: Close
2021-10-02 14:38:33.128079 (MainThread): 20:08:33 | 
2021-10-02 14:38:33.128276 (MainThread): 20:08:33 | Finished running 1 table model, 3 view models, 2 hooks in 33.55s.
2021-10-02 14:38:33.128452 (MainThread): Connection 'master' was properly closed.
2021-10-02 14:38:33.128595 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 14:38:33.137670 (MainThread): 
2021-10-02 14:38:33.137932 (MainThread): Completed successfully
2021-10-02 14:38:33.138134 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 14:38:33.138453 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd29006d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd2922cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffd291a9760>]}
2021-10-02 14:38:33.138733 (MainThread): Flushing usage events
2021-10-02 14:47:35.908632 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:47:36.035543 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:47:36.036873 (MainThread): Tracking: tracking
2021-10-02 14:47:36.058938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb25912bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2593e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2593ee80>]}
2021-10-02 14:47:36.086699 (MainThread): Partial parsing not enabled
2021-10-02 14:47:36.186136 (MainThread): Parsing macros/test_empty.sql
2021-10-02 14:47:36.187216 (MainThread): Parsing macros/audits.sql
2021-10-02 14:47:36.187849 (MainThread): Parsing macros/test_country.sql
2021-10-02 14:47:36.188568 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 14:47:36.189731 (MainThread): Parsing macros/catalog.sql
2021-10-02 14:47:36.195943 (MainThread): Parsing macros/relations.sql
2021-10-02 14:47:36.197825 (MainThread): Parsing macros/adapters.sql
2021-10-02 14:47:36.231652 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 14:47:36.234332 (MainThread): Parsing macros/core.sql
2021-10-02 14:47:36.239337 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 14:47:36.249512 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 14:47:36.263990 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 14:47:36.266515 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 14:47:36.289591 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 14:47:36.340034 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 14:47:36.372946 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 14:47:36.376167 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 14:47:36.395676 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 14:47:36.430068 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 14:47:36.450841 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 14:47:36.463803 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 14:47:36.473346 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 14:47:36.478414 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 14:47:36.479542 (MainThread): Parsing macros/etc/query.sql
2021-10-02 14:47:36.480750 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 14:47:36.482780 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 14:47:36.494416 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 14:47:36.496775 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 14:47:36.498686 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 14:47:36.572276 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 14:47:36.574521 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 14:47:36.575998 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 14:47:36.577753 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 14:47:36.580417 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 14:47:36.581768 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 14:47:36.583663 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 14:47:36.586512 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 14:47:36.595210 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 14:47:36.596679 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 14:47:36.598343 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 14:47:36.601385 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 14:47:36.602721 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 14:47:36.605594 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 14:47:36.618499 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 14:47:36.621145 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 14:47:36.623074 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 14:47:36.626335 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 14:47:36.628382 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 14:47:36.629616 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 14:47:36.633737 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 14:47:36.640586 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 14:47:36.641620 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 14:47:36.645190 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 14:47:36.647564 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 14:47:36.649457 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 14:47:36.651853 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 14:47:36.682209 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 14:47:36.683154 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 14:47:36.684059 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 14:47:36.684874 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 14:47:36.689007 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 14:47:36.691283 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 14:47:36.694148 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 14:47:36.695471 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 14:47:36.696524 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 14:47:36.698023 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 14:47:36.700433 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 14:47:36.701883 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 14:47:36.703027 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 14:47:36.704860 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 14:47:36.705989 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 14:47:36.709066 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 14:47:36.710924 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 14:47:36.712271 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 14:47:36.713944 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 14:47:36.718210 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 14:47:36.726044 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 14:47:36.727547 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 14:47:36.730619 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 14:47:36.734593 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 14:47:36.737605 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 14:47:36.738759 (MainThread): Parsing macros/sql/star.sql
2021-10-02 14:47:36.742098 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 14:47:36.749746 (MainThread): Parsing macros/sql/union.sql
2021-10-02 14:47:36.760071 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 14:47:36.761250 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 14:47:36.764645 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 14:47:36.765859 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 14:47:36.767262 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 14:47:36.770572 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 14:47:36.775372 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 14:47:36.778722 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 14:47:36.990332 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 14:47:36.991040 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0759445-0ba4-4952-b498-be087cdb6c15', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb259cdf70>]}
2021-10-02 14:47:37.145846 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:47:37.163820 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:47:37.172378 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:47:37.180295 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:47:37.191065 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 14:47:37.199108 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 14:47:37.229348 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 14:47:37.238215 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 14:47:37.343150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb25a0e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb25a44580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb25a78a60>]}
2021-10-02 14:47:37.343514 (MainThread): Flushing usage events
2021-10-02 14:47:39.144877 (MainThread): Connection 'operation.dbt_demo_project.dbt_demo_project-on-run-end-0' was properly closed.
2021-10-02 14:47:39.145153 (MainThread): Encountered an error:
2021-10-02 14:47:39.145362 (MainThread): Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  Documentation for 'model.dbt_demo_project.cust_details_ord_counts' depends on doc 'ord_cust_name'  which was not found
2021-10-02 14:47:39.158667 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 319, in load
    self.process_docs(self.root_project)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 689, in process_docs
    _process_docs_for_node(ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 873, in _process_docs_for_node
    column.description = get_rendered(column.description, context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/context/docs.py", line 73, in doc
    doc_target_not_found(self.node, doc_name, doc_package_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 524, in doc_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model cust_details_ord_counts (models/postgres_model/cust_details_ord_counts.sql)
  Documentation for 'model.dbt_demo_project.cust_details_ord_counts' depends on doc 'ord_cust_name'  which was not found

2021-10-02 14:48:05.710634 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 14:48:05.791216 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-02 14:48:05.793089 (MainThread): Tracking: tracking
2021-10-02 14:48:05.807385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a9523a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a97d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a97de50>]}
2021-10-02 14:48:05.829170 (MainThread): Partial parsing not enabled
2021-10-02 14:48:05.874992 (MainThread): Parsing macros/test_empty.sql
2021-10-02 14:48:05.875905 (MainThread): Parsing macros/audits.sql
2021-10-02 14:48:05.876470 (MainThread): Parsing macros/test_country.sql
2021-10-02 14:48:05.877122 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 14:48:05.878196 (MainThread): Parsing macros/catalog.sql
2021-10-02 14:48:05.881348 (MainThread): Parsing macros/relations.sql
2021-10-02 14:48:05.882766 (MainThread): Parsing macros/adapters.sql
2021-10-02 14:48:05.905721 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 14:48:05.907749 (MainThread): Parsing macros/core.sql
2021-10-02 14:48:05.912058 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 14:48:05.920781 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 14:48:05.932835 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 14:48:05.934845 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 14:48:05.957707 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 14:48:05.995148 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 14:48:06.016027 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 14:48:06.017830 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 14:48:06.028269 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 14:48:06.048918 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 14:48:06.063095 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 14:48:06.070951 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 14:48:06.078144 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 14:48:06.081824 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 14:48:06.082610 (MainThread): Parsing macros/etc/query.sql
2021-10-02 14:48:06.083568 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 14:48:06.084950 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 14:48:06.093426 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 14:48:06.095161 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 14:48:06.096692 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 14:48:06.153775 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 14:48:06.155395 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 14:48:06.156558 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 14:48:06.157925 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 14:48:06.160051 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 14:48:06.161128 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 14:48:06.162964 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 14:48:06.165050 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 14:48:06.170888 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 14:48:06.171963 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 14:48:06.173238 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 14:48:06.175402 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 14:48:06.176389 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 14:48:06.178623 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 14:48:06.188134 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 14:48:06.189872 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 14:48:06.191184 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 14:48:06.192712 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 14:48:06.194245 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 14:48:06.195175 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 14:48:06.198403 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 14:48:06.203676 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 14:48:06.204418 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 14:48:06.207097 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 14:48:06.208848 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 14:48:06.210543 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 14:48:06.213088 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 14:48:06.238293 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 14:48:06.238950 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 14:48:06.239587 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 14:48:06.240159 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 14:48:06.243223 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 14:48:06.244378 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 14:48:06.246220 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 14:48:06.247186 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 14:48:06.247959 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 14:48:06.249068 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 14:48:06.250978 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 14:48:06.252170 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 14:48:06.253028 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 14:48:06.254473 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 14:48:06.255296 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 14:48:06.257694 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 14:48:06.258980 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 14:48:06.260029 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 14:48:06.261210 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 14:48:06.265117 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 14:48:06.270617 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 14:48:06.271642 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 14:48:06.273882 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 14:48:06.277037 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 14:48:06.279259 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 14:48:06.280092 (MainThread): Parsing macros/sql/star.sql
2021-10-02 14:48:06.282657 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 14:48:06.288390 (MainThread): Parsing macros/sql/union.sql
2021-10-02 14:48:06.295845 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 14:48:06.296920 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 14:48:06.299461 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 14:48:06.300350 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 14:48:06.301382 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 14:48:06.303817 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 14:48:06.307587 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 14:48:06.309973 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 14:48:06.477593 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 14:48:06.477813 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00aa0d9d0>]}
2021-10-02 14:48:06.601105 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:06.615286 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:06.622136 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:06.628638 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:06.639300 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 14:48:06.648097 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 14:48:06.676219 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 14:48:06.683990 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 14:48:06.776464 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 14:48:06.781533 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00ab33040>]}
2021-10-02 14:48:06.790400 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00ab33160>]}
2021-10-02 14:48:06.790795 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 6 sources, 0 exposures
2021-10-02 14:48:06.792501 (MainThread): 
2021-10-02 14:48:06.792997 (MainThread): Acquiring new postgres connection "master".
2021-10-02 14:48:06.794047 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-02 14:48:06.850113 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-02 14:48:06.850352 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-02 14:48:06.850518 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 14:48:08.757508 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.91 seconds
2021-10-02 14:48:08.759617 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-02 14:48:08.761605 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 14:48:08.768368 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 14:48:08.768604 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 14:48:08.768753 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 14:48:10.701887 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.93 seconds
2021-10-02 14:48:10.702177 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 14:48:10.702357 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 14:48:10.722335 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 14:48:10.724001 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 14:48:10.725834 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-02 14:48:10.726493 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:48:10.728996 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:48:10.729258 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 14:48:10.729423 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 14:48:12.668783 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.94 seconds
2021-10-02 14:48:12.669213 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 14:48:12.669422 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 14:48:12.694447 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 14:48:12.695946 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 14:48:12.698399 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-02 14:48:12.699080 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 14:48:12.700984 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 14:48:12.701209 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-02 14:48:12.701387 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-02 14:48:14.138061 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.44 seconds
2021-10-02 14:48:14.138397 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-02 14:48:14.138565 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 14:48:14.157845 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 14:48:14.159217 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-02 14:48:14.161719 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-02 14:48:14.168988 (MainThread): Using postgres connection "master".
2021-10-02 14:48:14.169447 (MainThread): On master: BEGIN
2021-10-02 14:48:14.169766 (MainThread): Opening a new connection, currently in state init
2021-10-02 14:48:16.801048 (MainThread): SQL status: BEGIN in 2.63 seconds
2021-10-02 14:48:16.801493 (MainThread): Using postgres connection "master".
2021-10-02 14:48:16.801688 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 14:48:16.875748 (MainThread): SQL status: SELECT 7 in 0.07 seconds
2021-10-02 14:48:16.877278 (MainThread): On master: ROLLBACK
2021-10-02 14:48:16.878971 (MainThread): Using postgres connection "master".
2021-10-02 14:48:16.879139 (MainThread): On master: BEGIN
2021-10-02 14:48:16.882104 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-02 14:48:16.882312 (MainThread): On master: COMMIT
2021-10-02 14:48:16.882474 (MainThread): Using postgres connection "master".
2021-10-02 14:48:16.882616 (MainThread): On master: COMMIT
2021-10-02 14:48:16.884130 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:16.884508 (MainThread): 20:18:16 | 
2021-10-02 14:48:16.884999 (MainThread): 20:18:16 | Running 1 on-run-start hook
2021-10-02 14:48:16.885501 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-02 14:48:16.888546 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-02 14:48:16.890356 (MainThread): 20:18:16 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-02 14:48:16.890631 (MainThread): Using postgres connection "master".
2021-10-02 14:48:16.890792 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_STARTED');
    commit;


2021-10-02 14:48:16.902533 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:16.903718 (MainThread): 20:18:16 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-10-02 14:48:16.903989 (MainThread): 20:18:16 | 
2021-10-02 14:48:16.904206 (MainThread): On master: Close
2021-10-02 14:48:16.904607 (MainThread): 20:18:16 | Concurrency: 1 threads (target='dev')
2021-10-02 14:48:16.904806 (MainThread): 20:18:16 | 
2021-10-02 14:48:16.907589 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-02 14:48:16.908102 (Thread-1): 20:18:16 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-02 14:48:16.908574 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:16.908819 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-02 14:48:16.912885 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 14:48:16.913726 (Thread-1): finished collecting timing info
2021-10-02 14:48:16.945463 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:16.945771 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-02 14:48:16.945989 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:48:19.721178 (Thread-1): SQL status: BEGIN in 2.78 seconds
2021-10-02 14:48:19.721469 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.721650 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:48:19.729999 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:19.739617 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-02 14:48:19.741020 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.741326 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-02 14:48:19.771419 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-10-02 14:48:19.778002 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.778228 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-02 14:48:19.781587 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:48:19.785701 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.785933 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-02 14:48:19.789590 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:48:19.797212 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.797446 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:48:19.805522 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:19.815816 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 14:48:19.816071 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.816235 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-02 14:48:19.818638 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:19.825910 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 14:48:19.826142 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-02 14:48:19.846183 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-02 14:48:19.847538 (Thread-1): finished collecting timing info
2021-10-02 14:48:19.847812 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-02 14:48:19.848318 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00aae9160>]}
2021-10-02 14:48:19.848747 (Thread-1): 20:18:19 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 2.94s]
2021-10-02 14:48:19.849040 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-02 14:48:19.849274 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:48:19.849649 (Thread-1): 20:18:19 | 2 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-02 14:48:19.850017 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:19.850197 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:48:19.855649 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 14:48:19.856650 (Thread-1): finished collecting timing info
2021-10-02 14:48:19.876094 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:19.876370 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-02 14:48:19.876542 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:48:21.343265 (Thread-1): SQL status: BEGIN in 1.47 seconds
2021-10-02 14:48:21.343639 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.343800 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:48:21.351493 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:21.360785 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-02 14:48:21.362146 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.362519 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-02 14:48:21.388901 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-02 14:48:21.392520 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.392754 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-02 14:48:21.396915 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:48:21.400060 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.400388 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-02 14:48:21.406669 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-10-02 14:48:21.410516 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.410766 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:48:21.415983 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:21.417729 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 14:48:21.418083 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.418469 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-02 14:48:21.422562 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:21.424944 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 14:48:21.425240 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-02 14:48:21.432477 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-02 14:48:21.433837 (Thread-1): finished collecting timing info
2021-10-02 14:48:21.434087 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-02 14:48:21.434977 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe009c8e790>]}
2021-10-02 14:48:21.436830 (Thread-1): 20:18:21 | 2 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.58s]
2021-10-02 14:48:21.437356 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-02 14:48:21.439305 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:48:21.440318 (Thread-1): 20:18:21 | 3 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-02 14:48:21.441092 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:21.441490 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:48:21.447210 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 14:48:21.447896 (Thread-1): finished collecting timing info
2021-10-02 14:48:21.452633 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:21.452899 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-02 14:48:21.453113 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:48:23.036483 (Thread-1): SQL status: BEGIN in 1.58 seconds
2021-10-02 14:48:23.036735 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:23.036909 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:48:23.046230 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:23.047559 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-02 14:48:23.048305 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:23.048491 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 14:48:23.063349 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-02 14:48:23.067519 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:23.067745 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-02 14:48:23.071450 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:48:23.074006 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:23.074487 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:48:23.078561 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:23.079522 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 14:48:23.079695 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:23.079847 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-02 14:48:23.081394 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:23.083384 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 14:48:23.083582 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-02 14:48:23.085664 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 14:48:23.086935 (Thread-1): finished collecting timing info
2021-10-02 14:48:23.087168 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-02 14:48:23.087583 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00abe3070>]}
2021-10-02 14:48:23.087969 (Thread-1): 20:18:23 | 3 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.65s]
2021-10-02 14:48:23.088209 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-02 14:48:23.088414 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:48:23.088800 (Thread-1): 20:18:23 | 4 of 4 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-02 14:48:23.089205 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:23.089402 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:48:23.094110 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 14:48:23.095045 (Thread-1): finished collecting timing info
2021-10-02 14:48:23.099091 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:23.099323 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-02 14:48:23.099496 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 14:48:25.658320 (Thread-1): SQL status: BEGIN in 2.56 seconds
2021-10-02 14:48:25.658832 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:25.659132 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-02 14:48:25.669791 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:25.671170 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-02 14:48:25.671879 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:25.672049 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-02 14:48:25.690993 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-02 14:48:25.694129 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:25.694370 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-02 14:48:25.698672 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-02 14:48:25.701867 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:25.702108 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-02 14:48:25.705406 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:25.706511 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 14:48:25.706703 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:25.706855 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-02 14:48:25.711050 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:25.713718 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 14:48:25.713989 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-02 14:48:25.716295 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-02 14:48:25.717654 (Thread-1): finished collecting timing info
2021-10-02 14:48:25.717941 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-02 14:48:25.718559 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25cbd38-ae04-410a-a6c9-54047edba5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00abe3070>]}
2021-10-02 14:48:25.719154 (Thread-1): 20:18:25 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 2.63s]
2021-10-02 14:48:25.719483 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-02 14:48:25.720956 (MainThread): Acquiring new postgres connection "master".
2021-10-02 14:48:25.721264 (MainThread): Using postgres connection "master".
2021-10-02 14:48:25.721439 (MainThread): On master: BEGIN
2021-10-02 14:48:25.721603 (MainThread): Opening a new connection, currently in state closed
2021-10-02 14:48:28.010389 (MainThread): SQL status: BEGIN in 2.29 seconds
2021-10-02 14:48:28.010700 (MainThread): On master: COMMIT
2021-10-02 14:48:28.010874 (MainThread): Using postgres connection "master".
2021-10-02 14:48:28.011027 (MainThread): On master: COMMIT
2021-10-02 14:48:28.013032 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-02 14:48:28.013418 (MainThread): 20:18:28 | 
2021-10-02 14:48:28.013646 (MainThread): 20:18:28 | Running 1 on-run-end hook
2021-10-02 14:48:28.014002 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-02 14:48:28.017024 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-02 14:48:28.018120 (MainThread): 20:18:28 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-02 14:48:28.018445 (MainThread): Using postgres connection "master".
2021-10-02 14:48:28.018647 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_ENDED');
    commit;


2021-10-02 14:48:28.027669 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-02 14:48:28.029030 (MainThread): 20:18:28 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-10-02 14:48:28.029486 (MainThread): 20:18:28 | 
2021-10-02 14:48:28.029804 (MainThread): On master: Close
2021-10-02 14:48:28.030286 (MainThread): 20:18:28 | 
2021-10-02 14:48:28.030546 (MainThread): 20:18:28 | Finished running 1 table model, 3 view models, 2 hooks in 21.24s.
2021-10-02 14:48:28.030899 (MainThread): Connection 'master' was properly closed.
2021-10-02 14:48:28.031164 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-02 14:48:28.042219 (MainThread): 
2021-10-02 14:48:28.042828 (MainThread): Completed successfully
2021-10-02 14:48:28.043354 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-02 14:48:28.044029 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a97d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00a952cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe009c8eb50>]}
2021-10-02 14:48:28.044526 (MainThread): Flushing usage events
2021-10-02 17:16:51.544589 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:16:51.655725 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:16:51.658058 (MainThread): Tracking: tracking
2021-10-02 17:16:51.867725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812954e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812954e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812954d30>]}
2021-10-02 17:16:51.892622 (MainThread): Partial parsing not enabled
2021-10-02 17:16:51.966295 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:16:51.967247 (MainThread): Parsing macros/audits.sql
2021-10-02 17:16:51.967849 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:16:51.968504 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:16:51.969610 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:16:51.973699 (MainThread): Parsing macros/relations.sql
2021-10-02 17:16:51.975423 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:16:52.005961 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:16:52.009109 (MainThread): Parsing macros/core.sql
2021-10-02 17:16:52.014277 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:16:52.023125 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:16:52.036220 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:16:52.038272 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:16:52.058920 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:16:52.098200 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:16:52.123354 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:16:52.125727 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:16:52.137755 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:16:52.162199 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:16:52.178333 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:16:52.187674 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:16:52.196348 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:16:52.200884 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:16:52.201927 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:16:52.203033 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:16:52.204748 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:16:52.214726 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:16:52.216915 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:16:52.218685 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:16:52.284075 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:16:52.286130 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:16:52.287425 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:16:52.288891 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:16:52.291188 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:16:52.292326 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:16:52.293867 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:16:52.296259 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:16:52.303390 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:16:52.304650 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:16:52.306118 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:16:52.308979 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:16:52.310304 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:16:52.313313 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:16:52.325139 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:16:52.327421 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:16:52.329082 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:16:52.331185 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:16:52.333090 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:16:52.334212 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:16:52.337935 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:16:52.343877 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:16:52.344788 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:16:52.347887 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:16:52.350012 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:16:52.351736 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:16:52.353896 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:16:52.380434 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:16:52.381294 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:16:52.382108 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:16:52.382827 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:16:52.386512 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:16:52.387951 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:16:52.390248 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:16:52.391432 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:16:52.392418 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:16:52.393861 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:16:52.396111 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:16:52.397450 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:16:52.398519 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:16:52.400211 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:16:52.401252 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:16:52.403947 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:16:52.405541 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:16:52.406702 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:16:52.408190 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:16:52.412095 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:16:52.418900 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:16:52.420221 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:16:52.422996 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:16:52.426839 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:16:52.429797 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:16:52.430900 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:16:52.434006 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:16:52.440903 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:16:52.450053 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:16:52.451164 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:16:52.454326 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:16:52.455437 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:16:52.456710 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:16:52.459661 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:16:52.464052 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:16:52.467426 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:16:52.655729 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:16:52.656019 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10d06bf2-bf13-46f7-98aa-3361c565b858', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812b0e310>]}
2021-10-02 17:16:52.806516 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:16:52.823437 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:16:52.830930 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '10d06bf2-bf13-46f7-98aa-3361c565b858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812b87df0>]}
2021-10-02 17:16:52.832656 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:16:52.840435 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:16:52.849872 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:16:52.858007 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:16:52.888495 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:16:52.897059 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:16:52.998332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812c79880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812c86eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9812c86df0>]}
2021-10-02 17:16:52.998677 (MainThread): Flushing usage events
2021-10-02 17:16:54.212729 (MainThread): Connection 'operation.dbt_demo_project.dbt_demo_project-on-run-end-0' was properly closed.
2021-10-02 17:16:54.213060 (MainThread): Encountered an error:
2021-10-02 17:16:54.213269 (MainThread): Compilation Error
  Invalid sources config given in models/sources/my_fav_source.yml @ sources: {'name': 'freshness_test', 'database': 'postgres', 'schema': 'dbtdemo', 'freshness': {'warn_after': {'count': 5, 'period': 'minute'}, 'error_after': {'count': 10, 'period': 'minute'}}, 'loaded_at_field': 'created_ts', 'tables': [{'name': 'customers_freshness'}, {'name': 'orders_freshness', 'freshness': {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"}}, {'name': 'freshness_dont_check', 'freshness': None}]} - at path ['tables'][1]['freshness']: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas
2021-10-02 17:16:54.219128 (MainThread): jsonschema.exceptions.ValidationError: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

Failed validating 'oneOf' in schema['properties']['tables']['items']['properties']['freshness']:
    {'default': {'error_after': None, 'filter': None, 'warn_after': None},
     'oneOf': [{'$ref': '#/definitions/FreshnessThreshold'},
               {'type': 'null'}]}

On instance['tables'][1]['freshness']:
    {'error_after': {'count': 12, 'period': 'minutes'},
     'filter': "datediff('minutes', created_ts, current_timestamp) < 5",
     'warn_after': {'count': 6, 'period': 'minutes'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 655, in _target_from_dict
    cls.validate(data)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/hologram/__init__.py", line 989, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

Failed validating 'oneOf' in schema['properties']['tables']['items']['properties']['freshness']:
    {'default': {'error_after': None, 'filter': None, 'warn_after': None},
     'oneOf': [{'$ref': '#/definitions/FreshnessThreshold'},
               {'type': 'null'}]}

On instance['tables'][1]['freshness']:
    {'error_after': {'count': 12, 'period': 'minutes'},
     'filter': "datediff('minutes', created_ts, current_timestamp) < 5",
     'warn_after': {'count': 6, 'period': 'minutes'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 537, in parse_file
    parser.parse()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 679, in parse
    source = self._target_from_dict(UnparsedSourceDefinition, data)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 659, in _target_from_dict
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid sources config given in models/sources/my_fav_source.yml @ sources: {'name': 'freshness_test', 'database': 'postgres', 'schema': 'dbtdemo', 'freshness': {'warn_after': {'count': 5, 'period': 'minute'}, 'error_after': {'count': 10, 'period': 'minute'}}, 'loaded_at_field': 'created_ts', 'tables': [{'name': 'customers_freshness'}, {'name': 'orders_freshness', 'freshness': {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"}}, {'name': 'freshness_dont_check', 'freshness': None}]} - at path ['tables'][1]['freshness']: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

2021-10-02 17:18:14.588257 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:18:14.698167 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:18:14.699755 (MainThread): Tracking: tracking
2021-10-02 17:18:14.716528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf13954fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf13954a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf13954cd0>]}
2021-10-02 17:18:14.740002 (MainThread): Partial parsing not enabled
2021-10-02 17:18:14.806514 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:18:14.807481 (MainThread): Parsing macros/audits.sql
2021-10-02 17:18:14.808109 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:18:14.808909 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:18:14.810077 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:18:14.814052 (MainThread): Parsing macros/relations.sql
2021-10-02 17:18:14.815790 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:18:14.846444 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:18:14.848642 (MainThread): Parsing macros/core.sql
2021-10-02 17:18:14.853468 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:18:14.863017 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:18:14.875814 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:18:14.878053 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:18:14.900920 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:18:14.942782 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:18:14.968394 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:18:14.970531 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:18:14.983291 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:18:15.007591 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:18:15.024565 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:18:15.033942 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:18:15.042851 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:18:15.047356 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:18:15.048354 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:18:15.049464 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:18:15.051206 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:18:15.061758 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:18:15.064023 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:18:15.065846 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:18:15.130699 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:18:15.132762 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:18:15.133831 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:18:15.135008 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:18:15.137269 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:18:15.138273 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:18:15.139587 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:18:15.141550 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:18:15.147734 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:18:15.149230 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:18:15.150484 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:18:15.153140 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:18:15.154231 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:18:15.156528 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:18:15.167311 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:18:15.169559 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:18:15.171286 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:18:15.173287 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:18:15.175127 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:18:15.176234 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:18:15.180161 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:18:15.186660 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:18:15.187668 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:18:15.190851 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:18:15.192990 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:18:15.194817 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:18:15.197071 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:18:15.225130 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:18:15.225968 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:18:15.226786 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:18:15.227533 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:18:15.231305 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:18:15.232748 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:18:15.235105 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:18:15.236308 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:18:15.237311 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:18:15.238760 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:18:15.241072 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:18:15.242637 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:18:15.244383 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:18:15.246312 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:18:15.247436 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:18:15.250767 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:18:15.253068 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:18:15.254482 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:18:15.256063 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:18:15.260314 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:18:15.267542 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:18:15.268954 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:18:15.271991 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:18:15.276043 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:18:15.279066 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:18:15.280235 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:18:15.283625 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:18:15.291494 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:18:15.301039 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:18:15.302178 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:18:15.305773 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:18:15.306994 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:18:15.308512 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:18:15.311798 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:18:15.316650 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:18:15.320185 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:18:15.510032 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:18:15.510299 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd312a008-f77d-4d5e-abf7-44334bf7ed17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf13a076a0>]}
2021-10-02 17:18:15.657592 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:18:15.674218 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:18:15.682600 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:18:15.690708 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:18:15.700511 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:18:15.708210 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:18:15.737824 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:18:15.746691 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:18:15.865402 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 17:18:15.872161 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd312a008-f77d-4d5e-abf7-44334bf7ed17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf13aab4c0>]}
2021-10-02 17:18:15.884825 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd312a008-f77d-4d5e-abf7-44334bf7ed17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf13954f70>]}
2021-10-02 17:18:15.885384 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 7 sources, 0 exposures
2021-10-02 17:18:15.888584 (MainThread): 
2021-10-02 17:18:15.889389 (MainThread): Acquiring new postgres connection "master".
2021-10-02 17:18:15.891584 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 17:18:15.942333 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:18:15.942563 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 17:18:15.942724 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 17:18:21.741644 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 5.80 seconds
2021-10-02 17:18:21.742335 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:18:21.742553 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 17:18:21.768389 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.03 seconds
2021-10-02 17:18:21.769905 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 17:18:21.771696 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 17:18:21.772255 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 17:18:21.774676 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:18:21.774892 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 17:18:21.775046 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:18:23.246542 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.47 seconds
2021-10-02 17:18:23.246789 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:18:23.246939 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 17:18:23.260360 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 17:18:23.261807 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 17:18:23.263579 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 17:18:23.264103 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:18:23.266417 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:18:23.266633 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 17:18:23.266795 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:18:24.782581 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.52 seconds
2021-10-02 17:18:24.782826 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:18:24.782978 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 17:18:24.797406 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 17:18:24.798604 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 17:18:24.800496 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 17:18:24.807633 (MainThread): Using postgres connection "master".
2021-10-02 17:18:24.807950 (MainThread): On master: BEGIN
2021-10-02 17:18:24.808118 (MainThread): Opening a new connection, currently in state init
2021-10-02 17:18:26.520547 (MainThread): SQL status: BEGIN in 1.71 seconds
2021-10-02 17:18:26.520790 (MainThread): Using postgres connection "master".
2021-10-02 17:18:26.520936 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 17:18:26.608341 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-02 17:18:26.609854 (MainThread): On master: ROLLBACK
2021-10-02 17:18:26.611940 (MainThread): On master: Close
2021-10-02 17:18:26.612392 (MainThread): 22:48:26 | Concurrency: 1 threads (target='dev')
2021-10-02 17:18:26.612619 (MainThread): 22:48:26 | 
2021-10-02 17:18:26.616159 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:18:26.616443 (Thread-1): 22:48:26 | 1 of 1 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 17:18:26.616925 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:18:26.617140 (Thread-1): finished collecting timing info
2021-10-02 17:18:26.617559 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:18:26.617809 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:18:26.617952 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 17:18:26.618103 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:18:28.011961 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-10-02 17:18:28.012265 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:18:28.012423 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:18:28.012562 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:18:28.014020 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:18:28.022751 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:18:28.022960 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."dbtdemo"."customers_freshness"
    
  
2021-10-02 17:18:28.025273 (Thread-1): Postgres error: relation "dbtdemo.customers_freshness" does not exist
LINE 5:     from "postgres"."dbtdemo"."customers_freshness"
                 ^

2021-10-02 17:18:28.025530 (Thread-1): Error running SQL: macro collect_freshness
2021-10-02 17:18:28.025683 (Thread-1): Rolling back transaction.
2021-10-02 17:18:28.025850 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 17:18:28.026228 (Thread-1): finished collecting timing info
2021-10-02 17:18:28.026578 (Thread-1): Database Error in source customers_freshness (models/sources/my_fav_source.yml)
  relation "dbtdemo.customers_freshness" does not exist
  LINE 5:     from "postgres"."dbtdemo"."customers_freshness"
                   ^
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "dbtdemo.customers_freshness" does not exist
LINE 5:     from "postgres"."dbtdemo"."customers_freshness"
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/freshness.py", line 91, in execute
    freshness = self.adapter.calculate_freshness(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1086, in calculate_freshness
    table = self.execute_macro(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in source customers_freshness (models/sources/my_fav_source.yml)
  relation "dbtdemo.customers_freshness" does not exist
  LINE 5:     from "postgres"."dbtdemo"."customers_freshness"
                   ^
2021-10-02 17:18:28.037436 (Thread-1): 22:48:28 | 1 of 1 ERROR freshness of freshness_test.customers_freshness......... [ERROR in 1.42s]
2021-10-02 17:18:28.037677 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:18:28.039104 (MainThread): Connection 'master' was properly closed.
2021-10-02 17:18:28.039320 (MainThread): Connection 'source.dbt_demo_project.freshness_test.customers_freshness' was properly closed.
2021-10-02 17:18:28.047564 (MainThread): 
2021-10-02 17:18:28.047841 (MainThread): Database Error in source customers_freshness (models/sources/my_fav_source.yml)
2021-10-02 17:18:28.048055 (MainThread):   relation "dbtdemo.customers_freshness" does not exist
2021-10-02 17:18:28.048211 (MainThread):   LINE 5:     from "postgres"."dbtdemo"."customers_freshness"
2021-10-02 17:18:28.048399 (MainThread):                    ^
2021-10-02 17:18:28.048686 (MainThread): 22:48:28 | Done.
2021-10-02 17:18:28.049017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf1109a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf1391bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf1391b580>]}
2021-10-02 17:18:28.049376 (MainThread): Flushing usage events
2021-10-02 17:23:31.023669 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:23:31.132235 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:23:31.134061 (MainThread): Tracking: tracking
2021-10-02 17:23:31.153455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec064f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec064dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec064d30>]}
2021-10-02 17:23:31.185776 (MainThread): Partial parsing not enabled
2021-10-02 17:23:31.271261 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:23:31.272718 (MainThread): Parsing macros/audits.sql
2021-10-02 17:23:31.273471 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:23:31.274278 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:23:31.275552 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:23:31.280377 (MainThread): Parsing macros/relations.sql
2021-10-02 17:23:31.282592 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:23:31.316442 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:23:31.318577 (MainThread): Parsing macros/core.sql
2021-10-02 17:23:31.324847 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:23:31.334989 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:23:31.348945 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:23:31.351184 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:23:31.376292 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:23:31.424412 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:23:31.457967 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:23:31.460445 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:23:31.474168 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:23:31.505448 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:23:31.534902 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:23:31.546695 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:23:31.557392 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:23:31.563118 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:23:31.564273 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:23:31.565507 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:23:31.567801 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:23:31.581422 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:23:31.583966 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:23:31.585898 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:23:31.698265 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:23:31.700749 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:23:31.702196 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:23:31.703847 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:23:31.706816 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:23:31.708759 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:23:31.710600 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:23:31.713318 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:23:31.721250 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:23:31.723546 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:23:31.725333 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:23:31.728384 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:23:31.729795 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:23:31.732857 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:23:31.745662 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:23:31.747976 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:23:31.749805 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:23:31.752089 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:23:31.754232 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:23:31.755621 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:23:31.761324 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:23:31.768826 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:23:31.770087 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:23:31.774010 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:23:31.776474 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:23:31.778385 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:23:31.780988 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:23:31.812051 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:23:31.812973 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:23:31.813834 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:23:31.814598 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:23:31.818580 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:23:31.820132 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:23:31.822597 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:23:31.823839 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:23:31.824884 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:23:31.826367 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:23:31.828681 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:23:31.830033 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:23:31.831118 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:23:31.832824 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:23:31.834025 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:23:31.837029 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:23:31.838739 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:23:31.839933 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:23:31.841470 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:23:31.845591 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:23:31.852659 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:23:31.854038 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:23:31.856892 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:23:31.860614 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:23:31.863351 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:23:31.864395 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:23:31.867421 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:23:31.874389 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:23:31.883240 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:23:31.884354 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:23:31.887583 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:23:31.888872 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:23:31.890267 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:23:31.893524 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:23:31.898491 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:23:31.901792 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:23:32.091742 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:23:32.092024 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49fd64c9-6b66-4646-8e5e-801ed1ff9ce8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec0bf6d0>]}
2021-10-02 17:23:32.230654 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:23:32.247151 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:23:32.256143 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:23:32.264681 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:23:32.274046 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:23:32.281579 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:23:32.310513 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:23:32.319133 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:23:32.436359 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 17:23:32.442778 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49fd64c9-6b66-4646-8e5e-801ed1ff9ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec427820>]}
2021-10-02 17:23:32.456698 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49fd64c9-6b66-4646-8e5e-801ed1ff9ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec240ca0>]}
2021-10-02 17:23:32.457077 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 7 sources, 0 exposures
2021-10-02 17:23:32.459678 (MainThread): 
2021-10-02 17:23:32.460440 (MainThread): Acquiring new postgres connection "master".
2021-10-02 17:23:32.462697 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 17:23:32.511855 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:23:32.512082 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 17:23:32.512246 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 17:23:34.136480 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.62 seconds
2021-10-02 17:23:34.136756 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:23:34.136927 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 17:23:34.150939 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 17:23:34.152589 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 17:23:34.154583 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 17:23:34.155167 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:23:34.157144 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:23:34.157391 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 17:23:34.157553 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:23:35.690060 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.53 seconds
2021-10-02 17:23:35.690348 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:23:35.690503 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 17:23:35.708811 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 17:23:35.710050 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 17:23:35.711728 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 17:23:35.712281 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 17:23:35.713976 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:23:35.714189 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 17:23:35.714345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:23:37.099446 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.39 seconds
2021-10-02 17:23:37.099693 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:23:37.099852 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 17:23:37.113610 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 17:23:37.115240 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 17:23:37.117511 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 17:23:37.124293 (MainThread): Using postgres connection "master".
2021-10-02 17:23:37.124530 (MainThread): On master: BEGIN
2021-10-02 17:23:37.124695 (MainThread): Opening a new connection, currently in state init
2021-10-02 17:23:38.652696 (MainThread): SQL status: BEGIN in 1.53 seconds
2021-10-02 17:23:38.652940 (MainThread): Using postgres connection "master".
2021-10-02 17:23:38.653131 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 17:23:38.739586 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-02 17:23:38.740984 (MainThread): On master: ROLLBACK
2021-10-02 17:23:38.742619 (MainThread): On master: Close
2021-10-02 17:23:38.743005 (MainThread): 22:53:38 | Concurrency: 1 threads (target='dev')
2021-10-02 17:23:38.743210 (MainThread): 22:53:38 | 
2021-10-02 17:23:38.746161 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:23:38.746441 (Thread-1): 22:53:38 | 1 of 1 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 17:23:38.746875 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:23:38.747129 (Thread-1): finished collecting timing info
2021-10-02 17:23:38.747554 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:23:38.747825 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:23:38.748215 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 17:23:38.748533 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:23:40.080900 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-10-02 17:23:40.081183 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:23:40.081345 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:23:40.081489 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:23:40.083052 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:23:40.091763 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:23:40.091986 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 17:23:40.111284 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-10-02 17:23:40.112609 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 17:23:40.113032 (Thread-1): finished collecting timing info
2021-10-02 17:23:40.113388 (Thread-1): 22:53:40 | 1 of 1 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.37s]
2021-10-02 17:23:40.113592 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:23:40.114610 (MainThread): Connection 'master' was properly closed.
2021-10-02 17:23:40.114805 (MainThread): Connection 'source.dbt_demo_project.freshness_test.customers_freshness' was properly closed.
2021-10-02 17:23:40.124141 (MainThread): 
2021-10-02 17:23:40.124478 (MainThread): 22:53:40 | Done.
2021-10-02 17:23:40.124764 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae989a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec064dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec0087c0>]}
2021-10-02 17:23:40.125070 (MainThread): Flushing usage events
2021-10-02 17:25:06.515716 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:25:06.600791 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:25:06.602053 (MainThread): Tracking: tracking
2021-10-02 17:25:06.617543 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdba21f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdba306a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdba30e50>]}
2021-10-02 17:25:06.653748 (MainThread): Partial parsing not enabled
2021-10-02 17:25:06.732255 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:25:06.733368 (MainThread): Parsing macros/audits.sql
2021-10-02 17:25:06.734022 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:25:06.734703 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:25:06.735843 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:25:06.739461 (MainThread): Parsing macros/relations.sql
2021-10-02 17:25:06.741145 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:25:06.771478 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:25:06.773593 (MainThread): Parsing macros/core.sql
2021-10-02 17:25:06.778132 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:25:06.786966 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:25:06.800127 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:25:06.802605 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:25:06.827700 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:25:06.868910 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:25:06.893488 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:25:06.895433 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:25:06.907434 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:25:06.931405 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:25:06.947419 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:25:06.956155 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:25:06.963337 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:25:06.967101 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:25:06.967969 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:25:06.969147 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:25:06.970697 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:25:06.980147 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:25:06.982511 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:25:06.984354 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:25:07.040640 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:25:07.042440 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:25:07.043781 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:25:07.045066 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:25:07.047214 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:25:07.048326 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:25:07.049870 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:25:07.052068 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:25:07.058092 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:25:07.059296 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:25:07.060739 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:25:07.063294 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:25:07.064516 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:25:07.067111 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:25:07.078299 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:25:07.080453 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:25:07.082116 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:25:07.084040 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:25:07.085872 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:25:07.087029 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:25:07.090759 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:25:07.097172 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:25:07.098208 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:25:07.101525 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:25:07.103707 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:25:07.105437 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:25:07.107788 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:25:07.135678 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:25:07.136496 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:25:07.137309 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:25:07.138024 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:25:07.141647 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:25:07.143047 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:25:07.145311 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:25:07.146436 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:25:07.147391 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:25:07.148780 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:25:07.150996 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:25:07.152306 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:25:07.153424 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:25:07.155122 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:25:07.156158 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:25:07.158863 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:25:07.160407 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:25:07.161502 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:25:07.162930 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:25:07.166694 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:25:07.173115 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:25:07.174387 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:25:07.177071 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:25:07.180606 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:25:07.183479 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:25:07.184611 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:25:07.187721 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:25:07.194545 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:25:07.203196 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:25:07.204187 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:25:07.207204 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:25:07.208233 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:25:07.209394 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:25:07.211969 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:25:07.216102 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:25:07.218923 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:25:07.395570 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:25:07.395888 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9bb6cc26-f66a-4895-add8-8280186e0b27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdbacf310>]}
2021-10-02 17:25:07.527363 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:25:07.542617 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:25:07.550630 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:25:07.558038 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:25:07.567012 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:25:07.574472 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:25:07.602674 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:25:07.611532 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:25:07.715469 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdbc39880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdbc13fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdbc13df0>]}
2021-10-02 17:25:07.715815 (MainThread): Flushing usage events
2021-10-02 17:25:09.675626 (MainThread): Connection 'operation.dbt_demo_project.dbt_demo_project-on-run-end-0' was properly closed.
2021-10-02 17:25:09.675905 (MainThread): Encountered an error:
2021-10-02 17:25:09.676105 (MainThread): Compilation Error
  Invalid sources config given in models/sources/my_fav_source.yml @ sources: {'name': 'freshness_test', 'database': 'postgres', 'schema': 'public', 'freshness': {'warn_after': {'count': 5, 'period': 'minute'}, 'error_after': {'count': 10, 'period': 'minute'}}, 'loaded_at_field': 'created_ts', 'tables': [{'name': 'customers_freshness'}, {'name': 'orders_freshness', 'freshness': {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"}}]} - at path ['tables'][1]['freshness']: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas
2021-10-02 17:25:09.683128 (MainThread): jsonschema.exceptions.ValidationError: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

Failed validating 'oneOf' in schema['properties']['tables']['items']['properties']['freshness']:
    {'default': {'error_after': None, 'filter': None, 'warn_after': None},
     'oneOf': [{'$ref': '#/definitions/FreshnessThreshold'},
               {'type': 'null'}]}

On instance['tables'][1]['freshness']:
    {'error_after': {'count': 12, 'period': 'minutes'},
     'filter': "datediff('minutes', created_ts, current_timestamp) < 5",
     'warn_after': {'count': 6, 'period': 'minutes'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 655, in _target_from_dict
    cls.validate(data)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/hologram/__init__.py", line 989, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

Failed validating 'oneOf' in schema['properties']['tables']['items']['properties']['freshness']:
    {'default': {'error_after': None, 'filter': None, 'warn_after': None},
     'oneOf': [{'$ref': '#/definitions/FreshnessThreshold'},
               {'type': 'null'}]}

On instance['tables'][1]['freshness']:
    {'error_after': {'count': 12, 'period': 'minutes'},
     'filter': "datediff('minutes', created_ts, current_timestamp) < 5",
     'warn_after': {'count': 6, 'period': 'minutes'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 537, in parse_file
    parser.parse()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 679, in parse
    source = self._target_from_dict(UnparsedSourceDefinition, data)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 659, in _target_from_dict
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid sources config given in models/sources/my_fav_source.yml @ sources: {'name': 'freshness_test', 'database': 'postgres', 'schema': 'public', 'freshness': {'warn_after': {'count': 5, 'period': 'minute'}, 'error_after': {'count': 10, 'period': 'minute'}}, 'loaded_at_field': 'created_ts', 'tables': [{'name': 'customers_freshness'}, {'name': 'orders_freshness', 'freshness': {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"}}]} - at path ['tables'][1]['freshness']: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minutes', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

2021-10-02 17:25:38.234827 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:25:38.323614 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:25:38.325516 (MainThread): Tracking: tracking
2021-10-02 17:25:38.340064 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d167ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d170700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d170eb0>]}
2021-10-02 17:25:38.363490 (MainThread): Partial parsing not enabled
2021-10-02 17:25:38.416422 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:25:38.417356 (MainThread): Parsing macros/audits.sql
2021-10-02 17:25:38.417942 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:25:38.418590 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:25:38.419677 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:25:38.423127 (MainThread): Parsing macros/relations.sql
2021-10-02 17:25:38.424813 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:25:38.453893 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:25:38.456027 (MainThread): Parsing macros/core.sql
2021-10-02 17:25:38.460649 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:25:38.469589 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:25:38.482370 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:25:38.484919 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:25:38.507590 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:25:38.551605 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:25:38.575638 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:25:38.577810 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:25:38.590092 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:25:38.616869 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:25:38.636627 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:25:38.647237 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:25:38.657785 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:25:38.663628 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:25:38.664831 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:25:38.665983 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:25:38.667979 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:25:38.679155 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:25:38.681518 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:25:38.683526 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:25:38.748856 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:25:38.750992 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:25:38.752412 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:25:38.754040 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:25:38.756620 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:25:38.757891 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:25:38.759519 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:25:38.762004 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:25:38.768927 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:25:38.770323 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:25:38.771876 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:25:38.774536 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:25:38.775765 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:25:38.778607 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:25:38.790976 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:25:38.793220 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:25:38.794880 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:25:38.797088 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:25:38.799200 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:25:38.800320 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:25:38.804130 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:25:38.810367 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:25:38.811320 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:25:38.814665 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:25:38.817021 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:25:38.818778 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:25:38.821025 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:25:38.847115 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:25:38.847796 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:25:38.848543 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:25:38.849223 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:25:38.852424 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:25:38.853700 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:25:38.855666 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:25:38.856768 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:25:38.857669 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:25:38.858969 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:25:38.861298 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:25:38.862692 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:25:38.863750 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:25:38.865409 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:25:38.866444 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:25:38.869246 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:25:38.871028 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:25:38.872182 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:25:38.873700 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:25:38.877531 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:25:38.884622 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:25:38.886035 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:25:38.888819 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:25:38.892497 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:25:38.895657 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:25:38.896909 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:25:38.901143 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:25:38.908966 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:25:38.919102 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:25:38.920273 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:25:38.923937 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:25:38.925276 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:25:38.926706 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:25:38.931021 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:25:38.935914 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:25:38.939151 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:25:39.125355 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:25:39.125629 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a585932-8830-4ed2-a909-ee366a81805b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d20ef10>]}
2021-10-02 17:25:39.261809 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:25:39.280803 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:25:39.289658 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:25:39.297365 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:25:39.306675 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:25:39.314102 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:25:39.342555 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:25:39.351023 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:25:39.448875 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d37a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d343f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9d343f10>]}
2021-10-02 17:25:39.449192 (MainThread): Flushing usage events
2021-10-02 17:25:40.674086 (MainThread): Connection 'operation.dbt_demo_project.dbt_demo_project-on-run-end-0' was properly closed.
2021-10-02 17:25:40.674362 (MainThread): Encountered an error:
2021-10-02 17:25:40.674559 (MainThread): Compilation Error
  Invalid sources config given in models/sources/my_fav_source.yml @ sources: {'name': 'freshness_test', 'database': 'postgres', 'schema': 'public', 'freshness': {'warn_after': {'count': 5, 'period': 'minute'}, 'error_after': {'count': 10, 'period': 'minute'}}, 'loaded_at_field': 'created_ts', 'tables': [{'name': 'customers_freshness'}, {'name': 'orders_freshness', 'freshness': {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minute', created_ts, current_timestamp) < 5"}}]} - at path ['tables'][1]['freshness']: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minute', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas
2021-10-02 17:25:40.678365 (MainThread): jsonschema.exceptions.ValidationError: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minute', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

Failed validating 'oneOf' in schema['properties']['tables']['items']['properties']['freshness']:
    {'default': {'error_after': None, 'filter': None, 'warn_after': None},
     'oneOf': [{'$ref': '#/definitions/FreshnessThreshold'},
               {'type': 'null'}]}

On instance['tables'][1]['freshness']:
    {'error_after': {'count': 12, 'period': 'minutes'},
     'filter': "datediff('minute', created_ts, current_timestamp) < 5",
     'warn_after': {'count': 6, 'period': 'minutes'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 655, in _target_from_dict
    cls.validate(data)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/hologram/__init__.py", line 989, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minute', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

Failed validating 'oneOf' in schema['properties']['tables']['items']['properties']['freshness']:
    {'default': {'error_after': None, 'filter': None, 'warn_after': None},
     'oneOf': [{'$ref': '#/definitions/FreshnessThreshold'},
               {'type': 'null'}]}

On instance['tables'][1]['freshness']:
    {'error_after': {'count': 12, 'period': 'minutes'},
     'filter': "datediff('minute', created_ts, current_timestamp) < 5",
     'warn_after': {'count': 6, 'period': 'minutes'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 371, in parse_project
    parser.parse_file(block, dct=dct)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 537, in parse_file
    parser.parse()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 679, in parse
    source = self._target_from_dict(UnparsedSourceDefinition, data)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 659, in _target_from_dict
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid sources config given in models/sources/my_fav_source.yml @ sources: {'name': 'freshness_test', 'database': 'postgres', 'schema': 'public', 'freshness': {'warn_after': {'count': 5, 'period': 'minute'}, 'error_after': {'count': 10, 'period': 'minute'}}, 'loaded_at_field': 'created_ts', 'tables': [{'name': 'customers_freshness'}, {'name': 'orders_freshness', 'freshness': {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minute', created_ts, current_timestamp) < 5"}}]} - at path ['tables'][1]['freshness']: {'warn_after': {'count': 6, 'period': 'minutes'}, 'error_after': {'count': 12, 'period': 'minutes'}, 'filter': "datediff('minute', created_ts, current_timestamp) < 5"} is not valid under any of the given schemas

2021-10-02 17:26:13.155171 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:26:13.750232 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:26:13.751349 (MainThread): Tracking: tracking
2021-10-02 17:26:13.766263 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8827af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8827f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8827c70>]}
2021-10-02 17:26:13.789296 (MainThread): Partial parsing not enabled
2021-10-02 17:26:13.843552 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:26:13.844457 (MainThread): Parsing macros/audits.sql
2021-10-02 17:26:13.845053 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:26:13.845803 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:26:13.847005 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:26:13.850521 (MainThread): Parsing macros/relations.sql
2021-10-02 17:26:13.852335 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:26:13.882141 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:26:13.884386 (MainThread): Parsing macros/core.sql
2021-10-02 17:26:13.888948 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:26:13.897801 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:26:13.911936 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:26:13.914263 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:26:13.935763 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:26:13.977256 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:26:14.002436 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:26:14.004659 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:26:14.019558 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:26:14.045741 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:26:14.066120 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:26:14.080672 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:26:14.092739 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:26:14.098129 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:26:14.099261 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:26:14.100440 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:26:14.102281 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:26:14.112642 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:26:14.114978 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:26:14.116890 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:26:14.178312 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:26:14.180499 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:26:14.181861 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:26:14.183376 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:26:14.185799 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:26:14.187012 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:26:14.188537 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:26:14.190828 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:26:14.196687 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:26:14.197770 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:26:14.198983 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:26:14.201203 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:26:14.202183 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:26:14.204359 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:26:14.214214 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:26:14.216252 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:26:14.217632 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:26:14.219313 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:26:14.221264 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:26:14.222441 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:26:14.226561 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:26:14.232803 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:26:14.233726 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:26:14.236741 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:26:14.238781 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:26:14.240482 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:26:14.242599 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:26:14.269371 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:26:14.270237 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:26:14.271090 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:26:14.271844 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:26:14.275746 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:26:14.277328 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:26:14.279892 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:26:14.281174 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:26:14.282284 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:26:14.283825 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:26:14.286121 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:26:14.287448 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:26:14.288509 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:26:14.290244 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:26:14.291334 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:26:14.294151 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:26:14.295807 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:26:14.297193 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:26:14.298761 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:26:14.302735 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:26:14.309513 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:26:14.310892 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:26:14.314007 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:26:14.317858 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:26:14.320918 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:26:14.322149 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:26:14.325286 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:26:14.332277 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:26:14.341143 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:26:14.342225 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:26:14.345353 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:26:14.346451 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:26:14.347684 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:26:14.350469 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:26:14.354267 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:26:14.356909 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:26:14.542259 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:26:14.542530 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9c101ee-377a-4075-8ec0-a3164d28d108', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b88ced30>]}
2021-10-02 17:26:14.683367 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:26:14.699440 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:26:14.707836 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:26:14.715791 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:26:14.725429 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:26:14.732475 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:26:14.763636 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:26:14.771859 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:26:14.885781 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 17:26:14.892315 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9c101ee-377a-4075-8ec0-a3164d28d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8b22eb0>]}
2021-10-02 17:26:14.904227 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9c101ee-377a-4075-8ec0-a3164d28d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8b65fd0>]}
2021-10-02 17:26:14.904584 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 17:26:14.906845 (MainThread): 
2021-10-02 17:26:14.907320 (MainThread): Acquiring new postgres connection "master".
2021-10-02 17:26:14.909288 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:26:14.958517 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:26:14.958726 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 17:26:14.958880 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 17:26:18.703449 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 3.74 seconds
2021-10-02 17:26:18.703680 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:26:18.703828 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 17:26:18.716607 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 17:26:18.717937 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 17:26:18.719622 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 17:26:18.720227 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 17:26:18.721888 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:26:18.722057 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 17:26:18.722196 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:26:20.731542 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 2.01 seconds
2021-10-02 17:26:20.731775 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:26:20.731918 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 17:26:20.745882 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 17:26:20.747144 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 17:26:20.748419 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 17:26:20.748956 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 17:26:20.750716 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:26:20.750879 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 17:26:20.751019 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:26:22.281044 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.53 seconds
2021-10-02 17:26:22.281267 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:26:22.281407 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 17:26:22.294778 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 17:26:22.296285 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 17:26:22.298358 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 17:26:22.305481 (MainThread): Using postgres connection "master".
2021-10-02 17:26:22.305697 (MainThread): On master: BEGIN
2021-10-02 17:26:22.305926 (MainThread): Opening a new connection, currently in state init
2021-10-02 17:26:23.811011 (MainThread): SQL status: BEGIN in 1.51 seconds
2021-10-02 17:26:23.811243 (MainThread): Using postgres connection "master".
2021-10-02 17:26:23.811388 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 17:26:23.885419 (MainThread): SQL status: SELECT 7 in 0.07 seconds
2021-10-02 17:26:23.886635 (MainThread): On master: ROLLBACK
2021-10-02 17:26:23.888029 (MainThread): On master: Close
2021-10-02 17:26:23.888378 (MainThread): 22:56:23 | Concurrency: 1 threads (target='dev')
2021-10-02 17:26:23.888544 (MainThread): 22:56:23 | 
2021-10-02 17:26:23.890068 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:26:23.890259 (Thread-1): 22:56:23 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 17:26:23.890551 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:26:23.890750 (Thread-1): finished collecting timing info
2021-10-02 17:26:23.891212 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:26:23.891381 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:26:23.891492 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 17:26:23.891601 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:26:25.340635 (Thread-1): SQL status: BEGIN in 1.45 seconds
2021-10-02 17:26:25.341055 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:26:25.341239 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:26:25.341479 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:26:25.343855 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:26:25.352882 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:26:25.353091 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 17:26:25.356994 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 17:26:25.358402 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 17:26:25.358884 (Thread-1): finished collecting timing info
2021-10-02 17:26:25.359335 (Thread-1): 22:56:25 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.47s]
2021-10-02 17:26:25.359563 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:26:25.359764 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 17:26:25.360103 (Thread-1): 22:56:25 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 17:26:25.360464 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:26:25.360644 (Thread-1): finished collecting timing info
2021-10-02 17:26:25.361012 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:26:25.361192 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:26:25.361385 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 17:26:25.361542 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:26:27.068562 (Thread-1): SQL status: BEGIN in 1.71 seconds
2021-10-02 17:26:27.068779 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 17:26:27.068903 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:26:27.069013 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 17:26:27.070326 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:26:27.071951 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:26:27.072092 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where datediff('minute', created_ts, current_timestamp) < 5
    
  
2021-10-02 17:26:27.075398 (Thread-1): Postgres error: function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
LINE 7:     where datediff('minute', created_ts, current_timestamp) ...
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-02 17:26:27.075612 (Thread-1): Error running SQL: macro collect_freshness
2021-10-02 17:26:27.075730 (Thread-1): Rolling back transaction.
2021-10-02 17:26:27.075855 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 17:26:27.076150 (Thread-1): finished collecting timing info
2021-10-02 17:26:27.076427 (Thread-1): Database Error in source orders_freshness (models/sources/my_fav_source.yml)
  function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
  LINE 7:     where datediff('minute', created_ts, current_timestamp) ...
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
LINE 7:     where datediff('minute', created_ts, current_timestamp) ...
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/freshness.py", line 91, in execute
    freshness = self.adapter.calculate_freshness(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1086, in calculate_freshness
    table = self.execute_macro(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in source orders_freshness (models/sources/my_fav_source.yml)
  function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
  LINE 7:     where datediff('minute', created_ts, current_timestamp) ...
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-02 17:26:27.085900 (Thread-1): 22:56:27 | 2 of 2 ERROR freshness of freshness_test.orders_freshness............ [ERROR in 1.73s]
2021-10-02 17:26:27.086111 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 17:26:27.086854 (MainThread): Connection 'master' was properly closed.
2021-10-02 17:26:27.086983 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 17:26:27.094314 (MainThread): 
2021-10-02 17:26:27.094552 (MainThread): 
2021-10-02 17:26:27.094788 (MainThread): Database Error in source orders_freshness (models/sources/my_fav_source.yml)
2021-10-02 17:26:27.095057 (MainThread):   function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
2021-10-02 17:26:27.095234 (MainThread):   LINE 7:     where datediff('minute', created_ts, current_timestamp) ...
2021-10-02 17:26:27.095366 (MainThread):                     ^
2021-10-02 17:26:27.095540 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-02 17:26:27.095721 (MainThread): 22:56:27 | Done.
2021-10-02 17:26:27.095917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b609a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b86da970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b86daa30>]}
2021-10-02 17:26:27.096177 (MainThread): Flushing usage events
2021-10-02 17:28:06.229594 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:28:06.342513 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:28:06.347476 (MainThread): Tracking: tracking
2021-10-02 17:28:06.367478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d164940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d164c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d164d00>]}
2021-10-02 17:28:06.394358 (MainThread): Partial parsing not enabled
2021-10-02 17:28:06.475047 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:28:06.476611 (MainThread): Parsing macros/audits.sql
2021-10-02 17:28:06.477726 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:28:06.478977 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:28:06.480532 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:28:06.485373 (MainThread): Parsing macros/relations.sql
2021-10-02 17:28:06.487247 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:28:06.516427 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:28:06.518577 (MainThread): Parsing macros/core.sql
2021-10-02 17:28:06.523065 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:28:06.531833 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:28:06.544740 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:28:06.546919 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:28:06.569020 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:28:06.613695 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:28:06.645576 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:28:06.648776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:28:06.664335 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:28:06.696038 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:28:06.714266 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:28:06.724293 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:28:06.733407 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:28:06.738185 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:28:06.739293 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:28:06.740457 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:28:06.742226 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:28:06.753172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:28:06.755527 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:28:06.757374 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:28:06.833409 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:28:06.837081 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:28:06.839489 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:28:06.842263 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:28:06.846916 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:28:06.848810 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:28:06.851413 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:28:06.854963 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:28:06.868253 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:28:06.870417 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:28:06.872887 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:28:06.877659 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:28:06.880439 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:28:06.885898 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:28:06.906611 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:28:06.909550 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:28:06.913497 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:28:06.917219 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:28:06.920367 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:28:06.945685 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:28:06.951976 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:28:06.960333 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:28:06.962083 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:28:06.968197 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:28:06.971421 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:28:06.973771 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:28:06.978695 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:28:07.015269 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:28:07.016396 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:28:07.017390 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:28:07.018438 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:28:07.022654 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:28:07.024384 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:28:07.027423 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:28:07.028783 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:28:07.030116 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:28:07.031892 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:28:07.034445 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:28:07.036298 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:28:07.037663 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:28:07.039660 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:28:07.040840 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:28:07.044506 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:28:07.046544 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:28:07.048168 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:28:07.050685 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:28:07.056069 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:28:07.063763 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:28:07.065621 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:28:07.069252 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:28:07.073617 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:28:07.076822 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:28:07.078066 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:28:07.082707 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:28:07.090653 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:28:07.100879 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:28:07.102053 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:28:07.105809 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:28:07.107525 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:28:07.109031 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:28:07.113421 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:28:07.120590 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:28:07.125614 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:28:07.398075 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:28:07.398762 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '82bd1902-f52f-4b4d-8cb2-f08b1eb9f4b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d1bf6d0>]}
2021-10-02 17:28:07.574883 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:28:07.592164 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:28:07.601971 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:28:07.611663 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:28:07.622151 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:28:07.632284 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:28:07.673608 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:28:07.686988 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:28:07.856777 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 17:28:07.864054 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82bd1902-f52f-4b4d-8cb2-f08b1eb9f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d433190>]}
2021-10-02 17:28:07.877177 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82bd1902-f52f-4b4d-8cb2-f08b1eb9f4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d2fed90>]}
2021-10-02 17:28:07.877792 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 17:28:07.881799 (MainThread): 
2021-10-02 17:28:07.882648 (MainThread): Acquiring new postgres connection "master".
2021-10-02 17:28:07.885519 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:28:07.959458 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:28:07.959697 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 17:28:07.959860 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 17:28:12.919310 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 4.96 seconds
2021-10-02 17:28:12.920138 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:28:12.920591 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 17:28:12.939465 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 17:28:12.941028 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 17:28:12.943363 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 17:28:12.944016 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 17:28:12.946133 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:28:12.946466 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 17:28:12.946677 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:28:14.504587 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.56 seconds
2021-10-02 17:28:14.504891 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:28:14.505057 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 17:28:14.523927 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 17:28:14.525346 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 17:28:14.527392 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 17:28:14.527938 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 17:28:14.530324 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:28:14.530603 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 17:28:14.530902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:28:16.178642 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.65 seconds
2021-10-02 17:28:16.178910 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:28:16.179081 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 17:28:16.193866 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 17:28:16.195178 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 17:28:16.197007 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 17:28:16.204367 (MainThread): Using postgres connection "master".
2021-10-02 17:28:16.204589 (MainThread): On master: BEGIN
2021-10-02 17:28:16.204750 (MainThread): Opening a new connection, currently in state init
2021-10-02 17:28:17.678566 (MainThread): SQL status: BEGIN in 1.47 seconds
2021-10-02 17:28:17.678806 (MainThread): Using postgres connection "master".
2021-10-02 17:28:17.678986 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 17:28:17.756918 (MainThread): SQL status: SELECT 7 in 0.08 seconds
2021-10-02 17:28:17.758323 (MainThread): On master: ROLLBACK
2021-10-02 17:28:17.759844 (MainThread): On master: Close
2021-10-02 17:28:17.760231 (MainThread): 22:58:17 | Concurrency: 1 threads (target='dev')
2021-10-02 17:28:17.760427 (MainThread): 22:58:17 | 
2021-10-02 17:28:17.763782 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:28:17.764119 (Thread-1): 22:58:17 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 17:28:17.764783 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:28:17.765234 (Thread-1): finished collecting timing info
2021-10-02 17:28:17.765933 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:28:17.766225 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:28:17.766417 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 17:28:17.766579 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:28:19.119542 (Thread-1): SQL status: BEGIN in 1.35 seconds
2021-10-02 17:28:19.119807 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:28:19.119962 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:28:19.120104 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:28:19.121441 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:28:19.130286 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:28:19.130531 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 17:28:19.134873 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 17:28:19.136225 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 17:28:19.136647 (Thread-1): finished collecting timing info
2021-10-02 17:28:19.137284 (Thread-1): 22:58:19 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.37s]
2021-10-02 17:28:19.137564 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:28:19.137802 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 17:28:19.138107 (Thread-1): 22:58:19 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 17:28:19.138455 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:28:19.138636 (Thread-1): finished collecting timing info
2021-10-02 17:28:19.139017 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:28:19.139253 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:28:19.139404 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 17:28:19.139560 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:28:20.748130 (Thread-1): SQL status: BEGIN in 1.61 seconds
2021-10-02 17:28:20.748411 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 17:28:20.748569 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:28:20.748779 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 17:28:20.750421 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:28:20.752425 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:28:20.752611 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where datediff('mi', created_ts, current_timestamp) < 5
    
  
2021-10-02 17:28:20.755010 (Thread-1): Postgres error: function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
LINE 7:     where datediff('mi', created_ts, current_timestamp) < 5
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-02 17:28:20.755295 (Thread-1): Error running SQL: macro collect_freshness
2021-10-02 17:28:20.755458 (Thread-1): Rolling back transaction.
2021-10-02 17:28:20.755628 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 17:28:20.756027 (Thread-1): finished collecting timing info
2021-10-02 17:28:20.756457 (Thread-1): Database Error in source orders_freshness (models/sources/my_fav_source.yml)
  function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
  LINE 7:     where datediff('mi', created_ts, current_timestamp) < 5
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
LINE 7:     where datediff('mi', created_ts, current_timestamp) < 5
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/freshness.py", line 91, in execute
    freshness = self.adapter.calculate_freshness(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1086, in calculate_freshness
    table = self.execute_macro(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in source orders_freshness (models/sources/my_fav_source.yml)
  function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
  LINE 7:     where datediff('mi', created_ts, current_timestamp) < 5
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-02 17:28:20.767636 (Thread-1): 22:58:20 | 2 of 2 ERROR freshness of freshness_test.orders_freshness............ [ERROR in 1.63s]
2021-10-02 17:28:20.767871 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 17:28:20.769239 (MainThread): Connection 'master' was properly closed.
2021-10-02 17:28:20.769423 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 17:28:20.779913 (MainThread): 
2021-10-02 17:28:20.780218 (MainThread): 
2021-10-02 17:28:20.780392 (MainThread): Database Error in source orders_freshness (models/sources/my_fav_source.yml)
2021-10-02 17:28:20.780546 (MainThread):   function datediff(unknown, timestamp with time zone, timestamp with time zone) does not exist
2021-10-02 17:28:20.780731 (MainThread):   LINE 7:     where datediff('mi', created_ts, current_timestamp) < 5
2021-10-02 17:28:20.780892 (MainThread):                     ^
2021-10-02 17:28:20.781030 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-02 17:28:20.781176 (MainThread): 22:58:20 | Done.
2021-10-02 17:28:20.781386 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19a89a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d108880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19d1088b0>]}
2021-10-02 17:28:20.781680 (MainThread): Flushing usage events
2021-10-02 17:56:50.475130 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 17:56:50.574202 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 17:56:50.575591 (MainThread): Tracking: tracking
2021-10-02 17:56:50.774622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3689574f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368901580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368901790>]}
2021-10-02 17:56:50.797587 (MainThread): Partial parsing not enabled
2021-10-02 17:56:50.862564 (MainThread): Parsing macros/test_empty.sql
2021-10-02 17:56:50.863777 (MainThread): Parsing macros/audits.sql
2021-10-02 17:56:50.864547 (MainThread): Parsing macros/test_country.sql
2021-10-02 17:56:50.865178 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 17:56:50.866205 (MainThread): Parsing macros/catalog.sql
2021-10-02 17:56:50.870755 (MainThread): Parsing macros/relations.sql
2021-10-02 17:56:50.873197 (MainThread): Parsing macros/adapters.sql
2021-10-02 17:56:50.902082 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 17:56:50.904217 (MainThread): Parsing macros/core.sql
2021-10-02 17:56:50.908691 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 17:56:50.917023 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 17:56:50.928892 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 17:56:50.930874 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 17:56:50.949598 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 17:56:50.986820 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 17:56:51.007480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 17:56:51.009109 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 17:56:51.019447 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 17:56:51.039170 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 17:56:51.052785 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 17:56:51.061178 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 17:56:51.068737 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 17:56:51.072966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 17:56:51.073797 (MainThread): Parsing macros/etc/query.sql
2021-10-02 17:56:51.074674 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 17:56:51.076150 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 17:56:51.085158 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 17:56:51.087382 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 17:56:51.088900 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 17:56:51.143177 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 17:56:51.144830 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 17:56:51.145881 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 17:56:51.147460 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 17:56:51.149909 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 17:56:51.151115 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 17:56:51.152483 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 17:56:51.154800 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 17:56:51.160893 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 17:56:51.161969 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 17:56:51.163171 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 17:56:51.165347 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 17:56:51.166463 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 17:56:51.168615 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 17:56:51.178165 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 17:56:51.180290 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 17:56:51.181705 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 17:56:51.183428 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 17:56:51.184950 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 17:56:51.185841 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 17:56:51.189151 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 17:56:51.194230 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 17:56:51.194957 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 17:56:51.197951 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 17:56:51.199855 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 17:56:51.201273 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 17:56:51.203093 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 17:56:51.225560 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 17:56:51.226209 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 17:56:51.226842 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 17:56:51.227417 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 17:56:51.230446 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 17:56:51.231638 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 17:56:51.234047 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 17:56:51.235186 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 17:56:51.236055 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 17:56:51.237273 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 17:56:51.240955 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 17:56:51.242445 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 17:56:51.243651 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 17:56:51.245540 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 17:56:51.246983 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 17:56:51.249350 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 17:56:51.250811 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 17:56:51.251871 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 17:56:51.253257 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 17:56:51.257523 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 17:56:51.264172 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 17:56:51.265372 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 17:56:51.267991 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 17:56:51.270993 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 17:56:51.273641 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 17:56:51.274484 (MainThread): Parsing macros/sql/star.sql
2021-10-02 17:56:51.277151 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 17:56:51.283503 (MainThread): Parsing macros/sql/union.sql
2021-10-02 17:56:51.290981 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 17:56:51.291818 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 17:56:51.294372 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 17:56:51.295244 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 17:56:51.296403 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 17:56:51.299576 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 17:56:51.303160 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 17:56:51.305662 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 17:56:51.483254 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 17:56:51.483491 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '466340e4-e62c-4bb7-bbc4-d2cc65be6e9a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368b0f0d0>]}
2021-10-02 17:56:51.602567 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 17:56:51.617201 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 17:56:51.625442 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 17:56:51.632605 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 17:56:51.641632 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 17:56:51.648639 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 17:56:51.675701 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 17:56:51.683985 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 17:56:51.788444 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 17:56:51.794630 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '466340e4-e62c-4bb7-bbc4-d2cc65be6e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368c33040>]}
2021-10-02 17:56:51.806505 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '466340e4-e62c-4bb7-bbc4-d2cc65be6e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368baddc0>]}
2021-10-02 17:56:51.806905 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 17:56:51.809060 (MainThread): 
2021-10-02 17:56:51.809521 (MainThread): Acquiring new postgres connection "master".
2021-10-02 17:56:51.811509 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:56:51.863704 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:56:51.863938 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 17:56:51.864099 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 17:56:57.932887 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 6.07 seconds
2021-10-02 17:56:57.933149 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 17:56:57.933297 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 17:56:57.947346 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 17:56:57.948706 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 17:56:57.950283 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 17:56:57.950863 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 17:56:57.952842 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:56:57.953031 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 17:56:57.953172 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:56:59.572246 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.62 seconds
2021-10-02 17:56:59.572488 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 17:56:59.572634 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 17:56:59.585947 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 17:56:59.587467 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 17:56:59.589164 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 17:56:59.589687 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 17:56:59.591657 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:56:59.591830 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 17:56:59.591972 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 17:57:00.951791 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.36 seconds
2021-10-02 17:57:00.952080 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 17:57:00.952503 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 17:57:00.966182 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 17:57:00.967571 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 17:57:00.969471 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 17:57:00.976087 (MainThread): Using postgres connection "master".
2021-10-02 17:57:00.976391 (MainThread): On master: BEGIN
2021-10-02 17:57:00.976691 (MainThread): Opening a new connection, currently in state init
2021-10-02 17:57:02.707086 (MainThread): SQL status: BEGIN in 1.73 seconds
2021-10-02 17:57:02.707333 (MainThread): Using postgres connection "master".
2021-10-02 17:57:02.707489 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 17:57:02.797387 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-02 17:57:02.798944 (MainThread): On master: ROLLBACK
2021-10-02 17:57:02.800963 (MainThread): On master: Close
2021-10-02 17:57:02.801386 (MainThread): 23:27:02 | Concurrency: 1 threads (target='dev')
2021-10-02 17:57:02.801599 (MainThread): 23:27:02 | 
2021-10-02 17:57:02.804902 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:57:02.805197 (Thread-1): 23:27:02 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 17:57:02.805630 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:57:02.805894 (Thread-1): finished collecting timing info
2021-10-02 17:57:02.806903 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:57:02.807117 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:57:02.807285 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 17:57:02.807513 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:57:04.649785 (Thread-1): SQL status: BEGIN in 1.84 seconds
2021-10-02 17:57:04.650082 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:57:04.650246 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:57:04.650394 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 17:57:04.652190 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:57:04.661364 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 17:57:04.661606 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 17:57:04.666560 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 17:57:04.667945 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 17:57:04.668374 (Thread-1): finished collecting timing info
2021-10-02 17:57:04.668745 (Thread-1): 23:27:04 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.86s]
2021-10-02 17:57:04.668965 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 17:57:04.669164 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 17:57:04.669562 (Thread-1): 23:27:04 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 17:57:04.669943 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:57:04.670127 (Thread-1): finished collecting timing info
2021-10-02 17:57:04.670515 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:57:04.670697 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:57:04.670839 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 17:57:04.670984 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 17:57:05.989911 (Thread-1): SQL status: BEGIN in 1.32 seconds
2021-10-02 17:57:05.990364 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 17:57:05.990543 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:57:05.990693 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 17:57:05.992985 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 17:57:05.995794 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 17:57:05.996237 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where EXTRACT(MINUTE from (current_timestamp- created_ts) ) < 5
    
  
2021-10-02 17:57:06.004180 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 17:57:06.005674 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 17:57:06.006233 (Thread-1): finished collecting timing info
2021-10-02 17:57:06.006642 (Thread-1): 23:27:06 | 2 of 2 ERROR STALE freshness of freshness_test.orders_freshness...... [ERROR STALE in 1.34s]
2021-10-02 17:57:06.006884 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 17:57:06.008495 (MainThread): Connection 'master' was properly closed.
2021-10-02 17:57:06.008779 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 17:57:06.021334 (MainThread): 
2021-10-02 17:57:06.021651 (MainThread): 
2021-10-02 17:57:06.021861 (MainThread): 23:27:06 | Done.
2021-10-02 17:57:06.022129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368c42820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368c42bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368c42430>]}
2021-10-02 17:57:06.022493 (MainThread): Flushing usage events
2021-10-02 18:01:13.953655 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 18:01:14.051078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 18:01:14.052854 (MainThread): Tracking: tracking
2021-10-02 18:01:14.069197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7408e6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7409026a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd740902e50>]}
2021-10-02 18:01:14.092474 (MainThread): Partial parsing not enabled
2021-10-02 18:01:14.156960 (MainThread): Parsing macros/test_empty.sql
2021-10-02 18:01:14.158116 (MainThread): Parsing macros/audits.sql
2021-10-02 18:01:14.158957 (MainThread): Parsing macros/test_country.sql
2021-10-02 18:01:14.159824 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 18:01:14.161026 (MainThread): Parsing macros/catalog.sql
2021-10-02 18:01:14.165230 (MainThread): Parsing macros/relations.sql
2021-10-02 18:01:14.167038 (MainThread): Parsing macros/adapters.sql
2021-10-02 18:01:14.196707 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 18:01:14.199378 (MainThread): Parsing macros/core.sql
2021-10-02 18:01:14.204239 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 18:01:14.213849 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 18:01:14.226264 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 18:01:14.228322 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 18:01:14.250004 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 18:01:14.291145 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 18:01:14.318603 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 18:01:14.320795 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 18:01:14.333265 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 18:01:14.358809 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 18:01:14.374797 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 18:01:14.382991 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 18:01:14.390480 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 18:01:14.394027 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 18:01:14.394824 (MainThread): Parsing macros/etc/query.sql
2021-10-02 18:01:14.395827 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 18:01:14.397276 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 18:01:14.406535 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 18:01:14.408621 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 18:01:14.410340 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 18:01:14.476050 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 18:01:14.478032 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 18:01:14.479518 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 18:01:14.481095 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 18:01:14.483632 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 18:01:14.484953 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 18:01:14.486717 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 18:01:14.489322 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 18:01:14.496554 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 18:01:14.498023 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 18:01:14.499706 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 18:01:14.502653 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 18:01:14.504006 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 18:01:14.506795 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 18:01:14.519389 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 18:01:14.521743 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 18:01:14.523449 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 18:01:14.525427 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 18:01:14.527277 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 18:01:14.528383 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 18:01:14.532144 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 18:01:14.538514 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 18:01:14.539436 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 18:01:14.542574 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 18:01:14.544761 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 18:01:14.546450 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 18:01:14.548537 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 18:01:14.576609 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 18:01:14.577426 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 18:01:14.578221 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 18:01:14.578942 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 18:01:14.582740 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 18:01:14.584279 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 18:01:14.586705 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 18:01:14.587932 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 18:01:14.588938 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 18:01:14.590372 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 18:01:14.592622 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 18:01:14.593928 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 18:01:14.594982 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 18:01:14.596678 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 18:01:14.597788 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 18:01:14.600672 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 18:01:14.602369 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 18:01:14.603630 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 18:01:14.605144 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 18:01:14.609283 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 18:01:14.616263 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 18:01:14.617639 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 18:01:14.620451 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 18:01:14.624088 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 18:01:14.626827 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 18:01:14.627901 (MainThread): Parsing macros/sql/star.sql
2021-10-02 18:01:14.631438 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 18:01:14.638799 (MainThread): Parsing macros/sql/union.sql
2021-10-02 18:01:14.647956 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 18:01:14.649034 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 18:01:14.652173 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 18:01:14.653267 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 18:01:14.654538 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 18:01:14.657723 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 18:01:14.662344 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 18:01:14.665355 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 18:01:14.844353 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 18:01:14.844633 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad562fa2-b0af-4b07-b9fc-c6a6e4ba2af1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7409a1310>]}
2021-10-02 18:01:14.984533 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 18:01:15.000926 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 18:01:15.009186 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 18:01:15.016769 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 18:01:15.025898 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 18:01:15.033275 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 18:01:15.061694 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 18:01:15.069949 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 18:01:15.189808 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 18:01:15.196216 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad562fa2-b0af-4b07-b9fc-c6a6e4ba2af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd740a3e700>]}
2021-10-02 18:01:15.207597 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad562fa2-b0af-4b07-b9fc-c6a6e4ba2af1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd740a8fa00>]}
2021-10-02 18:01:15.207948 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 18:01:15.210084 (MainThread): 
2021-10-02 18:01:15.210549 (MainThread): Acquiring new postgres connection "master".
2021-10-02 18:01:15.212626 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 18:01:15.260434 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:01:15.260663 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 18:01:15.260822 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 18:01:17.062104 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.80 seconds
2021-10-02 18:01:17.062761 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:01:17.062930 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 18:01:17.078663 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.02 seconds
2021-10-02 18:01:17.080353 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 18:01:17.082467 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 18:01:17.083080 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 18:01:17.085344 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:01:17.085553 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 18:01:17.085819 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:01:18.699561 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.61 seconds
2021-10-02 18:01:18.699845 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:01:18.700114 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 18:01:18.713623 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 18:01:18.715347 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 18:01:18.717313 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 18:01:18.717893 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:01:18.719965 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:01:18.720153 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 18:01:18.720312 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:01:20.222187 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.50 seconds
2021-10-02 18:01:20.222430 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:01:20.222580 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 18:01:20.235042 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 18:01:20.236210 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 18:01:20.237994 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 18:01:20.244372 (MainThread): Using postgres connection "master".
2021-10-02 18:01:20.244575 (MainThread): On master: BEGIN
2021-10-02 18:01:20.244723 (MainThread): Opening a new connection, currently in state init
2021-10-02 18:01:21.676326 (MainThread): SQL status: BEGIN in 1.43 seconds
2021-10-02 18:01:21.676571 (MainThread): Using postgres connection "master".
2021-10-02 18:01:21.676719 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 18:01:21.757064 (MainThread): SQL status: SELECT 7 in 0.08 seconds
2021-10-02 18:01:21.758208 (MainThread): On master: ROLLBACK
2021-10-02 18:01:21.759777 (MainThread): On master: Close
2021-10-02 18:01:21.760176 (MainThread): 23:31:21 | Concurrency: 1 threads (target='dev')
2021-10-02 18:01:21.760355 (MainThread): 23:31:21 | 
2021-10-02 18:01:21.764548 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:01:21.764937 (Thread-1): 23:31:21 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 18:01:21.765352 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:01:21.765538 (Thread-1): finished collecting timing info
2021-10-02 18:01:21.765999 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:01:21.766180 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:01:21.766322 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 18:01:21.766464 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:01:23.403785 (Thread-1): SQL status: BEGIN in 1.64 seconds
2021-10-02 18:01:23.404054 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:01:23.404217 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:01:23.404362 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:01:23.406116 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:01:23.415708 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:01:23.415924 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 18:01:23.420310 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:01:23.421641 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 18:01:23.422064 (Thread-1): finished collecting timing info
2021-10-02 18:01:23.422425 (Thread-1): 23:31:23 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.66s]
2021-10-02 18:01:23.422644 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:01:23.422841 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:01:23.423196 (Thread-1): 23:31:23 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 18:01:23.423599 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:01:23.423783 (Thread-1): finished collecting timing info
2021-10-02 18:01:23.424316 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:01:23.424499 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:01:23.424641 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 18:01:23.424783 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:01:25.066192 (Thread-1): SQL status: BEGIN in 1.64 seconds
2021-10-02 18:01:25.066457 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:01:25.066622 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:01:25.066808 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:01:25.068385 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:01:25.070264 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:01:25.070435 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where EXTRACT(hour from (current_timestamp- created_ts) ) < 5
    
  
2021-10-02 18:01:25.074212 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:01:25.075482 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 18:01:25.075884 (Thread-1): finished collecting timing info
2021-10-02 18:01:25.076233 (Thread-1): 23:31:25 | 2 of 2 PASS freshness of freshness_test.orders_freshness............. [PASS in 1.65s]
2021-10-02 18:01:25.076443 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:01:25.078092 (MainThread): Connection 'master' was properly closed.
2021-10-02 18:01:25.078287 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 18:01:25.088165 (MainThread): 
2021-10-02 18:01:25.088532 (MainThread): 23:31:25 | Done.
2021-10-02 18:01:25.088951 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7408ad6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74089a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74089a8b0>]}
2021-10-02 18:01:25.089267 (MainThread): Flushing usage events
2021-10-02 18:04:31.755046 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 18:04:31.863902 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 18:04:31.866187 (MainThread): Tracking: tracking
2021-10-02 18:04:31.888331 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316958520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3169015b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3169017c0>]}
2021-10-02 18:04:31.919600 (MainThread): Partial parsing not enabled
2021-10-02 18:04:32.009582 (MainThread): Parsing macros/test_empty.sql
2021-10-02 18:04:32.010616 (MainThread): Parsing macros/audits.sql
2021-10-02 18:04:32.011294 (MainThread): Parsing macros/test_country.sql
2021-10-02 18:04:32.012042 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 18:04:32.013200 (MainThread): Parsing macros/catalog.sql
2021-10-02 18:04:32.018054 (MainThread): Parsing macros/relations.sql
2021-10-02 18:04:32.020469 (MainThread): Parsing macros/adapters.sql
2021-10-02 18:04:32.051230 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 18:04:32.053661 (MainThread): Parsing macros/core.sql
2021-10-02 18:04:32.058604 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 18:04:32.068007 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 18:04:32.084934 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 18:04:32.088305 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 18:04:32.110961 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 18:04:32.152961 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 18:04:32.179941 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 18:04:32.182455 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 18:04:32.196034 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 18:04:32.220930 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 18:04:32.236078 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 18:04:32.244544 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 18:04:32.252484 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 18:04:32.257022 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 18:04:32.258152 (MainThread): Parsing macros/etc/query.sql
2021-10-02 18:04:32.259250 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 18:04:32.260954 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 18:04:32.271654 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 18:04:32.274417 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 18:04:32.276319 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 18:04:32.346359 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 18:04:32.348361 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 18:04:32.349692 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 18:04:32.351203 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 18:04:32.353645 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 18:04:32.354898 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 18:04:32.356577 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 18:04:32.359095 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 18:04:32.366051 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 18:04:32.367279 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 18:04:32.368614 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 18:04:32.370932 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 18:04:32.371981 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 18:04:32.374623 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 18:04:32.384633 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 18:04:32.386468 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 18:04:32.388224 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 18:04:32.389876 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 18:04:32.391575 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 18:04:32.392600 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 18:04:32.396236 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 18:04:32.402574 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 18:04:32.403527 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 18:04:32.406756 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 18:04:32.409039 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 18:04:32.410937 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 18:04:32.413321 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 18:04:32.444001 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 18:04:32.445006 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 18:04:32.446071 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 18:04:32.446912 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 18:04:32.451259 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 18:04:32.453012 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 18:04:32.455383 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 18:04:32.456554 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 18:04:32.457653 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 18:04:32.459064 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 18:04:32.461388 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 18:04:32.462807 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 18:04:32.463969 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 18:04:32.465822 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 18:04:32.466932 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 18:04:32.469890 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 18:04:32.471455 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 18:04:32.472553 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 18:04:32.474771 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 18:04:32.478873 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 18:04:32.486166 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 18:04:32.487681 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 18:04:32.490557 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 18:04:32.494103 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 18:04:32.496736 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 18:04:32.497752 (MainThread): Parsing macros/sql/star.sql
2021-10-02 18:04:32.501004 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 18:04:32.507976 (MainThread): Parsing macros/sql/union.sql
2021-10-02 18:04:32.516827 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 18:04:32.517875 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 18:04:32.520862 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 18:04:32.522023 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 18:04:32.523334 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 18:04:32.526506 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 18:04:32.531417 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 18:04:32.535218 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 18:04:32.703994 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 18:04:32.704234 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c05c28d-35c3-405b-b2c5-ec7e893e8f5e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316b0fb50>]}
2021-10-02 18:04:32.837059 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 18:04:32.853123 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 18:04:32.861416 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 18:04:32.868412 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 18:04:32.877119 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 18:04:32.884761 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 18:04:32.917067 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 18:04:32.925302 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 18:04:33.040487 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 18:04:33.046870 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c05c28d-35c3-405b-b2c5-ec7e893e8f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316c330a0>]}
2021-10-02 18:04:33.058029 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c05c28d-35c3-405b-b2c5-ec7e893e8f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316b86d90>]}
2021-10-02 18:04:33.058383 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 18:04:33.060574 (MainThread): 
2021-10-02 18:04:33.061050 (MainThread): Acquiring new postgres connection "master".
2021-10-02 18:04:33.062864 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 18:04:33.114771 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:04:33.115002 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 18:04:33.115163 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 18:04:34.792777 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.68 seconds
2021-10-02 18:04:34.793073 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:04:34.793237 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 18:04:34.806476 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-02 18:04:34.808021 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 18:04:34.809802 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 18:04:34.810373 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 18:04:34.812380 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:04:34.812623 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 18:04:34.812835 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:04:36.667161 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.85 seconds
2021-10-02 18:04:36.667409 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:04:36.667554 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 18:04:36.680919 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 18:04:36.682406 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 18:04:36.684293 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 18:04:36.684843 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:04:36.687076 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:04:36.687286 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 18:04:36.687440 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:04:38.329164 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.64 seconds
2021-10-02 18:04:38.329751 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:04:38.329925 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 18:04:38.341540 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 18:04:38.342753 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 18:04:38.344386 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 18:04:38.350203 (MainThread): Using postgres connection "master".
2021-10-02 18:04:38.350424 (MainThread): On master: BEGIN
2021-10-02 18:04:38.350576 (MainThread): Opening a new connection, currently in state init
2021-10-02 18:04:39.730854 (MainThread): SQL status: BEGIN in 1.38 seconds
2021-10-02 18:04:39.731238 (MainThread): Using postgres connection "master".
2021-10-02 18:04:39.731427 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 18:04:39.816637 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-02 18:04:39.818105 (MainThread): On master: ROLLBACK
2021-10-02 18:04:39.820021 (MainThread): On master: Close
2021-10-02 18:04:39.820503 (MainThread): 23:34:39 | Concurrency: 1 threads (target='dev')
2021-10-02 18:04:39.820721 (MainThread): 23:34:39 | 
2021-10-02 18:04:39.824336 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:04:39.824654 (Thread-1): 23:34:39 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 18:04:39.825214 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:04:39.825497 (Thread-1): finished collecting timing info
2021-10-02 18:04:39.826394 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:04:39.826865 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:04:39.827230 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 18:04:39.827633 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:04:41.437516 (Thread-1): SQL status: BEGIN in 1.61 seconds
2021-10-02 18:04:41.437898 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:04:41.438157 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:04:41.438762 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:04:41.441180 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:04:41.451977 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:04:41.452188 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 18:04:41.456764 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:04:41.458371 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 18:04:41.458848 (Thread-1): finished collecting timing info
2021-10-02 18:04:41.459223 (Thread-1): 23:34:41 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.63s]
2021-10-02 18:04:41.459482 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:04:41.459733 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:04:41.460094 (Thread-1): 23:34:41 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 18:04:41.460579 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:04:41.460780 (Thread-1): finished collecting timing info
2021-10-02 18:04:41.461164 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:04:41.461350 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:04:41.461495 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 18:04:41.461644 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:04:43.090425 (Thread-1): SQL status: BEGIN in 1.63 seconds
2021-10-02 18:04:43.090857 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:04:43.091051 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:04:43.091212 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:04:43.093225 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:04:43.095268 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:04:43.095447 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where EXTRACT(hour from (current_timestamp- created_ts) ) < 5
    
  
2021-10-02 18:04:43.100293 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:04:43.101763 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 18:04:43.102177 (Thread-1): finished collecting timing info
2021-10-02 18:04:43.102543 (Thread-1): 23:34:43 | 2 of 2 ERROR STALE freshness of freshness_test.orders_freshness...... [ERROR STALE in 1.64s]
2021-10-02 18:04:43.102746 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:04:43.107345 (MainThread): Connection 'master' was properly closed.
2021-10-02 18:04:43.107900 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 18:04:43.118243 (MainThread): 
2021-10-02 18:04:43.118526 (MainThread): 
2021-10-02 18:04:43.118735 (MainThread): 23:34:43 | Done.
2021-10-02 18:04:43.118986 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316b15940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316b153d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316b151c0>]}
2021-10-02 18:04:43.119280 (MainThread): Flushing usage events
2021-10-02 18:05:50.313526 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 18:05:50.413136 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 18:05:50.414664 (MainThread): Tracking: tracking
2021-10-02 18:05:50.431826 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe343001fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3430016d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe343001c70>]}
2021-10-02 18:05:50.461754 (MainThread): Partial parsing not enabled
2021-10-02 18:05:50.539214 (MainThread): Parsing macros/test_empty.sql
2021-10-02 18:05:50.540213 (MainThread): Parsing macros/audits.sql
2021-10-02 18:05:50.540830 (MainThread): Parsing macros/test_country.sql
2021-10-02 18:05:50.541642 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 18:05:50.542909 (MainThread): Parsing macros/catalog.sql
2021-10-02 18:05:50.546759 (MainThread): Parsing macros/relations.sql
2021-10-02 18:05:50.548423 (MainThread): Parsing macros/adapters.sql
2021-10-02 18:05:50.577317 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 18:05:50.579368 (MainThread): Parsing macros/core.sql
2021-10-02 18:05:50.583869 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 18:05:50.592240 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 18:05:50.604187 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 18:05:50.606244 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 18:05:50.626733 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 18:05:50.667072 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 18:05:50.692879 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 18:05:50.695018 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 18:05:50.707443 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 18:05:50.732697 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 18:05:50.749331 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 18:05:50.759232 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 18:05:50.768071 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 18:05:50.772519 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 18:05:50.773479 (MainThread): Parsing macros/etc/query.sql
2021-10-02 18:05:50.774535 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 18:05:50.776229 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 18:05:50.785773 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 18:05:50.787928 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 18:05:50.789648 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 18:05:50.861791 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 18:05:50.864019 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 18:05:50.865470 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 18:05:50.867071 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 18:05:50.869663 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 18:05:50.871020 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 18:05:50.872787 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 18:05:50.875438 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 18:05:50.883259 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 18:05:50.884765 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 18:05:50.886499 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 18:05:50.889495 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 18:05:50.890866 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 18:05:50.893772 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 18:05:50.905829 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 18:05:50.908058 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 18:05:50.909721 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 18:05:50.911690 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 18:05:50.913602 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 18:05:50.914782 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 18:05:50.918777 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 18:05:50.925374 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 18:05:50.926384 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 18:05:50.929570 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 18:05:50.931727 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 18:05:50.933471 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 18:05:50.935675 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 18:05:50.964622 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 18:05:50.965481 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 18:05:50.966303 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 18:05:50.967031 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 18:05:50.971128 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 18:05:50.972656 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 18:05:50.975164 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 18:05:50.976418 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 18:05:50.977406 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 18:05:50.978856 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 18:05:50.981103 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 18:05:50.982438 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 18:05:50.983503 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 18:05:50.985226 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 18:05:50.986322 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 18:05:50.989111 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 18:05:50.990682 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 18:05:50.991805 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 18:05:50.993258 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 18:05:50.997132 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 18:05:51.004178 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 18:05:51.005697 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 18:05:51.008662 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 18:05:51.012663 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 18:05:51.015662 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 18:05:51.016754 (MainThread): Parsing macros/sql/star.sql
2021-10-02 18:05:51.019854 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 18:05:51.026664 (MainThread): Parsing macros/sql/union.sql
2021-10-02 18:05:51.035584 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 18:05:51.036696 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 18:05:51.039977 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 18:05:51.041329 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 18:05:51.042707 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 18:05:51.045697 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 18:05:51.049981 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 18:05:51.052882 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 18:05:51.234779 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 18:05:51.235076 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ed1b4b89-e8be-456d-8edf-b62ef6e40c69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3430cfd30>]}
2021-10-02 18:05:51.370923 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 18:05:51.386906 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 18:05:51.394868 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 18:05:51.402751 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 18:05:51.412878 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 18:05:51.421246 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 18:05:51.454696 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 18:05:51.465473 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 18:05:51.586854 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 18:05:51.593182 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed1b4b89-e8be-456d-8edf-b62ef6e40c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3433103d0>]}
2021-10-02 18:05:51.604904 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed1b4b89-e8be-456d-8edf-b62ef6e40c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe343350a30>]}
2021-10-02 18:05:51.605430 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 18:05:51.607430 (MainThread): 
2021-10-02 18:05:51.607950 (MainThread): Acquiring new postgres connection "master".
2021-10-02 18:05:51.610008 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 18:05:51.663510 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:05:51.663744 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 18:05:51.663915 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 18:05:53.442989 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.78 seconds
2021-10-02 18:05:53.443323 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:05:53.443550 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 18:05:53.460697 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 18:05:53.462324 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 18:05:53.465990 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 18:05:53.466607 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 18:05:53.469098 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:05:53.469405 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 18:05:53.469803 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:05:54.878156 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.41 seconds
2021-10-02 18:05:54.878409 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:05:54.878555 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 18:05:54.893951 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.02 seconds
2021-10-02 18:05:54.895582 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 18:05:54.897485 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 18:05:54.898012 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:05:54.900458 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:05:54.900682 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 18:05:54.900892 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:05:56.713858 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.81 seconds
2021-10-02 18:05:56.714184 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:05:56.714353 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 18:05:56.727938 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 18:05:56.729287 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 18:05:56.731017 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 18:05:56.738964 (MainThread): Using postgres connection "master".
2021-10-02 18:05:56.739181 (MainThread): On master: BEGIN
2021-10-02 18:05:56.739339 (MainThread): Opening a new connection, currently in state init
2021-10-02 18:05:58.088583 (MainThread): SQL status: BEGIN in 1.35 seconds
2021-10-02 18:05:58.088837 (MainThread): Using postgres connection "master".
2021-10-02 18:05:58.088991 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 18:05:58.170199 (MainThread): SQL status: SELECT 7 in 0.08 seconds
2021-10-02 18:05:58.171639 (MainThread): On master: ROLLBACK
2021-10-02 18:05:58.173431 (MainThread): On master: Close
2021-10-02 18:05:58.173873 (MainThread): 23:35:58 | Concurrency: 1 threads (target='dev')
2021-10-02 18:05:58.174192 (MainThread): 23:35:58 | 
2021-10-02 18:05:58.176133 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:05:58.176427 (Thread-1): 23:35:58 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 18:05:58.176942 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:05:58.177145 (Thread-1): finished collecting timing info
2021-10-02 18:05:58.177595 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:05:58.177923 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:05:58.178318 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 18:05:58.178802 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:05:59.523816 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-10-02 18:05:59.524102 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:05:59.524265 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:05:59.524405 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:05:59.526302 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:05:59.535302 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:05:59.535533 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 18:05:59.540057 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:05:59.541413 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 18:05:59.541864 (Thread-1): finished collecting timing info
2021-10-02 18:05:59.542285 (Thread-1): 23:35:59 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.37s]
2021-10-02 18:05:59.542578 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:05:59.542814 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:05:59.543258 (Thread-1): 23:35:59 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 18:05:59.543705 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:05:59.543890 (Thread-1): finished collecting timing info
2021-10-02 18:05:59.544335 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:05:59.544582 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:05:59.544745 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 18:05:59.544907 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:06:00.916064 (Thread-1): SQL status: BEGIN in 1.37 seconds
2021-10-02 18:06:00.916371 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:06:00.916558 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:06:00.916762 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:06:00.919221 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:06:00.921736 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:06:00.921945 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where EXTRACT(minute from (current_timestamp- created_ts) ) < 5
    
  
2021-10-02 18:06:00.928190 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 18:06:00.929526 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 18:06:00.929939 (Thread-1): finished collecting timing info
2021-10-02 18:06:00.930460 (Thread-1): 23:36:00 | 2 of 2 ERROR STALE freshness of freshness_test.orders_freshness...... [ERROR STALE in 1.39s]
2021-10-02 18:06:00.930683 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:06:00.931637 (MainThread): Connection 'master' was properly closed.
2021-10-02 18:06:00.931819 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 18:06:00.941191 (MainThread): 
2021-10-02 18:06:00.941453 (MainThread): 
2021-10-02 18:06:00.941702 (MainThread): 23:36:00 | Done.
2021-10-02 18:06:00.942120 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe342fd9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe342fd99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe342fd9940>]}
2021-10-02 18:06:00.942482 (MainThread): Flushing usage events
2021-10-02 18:07:36.375807 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 18:07:36.513896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 18:07:36.516105 (MainThread): Tracking: tracking
2021-10-02 18:07:36.534828 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7fe4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7f92670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7f92e20>]}
2021-10-02 18:07:36.560125 (MainThread): Partial parsing not enabled
2021-10-02 18:07:36.629386 (MainThread): Parsing macros/test_empty.sql
2021-10-02 18:07:36.630363 (MainThread): Parsing macros/audits.sql
2021-10-02 18:07:36.630981 (MainThread): Parsing macros/test_country.sql
2021-10-02 18:07:36.631721 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 18:07:36.632925 (MainThread): Parsing macros/catalog.sql
2021-10-02 18:07:36.637078 (MainThread): Parsing macros/relations.sql
2021-10-02 18:07:36.638862 (MainThread): Parsing macros/adapters.sql
2021-10-02 18:07:36.668167 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 18:07:36.670431 (MainThread): Parsing macros/core.sql
2021-10-02 18:07:36.675086 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 18:07:36.687240 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 18:07:36.699756 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 18:07:36.701930 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 18:07:36.723426 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 18:07:36.763168 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 18:07:36.785127 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 18:07:36.787274 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 18:07:36.799485 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 18:07:36.822764 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 18:07:36.839460 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 18:07:36.848124 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 18:07:36.855185 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 18:07:36.858801 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 18:07:36.859687 (MainThread): Parsing macros/etc/query.sql
2021-10-02 18:07:36.860596 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 18:07:36.861975 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 18:07:36.870758 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 18:07:36.872886 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 18:07:36.874591 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 18:07:36.948032 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 18:07:36.950260 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 18:07:36.951799 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 18:07:36.953450 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 18:07:36.956067 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 18:07:36.957437 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 18:07:36.959318 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 18:07:36.962166 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 18:07:36.969859 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 18:07:36.971321 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 18:07:36.973049 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 18:07:36.976058 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 18:07:36.977468 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 18:07:36.980453 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 18:07:36.993531 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 18:07:36.996118 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 18:07:36.998089 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 18:07:37.000313 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 18:07:37.002473 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 18:07:37.003740 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 18:07:37.007798 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 18:07:37.015438 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 18:07:37.016503 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 18:07:37.019885 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 18:07:37.022457 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 18:07:37.024383 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 18:07:37.026764 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 18:07:37.056020 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 18:07:37.056872 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 18:07:37.057705 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 18:07:37.058458 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 18:07:37.063527 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 18:07:37.065214 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 18:07:37.067748 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 18:07:37.068993 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 18:07:37.070008 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 18:07:37.071469 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 18:07:37.073790 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 18:07:37.075157 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 18:07:37.076264 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 18:07:37.078170 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 18:07:37.079373 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 18:07:37.082368 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 18:07:37.084145 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 18:07:37.085448 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 18:07:37.087062 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 18:07:37.091626 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 18:07:37.099337 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 18:07:37.101021 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 18:07:37.104337 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 18:07:37.108468 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 18:07:37.112645 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 18:07:37.114023 (MainThread): Parsing macros/sql/star.sql
2021-10-02 18:07:37.118161 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 18:07:37.126652 (MainThread): Parsing macros/sql/union.sql
2021-10-02 18:07:37.137581 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 18:07:37.138792 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 18:07:37.142126 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 18:07:37.143454 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 18:07:37.145387 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 18:07:37.149223 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 18:07:37.154414 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 18:07:37.157805 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 18:07:37.420507 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 18:07:37.421274 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7cac9e5-9d86-431b-b163-32e7de4efa4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f80516d0>]}
2021-10-02 18:07:37.640592 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 18:07:37.658804 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 18:07:37.669835 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 18:07:37.678961 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 18:07:37.689576 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 18:07:37.698607 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 18:07:37.733259 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 18:07:37.742369 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 18:07:37.922411 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 18:07:37.930386 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7cac9e5-9d86-431b-b163-32e7de4efa4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f81c5040>]}
2021-10-02 18:07:37.946534 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7cac9e5-9d86-431b-b163-32e7de4efa4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f80f4430>]}
2021-10-02 18:07:37.947767 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 18:07:37.954701 (MainThread): 
2021-10-02 18:07:37.955287 (MainThread): Acquiring new postgres connection "master".
2021-10-02 18:07:37.957822 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 18:07:38.021433 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:07:38.021682 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 18:07:38.021843 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 18:07:39.775403 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.75 seconds
2021-10-02 18:07:39.776228 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:07:39.776416 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 18:07:39.793171 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 18:07:39.795004 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 18:07:39.797213 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 18:07:39.797913 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 18:07:39.801250 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:07:39.801506 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 18:07:39.801680 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:07:41.209454 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.41 seconds
2021-10-02 18:07:41.209703 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:07:41.209862 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 18:07:41.224636 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 18:07:41.226079 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 18:07:41.228062 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 18:07:41.228640 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:07:41.230667 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:07:41.230868 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 18:07:41.231024 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:07:42.934672 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.70 seconds
2021-10-02 18:07:42.934920 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:07:42.935072 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 18:07:42.949866 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-02 18:07:42.951777 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 18:07:42.954207 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 18:07:42.961467 (MainThread): Using postgres connection "master".
2021-10-02 18:07:42.961721 (MainThread): On master: BEGIN
2021-10-02 18:07:42.961879 (MainThread): Opening a new connection, currently in state init
2021-10-02 18:07:44.570197 (MainThread): SQL status: BEGIN in 1.61 seconds
2021-10-02 18:07:44.570431 (MainThread): Using postgres connection "master".
2021-10-02 18:07:44.570576 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 18:07:44.658028 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-02 18:07:44.659816 (MainThread): On master: ROLLBACK
2021-10-02 18:07:44.662150 (MainThread): On master: Close
2021-10-02 18:07:44.662704 (MainThread): 23:37:44 | Concurrency: 1 threads (target='dev')
2021-10-02 18:07:44.662930 (MainThread): 23:37:44 | 
2021-10-02 18:07:44.666581 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:07:44.666932 (Thread-1): 23:37:44 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 18:07:44.667479 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:07:44.667777 (Thread-1): finished collecting timing info
2021-10-02 18:07:44.668338 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:07:44.668531 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:07:44.668818 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 18:07:44.669274 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:07:46.079413 (Thread-1): SQL status: BEGIN in 1.41 seconds
2021-10-02 18:07:46.079672 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:07:46.079827 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:07:46.079967 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:07:46.081489 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:07:46.090170 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:07:46.090414 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 18:07:46.094258 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:07:46.095617 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 18:07:46.096058 (Thread-1): finished collecting timing info
2021-10-02 18:07:46.096457 (Thread-1): 23:37:46 | 1 of 2 ERROR STALE freshness of freshness_test.customers_freshness... [ERROR STALE in 1.43s]
2021-10-02 18:07:46.096696 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:07:46.096922 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:07:46.097282 (Thread-1): 23:37:46 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 18:07:46.097669 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:07:46.097873 (Thread-1): finished collecting timing info
2021-10-02 18:07:46.098278 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:07:46.098461 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:07:46.098605 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 18:07:46.098746 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:07:47.756080 (Thread-1): SQL status: BEGIN in 1.66 seconds
2021-10-02 18:07:47.756348 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:07:47.756544 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:07:47.756706 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:07:47.759001 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:07:47.760977 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:07:47.761184 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where EXTRACT(minute from (current_timestamp- created_ts) ) < 5
    
  
2021-10-02 18:07:47.765505 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:07:47.766840 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 18:07:47.767299 (Thread-1): finished collecting timing info
2021-10-02 18:07:47.767681 (Thread-1): 23:37:47 | 2 of 2 ERROR STALE freshness of freshness_test.orders_freshness...... [ERROR STALE in 1.67s]
2021-10-02 18:07:47.767890 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:07:47.769219 (MainThread): Connection 'master' was properly closed.
2021-10-02 18:07:47.769404 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 18:07:47.779039 (MainThread): 
2021-10-02 18:07:47.779292 (MainThread): 
2021-10-02 18:07:47.779478 (MainThread): 23:37:47 | Done.
2021-10-02 18:07:47.779728 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7fb2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f81706d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f8170e20>]}
2021-10-02 18:07:47.780011 (MainThread): Flushing usage events
2021-10-02 18:09:03.424087 (MainThread): Running with dbt=0.21.0-b1
2021-10-02 18:09:03.551545 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='source-freshness', write_json=True)
2021-10-02 18:09:03.553896 (MainThread): Tracking: tracking
2021-10-02 18:09:03.579515 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34791c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34791c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34791c550>]}
2021-10-02 18:09:03.607820 (MainThread): Partial parsing not enabled
2021-10-02 18:09:03.686501 (MainThread): Parsing macros/test_empty.sql
2021-10-02 18:09:03.687625 (MainThread): Parsing macros/audits.sql
2021-10-02 18:09:03.688394 (MainThread): Parsing macros/test_country.sql
2021-10-02 18:09:03.689147 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-02 18:09:03.690321 (MainThread): Parsing macros/catalog.sql
2021-10-02 18:09:03.694530 (MainThread): Parsing macros/relations.sql
2021-10-02 18:09:03.696210 (MainThread): Parsing macros/adapters.sql
2021-10-02 18:09:03.727300 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-02 18:09:03.729504 (MainThread): Parsing macros/core.sql
2021-10-02 18:09:03.734793 (MainThread): Parsing macros/materializations/test.sql
2021-10-02 18:09:03.743746 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-02 18:09:03.756820 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-02 18:09:03.759023 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-02 18:09:03.780739 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-02 18:09:03.825682 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-02 18:09:03.853705 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-02 18:09:03.856117 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-02 18:09:03.870112 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-02 18:09:03.896555 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-02 18:09:03.915168 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-02 18:09:03.926332 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-02 18:09:03.936774 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-02 18:09:03.942098 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-02 18:09:03.943280 (MainThread): Parsing macros/etc/query.sql
2021-10-02 18:09:03.944461 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-02 18:09:03.946412 (MainThread): Parsing macros/etc/datetime.sql
2021-10-02 18:09:03.958228 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-02 18:09:03.960583 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-02 18:09:03.962467 (MainThread): Parsing macros/adapters/common.sql
2021-10-02 18:09:04.035770 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-02 18:09:04.038176 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-02 18:09:04.039718 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-02 18:09:04.041496 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-02 18:09:04.044264 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-02 18:09:04.045691 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-02 18:09:04.047507 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-02 18:09:04.050271 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-02 18:09:04.058651 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-02 18:09:04.060130 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-02 18:09:04.061793 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-02 18:09:04.064747 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-02 18:09:04.066192 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-02 18:09:04.069257 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-02 18:09:04.082294 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-02 18:09:04.085176 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-02 18:09:04.087897 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-02 18:09:04.090187 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-02 18:09:04.092313 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-02 18:09:04.093533 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-02 18:09:04.097670 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-02 18:09:04.105140 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-02 18:09:04.106211 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-02 18:09:04.109931 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-02 18:09:04.112409 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-02 18:09:04.114471 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-02 18:09:04.117252 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-02 18:09:04.150062 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-02 18:09:04.151289 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-02 18:09:04.152381 (MainThread): Parsing macros/logger/log_info.sql
2021-10-02 18:09:04.153439 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-02 18:09:04.158305 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-02 18:09:04.159941 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-02 18:09:04.162562 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-02 18:09:04.163844 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-02 18:09:04.165331 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-02 18:09:04.167740 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-02 18:09:04.171377 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-02 18:09:04.173708 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-02 18:09:04.176025 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-02 18:09:04.178183 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-02 18:09:04.179473 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-02 18:09:04.183221 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-02 18:09:04.185667 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-02 18:09:04.187507 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-02 18:09:04.189406 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-02 18:09:04.193985 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-02 18:09:04.201775 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-02 18:09:04.203353 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-02 18:09:04.206458 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-02 18:09:04.210748 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-02 18:09:04.214099 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-02 18:09:04.215433 (MainThread): Parsing macros/sql/star.sql
2021-10-02 18:09:04.219147 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-02 18:09:04.227771 (MainThread): Parsing macros/sql/union.sql
2021-10-02 18:09:04.238319 (MainThread): Parsing macros/sql/groupby.sql
2021-10-02 18:09:04.239568 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-02 18:09:04.243203 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-02 18:09:04.244532 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-02 18:09:04.245963 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-02 18:09:04.249383 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-02 18:09:04.255034 (MainThread): Parsing macros/sql/pivot.sql
2021-10-02 18:09:04.258957 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-02 18:09:04.489699 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-02 18:09:04.489984 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f041e780-d079-46a5-b5be-9d48fbb46239', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3479d83a0>]}
2021-10-02 18:09:04.654685 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-02 18:09:04.673919 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-02 18:09:04.686383 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-02 18:09:04.695201 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-02 18:09:04.705418 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-02 18:09:04.714024 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-02 18:09:04.745870 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-02 18:09:04.755273 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-02 18:09:04.885358 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-02 18:09:04.892883 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f041e780-d079-46a5-b5be-9d48fbb46239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff347aea550>]}
2021-10-02 18:09:04.904831 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f041e780-d079-46a5-b5be-9d48fbb46239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff347b17af0>]}
2021-10-02 18:09:04.905366 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-02 18:09:04.907406 (MainThread): 
2021-10-02 18:09:04.908100 (MainThread): Acquiring new postgres connection "master".
2021-10-02 18:09:04.910383 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-02 18:09:04.970891 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:09:04.971141 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-02 18:09:04.971307 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-02 18:09:06.510764 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.54 seconds
2021-10-02 18:09:06.511404 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-02 18:09:06.511712 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-02 18:09:06.526979 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-02 18:09:06.528659 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-02 18:09:06.530559 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-02 18:09:06.531297 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:09:06.533741 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:09:06.533991 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-02 18:09:06.534164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:09:07.843454 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.31 seconds
2021-10-02 18:09:07.843722 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-02 18:09:07.843886 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-02 18:09:07.859478 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-02 18:09:07.861018 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-02 18:09:07.863384 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-02 18:09:07.864157 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-02 18:09:07.866484 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:09:07.866725 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-02 18:09:07.866883 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-02 18:09:09.275149 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.41 seconds
2021-10-02 18:09:09.275456 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-02 18:09:09.275615 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-02 18:09:09.289688 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-02 18:09:09.291040 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-02 18:09:09.292995 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-02 18:09:09.299809 (MainThread): Using postgres connection "master".
2021-10-02 18:09:09.300055 (MainThread): On master: BEGIN
2021-10-02 18:09:09.300212 (MainThread): Opening a new connection, currently in state init
2021-10-02 18:09:10.659835 (MainThread): SQL status: BEGIN in 1.36 seconds
2021-10-02 18:09:10.660484 (MainThread): Using postgres connection "master".
2021-10-02 18:09:10.660668 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-02 18:09:10.753274 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-02 18:09:10.754885 (MainThread): On master: ROLLBACK
2021-10-02 18:09:10.756692 (MainThread): On master: Close
2021-10-02 18:09:10.757228 (MainThread): 23:39:10 | Concurrency: 1 threads (target='dev')
2021-10-02 18:09:10.757457 (MainThread): 23:39:10 | 
2021-10-02 18:09:10.761041 (Thread-1): Began running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:09:10.761345 (Thread-1): 23:39:10 | 1 of 2 START freshness of freshness_test.customers_freshness......... [RUN]
2021-10-02 18:09:10.762104 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:09:10.762409 (Thread-1): finished collecting timing info
2021-10-02 18:09:10.763052 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:09:10.763388 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:09:10.763653 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: BEGIN
2021-10-02 18:09:10.763855 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:09:12.481489 (Thread-1): SQL status: BEGIN in 1.72 seconds
2021-10-02 18:09:12.481958 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:09:12.482186 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:09:12.482467 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: COMMIT
2021-10-02 18:09:12.485021 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:09:12.501504 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.customers_freshness".
2021-10-02 18:09:12.501778 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.customers_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."customers_freshness"
    
  
2021-10-02 18:09:12.507328 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-02 18:09:12.509023 (Thread-1): On source.dbt_demo_project.freshness_test.customers_freshness: Close
2021-10-02 18:09:12.509646 (Thread-1): finished collecting timing info
2021-10-02 18:09:12.510129 (Thread-1): 23:39:12 | 1 of 2 WARN freshness of freshness_test.customers_freshness.......... [WARN in 1.75s]
2021-10-02 18:09:12.510378 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.customers_freshness
2021-10-02 18:09:12.510699 (Thread-1): Began running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:09:12.511180 (Thread-1): 23:39:12 | 2 of 2 START freshness of freshness_test.orders_freshness............ [RUN]
2021-10-02 18:09:12.511893 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:09:12.512117 (Thread-1): finished collecting timing info
2021-10-02 18:09:12.512753 (Thread-1): Acquiring new postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:09:12.513093 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:09:12.513458 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: BEGIN
2021-10-02 18:09:12.513815 (Thread-1): Opening a new connection, currently in state closed
2021-10-02 18:09:14.016676 (Thread-1): SQL status: BEGIN in 1.50 seconds
2021-10-02 18:09:14.016948 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:09:14.017104 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:09:14.017247 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: COMMIT
2021-10-02 18:09:14.019410 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-02 18:09:14.021552 (Thread-1): Using postgres connection "source.dbt_demo_project.freshness_test.orders_freshness".
2021-10-02 18:09:14.021747 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "source.dbt_demo_project.freshness_test.orders_freshness"} */
select
      max(created_ts) as max_loaded_at,
      now() as snapshotted_at
    from "postgres"."public"."orders_freshness"
    
    where EXTRACT(minute from (current_timestamp- created_ts) ) < 5
    
  
2021-10-02 18:09:14.026221 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-02 18:09:14.027660 (Thread-1): On source.dbt_demo_project.freshness_test.orders_freshness: Close
2021-10-02 18:09:14.028052 (Thread-1): finished collecting timing info
2021-10-02 18:09:14.028400 (Thread-1): 23:39:14 | 2 of 2 ERROR STALE freshness of freshness_test.orders_freshness...... [ERROR STALE in 1.52s]
2021-10-02 18:09:14.028608 (Thread-1): Finished running node source.dbt_demo_project.freshness_test.orders_freshness
2021-10-02 18:09:14.030202 (MainThread): Connection 'master' was properly closed.
2021-10-02 18:09:14.030399 (MainThread): Connection 'source.dbt_demo_project.freshness_test.orders_freshness' was properly closed.
2021-10-02 18:09:14.040897 (MainThread): 
2021-10-02 18:09:14.041233 (MainThread): 23:39:14 | Done.
2021-10-02 18:09:14.041837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3478d9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff347b2d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff347b2dca0>]}
2021-10-02 18:09:14.042459 (MainThread): Flushing usage events
2021-10-03 06:11:45.752106 (MainThread): Running with dbt=0.21.0-b1
2021-10-03 06:11:45.855485 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-03 06:11:45.857274 (MainThread): Tracking: tracking
2021-10-03 06:11:46.053282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23781f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237819a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23769c610>]}
2021-10-03 06:11:46.076669 (MainThread): Partial parsing not enabled
2021-10-03 06:11:46.142709 (MainThread): Parsing macros/test_empty.sql
2021-10-03 06:11:46.143611 (MainThread): Parsing macros/audits.sql
2021-10-03 06:11:46.144185 (MainThread): Parsing macros/test_country.sql
2021-10-03 06:11:46.144830 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-03 06:11:46.145908 (MainThread): Parsing macros/catalog.sql
2021-10-03 06:11:46.149916 (MainThread): Parsing macros/relations.sql
2021-10-03 06:11:46.151497 (MainThread): Parsing macros/adapters.sql
2021-10-03 06:11:46.178333 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-03 06:11:46.180312 (MainThread): Parsing macros/core.sql
2021-10-03 06:11:46.184552 (MainThread): Parsing macros/materializations/test.sql
2021-10-03 06:11:46.192264 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-03 06:11:46.204333 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-03 06:11:46.206517 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-03 06:11:46.228862 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-03 06:11:46.267787 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-03 06:11:46.287734 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-03 06:11:46.289468 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-03 06:11:46.299455 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-03 06:11:46.319789 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-03 06:11:46.333730 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-03 06:11:46.341583 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-03 06:11:46.348565 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-03 06:11:46.352149 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-03 06:11:46.353312 (MainThread): Parsing macros/etc/query.sql
2021-10-03 06:11:46.354409 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-03 06:11:46.355802 (MainThread): Parsing macros/etc/datetime.sql
2021-10-03 06:11:46.363734 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-03 06:11:46.365517 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-03 06:11:46.366925 (MainThread): Parsing macros/adapters/common.sql
2021-10-03 06:11:46.420527 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-03 06:11:46.422323 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-03 06:11:46.423424 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-03 06:11:46.424660 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-03 06:11:46.426596 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-03 06:11:46.427615 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-03 06:11:46.428974 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-03 06:11:46.430989 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-03 06:11:46.436924 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-03 06:11:46.438136 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-03 06:11:46.439361 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-03 06:11:46.441796 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-03 06:11:46.442810 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-03 06:11:46.445017 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-03 06:11:46.454642 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-03 06:11:46.456438 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-03 06:11:46.457756 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-03 06:11:46.459288 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-03 06:11:46.460735 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-03 06:11:46.461613 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-03 06:11:46.464690 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-03 06:11:46.469788 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-03 06:11:46.470537 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-03 06:11:46.473201 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-03 06:11:46.475418 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-03 06:11:46.476883 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-03 06:11:46.478756 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-03 06:11:46.501562 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-03 06:11:46.502292 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-03 06:11:46.503026 (MainThread): Parsing macros/logger/log_info.sql
2021-10-03 06:11:46.503687 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-03 06:11:46.506720 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-03 06:11:46.507926 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-03 06:11:46.509850 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-03 06:11:46.510813 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-03 06:11:46.511614 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-03 06:11:46.512761 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-03 06:11:46.514555 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-03 06:11:46.515610 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-03 06:11:46.516475 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-03 06:11:46.517871 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-03 06:11:46.518733 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-03 06:11:46.521027 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-03 06:11:46.522309 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-03 06:11:46.523227 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-03 06:11:46.524439 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-03 06:11:46.527667 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-03 06:11:46.533271 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-03 06:11:46.534517 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-03 06:11:46.536778 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-03 06:11:46.539845 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-03 06:11:46.542167 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-03 06:11:46.543019 (MainThread): Parsing macros/sql/star.sql
2021-10-03 06:11:46.545516 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-03 06:11:46.551032 (MainThread): Parsing macros/sql/union.sql
2021-10-03 06:11:46.558489 (MainThread): Parsing macros/sql/groupby.sql
2021-10-03 06:11:46.559274 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-03 06:11:46.561743 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-03 06:11:46.562626 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-03 06:11:46.563740 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-03 06:11:46.566339 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-03 06:11:46.569896 (MainThread): Parsing macros/sql/pivot.sql
2021-10-03 06:11:46.572653 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-03 06:11:46.740494 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-03 06:11:46.740740 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2378cfb80>]}
2021-10-03 06:11:46.880012 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:11:46.897430 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:11:46.905725 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:11:46.914531 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:11:46.923441 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:11:46.931900 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-03 06:11:46.939650 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-03 06:11:46.971370 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-03 06:11:46.979392 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-03 06:11:47.109648 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-03 06:11:47.116245 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237a8ad00>]}
2021-10-03 06:11:47.171243 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd236d72250>]}
2021-10-03 06:11:47.171753 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-03 06:11:47.174489 (MainThread): 
2021-10-03 06:11:47.175142 (MainThread): Acquiring new postgres connection "master".
2021-10-03 06:11:47.176628 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-03 06:11:47.187853 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-03 06:11:47.188112 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-03 06:11:47.188307 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-03 06:11:51.804606 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 4.62 seconds
2021-10-03 06:11:51.806016 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-03 06:11:51.808193 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-03 06:11:51.815716 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-03 06:11:51.815970 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-03 06:11:51.816131 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-03 06:11:53.349867 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.53 seconds
2021-10-03 06:11:53.350115 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-03 06:11:53.350265 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-03 06:11:53.374780 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-03 06:11:53.376185 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-03 06:11:53.377934 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-03 06:11:53.378451 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-03 06:11:53.380357 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-03 06:11:53.380544 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-03 06:11:53.380689 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-03 06:11:55.269753 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.89 seconds
2021-10-03 06:11:55.269987 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-03 06:11:55.270169 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-03 06:11:55.284164 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-03 06:11:55.285427 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-03 06:11:55.287371 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-03 06:11:55.287898 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:11:55.289813 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:11:55.289986 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-03 06:11:55.290128 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-03 06:11:56.820630 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.53 seconds
2021-10-03 06:11:56.820904 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:11:56.821091 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-03 06:11:56.834451 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-03 06:11:56.835638 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-03 06:11:56.837115 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-03 06:11:56.843983 (MainThread): Using postgres connection "master".
2021-10-03 06:11:56.844207 (MainThread): On master: BEGIN
2021-10-03 06:11:56.844363 (MainThread): Opening a new connection, currently in state init
2021-10-03 06:11:58.244835 (MainThread): SQL status: BEGIN in 1.40 seconds
2021-10-03 06:11:58.245074 (MainThread): Using postgres connection "master".
2021-10-03 06:11:58.245223 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-03 06:11:58.337481 (MainThread): SQL status: SELECT 7 in 0.09 seconds
2021-10-03 06:11:58.338700 (MainThread): On master: ROLLBACK
2021-10-03 06:11:58.340102 (MainThread): Using postgres connection "master".
2021-10-03 06:11:58.340257 (MainThread): On master: BEGIN
2021-10-03 06:11:58.342756 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-03 06:11:58.342934 (MainThread): On master: COMMIT
2021-10-03 06:11:58.343059 (MainThread): Using postgres connection "master".
2021-10-03 06:11:58.343167 (MainThread): On master: COMMIT
2021-10-03 06:11:58.344303 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:11:58.344464 (MainThread): 11:41:58 | 
2021-10-03 06:11:58.344627 (MainThread): 11:41:58 | Running 1 on-run-start hook
2021-10-03 06:11:58.344766 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-03 06:11:58.346683 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-03 06:11:58.348974 (MainThread): 11:41:58 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-03 06:11:58.349166 (MainThread): Using postgres connection "master".
2021-10-03 06:11:58.349285 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_STARTED');
    commit;


2021-10-03 06:11:58.403552 (MainThread): SQL status: COMMIT in 0.05 seconds
2021-10-03 06:11:58.404512 (MainThread): 11:41:58 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.06s]
2021-10-03 06:11:58.404763 (MainThread): 11:41:58 | 
2021-10-03 06:11:58.404964 (MainThread): On master: Close
2021-10-03 06:11:58.405370 (MainThread): 11:41:58 | Concurrency: 1 threads (target='dev')
2021-10-03 06:11:58.405645 (MainThread): 11:41:58 | 
2021-10-03 06:11:58.410345 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-03 06:11:58.411175 (Thread-1): 11:41:58 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-03 06:11:58.412050 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:11:58.412453 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-03 06:11:58.415364 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-03 06:11:58.416393 (Thread-1): finished collecting timing info
2021-10-03 06:11:58.443210 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:11:58.443498 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-03 06:11:58.443674 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:12:00.000976 (Thread-1): SQL status: BEGIN in 1.56 seconds
2021-10-03 06:12:00.001223 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.001373 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:12:00.008378 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:12:00.014621 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-03 06:12:00.015400 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.015591 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-03 06:12:00.064182 (Thread-1): SQL status: SELECT 44 in 0.05 seconds
2021-10-03 06:12:00.070322 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.070530 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-03 06:12:00.074847 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:12:00.077341 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.077522 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-03 06:12:00.080591 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:12:00.086893 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.087105 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:12:00.090344 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:00.096832 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-03 06:12:00.097030 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.097169 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-03 06:12:00.098781 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:00.103932 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:12:00.104142 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-03 06:12:00.131529 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-03 06:12:00.132754 (Thread-1): finished collecting timing info
2021-10-03 06:12:00.132956 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-03 06:12:00.133354 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2378e8220>]}
2021-10-03 06:12:00.133707 (Thread-1): 11:42:00 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.72s]
2021-10-03 06:12:00.133931 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-03 06:12:00.134163 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-10-03 06:12:00.134625 (Thread-1): 11:42:00 | 2 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-10-03 06:12:00.134945 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:00.135112 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-10-03 06:12:00.137568 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-10-03 06:12:00.138555 (Thread-1): finished collecting timing info
2021-10-03 06:12:00.142753 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:00.143002 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-10-03 06:12:00.143156 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:12:01.940399 (Thread-1): SQL status: BEGIN in 1.80 seconds
2021-10-03 06:12:01.940660 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:01.940824 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:12:01.947462 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:12:01.948877 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-10-03 06:12:01.949516 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:01.949680 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '16b73cb7-0ea5-4933-bc17-d8e4c26f3666' as invocation_id
  );
2021-10-03 06:12:01.982432 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-10-03 06:12:01.984914 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:01.985099 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-10-03 06:12:01.988588 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:12:01.990709 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:01.990898 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:12:01.993896 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:01.994928 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-10-03 06:12:01.995088 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:01.995220 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-10-03 06:12:01.996811 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:01.998493 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:12:01.998648 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-10-03 06:12:02.000513 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-03 06:12:02.001572 (Thread-1): finished collecting timing info
2021-10-03 06:12:02.001764 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-10-03 06:12:02.002159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237afa820>]}
2021-10-03 06:12:02.002582 (Thread-1): 11:42:02 | 2 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.87s]
2021-10-03 06:12:02.002781 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-10-03 06:12:02.002972 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:12:02.003334 (Thread-1): 11:42:02 | 3 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-03 06:12:02.003717 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:02.003891 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:12:02.007827 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-03 06:12:02.008540 (Thread-1): finished collecting timing info
2021-10-03 06:12:02.026275 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:02.026508 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-03 06:12:02.026656 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:12:03.688053 (Thread-1): SQL status: BEGIN in 1.66 seconds
2021-10-03 06:12:03.688315 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.688472 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:12:03.695229 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:12:03.700941 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-03 06:12:03.702321 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.702580 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-03 06:12:03.733553 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-03 06:12:03.736203 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.736405 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-03 06:12:03.743217 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-10-03 06:12:03.745587 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.745761 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-03 06:12:03.749095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:12:03.751357 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.751558 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:12:03.754670 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:03.755507 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-03 06:12:03.755677 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.755819 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-03 06:12:03.757691 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:03.759527 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:12:03.759693 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-03 06:12:03.766250 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-03 06:12:03.767447 (Thread-1): finished collecting timing info
2021-10-03 06:12:03.767645 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-03 06:12:03.768045 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237ad9bb0>]}
2021-10-03 06:12:03.768406 (Thread-1): 11:42:03 | 3 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.76s]
2021-10-03 06:12:03.768633 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:12:03.769402 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:12:03.769725 (Thread-1): 11:42:03 | 4 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-03 06:12:03.770060 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:03.770224 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:12:03.775475 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-03 06:12:03.777124 (Thread-1): finished collecting timing info
2021-10-03 06:12:03.780670 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:03.780917 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-03 06:12:03.781124 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:12:05.537878 (Thread-1): SQL status: BEGIN in 1.76 seconds
2021-10-03 06:12:05.538132 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:05.538335 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:12:05.543727 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:12:05.544724 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-03 06:12:05.545563 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:05.545747 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-03 06:12:05.559447 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-03 06:12:05.561823 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:05.562001 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-03 06:12:05.565184 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:12:05.567081 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:05.567234 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:12:05.569501 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:05.570152 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-03 06:12:05.570277 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:05.570385 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-03 06:12:05.571684 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:05.573361 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:12:05.573516 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-03 06:12:05.575118 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-03 06:12:05.576239 (Thread-1): finished collecting timing info
2021-10-03 06:12:05.576463 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-03 06:12:05.576830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237aa3f10>]}
2021-10-03 06:12:05.577159 (Thread-1): 11:42:05 | 4 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.81s]
2021-10-03 06:12:05.577381 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:12:05.577649 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:12:05.577937 (Thread-1): 11:42:05 | 5 of 5 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-03 06:12:05.578215 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:05.578353 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:12:05.581890 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-03 06:12:05.582877 (Thread-1): finished collecting timing info
2021-10-03 06:12:05.586332 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:05.586538 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-03 06:12:05.586672 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:12:07.529726 (Thread-1): SQL status: BEGIN in 1.94 seconds
2021-10-03 06:12:07.529924 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:07.530043 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:12:07.534382 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:07.535302 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-03 06:12:07.535857 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:07.536054 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-03 06:12:07.547049 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-03 06:12:07.550617 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:07.550804 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-03 06:12:07.553759 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:12:07.555940 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:07.556108 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:12:07.559928 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:07.560771 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-03 06:12:07.560927 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:07.561057 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-03 06:12:07.562931 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:07.564651 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:12:07.564808 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-03 06:12:07.566197 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-03 06:12:07.567259 (Thread-1): finished collecting timing info
2021-10-03 06:12:07.567454 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-03 06:12:07.567835 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b73cb7-0ea5-4933-bc17-d8e4c26f3666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237b9d3d0>]}
2021-10-03 06:12:07.568189 (Thread-1): 11:42:07 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.99s]
2021-10-03 06:12:07.568377 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:12:07.569357 (MainThread): Acquiring new postgres connection "master".
2021-10-03 06:12:07.569565 (MainThread): Using postgres connection "master".
2021-10-03 06:12:07.569706 (MainThread): On master: BEGIN
2021-10-03 06:12:07.569842 (MainThread): Opening a new connection, currently in state closed
2021-10-03 06:12:09.350281 (MainThread): SQL status: BEGIN in 1.78 seconds
2021-10-03 06:12:09.350547 (MainThread): On master: COMMIT
2021-10-03 06:12:09.350694 (MainThread): Using postgres connection "master".
2021-10-03 06:12:09.350825 (MainThread): On master: COMMIT
2021-10-03 06:12:09.352513 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:12:09.352730 (MainThread): 11:42:09 | 
2021-10-03 06:12:09.352916 (MainThread): 11:42:09 | Running 1 on-run-end hook
2021-10-03 06:12:09.353098 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-03 06:12:09.355438 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-03 06:12:09.356888 (MainThread): 11:42:09 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-03 06:12:09.357120 (MainThread): Using postgres connection "master".
2021-10-03 06:12:09.357267 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_ENDED');
    commit;


2021-10-03 06:12:09.364395 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:12:09.365244 (MainThread): 11:42:09 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-10-03 06:12:09.365467 (MainThread): 11:42:09 | 
2021-10-03 06:12:09.365657 (MainThread): On master: Close
2021-10-03 06:12:09.366088 (MainThread): 11:42:09 | 
2021-10-03 06:12:09.366283 (MainThread): 11:42:09 | Finished running 2 table models, 3 view models, 2 hooks in 22.19s.
2021-10-03 06:12:09.366498 (MainThread): Connection 'master' was properly closed.
2021-10-03 06:12:09.366643 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-03 06:12:09.378877 (MainThread): 
2021-10-03 06:12:09.379133 (MainThread): Completed successfully
2021-10-03 06:12:09.379464 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-03 06:12:09.379800 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23769c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2376b7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd237a49d90>]}
2021-10-03 06:12:09.380166 (MainThread): Flushing usage events
2021-10-03 06:13:04.562786 (MainThread): Running with dbt=0.21.0-b1
2021-10-03 06:13:04.665485 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-10-03 06:13:04.668430 (MainThread): Tracking: tracking
2021-10-03 06:13:04.686815 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb956d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb956af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb956970>]}
2021-10-03 06:13:04.714323 (MainThread): Partial parsing not enabled
2021-10-03 06:13:04.763166 (MainThread): Parsing macros/test_empty.sql
2021-10-03 06:13:04.764173 (MainThread): Parsing macros/audits.sql
2021-10-03 06:13:04.764825 (MainThread): Parsing macros/test_country.sql
2021-10-03 06:13:04.765626 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-03 06:13:04.766950 (MainThread): Parsing macros/catalog.sql
2021-10-03 06:13:04.770920 (MainThread): Parsing macros/relations.sql
2021-10-03 06:13:04.772903 (MainThread): Parsing macros/adapters.sql
2021-10-03 06:13:04.802645 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-03 06:13:04.805320 (MainThread): Parsing macros/core.sql
2021-10-03 06:13:04.810635 (MainThread): Parsing macros/materializations/test.sql
2021-10-03 06:13:04.819686 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-03 06:13:04.832117 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-03 06:13:04.834196 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-03 06:13:04.854556 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-03 06:13:04.894380 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-03 06:13:04.918773 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-03 06:13:04.920770 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-03 06:13:04.931746 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-03 06:13:04.951514 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-03 06:13:04.965155 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-03 06:13:04.972805 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-03 06:13:04.980564 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-03 06:13:04.984158 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-03 06:13:04.984962 (MainThread): Parsing macros/etc/query.sql
2021-10-03 06:13:04.985834 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-03 06:13:04.987215 (MainThread): Parsing macros/etc/datetime.sql
2021-10-03 06:13:04.995465 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-03 06:13:04.997154 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-03 06:13:04.998562 (MainThread): Parsing macros/adapters/common.sql
2021-10-03 06:13:05.054300 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-03 06:13:05.056072 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-03 06:13:05.057145 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-03 06:13:05.058436 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-03 06:13:05.060498 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-03 06:13:05.061496 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-03 06:13:05.063090 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-03 06:13:05.065309 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-03 06:13:05.071039 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-03 06:13:05.072097 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-03 06:13:05.073322 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-03 06:13:05.075609 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-03 06:13:05.076762 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-03 06:13:05.078903 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-03 06:13:05.088171 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-03 06:13:05.089908 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-03 06:13:05.091277 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-03 06:13:05.092941 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-03 06:13:05.094399 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-03 06:13:05.095331 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-03 06:13:05.098493 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-03 06:13:05.104055 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-03 06:13:05.104906 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-03 06:13:05.107492 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-03 06:13:05.109212 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-03 06:13:05.110616 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-03 06:13:05.112808 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-03 06:13:05.137100 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-03 06:13:05.138002 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-03 06:13:05.138701 (MainThread): Parsing macros/logger/log_info.sql
2021-10-03 06:13:05.139318 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-03 06:13:05.142461 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-03 06:13:05.143664 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-03 06:13:05.145547 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-03 06:13:05.146491 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-03 06:13:05.147274 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-03 06:13:05.148429 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-03 06:13:05.150292 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-03 06:13:05.151399 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-03 06:13:05.152253 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-03 06:13:05.153648 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-03 06:13:05.154513 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-03 06:13:05.156732 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-03 06:13:05.158022 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-03 06:13:05.158951 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-03 06:13:05.160145 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-03 06:13:05.163362 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-03 06:13:05.168936 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-03 06:13:05.170001 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-03 06:13:05.172340 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-03 06:13:05.175362 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-03 06:13:05.177704 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-03 06:13:05.178594 (MainThread): Parsing macros/sql/star.sql
2021-10-03 06:13:05.181097 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-03 06:13:05.186803 (MainThread): Parsing macros/sql/union.sql
2021-10-03 06:13:05.194560 (MainThread): Parsing macros/sql/groupby.sql
2021-10-03 06:13:05.195445 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-03 06:13:05.198706 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-03 06:13:05.199995 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-03 06:13:05.201062 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-03 06:13:05.204145 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-03 06:13:05.208690 (MainThread): Parsing macros/sql/pivot.sql
2021-10-03 06:13:05.212156 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-03 06:13:05.396065 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-03 06:13:05.396385 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fba182b0>]}
2021-10-03 06:13:05.527277 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:05.543997 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:05.550949 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:05.558504 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:05.566092 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:05.573857 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-03 06:13:05.581616 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-03 06:13:05.615353 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-03 06:13:05.624450 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-03 06:13:05.749391 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-03 06:13:05.756219 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fbacbcd0>]}
2021-10-03 06:13:05.808449 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fac874f0>]}
2021-10-03 06:13:05.808831 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-03 06:13:05.810690 (MainThread): 
2021-10-03 06:13:05.811185 (MainThread): Acquiring new postgres connection "master".
2021-10-03 06:13:05.812305 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-10-03 06:13:05.822954 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-10-03 06:13:05.823187 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-10-03 06:13:05.823343 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-03 06:13:07.875081 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 2.05 seconds
2021-10-03 06:13:07.876993 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-10-03 06:13:07.880029 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:13:07.887999 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:13:07.888236 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-03 06:13:07.888396 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-03 06:13:09.996501 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.11 seconds
2021-10-03 06:13:09.996749 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:13:09.996904 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-03 06:13:10.011399 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-10-03 06:13:10.012645 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-03 06:13:10.014490 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-10-03 06:13:10.015069 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-03 06:13:10.016791 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-03 06:13:10.016960 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-10-03 06:13:10.017108 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-03 06:13:11.498956 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.48 seconds
2021-10-03 06:13:11.499192 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-03 06:13:11.499338 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-03 06:13:11.516646 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-10-03 06:13:11.518609 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-03 06:13:11.520278 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-10-03 06:13:11.520879 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-10-03 06:13:11.523348 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-03 06:13:11.523566 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-10-03 06:13:11.523730 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-03 06:13:13.432055 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.91 seconds
2021-10-03 06:13:13.432305 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-10-03 06:13:13.432454 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-03 06:13:13.445158 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-10-03 06:13:13.446437 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-10-03 06:13:13.447926 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-10-03 06:13:13.454250 (MainThread): Using postgres connection "master".
2021-10-03 06:13:13.454461 (MainThread): On master: BEGIN
2021-10-03 06:13:13.454607 (MainThread): Opening a new connection, currently in state init
2021-10-03 06:13:15.448089 (MainThread): SQL status: BEGIN in 1.99 seconds
2021-10-03 06:13:15.448332 (MainThread): Using postgres connection "master".
2021-10-03 06:13:15.448486 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-03 06:13:15.515746 (MainThread): SQL status: SELECT 7 in 0.07 seconds
2021-10-03 06:13:15.516983 (MainThread): On master: ROLLBACK
2021-10-03 06:13:15.518945 (MainThread): Using postgres connection "master".
2021-10-03 06:13:15.519278 (MainThread): On master: BEGIN
2021-10-03 06:13:15.521832 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-03 06:13:15.522021 (MainThread): On master: COMMIT
2021-10-03 06:13:15.522147 (MainThread): Using postgres connection "master".
2021-10-03 06:13:15.522257 (MainThread): On master: COMMIT
2021-10-03 06:13:15.523522 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:15.523713 (MainThread): 11:43:15 | 
2021-10-03 06:13:15.523892 (MainThread): 11:43:15 | Running 1 on-run-start hook
2021-10-03 06:13:15.524108 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-03 06:13:15.526220 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-03 06:13:15.527650 (MainThread): 11:43:15 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-10-03 06:13:15.527884 (MainThread): Using postgres connection "master".
2021-10-03 06:13:15.528026 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_STARTED');
    commit;


2021-10-03 06:13:15.535238 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:15.536171 (MainThread): 11:43:15 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-10-03 06:13:15.536406 (MainThread): 11:43:15 | 
2021-10-03 06:13:15.536610 (MainThread): On master: Close
2021-10-03 06:13:15.537005 (MainThread): 11:43:15 | Concurrency: 1 threads (target='dev')
2021-10-03 06:13:15.537200 (MainThread): 11:43:15 | 
2021-10-03 06:13:15.539449 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-03 06:13:15.539817 (Thread-1): 11:43:15 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-10-03 06:13:15.540318 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:15.540538 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-03 06:13:15.544173 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-03 06:13:15.544844 (Thread-1): finished collecting timing info
2021-10-03 06:13:15.571993 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:15.572252 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-10-03 06:13:15.572419 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:13:17.372224 (Thread-1): SQL status: BEGIN in 1.80 seconds
2021-10-03 06:13:17.372483 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.372642 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:13:17.379437 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:17.385691 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-03 06:13:17.386509 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.386732 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-10-03 06:13:17.426513 (Thread-1): SQL status: SELECT 44 in 0.04 seconds
2021-10-03 06:13:17.434502 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.434724 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-10-03 06:13:17.438746 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:17.441515 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.441745 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-10-03 06:13:17.444992 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:17.451423 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.451642 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:13:17.455782 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:17.462361 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-03 06:13:17.462540 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.462677 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-10-03 06:13:17.464716 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:17.469593 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:13:17.469770 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-10-03 06:13:17.480714 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-03 06:13:17.481928 (Thread-1): finished collecting timing info
2021-10-03 06:13:17.482138 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-10-03 06:13:17.482538 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fbb6e610>]}
2021-10-03 06:13:17.482893 (Thread-1): 11:43:17 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.94s]
2021-10-03 06:13:17.483088 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-03 06:13:17.483277 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-10-03 06:13:17.483595 (Thread-1): 11:43:17 | 2 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-10-03 06:13:17.483903 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:17.484068 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-10-03 06:13:17.486444 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-10-03 06:13:17.487253 (Thread-1): finished collecting timing info
2021-10-03 06:13:17.491191 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:17.491434 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-10-03 06:13:17.491585 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:13:19.401683 (Thread-1): SQL status: BEGIN in 1.91 seconds
2021-10-03 06:13:19.401958 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.402204 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:13:19.410545 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:19.412112 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-10-03 06:13:19.412988 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.413201 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '4f1e6815-fe55-4867-8eae-888477b0a4b3' as invocation_id
  );
2021-10-03 06:13:19.450157 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-10-03 06:13:19.452676 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.452844 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-10-03 06:13:19.455670 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:19.458158 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.458339 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-10-03 06:13:19.461969 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:19.464023 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.464193 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:13:19.467295 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:19.468328 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-10-03 06:13:19.468487 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.468622 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-10-03 06:13:19.470279 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:19.471967 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:13:19.472121 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-10-03 06:13:19.490429 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-03 06:13:19.491543 (Thread-1): finished collecting timing info
2021-10-03 06:13:19.491729 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-10-03 06:13:19.492079 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fba2b4c0>]}
2021-10-03 06:13:19.492376 (Thread-1): 11:43:19 | 2 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 2.01s]
2021-10-03 06:13:19.492529 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-10-03 06:13:19.492683 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:13:19.492979 (Thread-1): 11:43:19 | 3 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-10-03 06:13:19.493252 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:19.493388 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:13:19.497836 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-03 06:13:19.498454 (Thread-1): finished collecting timing info
2021-10-03 06:13:19.514002 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:19.514221 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-10-03 06:13:19.514373 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:13:21.180560 (Thread-1): SQL status: BEGIN in 1.67 seconds
2021-10-03 06:13:21.180798 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.180944 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:13:21.186945 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:21.191534 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-03 06:13:21.192210 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.192382 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-10-03 06:13:21.214202 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-03 06:13:21.216856 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.217052 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-10-03 06:13:21.220728 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:21.223420 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.223624 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-10-03 06:13:21.227084 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:21.230273 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.230494 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:13:21.235352 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:21.236418 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-03 06:13:21.236648 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.236851 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-10-03 06:13:21.239140 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:21.241405 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:13:21.241600 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-10-03 06:13:21.248026 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-03 06:13:21.249484 (Thread-1): finished collecting timing info
2021-10-03 06:13:21.249762 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-10-03 06:13:21.250280 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb834d00>]}
2021-10-03 06:13:21.250739 (Thread-1): 11:43:21 | 3 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.76s]
2021-10-03 06:13:21.250951 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:13:21.251714 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:13:21.252081 (Thread-1): 11:43:21 | 4 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-10-03 06:13:21.252466 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:21.252672 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:13:21.258126 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-03 06:13:21.258928 (Thread-1): finished collecting timing info
2021-10-03 06:13:21.263996 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:21.264261 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-10-03 06:13:21.264425 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:13:23.179485 (Thread-1): SQL status: BEGIN in 1.92 seconds
2021-10-03 06:13:23.180094 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:23.180280 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:13:23.186327 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:23.187587 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-03 06:13:23.188213 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:23.188376 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-03 06:13:23.204886 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-03 06:13:23.207765 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:23.208131 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-10-03 06:13:23.211417 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:23.213716 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:23.213916 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:13:23.217709 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:23.218846 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-03 06:13:23.219175 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:23.219331 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-10-03 06:13:23.221444 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:23.223388 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:13:23.223585 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-10-03 06:13:23.225928 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-03 06:13:23.227218 (Thread-1): finished collecting timing info
2021-10-03 06:13:23.227450 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-10-03 06:13:23.228000 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fbbf4220>]}
2021-10-03 06:13:23.228479 (Thread-1): 11:43:23 | 4 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.98s]
2021-10-03 06:13:23.228705 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:13:23.229093 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:13:23.229662 (Thread-1): 11:43:23 | 5 of 5 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-10-03 06:13:23.230460 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:23.230771 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:13:23.237544 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-03 06:13:23.238233 (Thread-1): finished collecting timing info
2021-10-03 06:13:23.244884 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:23.245134 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-10-03 06:13:23.245305 (Thread-1): Opening a new connection, currently in state closed
2021-10-03 06:13:25.283886 (Thread-1): SQL status: BEGIN in 2.04 seconds
2021-10-03 06:13:25.284163 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:25.284328 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_STARTED');
    commit;
      
2021-10-03 06:13:25.290313 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:25.291521 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-03 06:13:25.292213 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:25.292390 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-10-03 06:13:25.305923 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-03 06:13:25.308359 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:25.308527 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-10-03 06:13:25.311537 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-03 06:13:25.313818 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:25.314003 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (action)  values('MODEL_ENDED');
    commit;
      
2021-10-03 06:13:25.316990 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:25.317821 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-03 06:13:25.318015 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:25.318183 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-10-03 06:13:25.320454 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:25.322394 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:13:25.322570 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-10-03 06:13:25.324385 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-03 06:13:25.325544 (Thread-1): finished collecting timing info
2021-10-03 06:13:25.325757 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-10-03 06:13:25.326182 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1e6815-fe55-4867-8eae-888477b0a4b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fbbf4eb0>]}
2021-10-03 06:13:25.326717 (Thread-1): 11:43:25 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 2.10s]
2021-10-03 06:13:25.327031 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:13:25.328202 (MainThread): Acquiring new postgres connection "master".
2021-10-03 06:13:25.328432 (MainThread): Using postgres connection "master".
2021-10-03 06:13:25.328656 (MainThread): On master: BEGIN
2021-10-03 06:13:25.328906 (MainThread): Opening a new connection, currently in state closed
2021-10-03 06:13:26.915939 (MainThread): SQL status: BEGIN in 1.59 seconds
2021-10-03 06:13:26.916203 (MainThread): On master: COMMIT
2021-10-03 06:13:26.916356 (MainThread): Using postgres connection "master".
2021-10-03 06:13:26.916492 (MainThread): On master: COMMIT
2021-10-03 06:13:26.918043 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-03 06:13:26.918268 (MainThread): 11:43:26 | 
2021-10-03 06:13:26.918472 (MainThread): 11:43:26 | Running 1 on-run-end hook
2021-10-03 06:13:26.918707 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-03 06:13:26.921192 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-03 06:13:26.922010 (MainThread): 11:43:26 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-10-03 06:13:26.922231 (MainThread): Using postgres connection "master".
2021-10-03 06:13:26.922374 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (action)  values('BUILD_ENDED');
    commit;


2021-10-03 06:13:26.929456 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-03 06:13:26.930324 (MainThread): 11:43:26 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-10-03 06:13:26.930530 (MainThread): 11:43:26 | 
2021-10-03 06:13:26.930719 (MainThread): On master: Close
2021-10-03 06:13:26.931125 (MainThread): 11:43:26 | 
2021-10-03 06:13:26.931305 (MainThread): 11:43:26 | Finished running 2 table models, 3 view models, 2 hooks in 21.12s.
2021-10-03 06:13:26.931467 (MainThread): Connection 'master' was properly closed.
2021-10-03 06:13:26.931682 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-10-03 06:13:26.941774 (MainThread): 
2021-10-03 06:13:26.942048 (MainThread): Completed successfully
2021-10-03 06:13:26.942249 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-03 06:13:26.942499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb961970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fba15f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb9e98b0>]}
2021-10-03 06:13:26.942782 (MainThread): Flushing usage events
2021-10-03 06:53:11.463602 (MainThread): Running with dbt=0.21.0-b1
2021-10-03 06:53:11.542419 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.542553 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.542646 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.542733 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.580415 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-10-03 06:53:11.583120 (MainThread): Tracking: tracking
2021-10-03 06:53:11.818421 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc462813c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc462a0f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc462a02970>]}
2021-10-03 06:53:11.824445 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.824713 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.824881 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.825033 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.831395 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.831631 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.831797 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.831954 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-10-03 06:53:11.841065 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4628f5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4628f5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4628f5340>]}
2021-10-03 06:53:11.841448 (MainThread): Flushing usage events
2021-10-03 06:53:13.705614 (MainThread): Encountered an error:
2021-10-03 06:53:13.705910 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils
2021-10-03 06:53:13.710762 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0-b1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils

2021-10-03 06:53:28.426172 (MainThread): Running with dbt=0.21.0-b1
2021-10-03 06:53:28.544000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='compile', write_json=True)
2021-10-03 06:53:28.546295 (MainThread): Tracking: tracking
2021-10-03 06:53:28.565926 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18a52e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18853c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18a7f700>]}
2021-10-03 06:53:28.588777 (MainThread): Partial parsing not enabled
2021-10-03 06:53:28.667059 (MainThread): Parsing macros/test_empty.sql
2021-10-03 06:53:28.667975 (MainThread): Parsing macros/audits.sql
2021-10-03 06:53:28.668456 (MainThread): Parsing macros/test_country.sql
2021-10-03 06:53:28.668976 (MainThread): Parsing macros/generate_schema_name.sql
2021-10-03 06:53:28.669862 (MainThread): Parsing macros/catalog.sql
2021-10-03 06:53:28.673989 (MainThread): Parsing macros/relations.sql
2021-10-03 06:53:28.675439 (MainThread): Parsing macros/adapters.sql
2021-10-03 06:53:28.700874 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-03 06:53:28.702760 (MainThread): Parsing macros/core.sql
2021-10-03 06:53:28.707636 (MainThread): Parsing macros/materializations/test.sql
2021-10-03 06:53:28.720141 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-03 06:53:28.732946 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-03 06:53:28.735064 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-03 06:53:28.754492 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-03 06:53:28.799291 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-03 06:53:28.832785 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-03 06:53:28.835561 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-03 06:53:28.849127 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-03 06:53:28.879962 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-03 06:53:28.899622 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-03 06:53:28.914639 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-03 06:53:28.924581 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-03 06:53:28.929852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-03 06:53:28.931028 (MainThread): Parsing macros/etc/query.sql
2021-10-03 06:53:28.932237 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-03 06:53:28.934293 (MainThread): Parsing macros/etc/datetime.sql
2021-10-03 06:53:28.948333 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-03 06:53:28.950967 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-03 06:53:28.953364 (MainThread): Parsing macros/adapters/common.sql
2021-10-03 06:53:29.029694 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-03 06:53:29.031945 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-03 06:53:29.033733 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-03 06:53:29.035606 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-03 06:53:29.038248 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-10-03 06:53:29.039631 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-10-03 06:53:29.041393 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-10-03 06:53:29.044037 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-10-03 06:53:29.052326 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-10-03 06:53:29.058430 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-10-03 06:53:29.060293 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-10-03 06:53:29.063398 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-10-03 06:53:29.064799 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-10-03 06:53:29.067759 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-10-03 06:53:29.080144 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-10-03 06:53:29.082758 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-10-03 06:53:29.084610 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-10-03 06:53:29.086742 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-10-03 06:53:29.089529 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-10-03 06:53:29.091205 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-10-03 06:53:29.096620 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-10-03 06:53:29.105119 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-10-03 06:53:29.106331 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-10-03 06:53:29.110176 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-10-03 06:53:29.114409 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-10-03 06:53:29.117759 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-10-03 06:53:29.121059 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-10-03 06:53:29.155037 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-10-03 06:53:29.156145 (MainThread): Parsing macros/logger/pretty_time.sql
2021-10-03 06:53:29.157185 (MainThread): Parsing macros/logger/log_info.sql
2021-10-03 06:53:29.158194 (MainThread): Parsing macros/datetime/date_spine.sql
2021-10-03 06:53:29.163393 (MainThread): Parsing macros/web/get_url_host.sql
2021-10-03 06:53:29.165680 (MainThread): Parsing macros/web/get_url_path.sql
2021-10-03 06:53:29.169323 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-10-03 06:53:29.172081 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-10-03 06:53:29.174287 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-10-03 06:53:29.177084 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-10-03 06:53:29.180761 (MainThread): Parsing macros/schema_tests/recency.sql
2021-10-03 06:53:29.182468 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-10-03 06:53:29.184390 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-10-03 06:53:29.186464 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-10-03 06:53:29.187608 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-10-03 06:53:29.191105 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-10-03 06:53:29.192953 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-10-03 06:53:29.194272 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-10-03 06:53:29.196857 (MainThread): Parsing macros/schema_tests/equality.sql
2021-10-03 06:53:29.203314 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-10-03 06:53:29.215849 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-10-03 06:53:29.218081 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-10-03 06:53:29.222310 (MainThread): Parsing macros/sql/generate_series.sql
2021-10-03 06:53:29.227272 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-10-03 06:53:29.232808 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-10-03 06:53:29.235081 (MainThread): Parsing macros/sql/star.sql
2021-10-03 06:53:29.239707 (MainThread): Parsing macros/sql/unpivot.sql
2021-10-03 06:53:29.250300 (MainThread): Parsing macros/sql/union.sql
2021-10-03 06:53:29.263659 (MainThread): Parsing macros/sql/groupby.sql
2021-10-03 06:53:29.265634 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-10-03 06:53:29.271227 (MainThread): Parsing macros/sql/safe_add.sql
2021-10-03 06:53:29.274045 (MainThread): Parsing macros/sql/nullcheck.sql
2021-10-03 06:53:29.276479 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-10-03 06:53:29.282162 (MainThread): Parsing macros/sql/get_column_values.sql
2021-10-03 06:53:29.289543 (MainThread): Parsing macros/sql/pivot.sql
2021-10-03 06:53:29.293624 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-10-03 06:53:29.567997 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-10-03 06:53:29.568267 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46acb8a4-f6a3-48b7-b88e-fa7c6d2b8841', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18b19f70>]}
2021-10-03 06:53:29.759067 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:53:29.783203 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:53:29.791803 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '46acb8a4-f6a3-48b7-b88e-fa7c6d2b8841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18b86760>]}
2021-10-03 06:53:29.793950 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:53:29.803960 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:53:29.814326 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:53:29.824095 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-03 06:53:29.832772 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-03 06:53:29.869797 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-03 06:53:29.877974 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-03 06:53:30.018826 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-10-03 06:53:30.025698 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46acb8a4-f6a3-48b7-b88e-fa7c6d2b8841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18bfa820>]}
2021-10-03 06:53:30.087720 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46acb8a4-f6a3-48b7-b88e-fa7c6d2b8841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc182aa970>]}
2021-10-03 06:53:30.088152 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-10-03 06:53:30.092343 (MainThread): 
2021-10-03 06:53:30.093009 (MainThread): Acquiring new postgres connection "master".
2021-10-03 06:53:30.095449 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_public".
2021-10-03 06:53:30.109715 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-03 06:53:30.110005 (ThreadPoolExecutor-0_0): On list_postgres_public: BEGIN
2021-10-03 06:53:30.110290 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-03 06:53:55.716924 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 25.61 seconds
2021-10-03 06:53:55.717571 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_public".
2021-10-03 06:53:55.717827 (ThreadPoolExecutor-0_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-03 06:53:55.737525 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.02 seconds
2021-10-03 06:53:55.739252 (ThreadPoolExecutor-0_0): On list_postgres_public: ROLLBACK
2021-10-03 06:53:55.741005 (ThreadPoolExecutor-0_0): On list_postgres_public: Close
2021-10-03 06:53:55.741546 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-10-03 06:53:55.744507 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-03 06:53:55.744988 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: BEGIN
2021-10-03 06:53:55.745195 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-03 06:53:59.939873 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 4.19 seconds
2021-10-03 06:53:59.940120 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbtdemo".
2021-10-03 06:53:59.940273 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-10-03 06:53:59.956394 (ThreadPoolExecutor-0_0): SQL status: SELECT 9 in 0.02 seconds
2021-10-03 06:53:59.957879 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: ROLLBACK
2021-10-03 06:53:59.960313 (ThreadPoolExecutor-0_0): On list_postgres_dbtdemo: Close
2021-10-03 06:53:59.960970 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:53:59.963238 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:53:59.963439 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: BEGIN
2021-10-03 06:53:59.963589 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-03 06:54:02.253571 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 2.29 seconds
2021-10-03 06:54:02.253822 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-10-03 06:54:02.254086 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-10-03 06:54:02.273458 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.02 seconds
2021-10-03 06:54:02.275101 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-10-03 06:54:02.277813 (ThreadPoolExecutor-0_0): On list_postgres_dbt_test__audit: Close
2021-10-03 06:54:02.290862 (MainThread): Using postgres connection "master".
2021-10-03 06:54:02.291265 (MainThread): On master: BEGIN
2021-10-03 06:54:02.291521 (MainThread): Opening a new connection, currently in state init
2021-10-03 06:54:05.142469 (MainThread): SQL status: BEGIN in 2.85 seconds
2021-10-03 06:54:05.142726 (MainThread): Using postgres connection "master".
2021-10-03 06:54:05.142878 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-03 06:54:05.260749 (MainThread): SQL status: SELECT 7 in 0.12 seconds
2021-10-03 06:54:05.262545 (MainThread): On master: ROLLBACK
2021-10-03 06:54:05.264746 (MainThread): On master: Close
2021-10-03 06:54:05.265305 (MainThread): 12:24:05 | Concurrency: 1 threads (target='dev')
2021-10-03 06:54:05.265523 (MainThread): 12:24:05 | 
2021-10-03 06:54:05.270512 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-10-03 06:54:05.271746 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-10-03 06:54:05.272429 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-10-03 06:54:05.276898 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-10-03 06:54:05.278385 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.278808 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.279524 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-10-03 06:54:05.279770 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-10-03 06:54:05.280472 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-10-03 06:54:05.280987 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-10-03 06:54:05.285693 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-10-03 06:54:05.287757 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.288152 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.288781 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-10-03 06:54:05.289262 (Thread-1): Began running node model.dbt_demo_project.my_first_dbt_model
2021-10-03 06:54:05.290856 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-10-03 06:54:05.291569 (Thread-1): Compiling model.dbt_demo_project.my_first_dbt_model
2021-10-03 06:54:05.297451 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_first_dbt_model"
2021-10-03 06:54:05.299839 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.300622 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.301378 (Thread-1): Finished running node model.dbt_demo_project.my_first_dbt_model
2021-10-03 06:54:05.301796 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:54:05.302506 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-10-03 06:54:05.302863 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:54:05.312362 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-10-03 06:54:05.314480 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.315093 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.316128 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-10-03 06:54:05.316609 (Thread-1): Began running node operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-03 06:54:05.317312 (Thread-1): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-10-03 06:54:05.317728 (Thread-1): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-03 06:54:05.323315 (Thread-1): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-10-03 06:54:05.324733 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.325160 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.326477 (Thread-1): Finished running node operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-10-03 06:54:05.327000 (Thread-1): Began running node operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-03 06:54:05.328014 (Thread-1): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-10-03 06:54:05.328497 (Thread-1): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-03 06:54:05.333383 (Thread-1): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-10-03 06:54:05.334839 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.335367 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.336156 (Thread-1): Finished running node operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-10-03 06:54:05.336531 (Thread-1): Began running node seed.dbt_demo_project.locations
2021-10-03 06:54:05.337151 (Thread-1): Acquiring new postgres connection "seed.dbt_demo_project.locations".
2021-10-03 06:54:05.337472 (Thread-1): Compiling seed.dbt_demo_project.locations
2021-10-03 06:54:05.340642 (Thread-1): Writing injected SQL for node "seed.dbt_demo_project.locations"
2021-10-03 06:54:05.340937 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.341171 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.341721 (Thread-1): Finished running node seed.dbt_demo_project.locations
2021-10-03 06:54:05.342130 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-03 06:54:05.342978 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-10-03 06:54:05.343303 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-03 06:54:05.348924 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-10-03 06:54:05.351237 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.351600 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.352109 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-10-03 06:54:05.352341 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-03 06:54:05.352815 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-10-03 06:54:05.353014 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-03 06:54:05.363239 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-10-03 06:54:05.364525 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.364794 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.365439 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-10-03 06:54:05.365838 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-03 06:54:05.367102 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-10-03 06:54:05.367429 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-03 06:54:05.381465 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-10-03 06:54:05.382326 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.382723 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.383294 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-10-03 06:54:05.383586 (Thread-1): Began running node model.dbt_demo_project.my_second_dbt_model
2021-10-03 06:54:05.383983 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-10-03 06:54:05.384194 (Thread-1): Compiling model.dbt_demo_project.my_second_dbt_model
2021-10-03 06:54:05.389415 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.my_second_dbt_model"
2021-10-03 06:54:05.391011 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.391448 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.391980 (Thread-1): Finished running node model.dbt_demo_project.my_second_dbt_model
2021-10-03 06:54:05.392209 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-03 06:54:05.392904 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-10-03 06:54:05.393250 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-03 06:54:05.399153 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-10-03 06:54:05.400478 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.400786 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.401249 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-10-03 06:54:05.401487 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-03 06:54:05.402190 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-03 06:54:05.402540 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-03 06:54:05.408722 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-03 06:54:05.410252 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.410793 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.411599 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-03 06:54:05.411976 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:54:05.412718 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-10-03 06:54:05.413527 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:54:05.426142 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-10-03 06:54:05.427330 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.427647 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.428187 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-10-03 06:54:05.428654 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:54:05.429274 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-10-03 06:54:05.429664 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:54:05.435365 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-10-03 06:54:05.436396 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.436780 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.437402 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-10-03 06:54:05.437634 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-03 06:54:05.438369 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-10-03 06:54:05.438628 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-03 06:54:05.444168 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-10-03 06:54:05.445616 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.446138 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.446624 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-10-03 06:54:05.446903 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-03 06:54:05.447498 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-03 06:54:05.447782 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-03 06:54:05.457577 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-03 06:54:05.458766 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.459278 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.459972 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-03 06:54:05.460306 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-03 06:54:05.461123 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-10-03 06:54:05.461429 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-03 06:54:05.469291 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-10-03 06:54:05.471552 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.472167 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.472947 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-10-03 06:54:05.473413 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-03 06:54:05.474107 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-10-03 06:54:05.474387 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-03 06:54:05.480073 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-10-03 06:54:05.480859 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.481092 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.481486 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-10-03 06:54:05.481722 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-03 06:54:05.482296 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-10-03 06:54:05.482562 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-03 06:54:05.488931 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-10-03 06:54:05.489771 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.490011 (Thread-1): finished collecting timing info
2021-10-03 06:54:05.490423 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-10-03 06:54:05.491841 (MainThread): Connection 'master' was properly closed.
2021-10-03 06:54:05.492031 (MainThread): Connection 'test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a' was properly closed.
2021-10-03 06:54:05.504673 (MainThread): 12:24:05 | Done.
2021-10-03 06:54:05.505082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18a1caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18a1c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc18a1c370>]}
2021-10-03 06:54:05.505483 (MainThread): Flushing usage events
2021-11-03 12:15:42.083387 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 12:15:42.151353 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.151469 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.151553 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.151630 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.184022 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-03 12:15:42.186477 (MainThread): Tracking: tracking
2021-11-03 12:15:42.383559 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd146d6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1478fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1478f370>]}
2021-11-03 12:15:42.387727 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.387906 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.388033 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.388145 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.393355 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.393525 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.393651 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.393765 (MainThread): Creating a LegacyVersion has been deprecated and will be removed in the next major release
2021-11-03 12:15:42.400520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd147be2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd147be580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd147be400>]}
2021-11-03 12:15:42.400748 (MainThread): Flushing usage events
2021-11-03 12:15:43.636031 (MainThread): Encountered an error:
2021-11-03 12:15:43.637395 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils
2021-11-03 12:15:43.642684 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.0-b1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in get_full_manifest
    projects = config.load_dependencies()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.0-b1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /Users/pl465j/projects/dbt-demo/dbt-demo/dbt_modules/dbt_utils

2021-11-03 12:15:54.865157 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 12:15:54.960252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 12:15:54.961672 (MainThread): Tracking: tracking
2021-11-03 12:15:54.979217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0500d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab04ff6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab04fa6610>]}
2021-11-03 12:15:55.001327 (MainThread): Partial parsing not enabled
2021-11-03 12:15:55.082234 (MainThread): Parsing macros/test_empty.sql
2021-11-03 12:15:55.083451 (MainThread): Parsing macros/audits.sql
2021-11-03 12:15:55.084480 (MainThread): Parsing macros/test_country.sql
2021-11-03 12:15:55.085210 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 12:15:55.086423 (MainThread): Parsing macros/catalog.sql
2021-11-03 12:15:55.091511 (MainThread): Parsing macros/relations.sql
2021-11-03 12:15:55.093925 (MainThread): Parsing macros/adapters.sql
2021-11-03 12:15:55.125630 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 12:15:55.127666 (MainThread): Parsing macros/core.sql
2021-11-03 12:15:55.133828 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 12:15:55.148175 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 12:15:55.165780 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 12:15:55.167959 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 12:15:55.191293 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 12:15:55.229679 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 12:15:55.259078 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 12:15:55.261711 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 12:15:55.275896 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 12:15:55.302057 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 12:15:55.320024 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 12:15:55.329553 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 12:15:55.337989 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 12:15:55.341724 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 12:15:55.342527 (MainThread): Parsing macros/etc/query.sql
2021-11-03 12:15:55.343397 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 12:15:55.344773 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 12:15:55.352840 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 12:15:55.354529 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 12:15:55.355936 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 12:15:55.409975 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 12:15:55.411607 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 12:15:55.412675 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 12:15:55.413917 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 12:15:55.415842 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 12:15:55.416848 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 12:15:55.418151 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 12:15:55.420130 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 12:15:55.426341 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 12:15:55.427546 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 12:15:55.429202 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 12:15:55.431642 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 12:15:55.432679 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 12:15:55.434870 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 12:15:55.444287 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 12:15:55.445992 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 12:15:55.447292 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 12:15:55.448849 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 12:15:55.450303 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 12:15:55.451300 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 12:15:55.454275 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 12:15:55.459173 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 12:15:55.459888 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 12:15:55.462440 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 12:15:55.464126 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 12:15:55.465530 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 12:15:55.467444 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 12:15:55.490024 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 12:15:55.490688 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 12:15:55.491324 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 12:15:55.491901 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 12:15:55.495212 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 12:15:55.496476 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 12:15:55.499288 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 12:15:55.500375 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 12:15:55.501229 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 12:15:55.502456 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 12:15:55.504533 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 12:15:55.505843 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 12:15:55.506949 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 12:15:55.508820 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 12:15:55.510122 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 12:15:55.513380 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 12:15:55.515620 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 12:15:55.516941 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 12:15:55.518623 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 12:15:55.523540 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 12:15:55.531437 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 12:15:55.533022 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 12:15:55.536220 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 12:15:55.540195 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 12:15:55.543357 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 12:15:55.544536 (MainThread): Parsing macros/sql/star.sql
2021-11-03 12:15:55.547776 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 12:15:55.555326 (MainThread): Parsing macros/sql/union.sql
2021-11-03 12:15:55.564940 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 12:15:55.566019 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 12:15:55.569314 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 12:15:55.570443 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 12:15:55.571853 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 12:15:55.575141 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 12:15:55.579785 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 12:15:55.583046 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 12:15:55.740544 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 12:15:55.740754 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab050b16a0>]}
2021-11-03 12:15:55.853549 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:15:55.866317 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:15:55.871666 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:15:55.878103 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:15:55.886052 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:15:55.893480 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 12:15:55.896842 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 12:15:55.916591 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 12:15:55.920427 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 12:15:56.008627 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 12:15:56.013747 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab051e3bb0>]}
2021-11-03 12:15:56.022489 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab051e3bb0>]}
2021-11-03 12:15:56.022781 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 12:15:56.024538 (MainThread): 
2021-11-03 12:15:56.025063 (MainThread): Acquiring new postgres connection "master".
2021-11-03 12:15:56.026296 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 12:15:56.037621 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 12:15:56.037827 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 12:15:56.037976 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 12:16:08.117410 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 12.08 seconds
2021-11-03 12:16:08.119027 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 12:16:08.120831 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 12:16:08.159762 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 12:16:08.159970 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 12:16:08.160119 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:16:09.457244 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.30 seconds
2021-11-03 12:16:09.457463 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 12:16:09.457600 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 12:16:09.481514 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-03 12:16:09.482666 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 12:16:09.483588 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 12:16:09.484102 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 12:16:09.485650 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 12:16:09.485783 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 12:16:09.485890 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:16:10.739185 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.25 seconds
2021-11-03 12:16:10.739429 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 12:16:10.739579 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 12:16:10.753791 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-03 12:16:10.755076 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 12:16:10.756293 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 12:16:10.756757 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:16:10.758548 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:16:10.758713 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 12:16:10.758849 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:16:12.113344 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.35 seconds
2021-11-03 12:16:12.113542 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:16:12.113658 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 12:16:12.125964 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 12:16:12.126978 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 12:16:12.128252 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 12:16:12.133520 (MainThread): Using postgres connection "master".
2021-11-03 12:16:12.133688 (MainThread): On master: BEGIN
2021-11-03 12:16:12.133802 (MainThread): Opening a new connection, currently in state init
2021-11-03 12:16:13.498837 (MainThread): SQL status: BEGIN in 1.37 seconds
2021-11-03 12:16:13.499059 (MainThread): Using postgres connection "master".
2021-11-03 12:16:13.499199 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 12:16:13.663107 (MainThread): SQL status: SELECT 7 in 0.16 seconds
2021-11-03 12:16:13.664646 (MainThread): On master: ROLLBACK
2021-11-03 12:16:13.666274 (MainThread): Using postgres connection "master".
2021-11-03 12:16:13.666413 (MainThread): On master: BEGIN
2021-11-03 12:16:13.668285 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 12:16:13.668429 (MainThread): On master: COMMIT
2021-11-03 12:16:13.668547 (MainThread): Using postgres connection "master".
2021-11-03 12:16:13.668652 (MainThread): On master: COMMIT
2021-11-03 12:16:13.669693 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:13.669852 (MainThread): 17:46:13 | 
2021-11-03 12:16:13.670003 (MainThread): 17:46:13 | Running 1 on-run-start hook
2021-11-03 12:16:13.670140 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 12:16:13.672058 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 12:16:13.675651 (MainThread): 17:46:13 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 12:16:13.675835 (MainThread): Using postgres connection "master".
2021-11-03 12:16:13.675952 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (model,status)  values('START','MAIN');
    commit;


2021-11-03 12:16:13.689434 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:13.690165 (MainThread): 17:46:13 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-03 12:16:13.690331 (MainThread): 17:46:13 | 
2021-11-03 12:16:13.690480 (MainThread): On master: Close
2021-11-03 12:16:13.690767 (MainThread): 17:46:13 | Concurrency: 1 threads (target='dev')
2021-11-03 12:16:13.690905 (MainThread): 17:46:13 | 
2021-11-03 12:16:13.694412 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 12:16:13.694816 (Thread-1): 17:46:13 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 12:16:13.695246 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:13.695461 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 12:16:13.697895 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 12:16:13.699781 (Thread-1): finished collecting timing info
2021-11-03 12:16:13.717149 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:13.717344 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 12:16:13.717466 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:16:15.072564 (Thread-1): SQL status: BEGIN in 1.36 seconds
2021-11-03 12:16:15.072818 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.072966 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:15.079448 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:15.085754 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 12:16:15.086822 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.087034 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 12:16:15.142444 (Thread-1): SQL status: SELECT 44 in 0.06 seconds
2021-11-03 12:16:15.148748 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.148964 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 12:16:15.152460 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:15.155878 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.156043 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 12:16:15.158230 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:15.163716 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.163854 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:15.165957 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:15.171037 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 12:16:15.171179 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.171286 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 12:16:15.172501 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:15.176200 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:16:15.176323 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 12:16:15.187376 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-03 12:16:15.188362 (Thread-1): finished collecting timing info
2021-11-03 12:16:15.188518 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 12:16:15.188844 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab050cbdf0>]}
2021-11-03 12:16:15.189136 (Thread-1): 17:46:15 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.49s]
2021-11-03 12:16:15.189283 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 12:16:15.189427 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 12:16:15.189683 (Thread-1): 17:46:15 | 2 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 12:16:15.189918 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:15.190046 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 12:16:15.192363 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 12:16:15.193600 (Thread-1): finished collecting timing info
2021-11-03 12:16:15.196671 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:15.196855 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 12:16:15.196973 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:16:16.460005 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-03 12:16:16.460318 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.460499 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:16.467762 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:16.469162 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 12:16:16.470065 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.470267 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '6896baf6-68df-40e0-aa96-d977f5c34efe' as invocation_id
  );
2021-11-03 12:16:16.508768 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-11-03 12:16:16.511379 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.511588 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 12:16:16.515551 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:16.517796 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.517954 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 12:16:16.520594 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:16.522644 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.522808 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:16.526104 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:16.527442 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 12:16:16.527669 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.527818 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 12:16:16.530092 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:16.532492 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:16:16.532886 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 12:16:16.560390 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-11-03 12:16:16.561420 (Thread-1): finished collecting timing info
2021-11-03 12:16:16.561602 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 12:16:16.561926 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab04ff5160>]}
2021-11-03 12:16:16.562224 (Thread-1): 17:46:16 | 2 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.37s]
2021-11-03 12:16:16.562376 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 12:16:16.562538 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:16:16.562806 (Thread-1): 17:46:16 | 3 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 12:16:16.563044 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:16.563170 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:16:16.566245 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 12:16:16.567261 (Thread-1): finished collecting timing info
2021-11-03 12:16:16.581500 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:16.581879 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 12:16:16.582040 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:16:17.792352 (Thread-1): SQL status: BEGIN in 1.21 seconds
2021-11-03 12:16:17.792602 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.792756 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:17.797967 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:17.802485 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 12:16:17.804103 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.804274 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 12:16:17.843258 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-11-03 12:16:17.845831 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.845987 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 12:16:17.849169 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:17.852752 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.852916 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 12:16:17.855561 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:17.857524 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.857673 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:17.860427 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:17.861210 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 12:16:17.861368 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.861504 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 12:16:17.862858 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:17.864581 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:16:17.864730 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 12:16:17.868944 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:16:17.870048 (Thread-1): finished collecting timing info
2021-11-03 12:16:17.870241 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 12:16:17.870623 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0527f460>]}
2021-11-03 12:16:17.870974 (Thread-1): 17:46:17 | 3 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.31s]
2021-11-03 12:16:17.871156 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:16:17.872056 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:16:17.872438 (Thread-1): 17:46:17 | 4 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 12:16:17.872769 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:17.872938 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:16:17.876705 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 12:16:17.878475 (Thread-1): finished collecting timing info
2021-11-03 12:16:17.882034 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:17.882254 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 12:16:17.882401 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:16:19.140254 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-03 12:16:19.140690 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:19.140840 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:19.147312 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:19.148474 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 12:16:19.149109 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:19.149259 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 12:16:19.162090 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 12:16:19.164448 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:19.164608 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 12:16:19.166847 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:19.168894 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:19.169061 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:19.171472 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:19.172244 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 12:16:19.172398 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:19.172527 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 12:16:19.173976 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:19.175699 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:16:19.175841 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 12:16:19.178043 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:16:19.179109 (Thread-1): finished collecting timing info
2021-11-03 12:16:19.179338 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 12:16:19.179812 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05185c10>]}
2021-11-03 12:16:19.180420 (Thread-1): 17:46:19 | 4 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.31s]
2021-11-03 12:16:19.180638 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:16:19.180829 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:16:19.181175 (Thread-1): 17:46:19 | 5 of 5 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-11-03 12:16:19.181534 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:19.181696 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:16:19.186102 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 12:16:19.186764 (Thread-1): finished collecting timing info
2021-11-03 12:16:19.190311 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:19.190544 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-11-03 12:16:19.190710 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:16:20.936386 (Thread-1): SQL status: BEGIN in 1.75 seconds
2021-11-03 12:16:20.936726 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:20.936922 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:20.944345 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:20.945568 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 12:16:20.946372 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:20.946554 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 12:16:20.972748 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-11-03 12:16:20.975761 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:20.975941 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-11-03 12:16:20.978964 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:16:20.981247 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:20.981415 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:16:20.983741 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:20.984705 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 12:16:20.984863 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:20.984996 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 12:16:20.986408 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:20.988147 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:16:20.988308 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-11-03 12:16:20.989986 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:16:20.991397 (Thread-1): finished collecting timing info
2021-11-03 12:16:20.991600 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-11-03 12:16:20.992045 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6896baf6-68df-40e0-aa96-d977f5c34efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0528c730>]}
2021-11-03 12:16:20.992571 (Thread-1): 17:46:20 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.81s]
2021-11-03 12:16:20.992780 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:16:20.994047 (MainThread): Acquiring new postgres connection "master".
2021-11-03 12:16:20.994284 (MainThread): Using postgres connection "master".
2021-11-03 12:16:20.994426 (MainThread): On master: BEGIN
2021-11-03 12:16:20.994566 (MainThread): Opening a new connection, currently in state closed
2021-11-03 12:16:22.635979 (MainThread): SQL status: BEGIN in 1.64 seconds
2021-11-03 12:16:22.636235 (MainThread): On master: COMMIT
2021-11-03 12:16:22.636384 (MainThread): Using postgres connection "master".
2021-11-03 12:16:22.636516 (MainThread): On master: COMMIT
2021-11-03 12:16:22.637936 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:16:22.638141 (MainThread): 17:46:22 | 
2021-11-03 12:16:22.638329 (MainThread): 17:46:22 | Running 1 on-run-end hook
2021-11-03 12:16:22.638503 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 12:16:22.642417 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 12:16:22.643250 (MainThread): 17:46:22 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 12:16:22.643480 (MainThread): Using postgres connection "master".
2021-11-03 12:16:22.643632 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (model,status)  values('END','MAIN');
    commit;


2021-11-03 12:16:22.650168 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:16:22.651049 (MainThread): 17:46:22 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 12:16:22.651269 (MainThread): 17:46:22 | 
2021-11-03 12:16:22.651464 (MainThread): On master: Close
2021-11-03 12:16:22.651888 (MainThread): 17:46:22 | 
2021-11-03 12:16:22.652121 (MainThread): 17:46:22 | Finished running 2 table models, 3 view models, 2 hooks in 26.63s.
2021-11-03 12:16:22.652369 (MainThread): Connection 'master' was properly closed.
2021-11-03 12:16:22.652529 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-11-03 12:16:22.662560 (MainThread): 
2021-11-03 12:16:22.662808 (MainThread): Completed successfully
2021-11-03 12:16:22.663005 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-03 12:16:22.663250 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab04fc53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab04fa6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab050453a0>]}
2021-11-03 12:16:22.663565 (MainThread): Flushing usage events
2021-11-03 12:20:55.550821 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 12:20:55.637050 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 12:20:55.639128 (MainThread): Tracking: tracking
2021-11-03 12:20:55.655146 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff02ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff021f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fee93640>]}
2021-11-03 12:20:55.677377 (MainThread): Partial parsing not enabled
2021-11-03 12:20:55.737977 (MainThread): Parsing macros/test_empty.sql
2021-11-03 12:20:55.738735 (MainThread): Parsing macros/audits.sql
2021-11-03 12:20:55.739272 (MainThread): Parsing macros/test_country.sql
2021-11-03 12:20:55.739781 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 12:20:55.740648 (MainThread): Parsing macros/catalog.sql
2021-11-03 12:20:55.744081 (MainThread): Parsing macros/relations.sql
2021-11-03 12:20:55.745395 (MainThread): Parsing macros/adapters.sql
2021-11-03 12:20:55.768099 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 12:20:55.770103 (MainThread): Parsing macros/core.sql
2021-11-03 12:20:55.773980 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 12:20:55.780606 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 12:20:55.791135 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 12:20:55.792909 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 12:20:55.811443 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 12:20:55.844891 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 12:20:55.864584 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 12:20:55.866156 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 12:20:55.876381 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 12:20:55.895930 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 12:20:55.908874 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 12:20:55.916504 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 12:20:55.923339 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 12:20:55.926950 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 12:20:55.927779 (MainThread): Parsing macros/etc/query.sql
2021-11-03 12:20:55.928651 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 12:20:55.930023 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 12:20:55.938126 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 12:20:55.939926 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 12:20:55.941331 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 12:20:55.994294 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 12:20:55.996049 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 12:20:55.997117 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 12:20:55.998273 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 12:20:56.000147 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 12:20:56.001192 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 12:20:56.002536 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 12:20:56.004510 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 12:20:56.010332 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 12:20:56.011344 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 12:20:56.012554 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 12:20:56.014888 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 12:20:56.015921 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 12:20:56.018086 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 12:20:56.027316 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 12:20:56.028985 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 12:20:56.030248 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 12:20:56.031954 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 12:20:56.033861 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 12:20:56.035376 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 12:20:56.039280 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 12:20:56.048894 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 12:20:56.049834 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 12:20:56.053750 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 12:20:56.056396 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 12:20:56.059304 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 12:20:56.062488 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 12:20:56.116229 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 12:20:56.117880 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 12:20:56.119306 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 12:20:56.120779 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 12:20:56.128291 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 12:20:56.131020 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 12:20:56.134917 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 12:20:56.136423 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 12:20:56.137830 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 12:20:56.140239 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 12:20:56.143200 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 12:20:56.144629 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 12:20:56.146112 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 12:20:56.149232 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 12:20:56.151463 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 12:20:56.156617 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 12:20:56.159592 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 12:20:56.162184 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 12:20:56.164508 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 12:20:56.169411 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 12:20:56.178819 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 12:20:56.180357 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 12:20:56.183483 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 12:20:56.187270 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 12:20:56.190505 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 12:20:56.191815 (MainThread): Parsing macros/sql/star.sql
2021-11-03 12:20:56.195384 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 12:20:56.202644 (MainThread): Parsing macros/sql/union.sql
2021-11-03 12:20:56.211471 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 12:20:56.212407 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 12:20:56.215165 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 12:20:56.216092 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 12:20:56.217148 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 12:20:56.219634 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 12:20:56.223323 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 12:20:56.225781 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 12:20:56.374561 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 12:20:56.374783 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff0d08b0>]}
2021-11-03 12:20:56.487471 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:20:56.501731 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:20:56.508298 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:20:56.515914 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:20:56.523525 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:20:56.529682 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 12:20:56.533164 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 12:20:56.556919 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 12:20:56.561412 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 12:20:56.649205 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 12:20:56.654331 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff175c10>]}
2021-11-03 12:20:56.663888 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff347c40>]}
2021-11-03 12:20:56.664221 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 12:20:56.665748 (MainThread): 
2021-11-03 12:20:56.666163 (MainThread): Acquiring new postgres connection "master".
2021-11-03 12:20:56.667046 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 12:20:56.675414 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 12:20:56.675587 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 12:20:56.675715 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 12:20:59.649761 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 2.97 seconds
2021-11-03 12:20:59.652057 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 12:20:59.654261 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:20:59.693484 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:20:59.693698 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 12:20:59.693842 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:21:01.097507 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.40 seconds
2021-11-03 12:21:01.097945 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:21:01.098191 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 12:21:01.112811 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 12:21:01.113968 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 12:21:01.115116 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 12:21:01.115628 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 12:21:01.117247 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 12:21:01.117412 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 12:21:01.117542 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:21:02.527794 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-11-03 12:21:02.528026 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 12:21:02.528174 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 12:21:02.543147 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-03 12:21:02.544693 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 12:21:02.546225 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 12:21:02.546761 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 12:21:02.548672 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 12:21:02.548841 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 12:21:02.548984 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:21:03.738052 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.19 seconds
2021-11-03 12:21:03.738272 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 12:21:03.738397 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 12:21:03.749612 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-03 12:21:03.750661 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 12:21:03.752454 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 12:21:03.757140 (MainThread): Using postgres connection "master".
2021-11-03 12:21:03.757299 (MainThread): On master: BEGIN
2021-11-03 12:21:03.757407 (MainThread): Opening a new connection, currently in state init
2021-11-03 12:21:05.076944 (MainThread): SQL status: BEGIN in 1.32 seconds
2021-11-03 12:21:05.077270 (MainThread): Using postgres connection "master".
2021-11-03 12:21:05.077440 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 12:21:05.231547 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-11-03 12:21:05.232717 (MainThread): On master: ROLLBACK
2021-11-03 12:21:05.234233 (MainThread): Using postgres connection "master".
2021-11-03 12:21:05.234377 (MainThread): On master: BEGIN
2021-11-03 12:21:05.236510 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 12:21:05.236660 (MainThread): On master: COMMIT
2021-11-03 12:21:05.236778 (MainThread): Using postgres connection "master".
2021-11-03 12:21:05.236895 (MainThread): On master: COMMIT
2021-11-03 12:21:05.237855 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:05.238005 (MainThread): 17:51:05 | 
2021-11-03 12:21:05.238149 (MainThread): 17:51:05 | Running 1 on-run-start hook
2021-11-03 12:21:05.238285 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 12:21:05.240177 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 12:21:05.242189 (MainThread): 17:51:05 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 12:21:05.242402 (MainThread): Using postgres connection "master".
2021-11-03 12:21:05.242567 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (model,status)  values('START','MAIN');
    commit;


2021-11-03 12:21:05.252000 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:05.252713 (MainThread): 17:51:05 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-03 12:21:05.252894 (MainThread): 17:51:05 | 
2021-11-03 12:21:05.253045 (MainThread): On master: Close
2021-11-03 12:21:05.253346 (MainThread): 17:51:05 | Concurrency: 1 threads (target='dev')
2021-11-03 12:21:05.253484 (MainThread): 17:51:05 | 
2021-11-03 12:21:05.256228 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 12:21:05.256776 (Thread-1): 17:51:05 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 12:21:05.257145 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:05.257300 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 12:21:05.259957 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 12:21:05.260845 (Thread-1): finished collecting timing info
2021-11-03 12:21:05.284107 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:05.284330 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 12:21:05.284480 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:21:06.680785 (Thread-1): SQL status: BEGIN in 1.40 seconds
2021-11-03 12:21:06.681005 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.681155 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:06.690881 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:06.696446 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 12:21:06.697071 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.697230 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 12:21:06.718263 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-11-03 12:21:06.723580 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.723718 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 12:21:06.725547 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:06.728297 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.728428 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 12:21:06.730783 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:06.736501 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.736687 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:06.739247 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:06.745362 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 12:21:06.745546 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.745677 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 12:21:06.747223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:06.751943 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:21:06.752099 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 12:21:06.762235 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-03 12:21:06.763303 (Thread-1): finished collecting timing info
2021-11-03 12:21:06.763473 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 12:21:06.763823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff0f8fa0>]}
2021-11-03 12:21:06.764124 (Thread-1): 17:51:06 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.51s]
2021-11-03 12:21:06.764274 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 12:21:06.764422 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 12:21:06.764728 (Thread-1): 17:51:06 | 2 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 12:21:06.765013 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:06.765151 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 12:21:06.767492 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 12:21:06.768314 (Thread-1): finished collecting timing info
2021-11-03 12:21:06.771492 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:06.771696 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 12:21:06.771834 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:21:08.102977 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-03 12:21:08.103249 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.103401 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:08.110206 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:08.111615 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 12:21:08.112703 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.113047 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7' as invocation_id
  );
2021-11-03 12:21:08.147044 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-03 12:21:08.149651 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.149873 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 12:21:08.153027 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:08.155344 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.155503 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 12:21:08.158145 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:08.160093 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.160246 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:08.162817 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:08.163907 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 12:21:08.164065 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.164191 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 12:21:08.165593 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:08.167358 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:21:08.167517 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 12:21:08.185240 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-03 12:21:08.186194 (Thread-1): finished collecting timing info
2021-11-03 12:21:08.186352 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 12:21:08.186670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff0c2490>]}
2021-11-03 12:21:08.186953 (Thread-1): 17:51:08 | 2 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.42s]
2021-11-03 12:21:08.187100 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 12:21:08.187248 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:21:08.187499 (Thread-1): 17:51:08 | 3 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 12:21:08.187731 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:08.187857 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:21:08.190849 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 12:21:08.191312 (Thread-1): finished collecting timing info
2021-11-03 12:21:08.203271 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:08.203444 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 12:21:08.203555 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:21:09.685053 (Thread-1): SQL status: BEGIN in 1.48 seconds
2021-11-03 12:21:09.685284 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.685431 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:09.691713 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:09.696321 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 12:21:09.696986 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.697151 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 12:21:09.711463 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 12:21:09.714056 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.714234 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 12:21:09.716400 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:09.719768 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.719924 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 12:21:09.722246 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:09.724202 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.724356 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:09.726735 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:09.727489 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 12:21:09.727639 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.727769 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 12:21:09.729096 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:09.731990 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:21:09.732330 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 12:21:09.738121 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-03 12:21:09.739332 (Thread-1): finished collecting timing info
2021-11-03 12:21:09.739536 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 12:21:09.740066 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff39a430>]}
2021-11-03 12:21:09.740665 (Thread-1): 17:51:09 | 3 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.55s]
2021-11-03 12:21:09.740919 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:21:09.742134 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:21:09.742737 (Thread-1): 17:51:09 | 4 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 12:21:09.743115 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:09.743285 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:21:09.747955 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 12:21:09.748681 (Thread-1): finished collecting timing info
2021-11-03 12:21:09.753320 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:09.753627 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 12:21:09.753876 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:21:11.003634 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-11-03 12:21:11.004054 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:11.004191 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:11.009629 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:11.010750 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 12:21:11.011376 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:11.011530 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 12:21:11.024218 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 12:21:11.026724 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:11.026914 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 12:21:11.029844 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:11.031998 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:11.032170 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:11.034804 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:11.035681 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 12:21:11.035847 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:11.035985 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 12:21:11.037534 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:11.039770 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:21:11.039993 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 12:21:11.041706 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:21:11.042904 (Thread-1): finished collecting timing info
2021-11-03 12:21:11.043122 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 12:21:11.043553 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff00cc70>]}
2021-11-03 12:21:11.044032 (Thread-1): 17:51:11 | 4 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.30s]
2021-11-03 12:21:11.044236 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:21:11.044499 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:21:11.044924 (Thread-1): 17:51:11 | 5 of 5 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-11-03 12:21:11.045372 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:11.045560 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:21:11.049625 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 12:21:11.050304 (Thread-1): finished collecting timing info
2021-11-03 12:21:11.053982 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:11.054202 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-11-03 12:21:11.054355 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:21:12.365774 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-11-03 12:21:12.366003 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:12.366147 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:12.371425 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:12.372599 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 12:21:12.374407 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:12.374575 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 12:21:12.387209 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 12:21:12.389624 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:12.389782 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-11-03 12:21:12.392483 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:21:12.394575 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:12.394738 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('ENDED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:21:12.397153 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:12.398076 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 12:21:12.398229 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:12.398375 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 12:21:12.399760 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:12.401443 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:21:12.401613 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-11-03 12:21:12.403150 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:21:12.404360 (Thread-1): finished collecting timing info
2021-11-03 12:21:12.404568 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-11-03 12:21:12.404974 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976b75db-c9a4-4b3c-82c5-db8ebd21b8e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff39aee0>]}
2021-11-03 12:21:12.405317 (Thread-1): 17:51:12 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.36s]
2021-11-03 12:21:12.405502 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:21:12.406487 (MainThread): Acquiring new postgres connection "master".
2021-11-03 12:21:12.406684 (MainThread): Using postgres connection "master".
2021-11-03 12:21:12.406827 (MainThread): On master: BEGIN
2021-11-03 12:21:12.406961 (MainThread): Opening a new connection, currently in state closed
2021-11-03 12:21:13.698099 (MainThread): SQL status: BEGIN in 1.29 seconds
2021-11-03 12:21:13.698342 (MainThread): On master: COMMIT
2021-11-03 12:21:13.698494 (MainThread): Using postgres connection "master".
2021-11-03 12:21:13.698634 (MainThread): On master: COMMIT
2021-11-03 12:21:13.699845 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:21:13.700081 (MainThread): 17:51:13 | 
2021-11-03 12:21:13.700276 (MainThread): 17:51:13 | Running 1 on-run-end hook
2021-11-03 12:21:13.700450 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 12:21:13.704553 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 12:21:13.706740 (MainThread): 17:51:13 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 12:21:13.707034 (MainThread): Using postgres connection "master".
2021-11-03 12:21:13.707201 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (model,status)  values('END','MAIN');
    commit;


2021-11-03 12:21:13.713235 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:21:13.714096 (MainThread): 17:51:13 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 12:21:13.714312 (MainThread): 17:51:13 | 
2021-11-03 12:21:13.714503 (MainThread): On master: Close
2021-11-03 12:21:13.714917 (MainThread): 17:51:13 | 
2021-11-03 12:21:13.715097 (MainThread): 17:51:13 | Finished running 2 table models, 3 view models, 2 hooks in 17.05s.
2021-11-03 12:21:13.715255 (MainThread): Connection 'master' was properly closed.
2021-11-03 12:21:13.715391 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-11-03 12:21:13.724910 (MainThread): 
2021-11-03 12:21:13.725198 (MainThread): Completed successfully
2021-11-03 12:21:13.725404 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-03 12:21:13.725645 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8feec33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff1b2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fee93850>]}
2021-11-03 12:21:13.725916 (MainThread): Flushing usage events
2021-11-03 12:28:52.337545 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 12:28:52.425137 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 12:28:52.429505 (MainThread): Tracking: tracking
2021-11-03 12:28:52.450441 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed129ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed129340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed1299d0>]}
2021-11-03 12:28:52.471970 (MainThread): Partial parsing not enabled
2021-11-03 12:28:52.921313 (MainThread): Parsing macros/test_empty.sql
2021-11-03 12:28:52.922082 (MainThread): Parsing macros/audits.sql
2021-11-03 12:28:52.922668 (MainThread): Parsing macros/test_country.sql
2021-11-03 12:28:52.923162 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 12:28:52.924010 (MainThread): Parsing macros/catalog.sql
2021-11-03 12:28:52.927196 (MainThread): Parsing macros/relations.sql
2021-11-03 12:28:52.928469 (MainThread): Parsing macros/adapters.sql
2021-11-03 12:28:52.950686 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 12:28:52.952424 (MainThread): Parsing macros/core.sql
2021-11-03 12:28:52.955857 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 12:28:52.962237 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 12:28:52.974306 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 12:28:52.976464 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 12:28:52.998975 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 12:28:53.040984 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 12:28:53.065581 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 12:28:53.067762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 12:28:53.087002 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 12:28:53.123035 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 12:28:53.150726 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 12:28:53.159556 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 12:28:53.168510 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 12:28:53.174601 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 12:28:53.176355 (MainThread): Parsing macros/etc/query.sql
2021-11-03 12:28:53.178043 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 12:28:53.181313 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 12:28:53.199199 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 12:28:53.203078 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 12:28:53.206043 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 12:28:53.294347 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 12:28:53.296096 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 12:28:53.297335 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 12:28:53.298847 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 12:28:53.301090 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 12:28:53.302126 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 12:28:53.303545 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 12:28:53.305629 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 12:28:53.311618 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 12:28:53.312654 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 12:28:53.313882 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 12:28:53.316236 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 12:28:53.317271 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 12:28:53.319471 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 12:28:53.330698 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 12:28:53.333371 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 12:28:53.335464 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 12:28:53.337819 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 12:28:53.339621 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 12:28:53.341233 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 12:28:53.344952 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 12:28:53.350441 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 12:28:53.351394 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 12:28:53.354321 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 12:28:53.356707 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 12:28:53.360245 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 12:28:53.364103 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 12:28:53.396219 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 12:28:53.396890 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 12:28:53.397529 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 12:28:53.398099 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 12:28:53.401363 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 12:28:53.402522 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 12:28:53.404366 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 12:28:53.405280 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 12:28:53.406081 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 12:28:53.407179 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 12:28:53.408914 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 12:28:53.409948 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 12:28:53.411058 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 12:28:53.412852 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 12:28:53.413698 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 12:28:53.416269 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 12:28:53.417617 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 12:28:53.418525 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 12:28:53.419688 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 12:28:53.422993 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 12:28:53.428916 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 12:28:53.429970 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 12:28:53.432215 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 12:28:53.436340 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 12:28:53.438667 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 12:28:53.439611 (MainThread): Parsing macros/sql/star.sql
2021-11-03 12:28:53.442040 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 12:28:53.447609 (MainThread): Parsing macros/sql/union.sql
2021-11-03 12:28:53.455014 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 12:28:53.455819 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 12:28:53.458335 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 12:28:53.459323 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 12:28:53.460608 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 12:28:53.463233 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 12:28:53.467348 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 12:28:53.470129 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 12:28:53.627659 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 12:28:53.627867 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed1d95b0>]}
2021-11-03 12:28:53.755570 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:28:53.765085 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:28:53.769607 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:28:53.776173 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.postgres_model".
2021-11-03 12:28:53.783528 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:28:53.787254 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:28:53.791464 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 12:28:53.795859 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 12:28:53.886504 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 12:28:53.892258 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 12:28:54.014275 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 12:28:54.020357 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed391ac0>]}
2021-11-03 12:28:54.031153 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed391af0>]}
2021-11-03 12:28:54.031440 (MainThread): Found 8 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 12:28:54.032901 (MainThread): 
2021-11-03 12:28:54.033301 (MainThread): Acquiring new postgres connection "master".
2021-11-03 12:28:54.034379 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 12:28:54.045929 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 12:28:54.046097 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 12:28:54.046213 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 12:28:58.293305 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 4.25 seconds
2021-11-03 12:28:58.295018 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 12:28:58.297701 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 12:28:58.303315 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 12:28:58.303462 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 12:28:58.303573 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:28:59.665912 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.36 seconds
2021-11-03 12:28:59.666114 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 12:28:59.666235 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 12:28:59.678444 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-03 12:28:59.679585 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 12:28:59.680748 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 12:28:59.681162 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:28:59.682761 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:28:59.682902 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 12:28:59.683019 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:29:00.943198 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-11-03 12:29:00.943403 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 12:29:00.943525 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 12:29:00.957260 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 12:29:00.958226 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 12:29:00.959240 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 12:29:00.959688 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 12:29:00.962401 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 12:29:00.962682 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 12:29:00.962809 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 12:29:02.377814 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-11-03 12:29:02.378039 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 12:29:02.378174 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 12:29:02.391453 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-03 12:29:02.392822 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 12:29:02.394230 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 12:29:02.433058 (MainThread): Using postgres connection "master".
2021-11-03 12:29:02.433267 (MainThread): On master: BEGIN
2021-11-03 12:29:02.433415 (MainThread): Opening a new connection, currently in state init
2021-11-03 12:29:03.904326 (MainThread): SQL status: BEGIN in 1.47 seconds
2021-11-03 12:29:03.904523 (MainThread): Using postgres connection "master".
2021-11-03 12:29:03.904641 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 12:29:04.064965 (MainThread): SQL status: SELECT 7 in 0.16 seconds
2021-11-03 12:29:04.066746 (MainThread): On master: ROLLBACK
2021-11-03 12:29:04.068472 (MainThread): Using postgres connection "master".
2021-11-03 12:29:04.068716 (MainThread): On master: BEGIN
2021-11-03 12:29:04.071427 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 12:29:04.071765 (MainThread): On master: COMMIT
2021-11-03 12:29:04.072026 (MainThread): Using postgres connection "master".
2021-11-03 12:29:04.072224 (MainThread): On master: COMMIT
2021-11-03 12:29:04.074016 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:04.074259 (MainThread): 17:59:04 | 
2021-11-03 12:29:04.074535 (MainThread): 17:59:04 | Running 1 on-run-start hook
2021-11-03 12:29:04.074858 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 12:29:04.078389 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 12:29:04.081404 (MainThread): 17:59:04 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 12:29:04.081876 (MainThread): Using postgres connection "master".
2021-11-03 12:29:04.082244 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (model,status)  values('START','MAIN');
    commit;


2021-11-03 12:29:04.094085 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:29:04.094878 (MainThread): 17:59:04 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-03 12:29:04.095054 (MainThread): 17:59:04 | 
2021-11-03 12:29:04.095285 (MainThread): On master: Close
2021-11-03 12:29:04.095607 (MainThread): 17:59:04 | Concurrency: 1 threads (target='dev')
2021-11-03 12:29:04.095894 (MainThread): 17:59:04 | 
2021-11-03 12:29:04.099102 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 12:29:04.099673 (Thread-1): 17:59:04 | 1 of 6 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 12:29:04.100263 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:04.100597 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 12:29:04.104021 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 12:29:04.105101 (Thread-1): finished collecting timing info
2021-11-03 12:29:04.143325 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 12:29:04.144146 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:04.144359 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 12:29:04.144545 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:29:05.442312 (Thread-1): SQL status: BEGIN in 1.30 seconds
2021-11-03 12:29:05.442506 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:05.442624 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 12:29:05.462223 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-11-03 12:29:05.468172 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:05.468351 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 12:29:05.469882 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:05.472577 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:05.472747 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 12:29:05.474558 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:05.484167 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 12:29:05.484535 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:05.484719 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 12:29:05.489356 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:05.494466 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 12:29:05.494610 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 12:29:05.504099 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-03 12:29:05.505087 (Thread-1): finished collecting timing info
2021-11-03 12:29:05.505247 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 12:29:05.505588 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed1c1970>]}
2021-11-03 12:29:05.505885 (Thread-1): 17:59:05 | 1 of 6 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.41s]
2021-11-03 12:29:05.506063 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 12:29:05.506220 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 12:29:05.506480 (Thread-1): 17:59:05 | 2 of 6 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 12:29:05.506726 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:05.506858 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 12:29:05.509094 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 12:29:05.509813 (Thread-1): finished collecting timing info
2021-11-03 12:29:05.513072 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 12:29:05.514094 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:05.514313 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 12:29:05.514430 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:29:06.886547 (Thread-1): SQL status: BEGIN in 1.37 seconds
2021-11-03 12:29:06.886828 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:06.887103 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5' as invocation_id
  );
2021-11-03 12:29:06.915924 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-03 12:29:06.918170 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:06.918308 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 12:29:06.920071 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:06.923232 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:06.923470 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 12:29:06.925662 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:06.927544 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 12:29:06.927696 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:06.927869 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 12:29:06.931745 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:06.934486 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 12:29:06.934724 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 12:29:06.958101 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-03 12:29:06.959087 (Thread-1): finished collecting timing info
2021-11-03 12:29:06.959265 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 12:29:06.959586 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed462cd0>]}
2021-11-03 12:29:06.959871 (Thread-1): 17:59:06 | 2 of 6 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.45s]
2021-11-03 12:29:06.960055 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 12:29:06.960208 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:29:06.960505 (Thread-1): 17:59:06 | 3 of 6 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 12:29:06.960781 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:06.960915 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:29:06.964267 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 12:29:06.964741 (Thread-1): finished collecting timing info
2021-11-03 12:29:06.991085 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 12:29:06.991869 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:06.992098 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 12:29:06.992302 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:29:08.277017 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-11-03 12:29:08.277219 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:08.277338 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 12:29:08.294236 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-03 12:29:08.296562 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:08.296699 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 12:29:08.298468 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:08.301149 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:08.301480 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 12:29:08.307751 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-03 12:29:08.308831 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 12:29:08.308961 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:08.309065 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 12:29:08.312530 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:08.314512 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 12:29:08.314760 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 12:29:08.321038 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-03 12:29:08.322287 (Thread-1): finished collecting timing info
2021-11-03 12:29:08.322492 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 12:29:08.322847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed462d30>]}
2021-11-03 12:29:08.323139 (Thread-1): 17:59:08 | 3 of 6 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.36s]
2021-11-03 12:29:08.323306 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 12:29:08.323539 (Thread-1): Began running node model.dbt_demo_project.postgres_model
2021-11-03 12:29:08.323871 (Thread-1): 17:59:08 | 4 of 6 START table model dbtdemo.postgres_model...................... [RUN]
2021-11-03 12:29:08.324264 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.postgres_model".
2021-11-03 12:29:08.324453 (Thread-1): Compiling model.dbt_demo_project.postgres_model
2021-11-03 12:29:08.327941 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.postgres_model"
2021-11-03 12:29:08.328139 (Thread-1): finished collecting timing info
2021-11-03 12:29:08.331701 (Thread-1): Using postgres connection "model.dbt_demo_project.postgres_model".
2021-11-03 12:29:08.331854 (Thread-1): On model.dbt_demo_project.postgres_model: BEGIN
2021-11-03 12:29:08.331970 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:29:09.741388 (Thread-1): SQL status: BEGIN in 1.41 seconds
2021-11-03 12:29:09.741623 (Thread-1): Using postgres connection "model.dbt_demo_project.postgres_model".
2021-11-03 12:29:09.741768 (Thread-1): On model.dbt_demo_project.postgres_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.postgres_model"} */

        insert into dbtdemo.dbt_audit_table (model,status)  values('STARTED','POSTGRES_MODEL');
    commit;
      
2021-11-03 12:29:09.749976 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:29:09.751201 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.postgres_model"
2021-11-03 12:29:09.751775 (Thread-1): Using postgres connection "model.dbt_demo_project.postgres_model".
2021-11-03 12:29:09.751937 (Thread-1): On model.dbt_demo_project.postgres_model: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.postgres_model"} */


  create  table "postgres"."dbtdemo"."postgres_model__dbt_tmp"
  as (
    
  );
2021-11-03 12:29:09.755923 (Thread-1): Postgres error: syntax error at or near ")"
LINE 7:   );
          ^

2021-11-03 12:29:09.756151 (Thread-1): On model.dbt_demo_project.postgres_model: ROLLBACK
2021-11-03 12:29:09.757851 (Thread-1): finished collecting timing info
2021-11-03 12:29:09.758122 (Thread-1): On model.dbt_demo_project.postgres_model: Close
2021-11-03 12:29:09.758517 (Thread-1): Database Error in model postgres_model (models/postgres_model/postgres_model.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/postgres_model.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 7:   );
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model postgres_model (models/postgres_model/postgres_model.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/postgres_model.sql
2021-11-03 12:29:09.768748 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed4de790>]}
2021-11-03 12:29:09.769157 (Thread-1): 17:59:09 | 4 of 6 ERROR creating table model dbtdemo.postgres_model............. [ERROR in 1.44s]
2021-11-03 12:29:09.769349 (Thread-1): Finished running node model.dbt_demo_project.postgres_model
2021-11-03 12:29:09.769543 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:29:09.769951 (Thread-1): 17:59:09 | 5 of 6 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 12:29:09.770312 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:29:09.770483 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:29:09.773946 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 12:29:09.774467 (Thread-1): finished collecting timing info
2021-11-03 12:29:09.776965 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 12:29:09.777635 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:29:09.777801 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 12:29:09.777961 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:29:11.405049 (Thread-1): SQL status: BEGIN in 1.63 seconds
2021-11-03 12:29:11.405276 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:29:11.405417 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 12:29:11.417515 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 12:29:11.419527 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:29:11.419651 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 12:29:11.420706 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:11.421523 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 12:29:11.421644 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:29:11.421762 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 12:29:11.423931 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:11.425323 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 12:29:11.425447 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 12:29:11.426607 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:29:11.427461 (Thread-1): finished collecting timing info
2021-11-03 12:29:11.427612 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 12:29:11.427921 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed4de7f0>]}
2021-11-03 12:29:11.428224 (Thread-1): 17:59:11 | 5 of 6 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.66s]
2021-11-03 12:29:11.428388 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 12:29:11.428542 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:29:11.428792 (Thread-1): 17:59:11 | 6 of 6 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-11-03 12:29:11.429035 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:29:11.429163 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:29:11.432573 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 12:29:11.433028 (Thread-1): finished collecting timing info
2021-11-03 12:29:11.435116 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 12:29:11.435862 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:29:11.436033 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-11-03 12:29:11.436153 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 12:29:12.799781 (Thread-1): SQL status: BEGIN in 1.36 seconds
2021-11-03 12:29:12.800004 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:29:12.800160 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 12:29:12.811707 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 12:29:12.813945 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:29:12.814087 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-11-03 12:29:12.815539 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 12:29:12.816454 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 12:29:12.816583 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:29:12.816691 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 12:29:12.818963 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:12.820281 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 12:29:12.820398 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-11-03 12:29:12.821405 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 12:29:12.822226 (Thread-1): finished collecting timing info
2021-11-03 12:29:12.822394 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-11-03 12:29:12.822704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfb7e68-16d3-4b2b-a02e-a09ace7e17a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed1fbb20>]}
2021-11-03 12:29:12.822993 (Thread-1): 17:59:12 | 6 of 6 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.39s]
2021-11-03 12:29:12.823142 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 12:29:12.823976 (MainThread): Acquiring new postgres connection "master".
2021-11-03 12:29:12.824139 (MainThread): Using postgres connection "master".
2021-11-03 12:29:12.824249 (MainThread): On master: BEGIN
2021-11-03 12:29:12.824355 (MainThread): Opening a new connection, currently in state closed
2021-11-03 12:29:14.124433 (MainThread): SQL status: BEGIN in 1.30 seconds
2021-11-03 12:29:14.124651 (MainThread): On master: COMMIT
2021-11-03 12:29:14.124773 (MainThread): Using postgres connection "master".
2021-11-03 12:29:14.124886 (MainThread): On master: COMMIT
2021-11-03 12:29:14.125965 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 12:29:14.126234 (MainThread): 17:59:14 | 
2021-11-03 12:29:14.126436 (MainThread): 17:59:14 | Running 1 on-run-end hook
2021-11-03 12:29:14.126604 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 12:29:14.129265 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 12:29:14.130174 (MainThread): 17:59:14 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 12:29:14.130389 (MainThread): Using postgres connection "master".
2021-11-03 12:29:14.130540 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (model,status)  values('END','MAIN');
    commit;


2021-11-03 12:29:14.139406 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 12:29:14.140236 (MainThread): 17:59:14 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 12:29:14.140460 (MainThread): 17:59:14 | 
2021-11-03 12:29:14.140770 (MainThread): On master: Close
2021-11-03 12:29:14.141274 (MainThread): 17:59:14 | 
2021-11-03 12:29:14.141456 (MainThread): 17:59:14 | Finished running 3 table models, 3 view models, 2 hooks in 20.11s.
2021-11-03 12:29:14.141737 (MainThread): Connection 'master' was properly closed.
2021-11-03 12:29:14.141943 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-11-03 12:29:14.153598 (MainThread): 
2021-11-03 12:29:14.153847 (MainThread): Completed with 1 error and 0 warnings:
2021-11-03 12:29:14.154085 (MainThread): 
2021-11-03 12:29:14.154264 (MainThread): Database Error in model postgres_model (models/postgres_model/postgres_model.sql)
2021-11-03 12:29:14.154421 (MainThread):   syntax error at or near ")"
2021-11-03 12:29:14.154570 (MainThread):   LINE 7:   );
2021-11-03 12:29:14.154712 (MainThread):             ^
2021-11-03 12:29:14.154850 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/postgres_model.sql
2021-11-03 12:29:14.155175 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-11-03 12:29:14.155524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed391bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed391490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aed16e6d0>]}
2021-11-03 12:29:14.155853 (MainThread): Flushing usage events
2021-11-03 14:27:05.284918 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 14:27:05.444435 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 14:27:05.446752 (MainThread): Tracking: tracking
2021-11-03 14:27:05.661460 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b92abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b8c2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b8c2e20>]}
2021-11-03 14:27:05.691497 (MainThread): Partial parsing not enabled
2021-11-03 14:27:05.773702 (MainThread): Parsing macros/test_empty.sql
2021-11-03 14:27:05.774509 (MainThread): Parsing macros/audits.sql
2021-11-03 14:27:05.775166 (MainThread): Parsing macros/test_country.sql
2021-11-03 14:27:05.775699 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 14:27:05.776600 (MainThread): Parsing macros/catalog.sql
2021-11-03 14:27:05.781035 (MainThread): Parsing macros/relations.sql
2021-11-03 14:27:05.782308 (MainThread): Parsing macros/adapters.sql
2021-11-03 14:27:05.811113 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 14:27:05.813237 (MainThread): Parsing macros/core.sql
2021-11-03 14:27:05.818078 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 14:27:05.826931 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 14:27:05.838885 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 14:27:05.841035 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 14:27:05.860898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 14:27:05.896211 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 14:27:05.916703 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 14:27:05.918607 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 14:27:05.928469 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 14:27:05.950437 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 14:27:05.965826 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 14:27:05.975414 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 14:27:05.984682 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 14:27:05.990063 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 14:27:05.991192 (MainThread): Parsing macros/etc/query.sql
2021-11-03 14:27:05.992282 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 14:27:05.993990 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 14:27:06.003851 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 14:27:06.006028 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 14:27:06.007823 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 14:27:06.067223 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 14:27:06.068897 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 14:27:06.070010 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 14:27:06.071714 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 14:27:06.074010 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 14:27:06.075055 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 14:27:06.076377 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 14:27:06.078419 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 14:27:06.084392 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 14:27:06.085433 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 14:27:06.086641 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 14:27:06.089713 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 14:27:06.090854 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 14:27:06.092998 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 14:27:06.103151 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 14:27:06.105811 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 14:27:06.107179 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 14:27:06.108884 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 14:27:06.110351 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 14:27:06.111298 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 14:27:06.114334 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 14:27:06.119915 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 14:27:06.120651 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 14:27:06.123602 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 14:27:06.125323 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 14:27:06.126773 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 14:27:06.128542 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 14:27:06.158044 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 14:27:06.159116 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 14:27:06.160069 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 14:27:06.160841 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 14:27:06.164777 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 14:27:06.166383 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 14:27:06.168916 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 14:27:06.170652 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 14:27:06.172348 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 14:27:06.174447 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 14:27:06.177567 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 14:27:06.179091 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 14:27:06.180207 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 14:27:06.182281 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 14:27:06.183556 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 14:27:06.186765 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 14:27:06.188643 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 14:27:06.190087 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 14:27:06.191888 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 14:27:06.197022 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 14:27:06.204454 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 14:27:06.206708 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 14:27:06.209805 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 14:27:06.213794 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 14:27:06.216691 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 14:27:06.217973 (MainThread): Parsing macros/sql/star.sql
2021-11-03 14:27:06.222971 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 14:27:06.230684 (MainThread): Parsing macros/sql/union.sql
2021-11-03 14:27:06.241293 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 14:27:06.242793 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 14:27:06.246730 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 14:27:06.248108 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 14:27:06.249502 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 14:27:06.252736 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 14:27:06.257426 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 14:27:06.260583 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 14:27:06.424991 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 14:27:06.425219 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9e30e31e-a1df-48dd-a07a-3504cccaef5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b9cb2e0>]}
2021-11-03 14:27:06.552806 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:27:06.563811 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:27:06.566397 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '9e30e31e-a1df-48dd-a07a-3504cccaef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90bb29df0>]}
2021-11-03 14:27:06.567563 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:27:06.572541 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:27:06.580343 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:27:06.584766 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 14:27:06.588647 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 14:27:06.612729 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 14:27:06.616676 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 14:27:06.725693 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 14:27:06.731808 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e30e31e-a1df-48dd-a07a-3504cccaef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90bbb1f70>]}
2021-11-03 14:27:06.744720 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e30e31e-a1df-48dd-a07a-3504cccaef5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90bb03d90>]}
2021-11-03 14:27:06.745073 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 14:27:06.747066 (MainThread): 
2021-11-03 14:27:06.747607 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:27:06.748725 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 14:27:06.759341 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 14:27:06.759558 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 14:27:06.759707 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 14:27:12.585374 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 5.83 seconds
2021-11-03 14:27:12.586984 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 14:27:12.589605 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 14:27:12.596002 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:27:12.596204 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 14:27:12.596352 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:27:14.059066 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.46 seconds
2021-11-03 14:27:14.059352 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:27:14.059502 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 14:27:14.076849 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2021-11-03 14:27:14.078204 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 14:27:14.079540 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 14:27:14.080177 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:27:14.082636 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:27:14.082857 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 14:27:14.083008 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:27:15.343109 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-11-03 14:27:15.343346 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:27:15.343492 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 14:27:15.358159 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 14:27:15.359460 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 14:27:15.361434 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 14:27:15.362683 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 14:27:15.365307 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:27:15.365546 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 14:27:15.365873 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:27:16.744765 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.38 seconds
2021-11-03 14:27:16.744996 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:27:16.745138 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 14:27:16.759789 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-03 14:27:16.761214 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 14:27:16.762604 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 14:27:16.770627 (MainThread): Using postgres connection "master".
2021-11-03 14:27:16.770846 (MainThread): On master: BEGIN
2021-11-03 14:27:16.770995 (MainThread): Opening a new connection, currently in state init
2021-11-03 14:27:18.367278 (MainThread): SQL status: BEGIN in 1.60 seconds
2021-11-03 14:27:18.367528 (MainThread): Using postgres connection "master".
2021-11-03 14:27:18.367675 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 14:27:18.511716 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-11-03 14:27:18.546354 (MainThread): On master: ROLLBACK
2021-11-03 14:27:18.548352 (MainThread): Using postgres connection "master".
2021-11-03 14:27:18.548559 (MainThread): On master: BEGIN
2021-11-03 14:27:18.551618 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 14:27:18.551841 (MainThread): On master: COMMIT
2021-11-03 14:27:18.551999 (MainThread): Using postgres connection "master".
2021-11-03 14:27:18.552138 (MainThread): On master: COMMIT
2021-11-03 14:27:18.553710 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:27:18.553902 (MainThread): 19:57:18 | 
2021-11-03 14:27:18.554094 (MainThread): 19:57:18 | Running 1 on-run-start hook
2021-11-03 14:27:18.554267 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 14:27:18.556866 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 14:27:18.560135 (MainThread): 19:57:18 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 14:27:18.560373 (MainThread): Using postgres connection "master".
2021-11-03 14:27:18.560524 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\n    commit;\n\n", Undefined)
2021-11-03 14:27:18.562439 (MainThread): Postgres error: syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\n    commit;\n\n""
LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
         ^

2021-11-03 14:27:18.562709 (MainThread): Database error while running on-run-start
2021-11-03 14:27:18.562902 (MainThread): On master: Close
2021-11-03 14:27:18.563289 (MainThread): Connection 'master' was properly closed.
2021-11-03 14:27:18.563439 (MainThread): Connection 'list_postgres_dbtdemo' was properly closed.
2021-11-03 14:27:18.563644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b8f5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b8be310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b8be3d0>]}
2021-11-03 14:27:18.563948 (MainThread): Flushing usage events
2021-11-03 14:27:20.295332 (MainThread): Encountered an error:
2021-11-03 14:27:20.295588 (MainThread): Database Error
  syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\n    commit;\n\n""
  LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
           ^
2021-11-03 14:27:20.303288 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\n    commit;\n\n""
LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 427, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 385, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\n    commit;\n\n""
  LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
           ^

2021-11-03 14:29:03.861824 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 14:29:03.942960 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 14:29:03.944140 (MainThread): Tracking: tracking
2021-11-03 14:29:03.964216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aa00f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aa006be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a9fa7610>]}
2021-11-03 14:29:03.985627 (MainThread): Partial parsing not enabled
2021-11-03 14:29:04.048188 (MainThread): Parsing macros/test_empty.sql
2021-11-03 14:29:04.049452 (MainThread): Parsing macros/audits.sql
2021-11-03 14:29:04.050375 (MainThread): Parsing macros/test_country.sql
2021-11-03 14:29:04.051122 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 14:29:04.052370 (MainThread): Parsing macros/catalog.sql
2021-11-03 14:29:04.055716 (MainThread): Parsing macros/relations.sql
2021-11-03 14:29:04.057184 (MainThread): Parsing macros/adapters.sql
2021-11-03 14:29:04.080974 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 14:29:04.083138 (MainThread): Parsing macros/core.sql
2021-11-03 14:29:04.087303 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 14:29:04.094447 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 14:29:04.104403 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 14:29:04.106110 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 14:29:04.127388 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 14:29:04.163858 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 14:29:04.191186 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 14:29:04.193272 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 14:29:04.204237 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 14:29:04.229743 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 14:29:04.244976 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 14:29:04.254012 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 14:29:04.261934 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 14:29:04.265814 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 14:29:04.266692 (MainThread): Parsing macros/etc/query.sql
2021-11-03 14:29:04.267624 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 14:29:04.269057 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 14:29:04.277176 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 14:29:04.278919 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 14:29:04.280383 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 14:29:04.340688 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 14:29:04.342659 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 14:29:04.343785 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 14:29:04.345072 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 14:29:04.346996 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 14:29:04.347995 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 14:29:04.349453 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 14:29:04.352195 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 14:29:04.358049 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 14:29:04.359783 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 14:29:04.361102 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 14:29:04.363301 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 14:29:04.364368 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 14:29:04.366843 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 14:29:04.377148 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 14:29:04.378950 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 14:29:04.380340 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 14:29:04.382067 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 14:29:04.384596 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 14:29:04.385590 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 14:29:04.388596 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 14:29:04.393697 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 14:29:04.394540 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 14:29:04.397077 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 14:29:04.399295 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 14:29:04.401040 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 14:29:04.402784 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 14:29:04.427608 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 14:29:04.428256 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 14:29:04.428916 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 14:29:04.429505 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 14:29:04.433023 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 14:29:04.434362 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 14:29:04.436493 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 14:29:04.437573 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 14:29:04.438501 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 14:29:04.439690 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 14:29:04.441544 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 14:29:04.442589 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 14:29:04.443428 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 14:29:04.444768 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 14:29:04.445588 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 14:29:04.447765 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 14:29:04.449585 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 14:29:04.450674 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 14:29:04.452233 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 14:29:04.455532 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 14:29:04.461702 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 14:29:04.463485 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 14:29:04.466640 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 14:29:04.469708 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 14:29:04.472024 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 14:29:04.472919 (MainThread): Parsing macros/sql/star.sql
2021-11-03 14:29:04.475397 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 14:29:04.481038 (MainThread): Parsing macros/sql/union.sql
2021-11-03 14:29:04.490760 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 14:29:04.491637 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 14:29:04.494190 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 14:29:04.495106 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 14:29:04.496191 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 14:29:04.498664 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 14:29:04.502469 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 14:29:04.505002 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 14:29:04.706610 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 14:29:04.706915 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28119a99-9c2d-47cb-81d8-161e6168be07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aa0b16a0>]}
2021-11-03 14:29:04.874932 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:29:04.890399 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:29:04.894976 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:29:04.900366 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:29:04.908360 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:29:04.913613 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 14:29:04.919691 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 14:29:05.540987 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 14:29:05.545515 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 14:29:05.673317 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 14:29:05.679217 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28119a99-9c2d-47cb-81d8-161e6168be07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aa2a6220>]}
2021-11-03 14:29:05.690432 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28119a99-9c2d-47cb-81d8-161e6168be07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aa30b640>]}
2021-11-03 14:29:05.690773 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 14:29:05.692475 (MainThread): 
2021-11-03 14:29:05.692849 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:29:05.693982 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 14:29:05.704620 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 14:29:05.704889 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 14:29:05.705116 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 14:29:08.044917 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 2.34 seconds
2021-11-03 14:29:08.046590 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 14:29:08.048717 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 14:29:08.056051 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:29:08.056235 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 14:29:08.056408 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:29:09.698710 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.64 seconds
2021-11-03 14:29:09.698910 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:29:09.699049 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 14:29:09.712239 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-03 14:29:09.713942 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 14:29:09.715792 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 14:29:09.716504 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:29:09.719280 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:29:09.719595 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 14:29:09.719899 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:29:11.213711 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.49 seconds
2021-11-03 14:29:11.213974 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:29:11.214094 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 14:29:11.228266 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 14:29:11.229697 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 14:29:11.231706 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 14:29:11.232728 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 14:29:11.234246 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:29:11.234398 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 14:29:11.234526 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:29:12.462911 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.23 seconds
2021-11-03 14:29:12.463202 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:29:12.463388 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 14:29:12.481709 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2021-11-03 14:29:12.485034 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 14:29:12.486830 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 14:29:12.535978 (MainThread): Using postgres connection "master".
2021-11-03 14:29:12.536295 (MainThread): On master: BEGIN
2021-11-03 14:29:12.536529 (MainThread): Opening a new connection, currently in state init
2021-11-03 14:29:13.983086 (MainThread): SQL status: BEGIN in 1.45 seconds
2021-11-03 14:29:13.983302 (MainThread): Using postgres connection "master".
2021-11-03 14:29:13.983419 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 14:29:14.141171 (MainThread): SQL status: SELECT 7 in 0.16 seconds
2021-11-03 14:29:14.142778 (MainThread): On master: ROLLBACK
2021-11-03 14:29:14.144131 (MainThread): Using postgres connection "master".
2021-11-03 14:29:14.144311 (MainThread): On master: BEGIN
2021-11-03 14:29:14.146638 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 14:29:14.146824 (MainThread): On master: COMMIT
2021-11-03 14:29:14.146969 (MainThread): Using postgres connection "master".
2021-11-03 14:29:14.147077 (MainThread): On master: COMMIT
2021-11-03 14:29:14.148231 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:29:14.148404 (MainThread): 19:59:14 | 
2021-11-03 14:29:14.148555 (MainThread): 19:59:14 | Running 1 on-run-start hook
2021-11-03 14:29:14.148716 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 14:29:14.151127 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 14:29:14.152876 (MainThread): 19:59:14 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 14:29:14.153175 (MainThread): Using postgres connection "master".
2021-11-03 14:29:14.153390 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\ncommit;\n\n", Undefined)
2021-11-03 14:29:14.155040 (MainThread): Postgres error: syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\ncommit;\n\n""
LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
         ^

2021-11-03 14:29:14.155281 (MainThread): Database error while running on-run-start
2021-11-03 14:29:14.155447 (MainThread): On master: Close
2021-11-03 14:29:14.155809 (MainThread): Connection 'master' was properly closed.
2021-11-03 14:29:14.155935 (MainThread): Connection 'list_postgres_public' was properly closed.
2021-11-03 14:29:14.156111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a9eda4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a9eda070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a9edaee0>]}
2021-11-03 14:29:14.156451 (MainThread): Flushing usage events
2021-11-03 14:29:15.626793 (MainThread): Encountered an error:
2021-11-03 14:29:15.627085 (MainThread): Database Error
  syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\ncommit;\n\n""
  LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
           ^
2021-11-03 14:29:15.632110 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\ncommit;\n\n""
LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 427, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 385, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_model)  values('START','MAIN','');\ncommit;\n\n""
  LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (model,status,sub_...
           ^

2021-11-03 14:36:54.409623 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 14:36:54.525777 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 14:36:54.527660 (MainThread): Tracking: tracking
2021-11-03 14:36:54.740006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0fa02abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0fa021eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f9ea5640>]}
2021-11-03 14:36:54.764241 (MainThread): Partial parsing not enabled
2021-11-03 14:36:54.835409 (MainThread): Parsing macros/test_empty.sql
2021-11-03 14:36:54.836337 (MainThread): Parsing macros/audits.sql
2021-11-03 14:36:54.837089 (MainThread): Parsing macros/test_country.sql
2021-11-03 14:36:54.837729 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 14:36:54.838786 (MainThread): Parsing macros/catalog.sql
2021-11-03 14:36:54.842721 (MainThread): Parsing macros/relations.sql
2021-11-03 14:36:54.844289 (MainThread): Parsing macros/adapters.sql
2021-11-03 14:36:54.869449 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 14:36:54.871108 (MainThread): Parsing macros/core.sql
2021-11-03 14:36:54.874697 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 14:36:54.881310 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 14:36:54.890753 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 14:36:54.892349 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 14:36:54.909427 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 14:36:54.943360 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 14:36:54.965271 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 14:36:54.966950 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 14:36:54.977560 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 14:36:55.000924 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 14:36:55.017495 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 14:36:55.026935 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 14:36:55.035858 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 14:36:55.040300 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 14:36:55.041281 (MainThread): Parsing macros/etc/query.sql
2021-11-03 14:36:55.042342 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 14:36:55.044041 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 14:36:55.053761 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 14:36:55.055945 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 14:36:55.057492 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 14:36:55.119642 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 14:36:55.121320 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 14:36:55.122421 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 14:36:55.123601 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 14:36:55.125502 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 14:36:55.126477 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 14:36:55.128144 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 14:36:55.131331 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 14:36:55.137199 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 14:36:55.138442 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 14:36:55.139831 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 14:36:55.142450 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 14:36:55.143633 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 14:36:55.146186 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 14:36:55.157525 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 14:36:55.159723 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 14:36:55.161883 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 14:36:55.164202 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 14:36:55.166196 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 14:36:55.167368 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 14:36:55.172009 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 14:36:55.179322 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 14:36:55.180366 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 14:36:55.184311 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 14:36:55.186613 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 14:36:55.188705 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 14:36:55.190913 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 14:36:55.221576 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 14:36:55.222434 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 14:36:55.223243 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 14:36:55.223952 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 14:36:55.227899 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 14:36:55.230171 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 14:36:55.233336 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 14:36:55.235324 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 14:36:55.237358 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 14:36:55.239352 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 14:36:55.242014 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 14:36:55.243784 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 14:36:55.245768 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 14:36:55.247931 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 14:36:55.249867 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 14:36:55.253769 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 14:36:55.256146 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 14:36:55.257527 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 14:36:55.259437 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 14:36:55.263789 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 14:36:55.270907 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 14:36:55.272401 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 14:36:55.275447 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 14:36:55.279531 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 14:36:55.282515 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 14:36:55.283728 (MainThread): Parsing macros/sql/star.sql
2021-11-03 14:36:55.287050 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 14:36:55.294508 (MainThread): Parsing macros/sql/union.sql
2021-11-03 14:36:55.304150 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 14:36:55.305265 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 14:36:55.308525 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 14:36:55.309664 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 14:36:55.311030 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 14:36:55.314273 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 14:36:55.318795 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 14:36:55.321686 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 14:36:55.499578 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 14:36:55.499847 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '857153ca-527d-43e6-aaad-4dffba87ebd3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0fa0cf9d0>]}
2021-11-03 14:36:55.629719 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:36:55.641005 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:36:55.644819 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:36:55.649840 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:36:55.657202 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:36:55.661570 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 14:36:55.665760 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 14:36:55.690894 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 14:36:55.695127 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 14:36:55.809750 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 14:36:55.815746 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857153ca-527d-43e6-aaad-4dffba87ebd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0fa21cb80>]}
2021-11-03 14:36:55.825671 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857153ca-527d-43e6-aaad-4dffba87ebd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0fa30b670>]}
2021-11-03 14:36:55.826042 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 14:36:55.828879 (MainThread): 
2021-11-03 14:36:55.829545 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:36:55.830890 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 14:36:55.842262 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 14:36:55.842478 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 14:36:55.842645 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 14:36:57.671723 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 1.83 seconds
2021-11-03 14:36:57.673352 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 14:36:57.675629 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 14:36:57.682359 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:36:57.682574 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 14:36:57.682725 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:36:59.294499 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.61 seconds
2021-11-03 14:36:59.294761 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:36:59.294917 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 14:36:59.310462 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-03 14:36:59.311992 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 14:36:59.313736 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 14:36:59.314278 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:36:59.316518 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:36:59.316713 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 14:36:59.316868 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:37:00.876725 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.56 seconds
2021-11-03 14:37:00.876954 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:37:00.877095 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 14:37:00.890283 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 14:37:00.891451 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 14:37:00.892894 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 14:37:00.893440 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 14:37:00.895503 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:37:00.895711 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 14:37:00.895853 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:37:02.186775 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.29 seconds
2021-11-03 14:37:02.187016 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:37:02.187163 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 14:37:02.204320 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2021-11-03 14:37:02.206602 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 14:37:02.208192 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 14:37:02.264964 (MainThread): Using postgres connection "master".
2021-11-03 14:37:02.265391 (MainThread): On master: BEGIN
2021-11-03 14:37:02.265659 (MainThread): Opening a new connection, currently in state init
2021-11-03 14:37:03.707414 (MainThread): SQL status: BEGIN in 1.44 seconds
2021-11-03 14:37:03.707654 (MainThread): Using postgres connection "master".
2021-11-03 14:37:03.707800 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 14:37:03.843197 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-11-03 14:37:03.844494 (MainThread): On master: ROLLBACK
2021-11-03 14:37:03.845890 (MainThread): Using postgres connection "master".
2021-11-03 14:37:03.846040 (MainThread): On master: BEGIN
2021-11-03 14:37:03.848054 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 14:37:03.848248 (MainThread): On master: COMMIT
2021-11-03 14:37:03.848371 (MainThread): Using postgres connection "master".
2021-11-03 14:37:03.848479 (MainThread): On master: COMMIT
2021-11-03 14:37:03.849494 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:37:03.849652 (MainThread): 20:07:03 | 
2021-11-03 14:37:03.849801 (MainThread): 20:07:03 | Running 1 on-run-start hook
2021-11-03 14:37:03.849938 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 14:37:03.851902 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 14:37:03.853128 (MainThread): 20:07:03 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 14:37:03.853304 (MainThread): Using postgres connection "master".
2021-11-03 14:37:03.853475 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
("\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');\n    commit;\n\n", Undefined)
2021-11-03 14:37:03.855217 (MainThread): Postgres error: syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');\n    commit;\n\n""
LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_...
         ^

2021-11-03 14:37:03.855486 (MainThread): Database error while running on-run-start
2021-11-03 14:37:03.855667 (MainThread): On master: Close
2021-11-03 14:37:03.855969 (MainThread): Connection 'master' was properly closed.
2021-11-03 14:37:03.856085 (MainThread): Connection 'list_postgres_public' was properly closed.
2021-11-03 14:37:03.856255 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f9e9da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f9e9d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f9e9db50>]}
2021-11-03 14:37:03.856527 (MainThread): Flushing usage events
2021-11-03 14:37:05.430872 (MainThread): Encountered an error:
2021-11-03 14:37:05.431183 (MainThread): Database Error
  syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');\n    commit;\n\n""
  LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_...
           ^
2021-11-03 14:37:05.438367 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');\n    commit;\n\n""
LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 427, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 385, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near ""\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');\n    commit;\n\n""
  LINE 2: ("\n\ninsert into dbtdemo.dbt_audit_table (status,model,sub_...
           ^

2021-11-03 14:38:02.427108 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 14:38:02.539935 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 14:38:02.541798 (MainThread): Tracking: tracking
2021-11-03 14:38:02.740242 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac2593a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac25fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac2015e0>]}
2021-11-03 14:38:02.767243 (MainThread): Partial parsing not enabled
2021-11-03 14:38:03.469693 (MainThread): Parsing macros/test_empty.sql
2021-11-03 14:38:03.470657 (MainThread): Parsing macros/audits.sql
2021-11-03 14:38:03.471430 (MainThread): Parsing macros/test_country.sql
2021-11-03 14:38:03.472077 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 14:38:03.473180 (MainThread): Parsing macros/catalog.sql
2021-11-03 14:38:03.477420 (MainThread): Parsing macros/relations.sql
2021-11-03 14:38:03.479026 (MainThread): Parsing macros/adapters.sql
2021-11-03 14:38:03.506533 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 14:38:03.508512 (MainThread): Parsing macros/core.sql
2021-11-03 14:38:03.512649 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 14:38:03.519580 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 14:38:03.529584 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 14:38:03.531566 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 14:38:03.548967 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 14:38:03.584256 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 14:38:03.605585 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 14:38:03.607206 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 14:38:03.618102 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 14:38:03.638873 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 14:38:03.652798 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 14:38:03.661500 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 14:38:03.669176 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 14:38:03.672955 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 14:38:03.673773 (MainThread): Parsing macros/etc/query.sql
2021-11-03 14:38:03.674634 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 14:38:03.675995 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 14:38:03.684410 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 14:38:03.686120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 14:38:03.687544 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 14:38:03.743715 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 14:38:03.745319 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 14:38:03.746367 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 14:38:03.747554 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 14:38:03.749920 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 14:38:03.750957 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 14:38:03.752425 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 14:38:03.754553 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 14:38:03.761019 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 14:38:03.762250 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 14:38:03.763507 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 14:38:03.765839 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 14:38:03.766838 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 14:38:03.768963 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 14:38:03.778965 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 14:38:03.780728 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 14:38:03.782147 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 14:38:03.783850 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 14:38:03.785321 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 14:38:03.786202 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 14:38:03.789506 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 14:38:03.794682 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 14:38:03.795438 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 14:38:03.798564 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 14:38:03.800802 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 14:38:03.802205 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 14:38:03.804255 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 14:38:03.827936 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 14:38:03.828794 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 14:38:03.829568 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 14:38:03.830154 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 14:38:03.834212 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 14:38:03.835667 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 14:38:03.838049 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 14:38:03.839066 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 14:38:03.839934 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 14:38:03.841258 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 14:38:03.843321 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 14:38:03.844634 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 14:38:03.845496 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 14:38:03.846865 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 14:38:03.847734 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 14:38:03.850155 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 14:38:03.851511 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 14:38:03.852462 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 14:38:03.853717 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 14:38:03.857106 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 14:38:03.863248 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 14:38:03.864510 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 14:38:03.867230 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 14:38:03.870484 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 14:38:03.873293 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 14:38:03.874215 (MainThread): Parsing macros/sql/star.sql
2021-11-03 14:38:03.877389 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 14:38:03.884129 (MainThread): Parsing macros/sql/union.sql
2021-11-03 14:38:03.891994 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 14:38:03.892898 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 14:38:03.895585 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 14:38:03.896548 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 14:38:03.897680 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 14:38:03.900165 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 14:38:03.903966 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 14:38:03.906767 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 14:38:04.061439 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 14:38:04.061674 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac30c310>]}
2021-11-03 14:38:04.184704 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:04.195378 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:04.199953 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:04.204772 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:04.211575 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:04.216244 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 14:38:04.219991 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 14:38:04.412328 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 14:38:04.417505 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 14:38:04.550656 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 14:38:04.557421 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac3a1940>]}
2021-11-03 14:38:04.568390 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac3e2b20>]}
2021-11-03 14:38:04.568751 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 14:38:04.570761 (MainThread): 
2021-11-03 14:38:04.571247 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:38:04.572370 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 14:38:04.582942 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 14:38:04.583149 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 14:38:04.583299 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 14:38:07.005291 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 2.42 seconds
2021-11-03 14:38:07.006569 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 14:38:07.008448 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:38:07.013679 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:38:07.013848 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 14:38:07.013967 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:38:08.637694 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.62 seconds
2021-11-03 14:38:08.637934 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:38:08.638089 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 14:38:08.652926 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-03 14:38:08.654135 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 14:38:08.655907 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 14:38:08.656486 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 14:38:08.658279 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:38:08.658470 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 14:38:08.658619 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:38:10.151167 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.49 seconds
2021-11-03 14:38:10.151480 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:38:10.151672 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 14:38:10.166538 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-03 14:38:10.167975 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 14:38:10.169243 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 14:38:10.169775 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 14:38:10.172215 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:38:10.172478 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 14:38:10.172654 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:38:11.405254 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.23 seconds
2021-11-03 14:38:11.405578 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:38:11.405779 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 14:38:11.426807 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.02 seconds
2021-11-03 14:38:11.429658 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 14:38:11.431822 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 14:38:11.477810 (MainThread): Using postgres connection "master".
2021-11-03 14:38:11.478027 (MainThread): On master: BEGIN
2021-11-03 14:38:11.478186 (MainThread): Opening a new connection, currently in state init
2021-11-03 14:38:12.972715 (MainThread): SQL status: BEGIN in 1.49 seconds
2021-11-03 14:38:12.972969 (MainThread): Using postgres connection "master".
2021-11-03 14:38:12.973113 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 14:38:13.102413 (MainThread): SQL status: SELECT 7 in 0.13 seconds
2021-11-03 14:38:13.104082 (MainThread): On master: ROLLBACK
2021-11-03 14:38:13.105451 (MainThread): Using postgres connection "master".
2021-11-03 14:38:13.105587 (MainThread): On master: BEGIN
2021-11-03 14:38:13.107609 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 14:38:13.107768 (MainThread): On master: COMMIT
2021-11-03 14:38:13.107887 (MainThread): Using postgres connection "master".
2021-11-03 14:38:13.107991 (MainThread): On master: COMMIT
2021-11-03 14:38:13.108967 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:13.109148 (MainThread): 20:08:13 | 
2021-11-03 14:38:13.109296 (MainThread): 20:08:13 | Running 1 on-run-start hook
2021-11-03 14:38:13.109432 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 14:38:13.111585 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 14:38:13.112954 (MainThread): 20:08:13 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 14:38:13.113155 (MainThread): Using postgres connection "master".
2021-11-03 14:38:13.113297 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-03 14:38:13.122474 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:38:13.123277 (MainThread): 20:08:13 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-03 14:38:13.123458 (MainThread): 20:08:13 | 
2021-11-03 14:38:13.123611 (MainThread): On master: Close
2021-11-03 14:38:13.123908 (MainThread): 20:08:13 | Concurrency: 1 threads (target='dev')
2021-11-03 14:38:13.124047 (MainThread): 20:08:13 | 
2021-11-03 14:38:13.126573 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 14:38:13.127021 (Thread-1): 20:08:13 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 14:38:13.127635 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:13.127901 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 14:38:13.131759 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 14:38:13.132925 (Thread-1): finished collecting timing info
2021-11-03 14:38:13.153467 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:13.153648 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 14:38:13.153771 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:38:16.571920 (Thread-1): SQL status: BEGIN in 3.42 seconds
2021-11-03 14:38:16.572159 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.572322 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:38:16.581351 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:38:16.587172 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 14:38:16.588002 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.588199 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 14:38:16.624723 (Thread-1): SQL status: SELECT 44 in 0.04 seconds
2021-11-03 14:38:16.632219 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.632446 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 14:38:16.635570 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:16.638093 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.638271 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 14:38:16.641111 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:16.646624 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.646832 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:38:16.649578 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:16.656153 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 14:38:16.656336 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.656471 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 14:38:16.657877 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:16.663043 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:38:16.663252 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 14:38:16.676168 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-03 14:38:16.677433 (Thread-1): finished collecting timing info
2021-11-03 14:38:16.677631 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 14:38:16.678033 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac2e89d0>]}
2021-11-03 14:38:16.678382 (Thread-1): 20:08:16 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 3.55s]
2021-11-03 14:38:16.678564 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 14:38:16.678742 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 14:38:16.679051 (Thread-1): 20:08:16 | 2 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 14:38:16.679342 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:16.679643 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 14:38:16.682123 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 14:38:16.683203 (Thread-1): finished collecting timing info
2021-11-03 14:38:16.687406 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 14:38:16.688424 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:16.688607 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 14:38:16.688799 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:38:18.672495 (Thread-1): SQL status: BEGIN in 1.98 seconds
2021-11-03 14:38:18.672890 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:18.673062 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '321e8d99-b647-475d-9109-1fb0dc78cdfb' as invocation_id
  );
2021-11-03 14:38:18.705114 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-03 14:38:18.707593 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:18.707768 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 14:38:18.709156 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:18.711963 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:18.712191 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 14:38:18.713870 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:18.715220 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 14:38:18.715432 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:18.715583 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 14:38:18.718896 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:18.720787 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:38:18.720971 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 14:38:18.745451 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-03 14:38:18.746703 (Thread-1): finished collecting timing info
2021-11-03 14:38:18.746916 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 14:38:18.747331 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac25f6a0>]}
2021-11-03 14:38:18.747721 (Thread-1): 20:08:18 | 2 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 2.07s]
2021-11-03 14:38:18.747909 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 14:38:18.748092 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:38:18.748518 (Thread-1): 20:08:18 | 3 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 14:38:18.749040 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:18.749290 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:38:18.753346 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 14:38:18.753992 (Thread-1): finished collecting timing info
2021-11-03 14:38:18.772435 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 14:38:18.773209 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:18.773385 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 14:38:18.773531 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:38:20.496978 (Thread-1): SQL status: BEGIN in 1.72 seconds
2021-11-03 14:38:20.497225 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:20.497379 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 14:38:20.514052 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-03 14:38:20.516709 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:20.516893 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 14:38:20.518699 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:20.521062 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:20.521224 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 14:38:20.522830 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:20.523876 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 14:38:20.524047 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:20.524177 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 14:38:20.527762 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:20.529617 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:38:20.529784 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 14:38:20.534866 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 14:38:20.536156 (Thread-1): finished collecting timing info
2021-11-03 14:38:20.536378 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 14:38:20.536810 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac25f9a0>]}
2021-11-03 14:38:20.537191 (Thread-1): 20:08:20 | 3 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.79s]
2021-11-03 14:38:20.537407 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:38:20.538082 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:38:20.538425 (Thread-1): 20:08:20 | 4 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 14:38:20.538763 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:20.538932 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:38:20.543017 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 14:38:20.544524 (Thread-1): finished collecting timing info
2021-11-03 14:38:20.549324 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 14:38:20.550132 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:20.550315 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 14:38:20.550464 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:38:22.226813 (Thread-1): SQL status: BEGIN in 1.68 seconds
2021-11-03 14:38:22.227125 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:22.227298 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 14:38:22.241141 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 14:38:22.244826 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:22.245184 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 14:38:22.249268 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:22.251309 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 14:38:22.251626 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:22.251858 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 14:38:22.261023 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:38:22.264553 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:38:22.264975 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 14:38:22.267723 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 14:38:22.269805 (Thread-1): finished collecting timing info
2021-11-03 14:38:22.270053 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 14:38:22.270650 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac2e89d0>]}
2021-11-03 14:38:22.271259 (Thread-1): 20:08:22 | 4 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.73s]
2021-11-03 14:38:22.271547 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:38:22.271831 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 14:38:22.272203 (Thread-1): 20:08:22 | 5 of 5 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-11-03 14:38:22.272814 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:22.273077 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 14:38:22.279901 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 14:38:22.281050 (Thread-1): finished collecting timing info
2021-11-03 14:38:22.286149 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 14:38:22.287924 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:22.288369 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-11-03 14:38:22.288654 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:38:23.679470 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-11-03 14:38:23.679716 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:23.679866 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 14:38:23.693644 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 14:38:23.696228 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:23.696418 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-11-03 14:38:23.698212 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:38:23.699359 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 14:38:23.699530 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:23.699670 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 14:38:23.702972 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:23.704830 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:38:23.705008 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-11-03 14:38:23.706699 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 14:38:23.707803 (Thread-1): finished collecting timing info
2021-11-03 14:38:23.708010 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-11-03 14:38:23.708416 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '321e8d99-b647-475d-9109-1fb0dc78cdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8abff76a0>]}
2021-11-03 14:38:23.708848 (Thread-1): 20:08:23 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.44s]
2021-11-03 14:38:23.709075 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 14:38:23.710524 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:38:23.710795 (MainThread): Using postgres connection "master".
2021-11-03 14:38:23.710952 (MainThread): On master: BEGIN
2021-11-03 14:38:23.711098 (MainThread): Opening a new connection, currently in state closed
2021-11-03 14:38:25.007844 (MainThread): SQL status: BEGIN in 1.30 seconds
2021-11-03 14:38:25.008085 (MainThread): On master: COMMIT
2021-11-03 14:38:25.008239 (MainThread): Using postgres connection "master".
2021-11-03 14:38:25.008379 (MainThread): On master: COMMIT
2021-11-03 14:38:25.009545 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:38:25.009753 (MainThread): 20:08:25 | 
2021-11-03 14:38:25.009944 (MainThread): 20:08:25 | Running 1 on-run-end hook
2021-11-03 14:38:25.010189 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 14:38:25.013059 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 14:38:25.014313 (MainThread): 20:08:25 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 14:38:25.014597 (MainThread): Using postgres connection "master".
2021-11-03 14:38:25.014767 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-03 14:38:25.021598 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:38:25.022502 (MainThread): 20:08:25 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 14:38:25.022757 (MainThread): 20:08:25 | 
2021-11-03 14:38:25.022965 (MainThread): On master: Close
2021-11-03 14:38:25.023495 (MainThread): 20:08:25 | 
2021-11-03 14:38:25.023758 (MainThread): 20:08:25 | Finished running 2 table models, 3 view models, 2 hooks in 20.45s.
2021-11-03 14:38:25.023952 (MainThread): Connection 'master' was properly closed.
2021-11-03 14:38:25.024151 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-11-03 14:38:25.037234 (MainThread): 
2021-11-03 14:38:25.037496 (MainThread): Completed successfully
2021-11-03 14:38:25.037693 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-03 14:38:25.037935 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac2015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac42e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ac20a9a0>]}
2021-11-03 14:38:25.038235 (MainThread): Flushing usage events
2021-11-03 14:42:17.006690 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 14:42:17.109996 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 14:42:17.112511 (MainThread): Tracking: tracking
2021-11-03 14:42:17.316129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c586a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c586ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c586aca0>]}
2021-11-03 14:42:17.338761 (MainThread): Partial parsing not enabled
2021-11-03 14:42:17.410790 (MainThread): Parsing macros/test_empty.sql
2021-11-03 14:42:17.412010 (MainThread): Parsing macros/audits.sql
2021-11-03 14:42:17.412842 (MainThread): Parsing macros/test_country.sql
2021-11-03 14:42:17.413537 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 14:42:17.414666 (MainThread): Parsing macros/catalog.sql
2021-11-03 14:42:17.418846 (MainThread): Parsing macros/relations.sql
2021-11-03 14:42:17.420683 (MainThread): Parsing macros/adapters.sql
2021-11-03 14:42:17.448709 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 14:42:17.450705 (MainThread): Parsing macros/core.sql
2021-11-03 14:42:17.455065 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 14:42:17.463206 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 14:42:17.474157 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 14:42:17.476004 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 14:42:17.492819 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 14:42:17.527369 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 14:42:17.548456 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 14:42:17.550402 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 14:42:17.560661 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 14:42:17.580701 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 14:42:17.597679 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 14:42:17.608809 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 14:42:17.617164 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 14:42:17.621935 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 14:42:17.622918 (MainThread): Parsing macros/etc/query.sql
2021-11-03 14:42:17.623967 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 14:42:17.625691 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 14:42:17.635816 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 14:42:17.638009 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 14:42:17.639878 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 14:42:17.699813 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 14:42:17.701602 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 14:42:17.702668 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 14:42:17.703843 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 14:42:17.706049 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 14:42:17.707089 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 14:42:17.708393 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 14:42:17.711465 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 14:42:17.717695 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 14:42:17.718766 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 14:42:17.719964 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 14:42:17.722184 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 14:42:17.723168 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 14:42:17.725286 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 14:42:17.735847 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 14:42:17.737778 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 14:42:17.739173 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 14:42:17.740692 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 14:42:17.742113 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 14:42:17.743183 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 14:42:17.746564 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 14:42:17.751875 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 14:42:17.752605 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 14:42:17.755209 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 14:42:17.756905 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 14:42:17.758273 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 14:42:17.760094 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 14:42:17.785560 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 14:42:17.786698 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 14:42:17.787768 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 14:42:17.788595 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 14:42:17.791592 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 14:42:17.792866 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 14:42:17.795279 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 14:42:17.796614 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 14:42:17.797473 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 14:42:17.798693 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 14:42:17.800691 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 14:42:17.801777 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 14:42:17.802803 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 14:42:17.805571 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 14:42:17.806602 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 14:42:17.809860 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 14:42:17.812400 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 14:42:17.813768 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 14:42:17.815536 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 14:42:17.819360 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 14:42:17.827146 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 14:42:17.828849 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 14:42:17.831704 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 14:42:17.835543 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 14:42:17.838163 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 14:42:17.839170 (MainThread): Parsing macros/sql/star.sql
2021-11-03 14:42:17.841713 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 14:42:17.848685 (MainThread): Parsing macros/sql/union.sql
2021-11-03 14:42:17.857319 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 14:42:17.858394 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 14:42:17.861405 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 14:42:17.862529 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 14:42:17.863785 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 14:42:17.866764 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 14:42:17.871112 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 14:42:17.875172 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 14:42:18.042290 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 14:42:18.042520 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c58fb460>]}
2021-11-03 14:42:18.155452 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:18.171528 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:18.176410 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:18.188614 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:18.198004 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:18.207112 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 14:42:18.212685 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 14:42:18.241346 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 14:42:18.246068 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 14:42:18.360112 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 14:42:18.365904 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c5aa1a00>]}
2021-11-03 14:42:18.376630 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c5aa1b50>]}
2021-11-03 14:42:18.377321 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 14:42:18.379347 (MainThread): 
2021-11-03 14:42:18.379822 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:42:18.380923 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 14:42:18.391153 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 14:42:18.391330 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 14:42:18.391476 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 14:42:22.089385 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 3.70 seconds
2021-11-03 14:42:22.091073 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 14:42:22.093264 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 14:42:22.099799 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:42:22.100002 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 14:42:22.100148 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:42:23.703517 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.60 seconds
2021-11-03 14:42:23.703747 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:42:23.703893 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 14:42:23.718150 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-03 14:42:23.719489 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 14:42:23.720754 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 14:42:23.721238 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 14:42:23.723809 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:42:23.724041 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 14:42:23.724317 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:42:25.366339 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.64 seconds
2021-11-03 14:42:25.366606 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:42:25.366761 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 14:42:25.384479 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-03 14:42:25.385885 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 14:42:25.387446 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 14:42:25.388058 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:42:25.424920 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:42:25.425143 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 14:42:25.425295 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:42:26.691505 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.27 seconds
2021-11-03 14:42:26.691747 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:42:26.691895 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 14:42:26.710090 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-03 14:42:26.711297 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 14:42:26.712453 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 14:42:26.718402 (MainThread): Using postgres connection "master".
2021-11-03 14:42:26.718617 (MainThread): On master: BEGIN
2021-11-03 14:42:26.718766 (MainThread): Opening a new connection, currently in state init
2021-11-03 14:42:28.309954 (MainThread): SQL status: BEGIN in 1.59 seconds
2021-11-03 14:42:28.310194 (MainThread): Using postgres connection "master".
2021-11-03 14:42:28.310352 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 14:42:28.452485 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-11-03 14:42:28.453723 (MainThread): On master: ROLLBACK
2021-11-03 14:42:28.455017 (MainThread): Using postgres connection "master".
2021-11-03 14:42:28.455154 (MainThread): On master: BEGIN
2021-11-03 14:42:28.456925 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 14:42:28.457072 (MainThread): On master: COMMIT
2021-11-03 14:42:28.457190 (MainThread): Using postgres connection "master".
2021-11-03 14:42:28.457293 (MainThread): On master: COMMIT
2021-11-03 14:42:28.458161 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:28.458312 (MainThread): 20:12:28 | 
2021-11-03 14:42:28.458457 (MainThread): 20:12:28 | Running 1 on-run-start hook
2021-11-03 14:42:28.458590 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 14:42:28.460609 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 14:42:28.462567 (MainThread): 20:12:28 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 14:42:28.462762 (MainThread): Using postgres connection "master".
2021-11-03 14:42:28.462945 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-03 14:42:28.471353 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:28.472147 (MainThread): 20:12:28 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-03 14:42:28.472345 (MainThread): 20:12:28 | 
2021-11-03 14:42:28.472536 (MainThread): On master: Close
2021-11-03 14:42:28.472881 (MainThread): 20:12:28 | Concurrency: 1 threads (target='dev')
2021-11-03 14:42:28.473095 (MainThread): 20:12:28 | 
2021-11-03 14:42:28.475520 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 14:42:28.475931 (Thread-1): 20:12:28 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 14:42:28.476624 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:28.476977 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 14:42:28.481459 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 14:42:28.482430 (Thread-1): finished collecting timing info
2021-11-03 14:42:28.506751 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:28.506978 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 14:42:28.507135 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:42:30.029914 (Thread-1): SQL status: BEGIN in 1.52 seconds
2021-11-03 14:42:30.030160 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.030309 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:30.036655 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:30.042526 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 14:42:30.043211 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.043381 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 14:42:30.068770 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-03 14:42:30.075133 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.075341 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 14:42:30.078216 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:30.080768 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.080965 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 14:42:30.083170 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:30.088599 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.088800 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:30.091768 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:30.098724 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 14:42:30.098953 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.099106 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 14:42:30.101325 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:30.106710 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:42:30.106919 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 14:42:30.118940 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-03 14:42:30.120161 (Thread-1): finished collecting timing info
2021-11-03 14:42:30.120371 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 14:42:30.120793 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c58a0100>]}
2021-11-03 14:42:30.121179 (Thread-1): 20:12:30 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.64s]
2021-11-03 14:42:30.121384 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 14:42:30.121658 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 14:42:30.122022 (Thread-1): 20:12:30 | 2 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 14:42:30.122339 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:30.122500 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 14:42:30.127309 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 14:42:30.128259 (Thread-1): finished collecting timing info
2021-11-03 14:42:30.131033 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 14:42:30.132037 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:30.132213 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 14:42:30.132361 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:42:31.327698 (Thread-1): SQL status: BEGIN in 1.20 seconds
2021-11-03 14:42:31.327949 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:31.328166 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d' as invocation_id
  );
2021-11-03 14:42:31.366799 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-11-03 14:42:31.369369 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:31.369553 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 14:42:31.371235 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:31.374071 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:31.374383 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 14:42:31.376690 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:31.378841 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 14:42:31.379193 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:31.379446 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 14:42:31.385340 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:31.387967 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:42:31.388214 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 14:42:31.416658 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-11-03 14:42:31.417901 (Thread-1): finished collecting timing info
2021-11-03 14:42:31.418121 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 14:42:31.418535 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c5ad43d0>]}
2021-11-03 14:42:31.418933 (Thread-1): 20:12:31 | 2 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.30s]
2021-11-03 14:42:31.419127 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 14:42:31.419318 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:42:31.419671 (Thread-1): 20:12:31 | 3 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 14:42:31.420024 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:31.420196 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:42:31.425825 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 14:42:31.426532 (Thread-1): finished collecting timing info
2021-11-03 14:42:31.443286 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:31.443504 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 14:42:31.443653 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:42:32.822968 (Thread-1): SQL status: BEGIN in 1.38 seconds
2021-11-03 14:42:32.823281 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.823451 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:32.829260 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:32.834169 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 14:42:32.834794 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.834954 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 14:42:32.871247 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-11-03 14:42:32.874218 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.874434 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 14:42:32.877699 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:32.880146 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.880323 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 14:42:32.883246 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:32.884717 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.884889 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:32.887762 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:32.888690 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 14:42:32.888981 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.889150 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 14:42:32.890587 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:32.892669 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:42:32.892862 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 14:42:32.900115 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-03 14:42:32.901394 (Thread-1): finished collecting timing info
2021-11-03 14:42:32.901623 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 14:42:32.902171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c58a0100>]}
2021-11-03 14:42:32.902596 (Thread-1): 20:12:32 | 3 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.48s]
2021-11-03 14:42:32.902905 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:42:32.903601 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:42:32.903972 (Thread-1): 20:12:32 | 4 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 14:42:32.904364 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:32.904555 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:42:32.912581 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 14:42:32.913257 (Thread-1): finished collecting timing info
2021-11-03 14:42:32.916251 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:32.916507 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 14:42:32.916665 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:42:34.257104 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-11-03 14:42:34.257493 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:34.257647 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:34.265050 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:34.266463 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 14:42:34.267284 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:34.267451 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 14:42:34.284064 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-03 14:42:34.286850 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:34.287067 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 14:42:34.290212 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:34.292103 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:34.292421 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:34.296498 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:34.297951 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 14:42:34.298234 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:34.298461 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 14:42:34.300682 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:34.303612 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:42:34.303941 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 14:42:34.306264 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 14:42:34.307933 (Thread-1): finished collecting timing info
2021-11-03 14:42:34.308221 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 14:42:34.308691 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c584b9a0>]}
2021-11-03 14:42:34.309088 (Thread-1): 20:12:34 | 4 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.40s]
2021-11-03 14:42:34.309357 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:42:34.309631 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 14:42:34.309984 (Thread-1): 20:12:34 | 5 of 5 START view model dbtdemo.cust_details_ord_counts copy......... [RUN]
2021-11-03 14:42:34.310341 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:34.310513 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 14:42:34.315610 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 14:42:34.316398 (Thread-1): finished collecting timing info
2021-11-03 14:42:34.319052 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:34.319333 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: BEGIN
2021-11-03 14:42:34.319506 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:42:35.525717 (Thread-1): SQL status: BEGIN in 1.21 seconds
2021-11-03 14:42:35.525975 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:35.526125 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:35.532232 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:35.533572 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts copy"
2021-11-03 14:42:35.534246 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:35.534408 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 14:42:35.553142 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-03 14:42:35.555642 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:35.555891 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_tmp" rename to "cust_details_ord_counts copy"
2021-11-03 14:42:35.558791 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:42:35.560123 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:35.560290 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:42:35.563176 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:35.563988 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 14:42:35.564161 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:35.564303 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: COMMIT
2021-11-03 14:42:35.566038 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:35.567906 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts copy".
2021-11-03 14:42:35.568081 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts copy"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts copy__dbt_backup" cascade
2021-11-03 14:42:35.569662 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 14:42:35.570883 (Thread-1): finished collecting timing info
2021-11-03 14:42:35.571088 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts copy: Close
2021-11-03 14:42:35.571489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0cdb968-ce2a-4b8b-a09b-9ab4dc50ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c57f5430>]}
2021-11-03 14:42:35.571860 (Thread-1): 20:12:35 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts copy.... [CREATE VIEW in 1.26s]
2021-11-03 14:42:35.572054 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts copy
2021-11-03 14:42:35.573134 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:42:35.573363 (MainThread): Using postgres connection "master".
2021-11-03 14:42:35.573511 (MainThread): On master: BEGIN
2021-11-03 14:42:35.573652 (MainThread): Opening a new connection, currently in state closed
2021-11-03 14:42:37.015998 (MainThread): SQL status: BEGIN in 1.44 seconds
2021-11-03 14:42:37.016329 (MainThread): On master: COMMIT
2021-11-03 14:42:37.016495 (MainThread): Using postgres connection "master".
2021-11-03 14:42:37.016627 (MainThread): On master: COMMIT
2021-11-03 14:42:37.017824 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:42:37.018019 (MainThread): 20:12:37 | 
2021-11-03 14:42:37.018201 (MainThread): 20:12:37 | Running 1 on-run-end hook
2021-11-03 14:42:37.018365 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 14:42:37.020889 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 14:42:37.021757 (MainThread): 20:12:37 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 14:42:37.021999 (MainThread): Using postgres connection "master".
2021-11-03 14:42:37.022208 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-03 14:42:37.029023 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:42:37.029886 (MainThread): 20:12:37 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 14:42:37.030106 (MainThread): 20:12:37 | 
2021-11-03 14:42:37.030296 (MainThread): On master: Close
2021-11-03 14:42:37.030719 (MainThread): 20:12:37 | 
2021-11-03 14:42:37.030903 (MainThread): 20:12:37 | Finished running 2 table models, 3 view models, 2 hooks in 18.65s.
2021-11-03 14:42:37.031109 (MainThread): Connection 'master' was properly closed.
2021-11-03 14:42:37.031316 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts copy' was properly closed.
2021-11-03 14:42:37.043477 (MainThread): 
2021-11-03 14:42:37.043757 (MainThread): Completed successfully
2021-11-03 14:42:37.043981 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-03 14:42:37.044287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c5ad3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c309c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0c5af8460>]}
2021-11-03 14:42:37.044559 (MainThread): Flushing usage events
2021-11-03 14:46:03.246525 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 14:46:03.384746 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 14:46:03.387249 (MainThread): Tracking: tracking
2021-11-03 14:46:03.405230 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0855df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a08006a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0800e50>]}
2021-11-03 14:46:03.429748 (MainThread): Partial parsing not enabled
2021-11-03 14:46:03.506745 (MainThread): Parsing macros/test_empty.sql
2021-11-03 14:46:03.507756 (MainThread): Parsing macros/audits.sql
2021-11-03 14:46:03.508591 (MainThread): Parsing macros/test_country.sql
2021-11-03 14:46:03.509282 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 14:46:03.510735 (MainThread): Parsing macros/catalog.sql
2021-11-03 14:46:03.514769 (MainThread): Parsing macros/relations.sql
2021-11-03 14:46:03.516578 (MainThread): Parsing macros/adapters.sql
2021-11-03 14:46:03.546497 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 14:46:03.548635 (MainThread): Parsing macros/core.sql
2021-11-03 14:46:03.553528 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 14:46:03.562069 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 14:46:03.574860 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 14:46:03.578843 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 14:46:03.602134 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 14:46:03.638948 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 14:46:03.659497 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 14:46:03.661491 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 14:46:03.671243 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 14:46:03.692663 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 14:46:03.707094 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 14:46:03.716468 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 14:46:03.724386 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 14:46:03.728115 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 14:46:03.728910 (MainThread): Parsing macros/etc/query.sql
2021-11-03 14:46:03.729769 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 14:46:03.731135 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 14:46:03.741988 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 14:46:03.744215 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 14:46:03.745684 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 14:46:03.805867 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 14:46:03.807696 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 14:46:03.808748 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 14:46:03.809922 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 14:46:03.811950 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 14:46:03.812950 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 14:46:03.814264 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 14:46:03.816347 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 14:46:03.823345 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 14:46:03.824440 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 14:46:03.825946 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 14:46:03.828711 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 14:46:03.829780 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 14:46:03.831908 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 14:46:03.842538 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 14:46:03.844475 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 14:46:03.845808 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 14:46:03.847344 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 14:46:03.848814 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 14:46:03.849772 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 14:46:03.853754 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 14:46:03.863048 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 14:46:03.863876 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 14:46:03.867241 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 14:46:03.868980 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 14:46:03.870589 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 14:46:03.872523 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 14:46:03.896070 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 14:46:03.896956 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 14:46:03.897913 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 14:46:03.898615 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 14:46:03.902439 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 14:46:03.904601 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 14:46:03.907453 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 14:46:03.909306 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 14:46:03.910929 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 14:46:03.913286 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 14:46:03.916476 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 14:46:03.918562 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 14:46:03.920845 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 14:46:03.922701 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 14:46:03.923587 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 14:46:03.926987 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 14:46:03.928539 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 14:46:03.929513 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 14:46:03.930762 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 14:46:03.933931 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 14:46:03.940238 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 14:46:03.941332 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 14:46:03.943655 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 14:46:03.946768 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 14:46:03.949500 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 14:46:03.950885 (MainThread): Parsing macros/sql/star.sql
2021-11-03 14:46:03.954288 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 14:46:03.960634 (MainThread): Parsing macros/sql/union.sql
2021-11-03 14:46:03.969266 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 14:46:03.970338 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 14:46:03.973618 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 14:46:03.974731 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 14:46:03.976015 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 14:46:03.979096 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 14:46:03.983635 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 14:46:03.987436 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 14:46:04.166260 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 14:46:04.166522 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0b10f10>]}
2021-11-03 14:46:04.334423 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:04.350633 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:04.354730 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:04.361484 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:04.368232 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 14:46:04.372300 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 14:46:04.398142 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 14:46:04.402355 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 14:46:04.519341 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 14:46:04.526145 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0b66be0>]}
2021-11-03 14:46:04.537129 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0be3d00>]}
2021-11-03 14:46:04.537540 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 14:46:04.539546 (MainThread): 
2021-11-03 14:46:04.540042 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:46:04.541083 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 14:46:04.551519 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 14:46:04.551729 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 14:46:04.551884 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 14:46:06.129926 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 1.58 seconds
2021-11-03 14:46:06.131450 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 14:46:06.133544 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 14:46:06.140557 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:46:06.140766 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 14:46:06.140916 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:46:07.517561 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.38 seconds
2021-11-03 14:46:07.517795 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 14:46:07.517942 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 14:46:07.532188 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-03 14:46:07.533551 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 14:46:07.535033 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 14:46:07.535620 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 14:46:07.537595 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:46:07.537775 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 14:46:07.537918 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:46:09.097904 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.56 seconds
2021-11-03 14:46:09.098153 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 14:46:09.098301 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 14:46:09.112485 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-03 14:46:09.113892 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 14:46:09.115265 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 14:46:09.115772 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:46:09.117678 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:46:09.117847 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 14:46:09.117991 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 14:46:10.446971 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.33 seconds
2021-11-03 14:46:10.447367 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 14:46:10.447630 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 14:46:10.472969 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.03 seconds
2021-11-03 14:46:10.475719 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 14:46:10.478089 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 14:46:10.527690 (MainThread): Using postgres connection "master".
2021-11-03 14:46:10.527991 (MainThread): On master: BEGIN
2021-11-03 14:46:10.528216 (MainThread): Opening a new connection, currently in state init
2021-11-03 14:46:12.055893 (MainThread): SQL status: BEGIN in 1.53 seconds
2021-11-03 14:46:12.056127 (MainThread): Using postgres connection "master".
2021-11-03 14:46:12.056276 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 14:46:12.278568 (MainThread): SQL status: SELECT 7 in 0.22 seconds
2021-11-03 14:46:12.280053 (MainThread): On master: ROLLBACK
2021-11-03 14:46:12.282003 (MainThread): Using postgres connection "master".
2021-11-03 14:46:12.282241 (MainThread): On master: BEGIN
2021-11-03 14:46:12.285628 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 14:46:12.285893 (MainThread): On master: COMMIT
2021-11-03 14:46:12.286051 (MainThread): Using postgres connection "master".
2021-11-03 14:46:12.286191 (MainThread): On master: COMMIT
2021-11-03 14:46:12.287704 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:12.287898 (MainThread): 20:16:12 | 
2021-11-03 14:46:12.288086 (MainThread): 20:16:12 | Running 1 on-run-start hook
2021-11-03 14:46:12.288261 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 14:46:12.290900 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 14:46:12.293647 (MainThread): 20:16:12 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 14:46:12.293981 (MainThread): Using postgres connection "master".
2021-11-03 14:46:12.294217 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-03 14:46:12.307271 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:46:12.308183 (MainThread): 20:16:12 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-03 14:46:12.308420 (MainThread): 20:16:12 | 
2021-11-03 14:46:12.308618 (MainThread): On master: Close
2021-11-03 14:46:12.308997 (MainThread): 20:16:12 | Concurrency: 1 threads (target='dev')
2021-11-03 14:46:12.309186 (MainThread): 20:16:12 | 
2021-11-03 14:46:12.311629 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 14:46:12.312115 (Thread-1): 20:16:12 | 1 of 4 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 14:46:12.312620 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:12.312975 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 14:46:12.318260 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 14:46:12.318940 (Thread-1): finished collecting timing info
2021-11-03 14:46:12.342899 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:12.343162 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 14:46:12.343336 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:46:14.011478 (Thread-1): SQL status: BEGIN in 1.67 seconds
2021-11-03 14:46:14.011719 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.011866 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:46:14.017838 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:46:14.023692 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 14:46:14.024424 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.024605 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 14:46:14.055553 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-03 14:46:14.065367 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.065606 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 14:46:14.069336 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:14.072017 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.072232 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 14:46:14.075337 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:14.081640 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.081871 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 14:46:14.085598 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:14.094447 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 14:46:14.094684 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.094841 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 14:46:14.096560 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:14.101708 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 14:46:14.101906 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 14:46:14.115825 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-03 14:46:14.117157 (Thread-1): finished collecting timing info
2021-11-03 14:46:14.117391 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 14:46:14.117900 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0b6a100>]}
2021-11-03 14:46:14.118509 (Thread-1): 20:16:14 | 1 of 4 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.81s]
2021-11-03 14:46:14.118809 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 14:46:14.119325 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 14:46:14.119979 (Thread-1): 20:16:14 | 2 of 4 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 14:46:14.120524 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:14.120729 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 14:46:14.124974 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 14:46:14.125859 (Thread-1): finished collecting timing info
2021-11-03 14:46:14.131705 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 14:46:14.132511 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:14.132685 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 14:46:14.132865 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:46:15.661043 (Thread-1): SQL status: BEGIN in 1.53 seconds
2021-11-03 14:46:15.661282 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:15.661433 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '80419bec-3ef1-44dd-b46b-43e41f4a64ce' as invocation_id
  );
2021-11-03 14:46:15.706338 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-11-03 14:46:15.710004 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:15.710263 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 14:46:15.712219 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:15.714644 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:15.714817 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 14:46:15.716520 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:15.718000 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 14:46:15.718184 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:15.718326 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 14:46:15.722062 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:15.724077 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 14:46:15.724270 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 14:46:15.749837 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-11-03 14:46:15.751216 (Thread-1): finished collecting timing info
2021-11-03 14:46:15.751441 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 14:46:15.751862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a07f5e50>]}
2021-11-03 14:46:15.752241 (Thread-1): 20:16:15 | 2 of 4 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.63s]
2021-11-03 14:46:15.752444 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 14:46:15.752638 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:46:15.753063 (Thread-1): 20:16:15 | 3 of 4 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 14:46:15.753446 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:15.753679 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:46:15.758699 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 14:46:15.759371 (Thread-1): finished collecting timing info
2021-11-03 14:46:15.775042 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:15.775507 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 14:46:15.775814 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:46:17.086650 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-11-03 14:46:17.086908 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.087058 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-03 14:46:17.093239 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:46:17.097803 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 14:46:17.098555 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.098724 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 14:46:17.118608 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-03 14:46:17.121420 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.121608 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 14:46:17.124044 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:17.127643 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.127882 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 14:46:17.131175 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:17.132499 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.132665 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-03 14:46:17.135312 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:17.136408 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 14:46:17.136599 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.136750 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 14:46:17.138318 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:17.140290 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 14:46:17.140483 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 14:46:17.146704 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-03 14:46:17.147982 (Thread-1): finished collecting timing info
2021-11-03 14:46:17.148212 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 14:46:17.148630 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0749dc0>]}
2021-11-03 14:46:17.149004 (Thread-1): 20:16:17 | 3 of 4 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.40s]
2021-11-03 14:46:17.149198 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 14:46:17.150097 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:46:17.150536 (Thread-1): 20:16:17 | 4 of 4 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 14:46:17.151089 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:17.151323 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:46:17.157368 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 14:46:17.158520 (Thread-1): finished collecting timing info
2021-11-03 14:46:17.164429 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:17.164691 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 14:46:17.164853 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 14:46:18.611759 (Thread-1): SQL status: BEGIN in 1.45 seconds
2021-11-03 14:46:18.612008 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:18.612209 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-03 14:46:18.617539 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:46:18.618868 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 14:46:18.619618 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:18.619809 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 14:46:18.631504 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 14:46:18.634057 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:18.634247 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 14:46:18.638222 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 14:46:18.639651 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:18.639832 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-03 14:46:18.643091 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:18.644118 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 14:46:18.644338 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:18.644492 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 14:46:18.646156 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:18.648090 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 14:46:18.648273 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 14:46:18.649922 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 14:46:18.651030 (Thread-1): finished collecting timing info
2021-11-03 14:46:18.651238 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 14:46:18.651682 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80419bec-3ef1-44dd-b46b-43e41f4a64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a07efb80>]}
2021-11-03 14:46:18.652079 (Thread-1): 20:16:18 | 4 of 4 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.50s]
2021-11-03 14:46:18.652383 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 14:46:18.653626 (MainThread): Acquiring new postgres connection "master".
2021-11-03 14:46:18.653894 (MainThread): Using postgres connection "master".
2021-11-03 14:46:18.654054 (MainThread): On master: BEGIN
2021-11-03 14:46:18.654246 (MainThread): Opening a new connection, currently in state closed
2021-11-03 14:46:20.259950 (MainThread): SQL status: BEGIN in 1.61 seconds
2021-11-03 14:46:20.260216 (MainThread): On master: COMMIT
2021-11-03 14:46:20.260376 (MainThread): Using postgres connection "master".
2021-11-03 14:46:20.260516 (MainThread): On master: COMMIT
2021-11-03 14:46:20.261887 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 14:46:20.262103 (MainThread): 20:16:20 | 
2021-11-03 14:46:20.262314 (MainThread): 20:16:20 | Running 1 on-run-end hook
2021-11-03 14:46:20.262486 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 14:46:20.265469 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 14:46:20.266448 (MainThread): 20:16:20 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 14:46:20.266704 (MainThread): Using postgres connection "master".
2021-11-03 14:46:20.266858 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-03 14:46:20.273927 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 14:46:20.274837 (MainThread): 20:16:20 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 14:46:20.275069 (MainThread): 20:16:20 | 
2021-11-03 14:46:20.275268 (MainThread): On master: Close
2021-11-03 14:46:20.275772 (MainThread): 20:16:20 | 
2021-11-03 14:46:20.275981 (MainThread): 20:16:20 | Finished running 2 table models, 2 view models, 2 hooks in 15.74s.
2021-11-03 14:46:20.276195 (MainThread): Connection 'master' was properly closed.
2021-11-03 14:46:20.276415 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-03 14:46:20.285897 (MainThread): 
2021-11-03 14:46:20.286474 (MainThread): Completed successfully
2021-11-03 14:46:20.286900 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-11-03 14:46:20.287448 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0767f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0bb8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a08008b0>]}
2021-11-03 14:46:20.287918 (MainThread): Flushing usage events
2021-11-03 18:10:44.311964 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 18:10:44.505396 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 18:10:44.508264 (MainThread): Tracking: tracking
2021-11-03 18:10:44.953566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67902af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67902a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67902aca0>]}
2021-11-03 18:10:44.983829 (MainThread): Partial parsing not enabled
2021-11-03 18:10:45.063534 (MainThread): Parsing macros/test_empty.sql
2021-11-03 18:10:45.064320 (MainThread): Parsing macros/audits.sql
2021-11-03 18:10:45.064949 (MainThread): Parsing macros/test_country.sql
2021-11-03 18:10:45.065472 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 18:10:45.066492 (MainThread): Parsing macros/catalog.sql
2021-11-03 18:10:45.070952 (MainThread): Parsing macros/relations.sql
2021-11-03 18:10:45.072599 (MainThread): Parsing macros/adapters.sql
2021-11-03 18:10:45.109300 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 18:10:45.111922 (MainThread): Parsing macros/core.sql
2021-11-03 18:10:45.119033 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 18:10:45.128214 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 18:10:45.143465 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 18:10:45.146688 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 18:10:45.174962 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 18:10:45.214910 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 18:10:45.247270 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 18:10:45.251575 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 18:10:45.265149 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 18:10:45.289185 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 18:10:45.305246 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 18:10:45.317383 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 18:10:45.326786 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 18:10:45.332968 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 18:10:45.335344 (MainThread): Parsing macros/etc/query.sql
2021-11-03 18:10:45.337425 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 18:10:45.340003 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 18:10:45.353666 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 18:10:45.356510 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 18:10:45.359303 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 18:10:45.446937 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 18:10:45.449569 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 18:10:45.451267 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 18:10:45.453557 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 18:10:45.456859 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 18:10:45.458366 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 18:10:45.462213 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 18:10:45.466268 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 18:10:45.474723 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 18:10:45.476374 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 18:10:45.478780 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 18:10:45.481934 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 18:10:45.483591 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 18:10:45.486877 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 18:10:45.501637 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 18:10:45.504545 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 18:10:45.508155 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 18:10:45.514635 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 18:10:45.518143 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 18:10:45.520508 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 18:10:45.530027 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 18:10:45.537699 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 18:10:45.538813 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 18:10:45.542631 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 18:10:45.545916 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 18:10:45.549440 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 18:10:45.553600 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 18:10:45.590672 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 18:10:45.591831 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 18:10:45.593333 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 18:10:45.594713 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 18:10:45.600093 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 18:10:45.601786 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 18:10:45.604429 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 18:10:45.605787 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 18:10:45.606968 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 18:10:45.609027 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 18:10:45.612460 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 18:10:45.614192 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 18:10:45.615494 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 18:10:45.617440 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 18:10:45.618646 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 18:10:45.621632 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 18:10:45.623313 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 18:10:45.624546 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 18:10:45.626110 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 18:10:45.630239 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 18:10:45.637753 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 18:10:45.639195 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 18:10:45.643343 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 18:10:45.648094 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 18:10:45.651596 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 18:10:45.652893 (MainThread): Parsing macros/sql/star.sql
2021-11-03 18:10:45.656397 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 18:10:45.666666 (MainThread): Parsing macros/sql/union.sql
2021-11-03 18:10:45.677302 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 18:10:45.678396 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 18:10:45.681789 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 18:10:45.682970 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 18:10:45.684654 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 18:10:45.688039 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 18:10:45.693969 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 18:10:45.697512 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 18:10:45.906632 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 18:10:45.906883 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6790bd460>]}
2021-11-03 18:10:46.031795 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:10:46.046630 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:10:46.049703 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:10:46.059983 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:10:46.067107 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:10:46.074397 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 18:10:46.078275 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 18:10:46.102037 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 18:10:46.106927 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 18:10:46.206565 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 18:10:46.212144 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd679246be0>]}
2021-11-03 18:10:46.221199 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67921d340>]}
2021-11-03 18:10:46.221502 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 18:10:46.223436 (MainThread): 
2021-11-03 18:10:46.223874 (MainThread): Acquiring new postgres connection "master".
2021-11-03 18:10:46.224964 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 18:10:46.234967 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 18:10:46.235153 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 18:10:46.235297 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 18:10:55.623539 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 9.39 seconds
2021-11-03 18:10:55.625114 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-03 18:10:55.627901 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-03 18:10:55.634638 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 18:10:55.634835 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-03 18:10:55.634979 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 18:10:57.793240 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.16 seconds
2021-11-03 18:10:57.793486 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-03 18:10:57.793656 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-03 18:10:57.814709 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-03 18:10:57.816146 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-03 18:10:57.817769 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-03 18:10:57.818324 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-03 18:10:57.860241 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 18:10:57.860453 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-03 18:10:57.860601 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 18:10:59.496141 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.64 seconds
2021-11-03 18:10:59.496378 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-03 18:10:59.496526 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-03 18:10:59.513241 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-03 18:10:59.514623 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-03 18:10:59.516004 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-03 18:10:59.516549 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-03 18:10:59.518231 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 18:10:59.518398 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-03 18:10:59.518550 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-03 18:11:01.202607 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.68 seconds
2021-11-03 18:11:01.202839 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-03 18:11:01.202986 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-03 18:11:01.221932 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-03 18:11:01.223327 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-03 18:11:01.225507 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-03 18:11:01.233192 (MainThread): Using postgres connection "master".
2021-11-03 18:11:01.233539 (MainThread): On master: BEGIN
2021-11-03 18:11:01.233874 (MainThread): Opening a new connection, currently in state init
2021-11-03 18:11:03.357490 (MainThread): SQL status: BEGIN in 2.12 seconds
2021-11-03 18:11:03.358003 (MainThread): Using postgres connection "master".
2021-11-03 18:11:03.358267 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-03 18:11:03.564676 (MainThread): SQL status: SELECT 5 in 0.21 seconds
2021-11-03 18:11:03.566328 (MainThread): On master: ROLLBACK
2021-11-03 18:11:03.568562 (MainThread): Using postgres connection "master".
2021-11-03 18:11:03.568878 (MainThread): On master: BEGIN
2021-11-03 18:11:03.573229 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-03 18:11:03.573868 (MainThread): On master: COMMIT
2021-11-03 18:11:03.574231 (MainThread): Using postgres connection "master".
2021-11-03 18:11:03.574420 (MainThread): On master: COMMIT
2021-11-03 18:11:03.576850 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:03.577131 (MainThread): 23:41:03 | 
2021-11-03 18:11:03.577327 (MainThread): 23:41:03 | Running 1 on-run-start hook
2021-11-03 18:11:03.577589 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-03 18:11:03.581089 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-03 18:11:03.586896 (MainThread): 23:41:03 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-03 18:11:03.587350 (MainThread): Using postgres connection "master".
2021-11-03 18:11:03.587604 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-03 18:11:03.613550 (MainThread): SQL status: COMMIT in 0.03 seconds
2021-11-03 18:11:03.615208 (MainThread): 23:41:03 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.03s]
2021-11-03 18:11:03.615782 (MainThread): 23:41:03 | 
2021-11-03 18:11:03.616123 (MainThread): On master: Close
2021-11-03 18:11:03.617041 (MainThread): 23:41:03 | Concurrency: 1 threads (target='dev')
2021-11-03 18:11:03.617434 (MainThread): 23:41:03 | 
2021-11-03 18:11:03.626396 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-03 18:11:03.627213 (Thread-1): 23:41:03 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-03 18:11:03.628104 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:03.628481 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-03 18:11:03.636605 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 18:11:03.638175 (Thread-1): finished collecting timing info
2021-11-03 18:11:03.679374 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:03.679713 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-03 18:11:03.679968 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 18:11:06.396803 (Thread-1): SQL status: BEGIN in 2.72 seconds
2021-11-03 18:11:06.397426 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.397806 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 18:11:06.413725 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-11-03 18:11:06.421252 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-03 18:11:06.422286 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.422600 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-03 18:11:06.455097 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-03 18:11:06.465043 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.465447 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-03 18:11:06.475413 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-03 18:11:06.481255 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.481597 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-03 18:11:06.488097 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-03 18:11:06.495901 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.496127 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-03 18:11:06.499881 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:06.507065 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 18:11:06.507296 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.507442 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-03 18:11:06.509060 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:06.515578 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:11:06.515787 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-03 18:11:06.559682 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-11-03 18:11:06.560888 (Thread-1): finished collecting timing info
2021-11-03 18:11:06.561514 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-03 18:11:06.561939 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6790f69d0>]}
2021-11-03 18:11:06.562481 (Thread-1): 23:41:06 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 2.93s]
2021-11-03 18:11:06.562833 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-03 18:11:06.563108 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-03 18:11:06.563452 (Thread-1): 23:41:06 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-03 18:11:06.563938 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:11:06.564172 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-03 18:11:06.568636 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-03 18:11:06.569216 (Thread-1): finished collecting timing info
2021-11-03 18:11:06.600243 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:11:06.600539 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-03 18:11:06.600663 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 18:11:08.015661 (Thread-1): SQL status: BEGIN in 1.41 seconds
2021-11-03 18:11:08.015922 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:11:08.016075 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','INCR_LOAD');
    commit;
      
2021-11-03 18:11:08.022329 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 18:11:08.023708 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-03 18:11:08.024409 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:11:08.024581 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

  create  table "postgres"."dbtdemo"."incr_load"
  as (
    

     select *,current_timestamp from events
     
  );
  
2021-11-03 18:11:08.045326 (Thread-1): SQL status: SELECT 100 in 0.02 seconds
2021-11-03 18:11:08.047483 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:11:08.047726 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','INCR_LOAD');
    commit;
      
2021-11-03 18:11:08.051645 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:08.053194 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-03 18:11:08.053412 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:11:08.053572 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-03 18:11:08.056490 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:08.057140 (Thread-1): finished collecting timing info
2021-11-03 18:11:08.057385 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-03 18:11:08.057932 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd678fcaac0>]}
2021-11-03 18:11:08.058689 (Thread-1): 23:41:08 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [SELECT 100 in 1.49s]
2021-11-03 18:11:08.059217 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-03 18:11:08.059534 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-03 18:11:08.060096 (Thread-1): 23:41:08 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-03 18:11:08.060546 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:08.060729 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-03 18:11:08.064136 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 18:11:08.065248 (Thread-1): finished collecting timing info
2021-11-03 18:11:08.067992 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-03 18:11:08.068990 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:08.069162 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-03 18:11:08.069304 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 18:11:09.886145 (Thread-1): SQL status: BEGIN in 1.82 seconds
2021-11-03 18:11:09.886464 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:09.886629 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '20514c61-3d85-4002-9bba-266a08831c85' as invocation_id
  );
2021-11-03 18:11:09.915576 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-03 18:11:09.918063 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:09.918224 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-03 18:11:09.919579 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 18:11:09.921769 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:09.921939 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-03 18:11:09.923426 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 18:11:09.924758 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 18:11:09.924919 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:09.925053 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-03 18:11:09.928376 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:09.930081 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:11:09.930232 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-03 18:11:09.949532 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-03 18:11:09.950477 (Thread-1): finished collecting timing info
2021-11-03 18:11:09.950633 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-03 18:11:09.950947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67933e1f0>]}
2021-11-03 18:11:09.951229 (Thread-1): 23:41:09 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.89s]
2021-11-03 18:11:09.951453 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-03 18:11:09.951615 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 18:11:09.951886 (Thread-1): 23:41:09 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-03 18:11:09.952203 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:09.952387 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-03 18:11:09.955833 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 18:11:09.956304 (Thread-1): finished collecting timing info
2021-11-03 18:11:09.969378 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:09.969547 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-03 18:11:09.969656 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 18:11:11.534401 (Thread-1): SQL status: BEGIN in 1.56 seconds
2021-11-03 18:11:11.534636 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.534783 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-03 18:11:11.540638 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 18:11:11.545338 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-03 18:11:11.546038 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.546196 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-03 18:11:11.563674 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-03 18:11:11.566188 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.566347 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-03 18:11:11.568809 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 18:11:11.570941 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.571091 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-03 18:11:11.573463 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 18:11:11.574605 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.574761 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-03 18:11:11.577211 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:11.577960 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 18:11:11.578111 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.578242 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-03 18:11:11.579917 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:11.581707 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:11:11.581861 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-03 18:11:11.586796 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 18:11:11.587957 (Thread-1): finished collecting timing info
2021-11-03 18:11:11.588156 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-03 18:11:11.588556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67926de20>]}
2021-11-03 18:11:11.588917 (Thread-1): 23:41:11 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.64s]
2021-11-03 18:11:11.589102 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-03 18:11:11.590344 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 18:11:11.590712 (Thread-1): 23:41:11 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-03 18:11:11.591066 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:11.591261 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-03 18:11:11.596317 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 18:11:11.597268 (Thread-1): finished collecting timing info
2021-11-03 18:11:11.599681 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:11.599900 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-03 18:11:11.600049 (Thread-1): Opening a new connection, currently in state closed
2021-11-03 18:11:12.985734 (Thread-1): SQL status: BEGIN in 1.39 seconds
2021-11-03 18:11:12.985956 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:12.986096 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-03 18:11:12.991584 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-03 18:11:12.992858 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-03 18:11:12.993460 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:12.993604 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-03 18:11:13.008373 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-03 18:11:13.010816 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:13.010989 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-03 18:11:13.014362 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-03 18:11:13.015651 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:13.015820 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-03 18:11:13.018176 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:13.019039 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 18:11:13.019207 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:13.019348 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-03 18:11:13.020905 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:13.023414 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:11:13.023635 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-03 18:11:13.025363 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-03 18:11:13.026511 (Thread-1): finished collecting timing info
2021-11-03 18:11:13.026719 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-03 18:11:13.027155 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20514c61-3d85-4002-9bba-266a08831c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd679338e20>]}
2021-11-03 18:11:13.027534 (Thread-1): 23:41:13 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.44s]
2021-11-03 18:11:13.027719 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-03 18:11:13.028871 (MainThread): Acquiring new postgres connection "master".
2021-11-03 18:11:13.029115 (MainThread): Using postgres connection "master".
2021-11-03 18:11:13.029259 (MainThread): On master: BEGIN
2021-11-03 18:11:13.029408 (MainThread): Opening a new connection, currently in state closed
2021-11-03 18:11:15.986096 (MainThread): SQL status: BEGIN in 2.96 seconds
2021-11-03 18:11:15.986379 (MainThread): On master: COMMIT
2021-11-03 18:11:15.986538 (MainThread): Using postgres connection "master".
2021-11-03 18:11:15.986676 (MainThread): On master: COMMIT
2021-11-03 18:11:15.988389 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-03 18:11:15.988694 (MainThread): 23:41:15 | 
2021-11-03 18:11:15.988950 (MainThread): 23:41:15 | Running 1 on-run-end hook
2021-11-03 18:11:15.989187 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-03 18:11:15.991829 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-03 18:11:15.992686 (MainThread): 23:41:15 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-03 18:11:15.992930 (MainThread): Using postgres connection "master".
2021-11-03 18:11:15.993152 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-03 18:11:16.003087 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-03 18:11:16.004460 (MainThread): 23:41:16 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-03 18:11:16.004729 (MainThread): 23:41:16 | 
2021-11-03 18:11:16.004935 (MainThread): On master: Close
2021-11-03 18:11:16.005380 (MainThread): 23:41:16 | 
2021-11-03 18:11:16.005567 (MainThread): 23:41:16 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 29.78s.
2021-11-03 18:11:16.005905 (MainThread): Connection 'master' was properly closed.
2021-11-03 18:11:16.006211 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-03 18:11:16.018124 (MainThread): 
2021-11-03 18:11:16.018591 (MainThread): Completed successfully
2021-11-03 18:11:16.018992 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-03 18:11:16.019706 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd679222d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd679225340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd679265e80>]}
2021-11-03 18:11:16.020384 (MainThread): Flushing usage events
2021-11-03 18:17:24.087153 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 18:17:24.175696 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 18:17:24.177775 (MainThread): Tracking: tracking
2021-11-03 18:17:24.195767 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69682a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6967c2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6967c2e20>]}
2021-11-03 18:17:24.215539 (MainThread): Partial parsing not enabled
2021-11-03 18:17:24.277475 (MainThread): Parsing macros/test_empty.sql
2021-11-03 18:17:24.278248 (MainThread): Parsing macros/audits.sql
2021-11-03 18:17:24.278867 (MainThread): Parsing macros/test_country.sql
2021-11-03 18:17:24.279378 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 18:17:24.280277 (MainThread): Parsing macros/catalog.sql
2021-11-03 18:17:24.283669 (MainThread): Parsing macros/relations.sql
2021-11-03 18:17:24.284979 (MainThread): Parsing macros/adapters.sql
2021-11-03 18:17:24.308680 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 18:17:24.310294 (MainThread): Parsing macros/core.sql
2021-11-03 18:17:24.314192 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 18:17:24.321184 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 18:17:24.333267 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 18:17:24.335319 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 18:17:24.351494 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 18:17:24.386130 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 18:17:24.409101 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 18:17:24.410953 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 18:17:24.421572 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 18:17:24.442692 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 18:17:24.455755 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 18:17:24.463446 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 18:17:24.474639 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 18:17:24.480834 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 18:17:24.481931 (MainThread): Parsing macros/etc/query.sql
2021-11-03 18:17:24.482912 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 18:17:24.484279 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 18:17:24.492638 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 18:17:24.494381 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 18:17:24.496128 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 18:17:24.552946 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 18:17:24.554662 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 18:17:24.555721 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 18:17:24.556897 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 18:17:24.558807 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 18:17:24.559787 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 18:17:24.561088 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 18:17:24.563055 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 18:17:24.568997 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 18:17:24.570034 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 18:17:24.571278 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 18:17:24.573999 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 18:17:24.575000 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 18:17:24.577125 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 18:17:24.586652 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 18:17:24.588501 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 18:17:24.589816 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 18:17:24.591410 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 18:17:24.592843 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 18:17:24.593753 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 18:17:24.596811 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 18:17:24.601881 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 18:17:24.602659 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 18:17:24.605329 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 18:17:24.607100 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 18:17:24.608541 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 18:17:24.610317 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 18:17:24.634767 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 18:17:24.635662 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 18:17:24.636400 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 18:17:24.636967 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 18:17:24.639926 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 18:17:24.641079 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 18:17:24.642917 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 18:17:24.643837 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 18:17:24.644602 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 18:17:24.645737 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 18:17:24.647492 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 18:17:24.648519 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 18:17:24.649341 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 18:17:24.651238 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 18:17:24.652482 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 18:17:24.654780 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 18:17:24.656226 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 18:17:24.657129 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 18:17:24.658300 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 18:17:24.661550 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 18:17:24.667089 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 18:17:24.668304 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 18:17:24.670834 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 18:17:24.673901 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 18:17:24.676444 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 18:17:24.677412 (MainThread): Parsing macros/sql/star.sql
2021-11-03 18:17:24.680090 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 18:17:24.685961 (MainThread): Parsing macros/sql/union.sql
2021-11-03 18:17:24.693360 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 18:17:24.694185 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 18:17:24.696714 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 18:17:24.697584 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 18:17:24.698655 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 18:17:24.701082 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 18:17:24.704979 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 18:17:24.707389 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 18:17:24.861649 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 18:17:24.861868 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef2e8548-7948-4968-85c7-b16d18310d52', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6968cc9d0>]}
2021-11-03 18:17:24.981912 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:17:24.997862 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:17:25.002788 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:17:25.014122 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:17:25.021422 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:17:25.032457 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 18:17:25.038565 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 18:17:25.078465 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 18:17:25.082691 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 18:17:25.186903 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 18:17:25.192288 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef2e8548-7948-4968-85c7-b16d18310d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff696a45730>]}
2021-11-03 18:17:25.202024 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef2e8548-7948-4968-85c7-b16d18310d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff696a21400>]}
2021-11-03 18:17:25.202395 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 18:17:25.204146 (MainThread): 
2021-11-03 18:17:25.204798 (MainThread): Acquiring new postgres connection "master".
2021-11-03 18:17:25.205978 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 18:17:25.217393 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 18:17:25.217694 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 18:17:25.217875 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 18:18:57.798384 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'timeout expired
'
2021-11-03 18:18:57.799000 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 18:18:57.799210 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-11-03 18:18:57.799484 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-11-03 18:18:57.799666 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-11-03 18:18:57.799898 (ThreadPoolExecutor-0_0): On list_postgres: No close available on handle
2021-11-03 18:18:57.800597 (MainThread): Connection 'master' was properly closed.
2021-11-03 18:18:57.800766 (MainThread): Connection 'list_postgres' was properly closed.
2021-11-03 18:18:57.800938 (MainThread): ERROR: Database Error
  timeout expired
  
2021-11-03 18:18:57.801176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff696a18850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6967caaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff696a9c190>]}
2021-11-03 18:18:57.801430 (MainThread): Flushing usage events
2021-11-03 18:19:27.813757 (MainThread): ctrl-c
2021-11-03 18:19:36.841098 (MainThread): Running with dbt=0.21.0-b1
2021-11-03 18:19:36.953519 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-03 18:19:36.954952 (MainThread): Tracking: tracking
2021-11-03 18:19:36.973234 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb878fd5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb878f81670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb878f81e20>]}
2021-11-03 18:19:37.000299 (MainThread): Partial parsing not enabled
2021-11-03 18:19:37.082961 (MainThread): Parsing macros/test_empty.sql
2021-11-03 18:19:37.083939 (MainThread): Parsing macros/audits.sql
2021-11-03 18:19:37.084732 (MainThread): Parsing macros/test_country.sql
2021-11-03 18:19:37.085541 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-03 18:19:37.086876 (MainThread): Parsing macros/catalog.sql
2021-11-03 18:19:37.091411 (MainThread): Parsing macros/relations.sql
2021-11-03 18:19:37.094044 (MainThread): Parsing macros/adapters.sql
2021-11-03 18:19:37.125836 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-03 18:19:37.128138 (MainThread): Parsing macros/core.sql
2021-11-03 18:19:37.132987 (MainThread): Parsing macros/materializations/test.sql
2021-11-03 18:19:37.141886 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-03 18:19:37.154260 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-03 18:19:37.156308 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-03 18:19:37.176474 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-03 18:19:37.211358 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-03 18:19:37.236101 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-03 18:19:37.237938 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-03 18:19:37.247824 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-03 18:19:37.267796 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-03 18:19:37.281479 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-03 18:19:37.289147 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-03 18:19:37.296335 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-03 18:19:37.299833 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-03 18:19:37.300737 (MainThread): Parsing macros/etc/query.sql
2021-11-03 18:19:37.301602 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-03 18:19:37.303006 (MainThread): Parsing macros/etc/datetime.sql
2021-11-03 18:19:37.311328 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-03 18:19:37.313018 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-03 18:19:37.314422 (MainThread): Parsing macros/adapters/common.sql
2021-11-03 18:19:37.367896 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-03 18:19:37.369521 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-03 18:19:37.370596 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-03 18:19:37.371791 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-03 18:19:37.373733 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-03 18:19:37.374824 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-03 18:19:37.376140 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-03 18:19:37.378610 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-03 18:19:37.384340 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-03 18:19:37.385372 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-03 18:19:37.386576 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-03 18:19:37.388756 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-03 18:19:37.389750 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-03 18:19:37.392073 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-03 18:19:37.402313 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-03 18:19:37.404083 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-03 18:19:37.405399 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-03 18:19:37.406932 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-03 18:19:37.408666 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-03 18:19:37.409566 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-03 18:19:37.412605 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-03 18:19:37.417547 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-03 18:19:37.418313 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-03 18:19:37.421675 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-03 18:19:37.423622 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-03 18:19:37.425677 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-03 18:19:37.428546 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-03 18:19:37.451893 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-03 18:19:37.452618 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-03 18:19:37.453304 (MainThread): Parsing macros/logger/log_info.sql
2021-11-03 18:19:37.454042 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-03 18:19:37.457705 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-03 18:19:37.459026 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-03 18:19:37.461139 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-03 18:19:37.462237 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-03 18:19:37.463190 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-03 18:19:37.464614 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-03 18:19:37.466968 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-03 18:19:37.468362 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-03 18:19:37.469469 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-03 18:19:37.471264 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-03 18:19:37.472364 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-03 18:19:37.475392 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-03 18:19:37.477142 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-03 18:19:37.478390 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-03 18:19:37.479962 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-03 18:19:37.484096 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-03 18:19:37.491402 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-03 18:19:37.492866 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-03 18:19:37.495865 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-03 18:19:37.499778 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-03 18:19:37.502738 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-03 18:19:37.503895 (MainThread): Parsing macros/sql/star.sql
2021-11-03 18:19:37.507280 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-03 18:19:37.514952 (MainThread): Parsing macros/sql/union.sql
2021-11-03 18:19:37.524909 (MainThread): Parsing macros/sql/groupby.sql
2021-11-03 18:19:37.526082 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-03 18:19:37.530279 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-03 18:19:37.531460 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-03 18:19:37.532869 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-03 18:19:37.536257 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-03 18:19:37.541030 (MainThread): Parsing macros/sql/pivot.sql
2021-11-03 18:19:37.544251 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-03 18:19:37.704149 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-03 18:19:37.704583 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5ee77b0-5f7f-4e35-907f-5c6c443dd556', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87918c9d0>]}
2021-11-03 18:19:37.825206 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-03 18:19:37.839233 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-03 18:19:37.842779 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-03 18:19:37.852021 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-03 18:19:37.856874 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-03 18:19:37.863074 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-03 18:19:37.866151 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-03 18:19:37.886704 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-03 18:19:37.889885 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-03 18:19:37.980208 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-03 18:19:37.985002 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5ee77b0-5f7f-4e35-907f-5c6c443dd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb879206be0>]}
2021-11-03 18:19:37.993995 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5ee77b0-5f7f-4e35-907f-5c6c443dd556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8791e13a0>]}
2021-11-03 18:19:37.994354 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-03 18:19:37.996046 (MainThread): 
2021-11-03 18:19:37.996523 (MainThread): Acquiring new postgres connection "master".
2021-11-03 18:19:37.997587 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-03 18:19:38.008343 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-03 18:19:38.008573 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-03 18:19:38.008733 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-03 18:20:36.027110 (MainThread): Connection 'master' was properly closed.
2021-11-03 18:20:36.028099 (MainThread): Connection 'list_postgres' was properly closed.
2021-11-03 18:20:36.028430 (MainThread): Flushing usage events
2021-11-03 18:21:06.043011 (MainThread): ctrl-c
2021-11-04 07:40:19.194361 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 07:40:19.260200 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 07:40:19.262450 (MainThread): Tracking: tracking
2021-11-04 07:40:19.334640 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fdfeba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fdf82670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fdf82e20>]}
2021-11-04 07:40:19.352468 (MainThread): Partial parsing not enabled
2021-11-04 07:40:19.432778 (MainThread): Parsing macros/test_empty.sql
2021-11-04 07:40:19.434155 (MainThread): Parsing macros/audits.sql
2021-11-04 07:40:19.435195 (MainThread): Parsing macros/test_country.sql
2021-11-04 07:40:19.436009 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 07:40:19.437342 (MainThread): Parsing macros/catalog.sql
2021-11-04 07:40:19.443531 (MainThread): Parsing macros/relations.sql
2021-11-04 07:40:19.445593 (MainThread): Parsing macros/adapters.sql
2021-11-04 07:40:19.481307 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 07:40:19.483507 (MainThread): Parsing macros/core.sql
2021-11-04 07:40:19.488062 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 07:40:19.496360 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 07:40:19.509170 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 07:40:19.511382 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 07:40:19.533300 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 07:40:19.569404 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 07:40:19.589869 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 07:40:19.591498 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 07:40:19.601250 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 07:40:19.620988 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 07:40:19.635129 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 07:40:19.644694 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 07:40:19.653566 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 07:40:19.657378 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 07:40:19.658485 (MainThread): Parsing macros/etc/query.sql
2021-11-04 07:40:19.659778 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 07:40:19.661291 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 07:40:19.669733 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 07:40:19.671519 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 07:40:19.673009 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 07:40:19.726971 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 07:40:19.728570 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 07:40:19.729611 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 07:40:19.730825 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 07:40:19.732747 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 07:40:19.733733 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 07:40:19.735028 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 07:40:19.737086 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 07:40:19.742860 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 07:40:19.743885 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 07:40:19.745072 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 07:40:19.747286 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 07:40:19.748261 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 07:40:19.750434 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 07:40:19.759733 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 07:40:19.761459 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 07:40:19.762883 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 07:40:19.764486 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 07:40:19.765914 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 07:40:19.766785 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 07:40:19.769873 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 07:40:19.775111 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 07:40:19.775880 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 07:40:19.778335 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 07:40:19.780105 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 07:40:19.781510 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 07:40:19.783232 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 07:40:19.805406 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 07:40:19.805994 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 07:40:19.806611 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 07:40:19.807347 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 07:40:19.810266 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 07:40:19.811436 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 07:40:19.813290 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 07:40:19.814208 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 07:40:19.814961 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 07:40:19.816040 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 07:40:19.817815 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 07:40:19.818831 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 07:40:19.819646 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 07:40:19.820947 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 07:40:19.821793 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 07:40:19.824014 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 07:40:19.825255 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 07:40:19.826144 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 07:40:19.827554 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 07:40:19.830847 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 07:40:19.836037 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 07:40:19.837025 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 07:40:19.839178 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 07:40:19.842106 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 07:40:19.844263 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 07:40:19.845085 (MainThread): Parsing macros/sql/star.sql
2021-11-04 07:40:19.847523 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 07:40:19.853065 (MainThread): Parsing macros/sql/union.sql
2021-11-04 07:40:19.860452 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 07:40:19.861230 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 07:40:19.863945 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 07:40:19.864809 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 07:40:19.865903 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 07:40:19.868301 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 07:40:19.872035 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 07:40:19.874831 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 07:40:20.023247 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 07:40:20.023450 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe08d9d0>]}
2021-11-04 07:40:20.141987 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:20.156344 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:20.159824 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:20.169713 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:20.174918 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:20.180751 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 07:40:20.183969 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 07:40:20.202549 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 07:40:20.205709 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 07:40:20.295182 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 07:40:20.301628 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe107160>]}
2021-11-04 07:40:20.311014 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe0e23a0>]}
2021-11-04 07:40:20.311409 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 07:40:20.313727 (MainThread): 
2021-11-04 07:40:20.314405 (MainThread): Acquiring new postgres connection "master".
2021-11-04 07:40:20.315611 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 07:40:20.325944 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 07:40:20.326103 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 07:40:20.326273 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 07:40:28.031159 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 7.70 seconds
2021-11-04 07:40:28.032751 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 07:40:28.035055 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 07:40:28.041971 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 07:40:28.042159 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 07:40:28.042297 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 07:40:29.515367 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-11-04 07:40:29.515562 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 07:40:29.515672 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 07:40:29.542231 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.03 seconds
2021-11-04 07:40:29.543343 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 07:40:29.544508 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 07:40:29.544929 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 07:40:29.577432 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 07:40:29.577646 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 07:40:29.577794 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 07:40:31.043214 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-11-04 07:40:31.043454 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 07:40:31.043601 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 07:40:31.057315 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-04 07:40:31.058871 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 07:40:31.060333 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 07:40:31.060886 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 07:40:31.062802 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 07:40:31.062966 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 07:40:31.063105 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 07:40:32.473346 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-11-04 07:40:32.473599 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 07:40:32.473725 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 07:40:32.483549 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-04 07:40:32.484490 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 07:40:32.485652 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 07:40:32.490712 (MainThread): Using postgres connection "master".
2021-11-04 07:40:32.490883 (MainThread): On master: BEGIN
2021-11-04 07:40:32.491000 (MainThread): Opening a new connection, currently in state init
2021-11-04 07:40:34.006364 (MainThread): SQL status: BEGIN in 1.52 seconds
2021-11-04 07:40:34.006564 (MainThread): Using postgres connection "master".
2021-11-04 07:40:34.006678 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 07:40:34.201254 (MainThread): SQL status: SELECT 5 in 0.19 seconds
2021-11-04 07:40:34.202464 (MainThread): On master: ROLLBACK
2021-11-04 07:40:34.204447 (MainThread): Using postgres connection "master".
2021-11-04 07:40:34.204614 (MainThread): On master: BEGIN
2021-11-04 07:40:34.207429 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 07:40:34.207633 (MainThread): On master: COMMIT
2021-11-04 07:40:34.207780 (MainThread): Using postgres connection "master".
2021-11-04 07:40:34.207880 (MainThread): On master: COMMIT
2021-11-04 07:40:34.209248 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:34.209426 (MainThread): 13:10:34 | 
2021-11-04 07:40:34.209604 (MainThread): 13:10:34 | Running 1 on-run-start hook
2021-11-04 07:40:34.209767 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 07:40:34.211939 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 07:40:34.213154 (MainThread): 13:10:34 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 07:40:34.213325 (MainThread): Using postgres connection "master".
2021-11-04 07:40:34.213453 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-04 07:40:34.234356 (MainThread): SQL status: COMMIT in 0.02 seconds
2021-11-04 07:40:34.235160 (MainThread): 13:10:34 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.02s]
2021-11-04 07:40:34.235340 (MainThread): 13:10:34 | 
2021-11-04 07:40:34.235590 (MainThread): On master: Close
2021-11-04 07:40:34.235923 (MainThread): 13:10:34 | Concurrency: 1 threads (target='dev')
2021-11-04 07:40:34.236068 (MainThread): 13:10:34 | 
2021-11-04 07:40:34.238975 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-04 07:40:34.239423 (Thread-1): 13:10:34 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-04 07:40:34.239934 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:34.240139 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-04 07:40:34.243501 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 07:40:34.244078 (Thread-1): finished collecting timing info
2021-11-04 07:40:34.267573 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:34.267799 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-04 07:40:34.267935 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:40:35.797041 (Thread-1): SQL status: BEGIN in 1.53 seconds
2021-11-04 07:40:35.797304 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.797455 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-04 07:40:35.804450 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:40:35.810979 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 07:40:35.811861 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.812033 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-04 07:40:35.901378 (Thread-1): SQL status: SELECT 44 in 0.09 seconds
2021-11-04 07:40:35.906361 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.906521 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-04 07:40:35.909732 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:35.911645 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.911764 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-04 07:40:35.913802 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:35.917860 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.940469 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-04 07:40:35.944056 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:35.950535 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 07:40:35.950751 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.950884 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 07:40:35.953083 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:35.959179 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:40:35.959367 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-04 07:40:35.982830 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-04 07:40:35.984232 (Thread-1): finished collecting timing info
2021-11-04 07:40:35.984448 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-04 07:40:35.984869 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe208700>]}
2021-11-04 07:40:35.985242 (Thread-1): 13:10:35 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.75s]
2021-11-04 07:40:35.985436 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-04 07:40:35.985624 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-04 07:40:35.986002 (Thread-1): 13:10:35 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-04 07:40:35.986348 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:35.986519 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-04 07:40:35.993471 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 07:40:35.994068 (Thread-1): finished collecting timing info
2021-11-04 07:40:36.025821 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:36.026006 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-04 07:40:36.026122 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:40:37.268526 (Thread-1): SQL status: BEGIN in 1.24 seconds
2021-11-04 07:40:37.268775 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.268933 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','INCR_LOAD');
    commit;
      
2021-11-04 07:40:37.275366 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:40:37.279768 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.279996 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp131036022316"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-04 07:40:37.340715 (Thread-1): SQL status: SELECT 101 in 0.06 seconds
2021-11-04 07:40:37.351656 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.351878 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp131036022316'
        
      order by ordinal_position

  
2021-11-04 07:40:37.463823 (Thread-1): SQL status: SELECT 7 in 0.11 seconds
2021-11-04 07:40:37.471294 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.471526 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 07:40:37.492380 (Thread-1): SQL status: SELECT 7 in 0.02 seconds
2021-11-04 07:40:37.508039 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.508333 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 07:40:37.516052 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-04 07:40:37.518651 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 07:40:37.519588 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.519845 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp131036022316"
    );
  
2021-11-04 07:40:37.544307 (Thread-1): SQL status: INSERT 0 101 in 0.02 seconds
2021-11-04 07:40:37.546315 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.546543 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','INCR_LOAD');
    commit;
      
2021-11-04 07:40:37.550853 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:37.552182 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 07:40:37.552415 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:40:37.552580 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 07:40:37.555280 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:37.555974 (Thread-1): finished collecting timing info
2021-11-04 07:40:37.556222 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-04 07:40:37.556758 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe20c520>]}
2021-11-04 07:40:37.557311 (Thread-1): 13:10:37 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 101 in 1.57s]
2021-11-04 07:40:37.557619 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-04 07:40:37.557928 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-04 07:40:37.558404 (Thread-1): 13:10:37 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-04 07:40:37.558891 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:37.559103 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-04 07:40:37.562656 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 07:40:37.564629 (Thread-1): finished collecting timing info
2021-11-04 07:40:37.569061 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 07:40:37.571965 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:37.572263 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-04 07:40:37.572531 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:40:38.830904 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-04 07:40:38.831140 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:38.831281 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '7696c7ba-dae3-45c3-b36b-d3da52dd139e' as invocation_id
  );
2021-11-04 07:40:38.870900 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-11-04 07:40:38.874536 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:38.874703 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-04 07:40:38.877880 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:38.880211 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:38.880368 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-04 07:40:38.881744 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:38.882999 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 07:40:38.883160 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:38.883291 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 07:40:38.886529 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:38.888223 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:40:38.888367 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-04 07:40:39.017484 (Thread-1): SQL status: DROP TABLE in 0.13 seconds
2021-11-04 07:40:39.018675 (Thread-1): finished collecting timing info
2021-11-04 07:40:39.018861 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-04 07:40:39.019330 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fdf78af0>]}
2021-11-04 07:40:39.019686 (Thread-1): 13:10:39 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.46s]
2021-11-04 07:40:39.019852 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-04 07:40:39.020051 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 07:40:39.020363 (Thread-1): 13:10:39 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-04 07:40:39.020671 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:39.020813 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-04 07:40:39.024927 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 07:40:39.025418 (Thread-1): finished collecting timing info
2021-11-04 07:40:39.039924 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:39.040188 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-04 07:40:39.040374 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:40:40.267256 (Thread-1): SQL status: BEGIN in 1.23 seconds
2021-11-04 07:40:40.267491 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.267635 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-04 07:40:40.272837 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:40:40.277432 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 07:40:40.278115 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.278302 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-04 07:40:40.304158 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-11-04 07:40:40.307051 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.307240 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-04 07:40:40.310373 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:40.312834 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.313023 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-04 07:40:40.315955 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:40.317289 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.317563 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-04 07:40:40.320472 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:40.321477 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 07:40:40.321647 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.321779 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 07:40:40.323643 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:40.326547 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:40:40.326743 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-04 07:40:40.333223 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-04 07:40:40.335180 (Thread-1): finished collecting timing info
2021-11-04 07:40:40.335527 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-04 07:40:40.336177 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe085fa0>]}
2021-11-04 07:40:40.336665 (Thread-1): 13:10:40 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.32s]
2021-11-04 07:40:40.336917 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 07:40:40.337637 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 07:40:40.338152 (Thread-1): 13:10:40 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-04 07:40:40.338727 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:40.339020 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-04 07:40:40.347274 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 07:40:40.348137 (Thread-1): finished collecting timing info
2021-11-04 07:40:40.352577 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:40.352894 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-04 07:40:40.353118 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:40:41.604331 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-11-04 07:40:41.604559 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:41.604696 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-04 07:40:41.610927 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:40:41.612176 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 07:40:41.612794 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:41.612945 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-04 07:40:41.626844 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-04 07:40:41.630585 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:41.630756 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-04 07:40:41.633391 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:40:41.634630 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:41.634788 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-04 07:40:41.637665 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:41.638532 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 07:40:41.638699 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:41.638834 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 07:40:41.640515 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:41.642761 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:40:41.642975 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-04 07:40:41.645504 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 07:40:41.647040 (Thread-1): finished collecting timing info
2021-11-04 07:40:41.647277 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-04 07:40:41.647706 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7696c7ba-dae3-45c3-b36b-d3da52dd139e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe147730>]}
2021-11-04 07:40:41.648114 (Thread-1): 13:10:41 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.31s]
2021-11-04 07:40:41.648389 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 07:40:41.649631 (MainThread): Acquiring new postgres connection "master".
2021-11-04 07:40:41.649864 (MainThread): Using postgres connection "master".
2021-11-04 07:40:41.650010 (MainThread): On master: BEGIN
2021-11-04 07:40:41.650154 (MainThread): Opening a new connection, currently in state closed
2021-11-04 07:40:42.936824 (MainThread): SQL status: BEGIN in 1.29 seconds
2021-11-04 07:40:42.937063 (MainThread): On master: COMMIT
2021-11-04 07:40:42.937205 (MainThread): Using postgres connection "master".
2021-11-04 07:40:42.937332 (MainThread): On master: COMMIT
2021-11-04 07:40:42.938453 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:40:42.938653 (MainThread): 13:10:42 | 
2021-11-04 07:40:42.938834 (MainThread): 13:10:42 | Running 1 on-run-end hook
2021-11-04 07:40:42.938998 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-04 07:40:42.941518 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-04 07:40:42.942350 (MainThread): 13:10:42 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-04 07:40:42.942576 (MainThread): Using postgres connection "master".
2021-11-04 07:40:42.942758 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-04 07:40:42.949911 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:40:42.950769 (MainThread): 13:10:42 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-04 07:40:42.950974 (MainThread): 13:10:42 | 
2021-11-04 07:40:42.951157 (MainThread): On master: Close
2021-11-04 07:40:42.951577 (MainThread): 13:10:42 | 
2021-11-04 07:40:42.951749 (MainThread): 13:10:42 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 22.64s.
2021-11-04 07:40:42.951915 (MainThread): Connection 'master' was properly closed.
2021-11-04 07:40:42.952071 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-04 07:40:42.961741 (MainThread): 
2021-11-04 07:40:42.962062 (MainThread): Completed successfully
2021-11-04 07:40:42.962297 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-04 07:40:42.962558 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe0e8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fdf9fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89fe137550>]}
2021-11-04 07:40:42.962926 (MainThread): Flushing usage events
2021-11-04 07:43:29.140321 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 07:43:29.744017 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 07:43:29.745292 (MainThread): Tracking: tracking
2021-11-04 07:43:29.758469 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ca955b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ca955df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ca9559d0>]}
2021-11-04 07:43:29.778112 (MainThread): Partial parsing not enabled
2021-11-04 07:43:29.844385 (MainThread): Parsing macros/test_empty.sql
2021-11-04 07:43:29.845502 (MainThread): Parsing macros/audits.sql
2021-11-04 07:43:29.846169 (MainThread): Parsing macros/test_country.sql
2021-11-04 07:43:29.846825 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 07:43:29.848480 (MainThread): Parsing macros/catalog.sql
2021-11-04 07:43:29.852438 (MainThread): Parsing macros/relations.sql
2021-11-04 07:43:29.853913 (MainThread): Parsing macros/adapters.sql
2021-11-04 07:43:29.877061 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 07:43:29.879853 (MainThread): Parsing macros/core.sql
2021-11-04 07:43:29.883991 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 07:43:29.891276 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 07:43:29.901571 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 07:43:29.903370 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 07:43:29.919530 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 07:43:29.952393 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 07:43:29.972037 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 07:43:29.973738 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 07:43:29.983398 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 07:43:30.002497 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 07:43:30.015878 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 07:43:30.023654 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 07:43:30.030896 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 07:43:30.034611 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 07:43:30.035427 (MainThread): Parsing macros/etc/query.sql
2021-11-04 07:43:30.036306 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 07:43:30.037898 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 07:43:30.045950 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 07:43:30.047634 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 07:43:30.049039 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 07:43:30.101328 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 07:43:30.102956 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 07:43:30.104354 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 07:43:30.105548 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 07:43:30.107780 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 07:43:30.108769 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 07:43:30.110335 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 07:43:30.112315 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 07:43:30.117938 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 07:43:30.118966 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 07:43:30.120151 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 07:43:30.122308 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 07:43:30.123282 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 07:43:30.125427 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 07:43:30.135908 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 07:43:30.139084 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 07:43:30.141163 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 07:43:30.142842 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 07:43:30.144365 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 07:43:30.145252 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 07:43:30.148281 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 07:43:30.153698 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 07:43:30.154431 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 07:43:30.157059 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 07:43:30.158899 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 07:43:30.160274 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 07:43:30.162100 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 07:43:30.184474 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 07:43:30.185095 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 07:43:30.185719 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 07:43:30.186281 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 07:43:30.189355 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 07:43:30.190794 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 07:43:30.192923 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 07:43:30.193844 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 07:43:30.194613 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 07:43:30.195711 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 07:43:30.197470 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 07:43:30.198519 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 07:43:30.199352 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 07:43:30.200687 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 07:43:30.201511 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 07:43:30.203698 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 07:43:30.204972 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 07:43:30.205876 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 07:43:30.207036 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 07:43:30.210111 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 07:43:30.215264 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 07:43:30.216257 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 07:43:30.218432 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 07:43:30.221271 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 07:43:30.223449 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 07:43:30.224279 (MainThread): Parsing macros/sql/star.sql
2021-11-04 07:43:30.226780 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 07:43:30.232538 (MainThread): Parsing macros/sql/union.sql
2021-11-04 07:43:30.239846 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 07:43:30.240639 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 07:43:30.243109 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 07:43:30.243984 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 07:43:30.245034 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 07:43:30.247550 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 07:43:30.251099 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 07:43:30.253565 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 07:43:30.405278 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 07:43:30.405530 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab1b9a0>]}
2021-11-04 07:43:30.533829 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:30.546291 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:30.549178 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:30.557394 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:30.562188 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:30.568357 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 07:43:30.571377 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 07:43:30.679294 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 07:43:30.683515 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 07:43:30.803935 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 07:43:30.811595 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab68580>]}
2021-11-04 07:43:30.822827 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab60190>]}
2021-11-04 07:43:30.823217 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 07:43:30.825770 (MainThread): 
2021-11-04 07:43:30.826307 (MainThread): Acquiring new postgres connection "master".
2021-11-04 07:43:30.827457 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 07:43:30.838745 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 07:43:30.839041 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 07:43:30.839393 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 07:43:32.606018 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 1.77 seconds
2021-11-04 07:43:32.607852 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 07:43:32.611558 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 07:43:32.619215 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 07:43:32.619429 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 07:43:32.619580 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 07:43:34.032733 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.41 seconds
2021-11-04 07:43:34.032953 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 07:43:34.033088 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 07:43:34.050173 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-04 07:43:34.051772 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 07:43:34.053499 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 07:43:34.054189 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 07:43:34.089813 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 07:43:34.089992 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 07:43:34.090112 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 07:43:35.469685 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.38 seconds
2021-11-04 07:43:35.469924 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 07:43:35.470071 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 07:43:35.485942 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-04 07:43:35.487199 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 07:43:35.488987 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 07:43:35.489519 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 07:43:35.491542 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 07:43:35.491740 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 07:43:35.491903 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 07:43:36.836956 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.35 seconds
2021-11-04 07:43:36.837158 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 07:43:36.837283 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 07:43:36.847376 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-11-04 07:43:36.848497 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 07:43:36.849489 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 07:43:36.854148 (MainThread): Using postgres connection "master".
2021-11-04 07:43:36.854312 (MainThread): On master: BEGIN
2021-11-04 07:43:36.854423 (MainThread): Opening a new connection, currently in state init
2021-11-04 07:43:38.237585 (MainThread): SQL status: BEGIN in 1.38 seconds
2021-11-04 07:43:38.237828 (MainThread): Using postgres connection "master".
2021-11-04 07:43:38.237982 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 07:43:38.371249 (MainThread): SQL status: SELECT 5 in 0.13 seconds
2021-11-04 07:43:38.372343 (MainThread): On master: ROLLBACK
2021-11-04 07:43:38.374160 (MainThread): Using postgres connection "master".
2021-11-04 07:43:38.374315 (MainThread): On master: BEGIN
2021-11-04 07:43:38.377047 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 07:43:38.377189 (MainThread): On master: COMMIT
2021-11-04 07:43:38.377306 (MainThread): Using postgres connection "master".
2021-11-04 07:43:38.377406 (MainThread): On master: COMMIT
2021-11-04 07:43:38.378419 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:38.378575 (MainThread): 13:13:38 | 
2021-11-04 07:43:38.378724 (MainThread): 13:13:38 | Running 1 on-run-start hook
2021-11-04 07:43:38.378856 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 07:43:38.380858 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 07:43:38.382159 (MainThread): 13:13:38 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 07:43:38.382348 (MainThread): Using postgres connection "master".
2021-11-04 07:43:38.382465 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-04 07:43:38.387397 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:38.388116 (MainThread): 13:13:38 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-04 07:43:38.388288 (MainThread): 13:13:38 | 
2021-11-04 07:43:38.388439 (MainThread): On master: Close
2021-11-04 07:43:38.388735 (MainThread): 13:13:38 | Concurrency: 1 threads (target='dev')
2021-11-04 07:43:38.388875 (MainThread): 13:13:38 | 
2021-11-04 07:43:38.391164 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-04 07:43:38.391717 (Thread-1): 13:13:38 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-04 07:43:38.392263 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:38.392474 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-04 07:43:38.395923 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 07:43:38.396473 (Thread-1): finished collecting timing info
2021-11-04 07:43:38.415726 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:38.416032 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-04 07:43:38.416168 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:43:39.968673 (Thread-1): SQL status: BEGIN in 1.55 seconds
2021-11-04 07:43:39.968883 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:39.969009 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-04 07:43:39.973071 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:39.977814 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 07:43:39.978424 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:39.978562 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-04 07:43:39.997218 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-11-04 07:43:40.002116 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:40.002255 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-04 07:43:40.005055 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:40.006852 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:40.006980 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-04 07:43:40.008973 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:40.012990 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:40.013119 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-04 07:43:40.015605 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:40.020500 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 07:43:40.020644 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:40.020749 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 07:43:40.022436 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:40.027244 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 07:43:40.027379 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-04 07:43:40.039030 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-04 07:43:40.040194 (Thread-1): finished collecting timing info
2021-11-04 07:43:40.040373 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-04 07:43:40.040745 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab3d3d0>]}
2021-11-04 07:43:40.041060 (Thread-1): 13:13:40 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.65s]
2021-11-04 07:43:40.041216 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-04 07:43:40.041366 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-04 07:43:40.041634 (Thread-1): 13:13:40 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-04 07:43:40.041884 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:40.042014 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-04 07:43:40.047455 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 07:43:40.048147 (Thread-1): finished collecting timing info
2021-11-04 07:43:40.078999 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:40.079283 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-04 07:43:40.079413 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:43:41.607498 (Thread-1): SQL status: BEGIN in 1.53 seconds
2021-11-04 07:43:41.607762 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.607895 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','INCR_LOAD');
    commit;
      
2021-11-04 07:43:41.612269 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:41.613392 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 07:43:41.613877 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.613997 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

  create  table "postgres"."dbtdemo"."incr_load__dbt_tmp"
  as (
    

     select *,current_timestamp from events
     
  );
  
2021-11-04 07:43:41.634651 (Thread-1): SQL status: SELECT 200 in 0.02 seconds
2021-11-04 07:43:41.636838 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.636968 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */
alter table "postgres"."dbtdemo"."incr_load" rename to "incr_load__dbt_backup"
2021-11-04 07:43:41.640037 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:41.642446 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.642617 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */
alter table "postgres"."dbtdemo"."incr_load__dbt_tmp" rename to "incr_load"
2021-11-04 07:43:41.645433 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:41.647155 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.647316 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','INCR_LOAD');
    commit;
      
2021-11-04 07:43:41.649922 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:41.650773 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 07:43:41.650900 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.651005 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 07:43:41.652044 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:41.653391 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 07:43:41.653511 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */
drop table if exists "postgres"."dbtdemo"."incr_load__dbt_backup" cascade
2021-11-04 07:43:41.664287 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-04 07:43:41.665382 (Thread-1): finished collecting timing info
2021-11-04 07:43:41.665564 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-04 07:43:41.665892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab25340>]}
2021-11-04 07:43:41.666208 (Thread-1): 13:13:41 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [SELECT 200 in 1.62s]
2021-11-04 07:43:41.666361 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-04 07:43:41.666505 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-04 07:43:41.666695 (Thread-1): 13:13:41 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-04 07:43:41.667022 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:41.667163 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-04 07:43:41.669666 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 07:43:41.670428 (Thread-1): finished collecting timing info
2021-11-04 07:43:41.672923 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 07:43:41.673739 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:41.673916 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-04 07:43:41.674097 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:43:42.948213 (Thread-1): SQL status: BEGIN in 1.27 seconds
2021-11-04 07:43:42.948431 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:42.948583 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '76aac644-ec7b-41dc-ad5c-472651776a16' as invocation_id
  );
2021-11-04 07:43:42.970467 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-04 07:43:42.972490 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:42.972739 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-04 07:43:42.973984 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:42.977008 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:42.977209 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-04 07:43:42.978813 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:42.980118 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 07:43:42.980339 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:42.980523 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 07:43:42.983156 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:42.984660 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 07:43:42.984786 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-04 07:43:43.001938 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-04 07:43:43.003086 (Thread-1): finished collecting timing info
2021-11-04 07:43:43.003288 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-04 07:43:43.003645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cac98d30>]}
2021-11-04 07:43:43.003962 (Thread-1): 13:13:43 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.34s]
2021-11-04 07:43:43.004123 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-04 07:43:43.004314 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 07:43:43.004598 (Thread-1): 13:13:43 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-04 07:43:43.004865 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:43.004996 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-04 07:43:43.009170 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 07:43:43.010023 (Thread-1): finished collecting timing info
2021-11-04 07:43:43.026037 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:43.026281 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-04 07:43:43.026440 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:43:44.486928 (Thread-1): SQL status: BEGIN in 1.46 seconds
2021-11-04 07:43:44.487338 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.487699 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-04 07:43:44.499048 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:43:44.506752 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 07:43:44.507760 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.508020 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-04 07:43:44.533426 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-11-04 07:43:44.536499 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.536703 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-04 07:43:44.540882 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:44.545164 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.545512 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-04 07:43:44.549481 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:44.550870 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.551143 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-04 07:43:44.555015 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:44.555895 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 07:43:44.556057 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.556193 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 07:43:44.557709 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:44.559478 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 07:43:44.559631 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-04 07:43:44.564182 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 07:43:44.565240 (Thread-1): finished collecting timing info
2021-11-04 07:43:44.565431 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-04 07:43:44.565804 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab60490>]}
2021-11-04 07:43:44.566148 (Thread-1): 13:13:44 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.56s]
2021-11-04 07:43:44.566338 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 07:43:44.566821 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 07:43:44.567162 (Thread-1): 13:13:44 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-04 07:43:44.567469 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:44.567624 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-04 07:43:44.572585 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 07:43:44.573210 (Thread-1): finished collecting timing info
2021-11-04 07:43:44.575662 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:44.575871 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-04 07:43:44.576025 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 07:43:45.783622 (Thread-1): SQL status: BEGIN in 1.21 seconds
2021-11-04 07:43:45.783865 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:45.784018 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-04 07:43:45.790495 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:43:45.791848 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 07:43:45.792614 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:45.792787 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-04 07:43:45.807522 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-04 07:43:45.809938 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:45.810108 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-04 07:43:45.813475 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 07:43:45.814682 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:45.814845 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-04 07:43:45.817353 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:45.818167 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 07:43:45.818326 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:45.818458 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 07:43:45.819785 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:45.822778 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 07:43:45.822943 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-04 07:43:45.824355 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 07:43:45.825416 (Thread-1): finished collecting timing info
2021-11-04 07:43:45.825612 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-04 07:43:45.826019 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76aac644-ec7b-41dc-ad5c-472651776a16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1caefa8e0>]}
2021-11-04 07:43:45.826389 (Thread-1): 13:13:45 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.26s]
2021-11-04 07:43:45.826581 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 07:43:45.827955 (MainThread): Acquiring new postgres connection "master".
2021-11-04 07:43:45.828214 (MainThread): Using postgres connection "master".
2021-11-04 07:43:45.828363 (MainThread): On master: BEGIN
2021-11-04 07:43:45.828498 (MainThread): Opening a new connection, currently in state closed
2021-11-04 07:43:47.154566 (MainThread): SQL status: BEGIN in 1.33 seconds
2021-11-04 07:43:47.154809 (MainThread): On master: COMMIT
2021-11-04 07:43:47.154959 (MainThread): Using postgres connection "master".
2021-11-04 07:43:47.155094 (MainThread): On master: COMMIT
2021-11-04 07:43:47.156179 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 07:43:47.156388 (MainThread): 13:13:47 | 
2021-11-04 07:43:47.156580 (MainThread): 13:13:47 | Running 1 on-run-end hook
2021-11-04 07:43:47.156750 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-04 07:43:47.159311 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-04 07:43:47.160150 (MainThread): 13:13:47 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-04 07:43:47.160382 (MainThread): Using postgres connection "master".
2021-11-04 07:43:47.160533 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-04 07:43:47.167073 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 07:43:47.167973 (MainThread): 13:13:47 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-04 07:43:47.168195 (MainThread): 13:13:47 | 
2021-11-04 07:43:47.168389 (MainThread): On master: Close
2021-11-04 07:43:47.168808 (MainThread): 13:13:47 | 
2021-11-04 07:43:47.168989 (MainThread): 13:13:47 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 16.34s.
2021-11-04 07:43:47.169156 (MainThread): Connection 'master' was properly closed.
2021-11-04 07:43:47.169298 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-04 07:43:47.178319 (MainThread): 
2021-11-04 07:43:47.178610 (MainThread): Completed successfully
2021-11-04 07:43:47.178850 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-04 07:43:47.179126 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cac2b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c789c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cab64fd0>]}
2021-11-04 07:43:47.179448 (MainThread): Flushing usage events
2021-11-04 15:26:41.825203 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 15:26:41.935230 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 15:26:41.937150 (MainThread): Tracking: tracking
2021-11-04 15:26:42.126005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f815eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f692700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f692eb0>]}
2021-11-04 15:26:42.149500 (MainThread): Partial parsing not enabled
2021-11-04 15:26:42.228407 (MainThread): Parsing macros/test_empty.sql
2021-11-04 15:26:42.230161 (MainThread): Parsing macros/audits.sql
2021-11-04 15:26:42.231392 (MainThread): Parsing macros/test_country.sql
2021-11-04 15:26:42.232283 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 15:26:42.233421 (MainThread): Parsing macros/catalog.sql
2021-11-04 15:26:42.237671 (MainThread): Parsing macros/relations.sql
2021-11-04 15:26:42.239308 (MainThread): Parsing macros/adapters.sql
2021-11-04 15:26:42.270282 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 15:26:42.273313 (MainThread): Parsing macros/core.sql
2021-11-04 15:26:42.280046 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 15:26:42.288506 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 15:26:42.305440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 15:26:42.308461 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 15:26:42.335215 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 15:26:42.388007 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 15:26:42.419610 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 15:26:42.422474 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 15:26:42.441438 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 15:26:42.478031 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 15:26:42.506761 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 15:26:42.520833 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 15:26:42.531850 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 15:26:42.537740 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 15:26:42.538882 (MainThread): Parsing macros/etc/query.sql
2021-11-04 15:26:42.540098 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 15:26:42.541624 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 15:26:42.555553 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 15:26:42.558065 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 15:26:42.560584 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 15:26:42.620813 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 15:26:42.622443 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 15:26:42.623495 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 15:26:42.624674 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 15:26:42.626657 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 15:26:42.627638 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 15:26:42.628932 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 15:26:42.630909 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 15:26:42.636549 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 15:26:42.637572 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 15:26:42.638804 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 15:26:42.640953 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 15:26:42.641929 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 15:26:42.644055 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 15:26:42.654297 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 15:26:42.656079 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 15:26:42.657441 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 15:26:42.659866 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 15:26:42.661974 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 15:26:42.663143 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 15:26:42.666770 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 15:26:42.673039 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 15:26:42.674051 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 15:26:42.678334 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 15:26:42.680739 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 15:26:42.682520 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 15:26:42.684763 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 15:26:42.708458 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 15:26:42.709167 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 15:26:42.709846 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 15:26:42.710407 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 15:26:42.713623 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 15:26:42.714807 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 15:26:42.716709 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 15:26:42.717913 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 15:26:42.718683 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 15:26:42.719785 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 15:26:42.721582 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 15:26:42.722615 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 15:26:42.723477 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 15:26:42.724852 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 15:26:42.725737 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 15:26:42.728060 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 15:26:42.729692 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 15:26:42.731802 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 15:26:42.734789 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 15:26:42.741700 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 15:26:42.752624 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 15:26:42.754605 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 15:26:42.758727 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 15:26:42.764934 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 15:26:42.769554 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 15:26:42.771096 (MainThread): Parsing macros/sql/star.sql
2021-11-04 15:26:42.775483 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 15:26:42.785038 (MainThread): Parsing macros/sql/union.sql
2021-11-04 15:26:42.795797 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 15:26:42.796889 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 15:26:42.799931 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 15:26:42.800912 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 15:26:42.802882 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 15:26:42.806088 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 15:26:42.810480 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 15:26:42.813164 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 15:26:43.045909 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 15:26:43.046274 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f8dcd00>]}
2021-11-04 15:26:43.177890 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:26:43.192756 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:43.196526 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:43.206235 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:43.212812 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:26:43.219715 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 15:26:43.223840 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 15:26:43.246232 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 15:26:43.250216 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 15:26:43.368602 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 15:26:43.375062 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f92aa90>]}
2021-11-04 15:26:43.389133 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f9212b0>]}
2021-11-04 15:26:43.389665 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 15:26:43.392506 (MainThread): 
2021-11-04 15:26:43.393265 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:26:43.394975 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 15:26:43.406646 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 15:26:43.407015 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 15:26:43.407197 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 15:26:49.210236 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 5.80 seconds
2021-11-04 15:26:49.212335 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 15:26:49.214518 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 15:26:49.220747 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:26:49.220927 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 15:26:49.221069 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:26:50.477384 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-11-04 15:26:50.477765 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:26:50.478081 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 15:26:50.505115 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.03 seconds
2021-11-04 15:26:50.506769 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 15:26:50.508401 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 15:26:50.509257 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 15:26:50.565913 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:26:50.566121 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 15:26:50.566266 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:26:51.858663 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.29 seconds
2021-11-04 15:26:51.858894 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:26:51.859042 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 15:26:51.871849 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-11-04 15:26:51.873342 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 15:26:51.874702 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 15:26:51.875261 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:26:51.877170 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:26:51.877357 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 15:26:51.877495 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:26:53.126951 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.25 seconds
2021-11-04 15:26:53.127182 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:26:53.127331 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 15:26:53.139828 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-04 15:26:53.140938 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 15:26:53.142098 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 15:26:53.147970 (MainThread): Using postgres connection "master".
2021-11-04 15:26:53.148173 (MainThread): On master: BEGIN
2021-11-04 15:26:53.148313 (MainThread): Opening a new connection, currently in state init
2021-11-04 15:26:54.565045 (MainThread): SQL status: BEGIN in 1.42 seconds
2021-11-04 15:26:54.565244 (MainThread): Using postgres connection "master".
2021-11-04 15:26:54.565357 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 15:26:54.780461 (MainThread): SQL status: SELECT 5 in 0.21 seconds
2021-11-04 15:26:54.781796 (MainThread): On master: ROLLBACK
2021-11-04 15:26:54.783033 (MainThread): Using postgres connection "master".
2021-11-04 15:26:54.783174 (MainThread): On master: BEGIN
2021-11-04 15:26:54.785079 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 15:26:54.785241 (MainThread): On master: COMMIT
2021-11-04 15:26:54.785361 (MainThread): Using postgres connection "master".
2021-11-04 15:26:54.785468 (MainThread): On master: COMMIT
2021-11-04 15:26:54.786397 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:26:54.786547 (MainThread): 20:56:54 | 
2021-11-04 15:26:54.786698 (MainThread): 20:56:54 | Running 1 on-run-start hook
2021-11-04 15:26:54.786869 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 15:26:54.788895 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 15:26:54.791073 (MainThread): 20:56:54 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 15:26:54.791268 (MainThread): Using postgres connection "master".
2021-11-04 15:26:54.791383 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','START','');
    commit;


2021-11-04 15:26:54.877737 (MainThread): SQL status: COMMIT in 0.09 seconds
2021-11-04 15:26:54.878592 (MainThread): 20:56:54 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.09s]
2021-11-04 15:26:54.878827 (MainThread): 20:56:54 | 
2021-11-04 15:26:54.879018 (MainThread): On master: Close
2021-11-04 15:26:54.879404 (MainThread): 20:56:54 | Concurrency: 1 threads (target='dev')
2021-11-04 15:26:54.879608 (MainThread): 20:56:54 | 
2021-11-04 15:26:54.883298 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-04 15:26:54.883650 (Thread-1): 20:56:54 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-04 15:26:54.884016 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:54.884272 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-04 15:26:54.887952 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 15:26:54.889202 (Thread-1): finished collecting timing info
2021-11-04 15:26:54.907355 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:54.907546 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-04 15:26:54.907670 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:26:56.196860 (Thread-1): SQL status: BEGIN in 1.29 seconds
2021-11-04 15:26:56.197090 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.197238 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-04 15:26:56.202579 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:26:56.208323 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 15:26:56.210158 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.210337 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-04 15:26:56.245606 (Thread-1): SQL status: SELECT 44 in 0.04 seconds
2021-11-04 15:26:56.251638 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.251802 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-04 15:26:56.254228 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:26:56.256409 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.256564 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-04 15:26:56.259338 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:26:56.263776 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.263918 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE');
    commit;
      
2021-11-04 15:26:56.266009 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:26:56.271761 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 15:26:56.271961 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.272100 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 15:26:56.274378 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:26:56.280818 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:26:56.281002 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-04 15:26:56.295889 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-04 15:26:56.296939 (Thread-1): finished collecting timing info
2021-11-04 15:26:56.297105 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-04 15:26:56.297434 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f8e8190>]}
2021-11-04 15:26:56.297735 (Thread-1): 20:56:56 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.41s]
2021-11-04 15:26:56.297880 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-04 15:26:56.298032 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-04 15:26:56.298355 (Thread-1): 20:56:56 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-04 15:26:56.298615 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:56.298747 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-04 15:26:56.304375 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 15:26:56.305578 (Thread-1): finished collecting timing info
2021-11-04 15:26:56.333096 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:56.333329 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-04 15:26:56.333453 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:26:57.606198 (Thread-1): SQL status: BEGIN in 1.27 seconds
2021-11-04 15:26:57.606429 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.606577 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','INCR_LOAD');
    commit;
      
2021-11-04 15:26:57.612957 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:26:57.616416 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.616581 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp205656330053"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-04 15:26:57.633856 (Thread-1): SQL status: SELECT 151 in 0.02 seconds
2021-11-04 15:26:57.639926 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.640081 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp205656330053'
        
      order by ordinal_position

  
2021-11-04 15:26:57.675001 (Thread-1): SQL status: SELECT 7 in 0.03 seconds
2021-11-04 15:26:57.679216 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.679355 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 15:26:57.683178 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-04 15:26:57.691821 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.691964 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 15:26:57.695549 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-04 15:26:57.696804 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 15:26:57.697795 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.697914 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp205656330053"
    );
  
2021-11-04 15:26:57.714444 (Thread-1): SQL status: INSERT 0 151 in 0.02 seconds
2021-11-04 15:26:57.715557 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.715684 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','INCR_LOAD');
    commit;
      
2021-11-04 15:26:57.717802 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:26:57.718467 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 15:26:57.718593 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:26:57.718699 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 15:26:57.719817 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:26:57.720217 (Thread-1): finished collecting timing info
2021-11-04 15:26:57.720368 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-04 15:26:57.720694 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f95a2e0>]}
2021-11-04 15:26:57.720988 (Thread-1): 20:56:57 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 151 in 1.42s]
2021-11-04 15:26:57.721138 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-04 15:26:57.721286 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-04 15:26:57.721580 (Thread-1): 20:56:57 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-04 15:26:57.721870 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:57.722047 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-04 15:26:57.723952 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 15:26:57.724601 (Thread-1): finished collecting timing info
2021-11-04 15:26:57.727270 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 15:26:57.728134 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:57.728299 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-04 15:26:57.728459 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:26:58.975854 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-11-04 15:26:58.976063 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:58.976185 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '4d89fb99-495e-433f-a99d-3dd8a31f9196' as invocation_id
  );
2021-11-04 15:26:59.002432 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-04 15:26:59.005472 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:59.005637 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-04 15:26:59.007190 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:26:59.009282 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:59.009435 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-04 15:26:59.010827 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:26:59.011957 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 15:26:59.012104 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:59.012214 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 15:26:59.015600 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:26:59.017353 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:26:59.017552 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-04 15:26:59.043290 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-11-04 15:26:59.044299 (Thread-1): finished collecting timing info
2021-11-04 15:26:59.044468 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-04 15:26:59.044796 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f95a2e0>]}
2021-11-04 15:26:59.045092 (Thread-1): 20:56:59 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.32s]
2021-11-04 15:26:59.045272 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-04 15:26:59.045447 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:26:59.045736 (Thread-1): 20:56:59 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-04 15:26:59.046032 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:26:59.046174 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:26:59.050306 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 15:26:59.050894 (Thread-1): finished collecting timing info
2021-11-04 15:26:59.064015 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:26:59.064196 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-04 15:26:59.064330 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:27:00.512424 (Thread-1): SQL status: BEGIN in 1.45 seconds
2021-11-04 15:27:00.512713 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.512871 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-04 15:27:00.519550 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:27:00.523976 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 15:27:00.524920 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.525127 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-04 15:27:00.545395 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-04 15:27:00.547854 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.548015 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-04 15:27:00.550596 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:27:00.552739 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.552887 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-04 15:27:00.555027 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:27:00.556033 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.556164 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST');
    commit;
      
2021-11-04 15:27:00.558332 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:27:00.558923 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 15:27:00.559046 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.559152 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 15:27:00.560139 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:27:00.561492 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:27:00.561616 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-04 15:27:00.564848 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 15:27:00.565718 (Thread-1): finished collecting timing info
2021-11-04 15:27:00.565875 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-04 15:27:00.566186 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f9a5730>]}
2021-11-04 15:27:00.566492 (Thread-1): 20:57:00 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.52s]
2021-11-04 15:27:00.566643 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:27:00.567417 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:27:00.567676 (Thread-1): 20:57:00 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-04 15:27:00.567933 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:00.568079 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:27:00.571996 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 15:27:00.573320 (Thread-1): finished collecting timing info
2021-11-04 15:27:00.575435 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:00.575619 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-04 15:27:00.575760 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:27:01.837613 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-04 15:27:01.837846 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:01.837994 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-04 15:27:01.843112 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:27:01.844259 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 15:27:01.846058 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:01.846223 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-04 15:27:01.857758 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-04 15:27:01.861325 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:01.861504 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-04 15:27:01.864755 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:27:01.866003 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:01.866165 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS');
    commit;
      
2021-11-04 15:27:01.868760 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:27:01.869586 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 15:27:01.869749 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:01.869882 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 15:27:01.871755 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:27:01.873503 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:27:01.873661 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-04 15:27:01.875863 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 15:27:01.877127 (Thread-1): finished collecting timing info
2021-11-04 15:27:01.877347 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-04 15:27:01.877761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d89fb99-495e-433f-a99d-3dd8a31f9196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8fc097c0>]}
2021-11-04 15:27:01.878126 (Thread-1): 20:57:01 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.31s]
2021-11-04 15:27:01.878323 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:27:01.879475 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:27:01.879715 (MainThread): Using postgres connection "master".
2021-11-04 15:27:01.879863 (MainThread): On master: BEGIN
2021-11-04 15:27:01.880001 (MainThread): Opening a new connection, currently in state closed
2021-11-04 15:27:03.196738 (MainThread): SQL status: BEGIN in 1.32 seconds
2021-11-04 15:27:03.197109 (MainThread): On master: COMMIT
2021-11-04 15:27:03.197289 (MainThread): Using postgres connection "master".
2021-11-04 15:27:03.197433 (MainThread): On master: COMMIT
2021-11-04 15:27:03.198986 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:27:03.199194 (MainThread): 20:57:03 | 
2021-11-04 15:27:03.199386 (MainThread): 20:57:03 | Running 1 on-run-end hook
2021-11-04 15:27:03.199562 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-04 15:27:03.202444 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-04 15:27:03.203265 (MainThread): 20:57:03 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-04 15:27:03.203499 (MainThread): Using postgres connection "master".
2021-11-04 15:27:03.203649 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model)  values('MAIN','END','');
    commit;


2021-11-04 15:27:03.209805 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:27:03.210698 (MainThread): 20:57:03 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-04 15:27:03.210920 (MainThread): 20:57:03 | 
2021-11-04 15:27:03.211112 (MainThread): On master: Close
2021-11-04 15:27:03.211540 (MainThread): 20:57:03 | 
2021-11-04 15:27:03.211738 (MainThread): 20:57:03 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 19.82s.
2021-11-04 15:27:03.212012 (MainThread): Connection 'master' was properly closed.
2021-11-04 15:27:03.212159 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-04 15:27:03.222574 (MainThread): 
2021-11-04 15:27:03.222912 (MainThread): Completed successfully
2021-11-04 15:27:03.223231 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-04 15:27:03.223633 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f95a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8f9266a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8fbeb730>]}
2021-11-04 15:27:03.224124 (MainThread): Flushing usage events
2021-11-04 15:41:30.216688 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 15:41:30.305867 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 15:41:30.307943 (MainThread): Tracking: tracking
2021-11-04 15:41:30.337182 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24bfd5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24bfd5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24bfd5be0>]}
2021-11-04 15:41:30.365185 (MainThread): Partial parsing not enabled
2021-11-04 15:41:30.429125 (MainThread): Parsing macros/test_empty.sql
2021-11-04 15:41:30.429899 (MainThread): Parsing macros/audits.sql
2021-11-04 15:41:30.430636 (MainThread): Parsing macros/test_country.sql
2021-11-04 15:41:30.431194 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 15:41:30.432078 (MainThread): Parsing macros/catalog.sql
2021-11-04 15:41:30.435262 (MainThread): Parsing macros/relations.sql
2021-11-04 15:41:30.436502 (MainThread): Parsing macros/adapters.sql
2021-11-04 15:41:30.461455 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 15:41:30.463184 (MainThread): Parsing macros/core.sql
2021-11-04 15:41:30.466620 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 15:41:30.473533 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 15:41:30.483536 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 15:41:30.485109 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 15:41:30.501426 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 15:41:30.535511 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 15:41:30.556148 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 15:41:30.557850 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 15:41:30.567966 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 15:41:30.587486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 15:41:30.600879 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 15:41:30.608638 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 15:41:30.615880 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 15:41:30.619470 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 15:41:30.620271 (MainThread): Parsing macros/etc/query.sql
2021-11-04 15:41:30.621147 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 15:41:30.622513 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 15:41:30.631074 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 15:41:30.632899 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 15:41:30.634411 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 15:41:30.686476 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 15:41:30.688128 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 15:41:30.689187 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 15:41:30.690374 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 15:41:30.692289 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 15:41:30.693284 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 15:41:30.694579 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 15:41:30.696556 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 15:41:30.702440 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 15:41:30.703477 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 15:41:30.704783 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 15:41:30.706957 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 15:41:30.707954 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 15:41:30.710141 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 15:41:30.719745 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 15:41:30.721459 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 15:41:30.723005 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 15:41:30.724551 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 15:41:30.726098 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 15:41:30.726972 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 15:41:30.729971 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 15:41:30.736069 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 15:41:30.736954 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 15:41:30.739516 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 15:41:30.741221 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 15:41:30.742607 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 15:41:30.744381 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 15:41:30.769096 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 15:41:30.769767 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 15:41:30.770410 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 15:41:30.771053 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 15:41:30.774078 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 15:41:30.775240 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 15:41:30.777098 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 15:41:30.778029 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 15:41:30.778811 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 15:41:30.779970 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 15:41:30.781744 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 15:41:30.782794 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 15:41:30.783713 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 15:41:30.785103 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 15:41:30.786009 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 15:41:30.788398 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 15:41:30.789854 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 15:41:30.790845 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 15:41:30.792037 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 15:41:30.795263 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 15:41:30.800999 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 15:41:30.802046 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 15:41:30.804310 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 15:41:30.807251 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 15:41:30.809469 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 15:41:30.810326 (MainThread): Parsing macros/sql/star.sql
2021-11-04 15:41:30.812808 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 15:41:30.818880 (MainThread): Parsing macros/sql/union.sql
2021-11-04 15:41:30.826294 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 15:41:30.827183 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 15:41:30.829759 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 15:41:30.830668 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 15:41:30.831764 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 15:41:30.834401 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 15:41:30.838294 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 15:41:30.840867 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 15:41:30.995339 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 15:41:30.995542 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7621aed3-41d9-4125-8000-60539fdaa1f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24c07b8e0>]}
2021-11-04 15:41:31.118257 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:41:31.134176 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:41:31.138065 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:41:31.146305 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:41:31.150993 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:41:31.156854 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 15:41:31.159824 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 15:41:31.178701 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 15:41:31.181832 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 15:41:31.269484 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 15:41:31.276402 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7621aed3-41d9-4125-8000-60539fdaa1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24c126a30>]}
2021-11-04 15:41:31.331206 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7621aed3-41d9-4125-8000-60539fdaa1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24c114670>]}
2021-11-04 15:41:31.331509 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 15:41:31.333526 (MainThread): 
2021-11-04 15:41:31.334368 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:41:31.336634 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 15:41:31.346602 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 15:41:31.347001 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 15:41:31.347145 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 15:41:37.183522 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 5.84 seconds
2021-11-04 15:41:37.185221 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 15:41:37.187588 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 15:41:37.194132 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:41:37.194334 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 15:41:37.194488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:41:38.647790 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.45 seconds
2021-11-04 15:41:38.648022 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:41:38.648171 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 15:41:38.663596 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-04 15:41:38.665011 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 15:41:38.666428 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 15:41:38.666979 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 15:41:38.700919 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:41:38.701147 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 15:41:38.701328 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:41:39.949655 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.25 seconds
2021-11-04 15:41:39.949891 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:41:39.950038 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 15:41:39.963010 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-04 15:41:39.964539 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 15:41:39.966044 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 15:41:39.966613 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:41:39.968605 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:41:39.968789 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 15:41:39.969036 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:41:41.232395 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-11-04 15:41:41.232615 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:41:41.232756 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 15:41:41.245111 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-04 15:41:41.246256 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 15:41:41.247419 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 15:41:41.253194 (MainThread): Using postgres connection "master".
2021-11-04 15:41:41.253402 (MainThread): On master: BEGIN
2021-11-04 15:41:41.253542 (MainThread): Opening a new connection, currently in state init
2021-11-04 15:41:42.715283 (MainThread): SQL status: BEGIN in 1.46 seconds
2021-11-04 15:41:42.715514 (MainThread): Using postgres connection "master".
2021-11-04 15:41:42.715662 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 15:41:42.854141 (MainThread): SQL status: SELECT 5 in 0.14 seconds
2021-11-04 15:41:42.855243 (MainThread): On master: ROLLBACK
2021-11-04 15:41:42.856440 (MainThread): Using postgres connection "master".
2021-11-04 15:41:42.856589 (MainThread): On master: BEGIN
2021-11-04 15:41:42.858813 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 15:41:42.858953 (MainThread): On master: COMMIT
2021-11-04 15:41:42.859069 (MainThread): Using postgres connection "master".
2021-11-04 15:41:42.859171 (MainThread): On master: COMMIT
2021-11-04 15:41:42.859994 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:41:42.860129 (MainThread): 21:11:42 | 
2021-11-04 15:41:42.860266 (MainThread): 21:11:42 | Running 1 on-run-start hook
2021-11-04 15:41:42.860394 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 15:41:42.862382 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 15:41:42.863662 (MainThread): 21:11:42 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 15:41:42.863844 (MainThread): Using postgres connection "master".
2021-11-04 15:41:42.863961 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START',''),'7621aed3-41d9-4125-8000-60539fdaa1f3';
    commit;


2021-11-04 15:41:42.866779 (MainThread): Postgres error: syntax error at or near "'7621aed3-41d9-4125-8000-60539fdaa1f3'"
LINE 4: ...b_model,invocation_id)  values('MAIN','START',''),'7621aed3-...
                                                             ^

2021-11-04 15:41:42.866960 (MainThread): Database error while running on-run-start
2021-11-04 15:41:42.867188 (MainThread): On master: Close
2021-11-04 15:41:42.867539 (MainThread): Connection 'master' was properly closed.
2021-11-04 15:41:42.867669 (MainThread): Connection 'list_postgres_dbt_test__audit' was properly closed.
2021-11-04 15:41:42.867858 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24c18d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24c18daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff24c18dc70>]}
2021-11-04 15:41:42.868077 (MainThread): Flushing usage events
2021-11-04 15:41:45.047356 (MainThread): Encountered an error:
2021-11-04 15:41:45.047664 (MainThread): Database Error
  syntax error at or near "'7621aed3-41d9-4125-8000-60539fdaa1f3'"
  LINE 4: ...b_model,invocation_id)  values('MAIN','START',''),'7621aed3-...
                                                               ^
2021-11-04 15:41:45.056921 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "'7621aed3-41d9-4125-8000-60539fdaa1f3'"
LINE 4: ...b_model,invocation_id)  values('MAIN','START',''),'7621aed3-...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 427, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 385, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 413, in before_run
    self.safe_run_hooks(adapter, RunHookType.Start, {})
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 353, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 335, in run_hooks
    status, _ = adapter.execute(sql, auto_begin=False,
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error
  syntax error at or near "'7621aed3-41d9-4125-8000-60539fdaa1f3'"
  LINE 4: ...b_model,invocation_id)  values('MAIN','START',''),'7621aed3-...
                                                               ^

2021-11-04 15:42:20.740790 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 15:42:20.812437 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 15:42:20.814068 (MainThread): Tracking: tracking
2021-11-04 15:42:20.922988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c101156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ffc2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ffc2e20>]}
2021-11-04 15:42:20.942638 (MainThread): Partial parsing not enabled
2021-11-04 15:42:20.992450 (MainThread): Parsing macros/test_empty.sql
2021-11-04 15:42:20.993334 (MainThread): Parsing macros/audits.sql
2021-11-04 15:42:20.994155 (MainThread): Parsing macros/test_country.sql
2021-11-04 15:42:20.994777 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 15:42:20.995848 (MainThread): Parsing macros/catalog.sql
2021-11-04 15:42:20.999149 (MainThread): Parsing macros/relations.sql
2021-11-04 15:42:21.000708 (MainThread): Parsing macros/adapters.sql
2021-11-04 15:42:21.022918 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 15:42:21.024607 (MainThread): Parsing macros/core.sql
2021-11-04 15:42:21.028166 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 15:42:21.034775 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 15:42:21.044390 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 15:42:21.046074 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 15:42:21.063554 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 15:42:21.102790 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 15:42:21.123073 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 15:42:21.124782 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 15:42:21.134283 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 15:42:21.153610 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 15:42:21.166701 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 15:42:21.174334 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 15:42:21.181688 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 15:42:21.185418 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 15:42:21.186329 (MainThread): Parsing macros/etc/query.sql
2021-11-04 15:42:21.187230 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 15:42:21.188725 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 15:42:21.196624 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 15:42:21.198528 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 15:42:21.199992 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 15:42:21.253510 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 15:42:21.255118 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 15:42:21.256186 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 15:42:21.257368 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 15:42:21.259282 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 15:42:21.260286 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 15:42:21.261587 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 15:42:21.263576 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 15:42:21.269163 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 15:42:21.270184 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 15:42:21.271389 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 15:42:21.273695 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 15:42:21.275136 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 15:42:21.277422 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 15:42:21.288132 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 15:42:21.290207 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 15:42:21.291608 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 15:42:21.293531 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 15:42:21.295258 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 15:42:21.296469 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 15:42:21.300657 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 15:42:21.306444 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 15:42:21.307273 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 15:42:21.309998 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 15:42:21.311721 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 15:42:21.313111 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 15:42:21.315106 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 15:42:21.349825 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 15:42:21.350632 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 15:42:21.351409 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 15:42:21.352104 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 15:42:21.355802 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 15:42:21.357315 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 15:42:21.359591 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 15:42:21.360722 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 15:42:21.361635 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 15:42:21.362912 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 15:42:21.364924 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 15:42:21.366121 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 15:42:21.367177 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 15:42:21.368795 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 15:42:21.369857 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 15:42:21.373427 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 15:42:21.376180 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 15:42:21.377822 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 15:42:21.379485 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 15:42:21.383621 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 15:42:21.390568 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 15:42:21.391802 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 15:42:21.394244 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 15:42:21.397611 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 15:42:21.399994 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 15:42:21.401005 (MainThread): Parsing macros/sql/star.sql
2021-11-04 15:42:21.403864 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 15:42:21.409937 (MainThread): Parsing macros/sql/union.sql
2021-11-04 15:42:21.420790 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 15:42:21.422043 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 15:42:21.426706 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 15:42:21.428425 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 15:42:21.430081 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 15:42:21.433402 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 15:42:21.437829 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 15:42:21.440467 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 15:42:21.604122 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 15:42:21.604340 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c101cc9d0>]}
2021-11-04 15:42:21.718922 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:21.730982 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:21.733999 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:21.742079 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:21.746810 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:21.753555 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 15:42:21.757054 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 15:42:21.778509 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 15:42:21.782300 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 15:42:21.878614 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 15:42:21.883875 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c10206dc0>]}
2021-11-04 15:42:21.892250 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c103039a0>]}
2021-11-04 15:42:21.892584 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 15:42:21.894323 (MainThread): 
2021-11-04 15:42:21.894751 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:42:21.895813 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 15:42:21.905572 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 15:42:21.905766 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 15:42:21.905907 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 15:42:23.326123 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 1.42 seconds
2021-11-04 15:42:23.327998 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 15:42:23.330947 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 15:42:23.339271 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:42:23.339482 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 15:42:23.339695 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:42:24.593838 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.25 seconds
2021-11-04 15:42:24.594084 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:42:24.594235 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 15:42:24.612675 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-04 15:42:24.614075 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 15:42:24.615477 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 15:42:24.616024 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 15:42:24.651311 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:42:24.651523 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 15:42:24.651666 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:42:25.948416 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.30 seconds
2021-11-04 15:42:25.948645 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:42:25.948787 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 15:42:25.963884 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-04 15:42:25.965424 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 15:42:25.966902 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 15:42:25.967401 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:42:25.969454 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:42:25.969637 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 15:42:25.969845 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:42:27.206566 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.24 seconds
2021-11-04 15:42:27.206810 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:42:27.206962 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 15:42:27.222522 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-04 15:42:27.223657 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 15:42:27.225159 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 15:42:27.231068 (MainThread): Using postgres connection "master".
2021-11-04 15:42:27.231270 (MainThread): On master: BEGIN
2021-11-04 15:42:27.231407 (MainThread): Opening a new connection, currently in state init
2021-11-04 15:42:28.600435 (MainThread): SQL status: BEGIN in 1.37 seconds
2021-11-04 15:42:28.600649 (MainThread): Using postgres connection "master".
2021-11-04 15:42:28.600768 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 15:42:28.733794 (MainThread): SQL status: SELECT 5 in 0.13 seconds
2021-11-04 15:42:28.734918 (MainThread): On master: ROLLBACK
2021-11-04 15:42:28.736590 (MainThread): Using postgres connection "master".
2021-11-04 15:42:28.736832 (MainThread): On master: BEGIN
2021-11-04 15:42:28.739320 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 15:42:28.739465 (MainThread): On master: COMMIT
2021-11-04 15:42:28.739588 (MainThread): Using postgres connection "master".
2021-11-04 15:42:28.739705 (MainThread): On master: COMMIT
2021-11-04 15:42:28.740611 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:28.740772 (MainThread): 21:12:28 | 
2021-11-04 15:42:28.740923 (MainThread): 21:12:28 | Running 1 on-run-start hook
2021-11-04 15:42:28.741056 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 15:42:28.743047 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 15:42:28.744342 (MainThread): 21:12:28 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 15:42:28.744531 (MainThread): Using postgres connection "master".
2021-11-04 15:42:28.744650 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;


2021-11-04 15:42:28.753614 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:42:28.754405 (MainThread): 21:12:28 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-04 15:42:28.754585 (MainThread): 21:12:28 | 
2021-11-04 15:42:28.754736 (MainThread): On master: Close
2021-11-04 15:42:28.755103 (MainThread): 21:12:28 | Concurrency: 1 threads (target='dev')
2021-11-04 15:42:28.755251 (MainThread): 21:12:28 | 
2021-11-04 15:42:28.757699 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-04 15:42:28.758081 (Thread-1): 21:12:28 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-04 15:42:28.758489 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:28.758673 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-04 15:42:28.761807 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 15:42:28.762443 (Thread-1): finished collecting timing info
2021-11-04 15:42:28.779856 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:28.780112 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-04 15:42:28.780243 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:42:30.018956 (Thread-1): SQL status: BEGIN in 1.24 seconds
2021-11-04 15:42:30.019195 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.019343 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:30.025460 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:42:30.031374 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 15:42:30.032818 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.032988 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-04 15:42:30.056469 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-11-04 15:42:30.062802 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.062994 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-04 15:42:30.065417 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:30.067626 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.067780 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-04 15:42:30.069979 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:30.076462 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.076694 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:30.080246 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:30.086742 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 15:42:30.086945 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.087082 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 15:42:30.088573 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:30.094616 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:42:30.094787 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-04 15:42:30.104435 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-04 15:42:30.105706 (Thread-1): finished collecting timing info
2021-11-04 15:42:30.105892 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-04 15:42:30.106288 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c101da040>]}
2021-11-04 15:42:30.106647 (Thread-1): 21:12:30 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.35s]
2021-11-04 15:42:30.106828 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-04 15:42:30.107006 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-04 15:42:30.107328 (Thread-1): 21:12:30 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-04 15:42:30.107627 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:30.107781 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-04 15:42:30.114239 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 15:42:30.115588 (Thread-1): finished collecting timing info
2021-11-04 15:42:30.144469 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:30.144728 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-04 15:42:30.144849 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:42:31.457286 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-11-04 15:42:31.457513 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.457659 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:31.462730 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:31.465699 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.465835 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp211230140698"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-04 15:42:31.480938 (Thread-1): SQL status: SELECT 151 in 0.01 seconds
2021-11-04 15:42:31.487705 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.487880 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp211230140698'
        
      order by ordinal_position

  
2021-11-04 15:42:31.519179 (Thread-1): SQL status: SELECT 7 in 0.03 seconds
2021-11-04 15:42:31.523829 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.524035 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 15:42:31.527951 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-04 15:42:31.535914 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.536055 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 15:42:31.540267 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-04 15:42:31.541588 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 15:42:31.542059 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.542175 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp211230140698"
    );
  
2021-11-04 15:42:31.549735 (Thread-1): SQL status: INSERT 0 151 in 0.01 seconds
2021-11-04 15:42:31.550842 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.550965 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:31.552861 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:31.553498 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 15:42:31.553629 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:42:31.553737 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 15:42:31.554843 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:31.555258 (Thread-1): finished collecting timing info
2021-11-04 15:42:31.555415 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-04 15:42:31.555786 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c074d6880>]}
2021-11-04 15:42:31.556091 (Thread-1): 21:12:31 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 151 in 1.45s]
2021-11-04 15:42:31.556248 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-04 15:42:31.556397 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-04 15:42:31.556678 (Thread-1): 21:12:31 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-04 15:42:31.556954 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:31.557101 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-04 15:42:31.559104 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 15:42:31.559803 (Thread-1): finished collecting timing info
2021-11-04 15:42:31.562181 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 15:42:31.563169 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:31.563343 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-04 15:42:31.563464 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:42:32.941446 (Thread-1): SQL status: BEGIN in 1.38 seconds
2021-11-04 15:42:32.941678 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:32.941826 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '95eb8807-5216-4ce1-87cd-81a126f14338' as invocation_id
  );
2021-11-04 15:42:32.967182 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-04 15:42:32.970174 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:32.970314 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-04 15:42:32.972000 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:32.974198 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:32.974377 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-04 15:42:32.976155 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:32.977179 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 15:42:32.977308 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:32.977411 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 15:42:32.980932 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:32.982636 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:42:32.982786 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-04 15:42:33.001326 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-04 15:42:33.002286 (Thread-1): finished collecting timing info
2021-11-04 15:42:33.002446 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-04 15:42:33.002761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c074d6880>]}
2021-11-04 15:42:33.003050 (Thread-1): 21:12:33 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.45s]
2021-11-04 15:42:33.003195 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-04 15:42:33.003341 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:42:33.003612 (Thread-1): 21:12:33 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-04 15:42:33.003851 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:33.003975 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:42:33.007821 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 15:42:33.008960 (Thread-1): finished collecting timing info
2021-11-04 15:42:33.020465 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:33.020638 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-04 15:42:33.020746 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:42:34.327778 (Thread-1): SQL status: BEGIN in 1.31 seconds
2021-11-04 15:42:34.328005 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.328145 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:34.333513 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:42:34.338241 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 15:42:34.339067 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.339307 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-04 15:42:34.362505 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-04 15:42:34.364816 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.364967 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-04 15:42:34.367238 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:34.369541 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.369728 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-04 15:42:34.372237 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:34.373498 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.373663 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:34.376706 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:34.377553 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 15:42:34.377714 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.377844 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 15:42:34.379475 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:34.381481 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:42:34.381687 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-04 15:42:34.386532 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 15:42:34.387788 (Thread-1): finished collecting timing info
2021-11-04 15:42:34.388025 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-04 15:42:34.388629 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c101ccf10>]}
2021-11-04 15:42:34.389410 (Thread-1): 21:12:34 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.38s]
2021-11-04 15:42:34.389743 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:42:34.390452 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:42:34.390898 (Thread-1): 21:12:34 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-04 15:42:34.391376 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:34.391567 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:42:34.398004 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 15:42:34.398659 (Thread-1): finished collecting timing info
2021-11-04 15:42:34.401208 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:34.401429 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-04 15:42:34.401581 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:42:35.968341 (Thread-1): SQL status: BEGIN in 1.57 seconds
2021-11-04 15:42:35.968557 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:35.968681 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:35.973363 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:35.974354 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 15:42:35.974908 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:35.975033 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-04 15:42:35.986116 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-04 15:42:35.990553 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:35.990748 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-04 15:42:35.993131 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:42:35.994180 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:35.994329 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;
      
2021-11-04 15:42:35.996228 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:35.996907 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 15:42:35.997045 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:35.997163 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 15:42:35.998291 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:35.999951 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:42:36.000103 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-04 15:42:36.001367 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 15:42:36.002376 (Thread-1): finished collecting timing info
2021-11-04 15:42:36.002556 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-04 15:42:36.002920 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95eb8807-5216-4ce1-87cd-81a126f14338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c10256e20>]}
2021-11-04 15:42:36.003271 (Thread-1): 21:12:36 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.61s]
2021-11-04 15:42:36.003472 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:42:36.004977 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:42:36.005343 (MainThread): Using postgres connection "master".
2021-11-04 15:42:36.005557 (MainThread): On master: BEGIN
2021-11-04 15:42:36.005765 (MainThread): Opening a new connection, currently in state closed
2021-11-04 15:42:37.415558 (MainThread): SQL status: BEGIN in 1.41 seconds
2021-11-04 15:42:37.415769 (MainThread): On master: COMMIT
2021-11-04 15:42:37.415888 (MainThread): Using postgres connection "master".
2021-11-04 15:42:37.415993 (MainThread): On master: COMMIT
2021-11-04 15:42:37.416915 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:42:37.417053 (MainThread): 21:12:37 | 
2021-11-04 15:42:37.417194 (MainThread): 21:12:37 | Running 1 on-run-end hook
2021-11-04 15:42:37.417335 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-04 15:42:37.419334 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-04 15:42:37.420256 (MainThread): 21:12:37 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-04 15:42:37.420507 (MainThread): Using postgres connection "master".
2021-11-04 15:42:37.420639 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','95eb8807-5216-4ce1-87cd-81a126f14338');
    commit;


2021-11-04 15:42:37.426323 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:42:37.427181 (MainThread): 21:12:37 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-04 15:42:37.427421 (MainThread): 21:12:37 | 
2021-11-04 15:42:37.427587 (MainThread): On master: Close
2021-11-04 15:42:37.427927 (MainThread): 21:12:37 | 
2021-11-04 15:42:37.428065 (MainThread): 21:12:37 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 15.53s.
2021-11-04 15:42:37.428190 (MainThread): Connection 'master' was properly closed.
2021-11-04 15:42:37.428289 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-04 15:42:37.436145 (MainThread): 
2021-11-04 15:42:37.436412 (MainThread): Completed successfully
2021-11-04 15:42:37.436600 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-04 15:42:37.436868 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ffc2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c105067f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1016f670>]}
2021-11-04 15:42:37.437220 (MainThread): Flushing usage events
2021-11-04 15:43:17.693432 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 15:43:17.757772 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 15:43:17.758946 (MainThread): Tracking: tracking
2021-11-04 15:43:17.771457 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa551682b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa55168bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa55168b50>]}
2021-11-04 15:43:17.794084 (MainThread): Partial parsing not enabled
2021-11-04 15:43:17.838052 (MainThread): Parsing macros/test_empty.sql
2021-11-04 15:43:17.838801 (MainThread): Parsing macros/audits.sql
2021-11-04 15:43:17.839463 (MainThread): Parsing macros/test_country.sql
2021-11-04 15:43:17.839968 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 15:43:17.840816 (MainThread): Parsing macros/catalog.sql
2021-11-04 15:43:17.843458 (MainThread): Parsing macros/relations.sql
2021-11-04 15:43:17.844694 (MainThread): Parsing macros/adapters.sql
2021-11-04 15:43:17.866973 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 15:43:17.868630 (MainThread): Parsing macros/core.sql
2021-11-04 15:43:17.872203 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 15:43:17.879790 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 15:43:17.889479 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 15:43:17.891026 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 15:43:17.907424 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 15:43:17.939554 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 15:43:17.958940 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 15:43:17.960488 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 15:43:17.969847 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 15:43:17.988847 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 15:43:18.001892 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 15:43:18.010720 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 15:43:18.019302 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 15:43:18.023482 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 15:43:18.024483 (MainThread): Parsing macros/etc/query.sql
2021-11-04 15:43:18.025573 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 15:43:18.027495 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 15:43:18.036153 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 15:43:18.037972 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 15:43:18.039402 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 15:43:18.093994 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 15:43:18.095600 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 15:43:18.096649 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 15:43:18.097813 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 15:43:18.099705 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 15:43:18.100683 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 15:43:18.101960 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 15:43:18.103938 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 15:43:18.109649 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 15:43:18.110680 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 15:43:18.111877 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 15:43:18.114208 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 15:43:18.115188 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 15:43:18.117412 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 15:43:18.128956 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 15:43:18.131014 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 15:43:18.132332 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 15:43:18.133866 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 15:43:18.135454 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 15:43:18.136697 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 15:43:18.139785 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 15:43:18.144759 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 15:43:18.145855 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 15:43:18.148876 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 15:43:18.151838 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 15:43:18.153379 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 15:43:18.155236 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 15:43:18.177049 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 15:43:18.177690 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 15:43:18.178322 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 15:43:18.178888 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 15:43:18.181843 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 15:43:18.182991 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 15:43:18.185267 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 15:43:18.186392 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 15:43:18.187233 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 15:43:18.188388 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 15:43:18.190223 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 15:43:18.191262 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 15:43:18.192094 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 15:43:18.193436 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 15:43:18.194260 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 15:43:18.196435 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 15:43:18.197706 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 15:43:18.198617 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 15:43:18.199793 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 15:43:18.202851 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 15:43:18.208317 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 15:43:18.209326 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 15:43:18.211499 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 15:43:18.214363 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 15:43:18.216676 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 15:43:18.217697 (MainThread): Parsing macros/sql/star.sql
2021-11-04 15:43:18.220146 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 15:43:18.225717 (MainThread): Parsing macros/sql/union.sql
2021-11-04 15:43:18.232739 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 15:43:18.233513 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 15:43:18.236300 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 15:43:18.237250 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 15:43:18.238642 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 15:43:18.241273 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 15:43:18.244902 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 15:43:18.247359 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 15:43:18.425128 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 15:43:18.425360 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa551fb8e0>]}
2021-11-04 15:43:18.561834 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:18.577022 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:18.580744 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:18.592203 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:18.598307 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:18.606334 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 15:43:18.610288 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 15:43:18.634951 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 15:43:18.638934 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 15:43:18.742495 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 15:43:18.748200 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa552a5580>]}
2021-11-04 15:43:18.758401 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa55293670>]}
2021-11-04 15:43:18.759006 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 15:43:18.761041 (MainThread): 
2021-11-04 15:43:18.761510 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:43:18.762653 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 15:43:18.772755 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 15:43:18.772944 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 15:43:18.773090 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 15:43:20.573375 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 1.80 seconds
2021-11-04 15:43:20.574656 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 15:43:20.576314 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 15:43:20.581798 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:43:20.581949 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 15:43:20.582066 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:43:22.081871 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.50 seconds
2021-11-04 15:43:22.082096 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 15:43:22.082234 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 15:43:22.094241 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-11-04 15:43:22.095368 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 15:43:22.096383 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 15:43:22.096820 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 15:43:22.128860 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:43:22.129072 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 15:43:22.129216 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:43:23.783346 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.65 seconds
2021-11-04 15:43:23.783577 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 15:43:23.783721 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 15:43:23.797232 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-04 15:43:23.798719 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 15:43:23.800270 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 15:43:23.800805 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:43:23.802775 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:43:23.802958 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 15:43:23.803194 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 15:43:25.424041 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.62 seconds
2021-11-04 15:43:25.424330 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 15:43:25.424485 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 15:43:25.437906 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-04 15:43:25.439057 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 15:43:25.440452 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 15:43:25.445806 (MainThread): Using postgres connection "master".
2021-11-04 15:43:25.446017 (MainThread): On master: BEGIN
2021-11-04 15:43:25.446161 (MainThread): Opening a new connection, currently in state init
2021-11-04 15:43:26.980089 (MainThread): SQL status: BEGIN in 1.53 seconds
2021-11-04 15:43:26.980341 (MainThread): Using postgres connection "master".
2021-11-04 15:43:26.980489 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 15:43:27.116813 (MainThread): SQL status: SELECT 5 in 0.14 seconds
2021-11-04 15:43:27.117931 (MainThread): On master: ROLLBACK
2021-11-04 15:43:27.119338 (MainThread): Using postgres connection "master".
2021-11-04 15:43:27.119521 (MainThread): On master: BEGIN
2021-11-04 15:43:27.121528 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 15:43:27.121665 (MainThread): On master: COMMIT
2021-11-04 15:43:27.121779 (MainThread): Using postgres connection "master".
2021-11-04 15:43:27.121880 (MainThread): On master: COMMIT
2021-11-04 15:43:27.122788 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:27.122938 (MainThread): 21:13:27 | 
2021-11-04 15:43:27.123082 (MainThread): 21:13:27 | Running 1 on-run-start hook
2021-11-04 15:43:27.123214 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 15:43:27.125243 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 15:43:27.126530 (MainThread): 21:13:27 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 15:43:27.126711 (MainThread): Using postgres connection "master".
2021-11-04 15:43:27.126823 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;


2021-11-04 15:43:27.131471 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:27.132177 (MainThread): 21:13:27 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-04 15:43:27.132343 (MainThread): 21:13:27 | 
2021-11-04 15:43:27.132503 (MainThread): On master: Close
2021-11-04 15:43:27.132800 (MainThread): 21:13:27 | Concurrency: 1 threads (target='dev')
2021-11-04 15:43:27.132936 (MainThread): 21:13:27 | 
2021-11-04 15:43:27.134678 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-04 15:43:27.134993 (Thread-1): 21:13:27 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-04 15:43:27.135402 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:27.135638 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-04 15:43:27.139361 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 15:43:27.140120 (Thread-1): finished collecting timing info
2021-11-04 15:43:27.159105 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:27.159527 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-04 15:43:27.159690 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:43:28.701712 (Thread-1): SQL status: BEGIN in 1.54 seconds
2021-11-04 15:43:28.701948 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.702096 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:28.710721 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:43:28.716612 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 15:43:28.717231 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.717392 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-04 15:43:28.738670 (Thread-1): SQL status: SELECT 44 in 0.02 seconds
2021-11-04 15:43:28.744606 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.744771 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-04 15:43:28.747474 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:28.749640 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.749789 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-04 15:43:28.751983 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:28.756385 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.756523 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:28.758675 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:28.763443 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 15:43:28.763581 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.763688 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 15:43:28.764866 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:28.769509 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 15:43:28.769636 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-04 15:43:28.778171 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-04 15:43:28.779277 (Thread-1): finished collecting timing info
2021-11-04 15:43:28.779440 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-04 15:43:28.779763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5521baf0>]}
2021-11-04 15:43:28.780060 (Thread-1): 21:13:28 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.64s]
2021-11-04 15:43:28.780210 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-04 15:43:28.780360 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-04 15:43:28.780646 (Thread-1): 21:13:28 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-04 15:43:28.780894 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:28.781024 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-04 15:43:28.786686 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 15:43:28.787324 (Thread-1): finished collecting timing info
2021-11-04 15:43:28.815708 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:28.815918 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-04 15:43:28.816045 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:43:30.027201 (Thread-1): SQL status: BEGIN in 1.21 seconds
2021-11-04 15:43:30.027434 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.027577 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:30.032642 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:30.036273 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.036444 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp211328812210"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-04 15:43:30.053236 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-04 15:43:30.060561 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.060742 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp211328812210'
        
      order by ordinal_position

  
2021-11-04 15:43:30.107743 (Thread-1): SQL status: SELECT 7 in 0.05 seconds
2021-11-04 15:43:30.113841 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.114055 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 15:43:30.119332 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-04 15:43:30.138567 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.139049 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 15:43:30.151429 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-04 15:43:30.154519 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 15:43:30.155733 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.156076 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp211328812210"
    );
  
2021-11-04 15:43:30.164898 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-11-04 15:43:30.167379 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.167679 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:30.171304 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:30.172932 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 15:43:30.173244 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 15:43:30.173548 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 15:43:30.175646 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:30.176545 (Thread-1): finished collecting timing info
2021-11-04 15:43:30.176885 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-04 15:43:30.177612 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa552b9940>]}
2021-11-04 15:43:30.178307 (Thread-1): 21:13:30 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 1.40s]
2021-11-04 15:43:30.178693 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-04 15:43:30.179122 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-04 15:43:30.179747 (Thread-1): 21:13:30 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-04 15:43:30.180708 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:30.181092 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-04 15:43:30.185291 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 15:43:30.186210 (Thread-1): finished collecting timing info
2021-11-04 15:43:30.190463 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 15:43:30.191515 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:30.191933 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-04 15:43:30.192163 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:43:31.785862 (Thread-1): SQL status: BEGIN in 1.59 seconds
2021-11-04 15:43:31.786125 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:31.786277 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '7218abe7-2b38-4550-b098-6d3865732ff6' as invocation_id
  );
2021-11-04 15:43:31.817560 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-04 15:43:31.821178 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:31.821425 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-04 15:43:31.823319 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:31.826079 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:31.826353 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-04 15:43:31.828493 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:31.830095 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 15:43:31.830284 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:31.830419 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 15:43:31.834256 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:31.836062 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 15:43:31.836220 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-04 15:43:31.856593 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-04 15:43:31.857549 (Thread-1): finished collecting timing info
2021-11-04 15:43:31.857708 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-04 15:43:31.858035 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa553d5520>]}
2021-11-04 15:43:31.858311 (Thread-1): 21:13:31 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.68s]
2021-11-04 15:43:31.858457 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-04 15:43:31.858613 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:43:31.858870 (Thread-1): 21:13:31 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-04 15:43:31.859116 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:31.859241 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:43:31.862760 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 15:43:31.863225 (Thread-1): finished collecting timing info
2021-11-04 15:43:31.874768 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:31.874961 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-04 15:43:31.875086 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:43:33.103955 (Thread-1): SQL status: BEGIN in 1.23 seconds
2021-11-04 15:43:33.104166 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.104284 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:33.108958 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:33.113268 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 15:43:33.113897 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.114074 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-04 15:43:33.130754 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-04 15:43:33.133461 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.133660 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-04 15:43:33.136823 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:33.139173 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.139340 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-04 15:43:33.141949 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:33.143189 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.143353 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:33.146074 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:33.146851 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 15:43:33.147013 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.147145 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 15:43:33.148460 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:33.150270 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 15:43:33.150431 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-04 15:43:33.154668 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 15:43:33.155788 (Thread-1): finished collecting timing info
2021-11-04 15:43:33.155989 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-04 15:43:33.156385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa553fedc0>]}
2021-11-04 15:43:33.156806 (Thread-1): 21:13:33 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.30s]
2021-11-04 15:43:33.156993 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 15:43:33.157557 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:43:33.157921 (Thread-1): 21:13:33 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-04 15:43:33.158253 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:33.158414 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:43:33.163059 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 15:43:33.163655 (Thread-1): finished collecting timing info
2021-11-04 15:43:33.166431 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:33.166660 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-04 15:43:33.166835 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 15:43:34.410507 (Thread-1): SQL status: BEGIN in 1.24 seconds
2021-11-04 15:43:34.410737 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:34.410851 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:34.415288 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:34.416199 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 15:43:34.416709 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:34.416828 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-04 15:43:34.430706 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-04 15:43:34.433767 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:34.433927 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-04 15:43:34.436261 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 15:43:34.437337 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:34.437517 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;
      
2021-11-04 15:43:34.439728 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:34.440420 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 15:43:34.440557 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:34.440665 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 15:43:34.441810 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:34.443306 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 15:43:34.443439 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-04 15:43:34.444615 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 15:43:34.445456 (Thread-1): finished collecting timing info
2021-11-04 15:43:34.445610 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-04 15:43:34.445938 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7218abe7-2b38-4550-b098-6d3865732ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54f55c70>]}
2021-11-04 15:43:34.446227 (Thread-1): 21:13:34 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.29s]
2021-11-04 15:43:34.446374 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 15:43:34.447198 (MainThread): Acquiring new postgres connection "master".
2021-11-04 15:43:34.447367 (MainThread): Using postgres connection "master".
2021-11-04 15:43:34.447484 (MainThread): On master: BEGIN
2021-11-04 15:43:34.447603 (MainThread): Opening a new connection, currently in state closed
2021-11-04 15:43:35.771270 (MainThread): SQL status: BEGIN in 1.32 seconds
2021-11-04 15:43:35.771517 (MainThread): On master: COMMIT
2021-11-04 15:43:35.771667 (MainThread): Using postgres connection "master".
2021-11-04 15:43:35.771801 (MainThread): On master: COMMIT
2021-11-04 15:43:35.773052 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 15:43:35.773257 (MainThread): 21:13:35 | 
2021-11-04 15:43:35.773448 (MainThread): 21:13:35 | Running 1 on-run-end hook
2021-11-04 15:43:35.773622 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-04 15:43:35.776288 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-04 15:43:35.777203 (MainThread): 21:13:35 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-04 15:43:35.777469 (MainThread): Using postgres connection "master".
2021-11-04 15:43:35.777627 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','7218abe7-2b38-4550-b098-6d3865732ff6');
    commit;


2021-11-04 15:43:35.785404 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 15:43:35.786289 (MainThread): 21:13:35 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-04 15:43:35.786507 (MainThread): 21:13:35 | 
2021-11-04 15:43:35.786699 (MainThread): On master: Close
2021-11-04 15:43:35.787161 (MainThread): 21:13:35 | 
2021-11-04 15:43:35.787343 (MainThread): 21:13:35 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 17.03s.
2021-11-04 15:43:35.787531 (MainThread): Connection 'master' was properly closed.
2021-11-04 15:43:35.787771 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-04 15:43:35.796543 (MainThread): 
2021-11-04 15:43:35.796815 (MainThread): Completed successfully
2021-11-04 15:43:35.797035 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-04 15:43:35.797291 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4fca23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa552023a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa551097c0>]}
2021-11-04 15:43:35.797554 (MainThread): Flushing usage events
2021-11-04 18:14:07.955793 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 18:14:08.067359 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 18:14:08.069015 (MainThread): Tracking: tracking
2021-11-04 18:14:08.254640 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd46055d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd46002670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd46002e20>]}
2021-11-04 18:14:08.275488 (MainThread): Partial parsing not enabled
2021-11-04 18:14:08.332659 (MainThread): Parsing macros/test_empty.sql
2021-11-04 18:14:08.333406 (MainThread): Parsing macros/audits.sql
2021-11-04 18:14:08.334085 (MainThread): Parsing macros/test_country.sql
2021-11-04 18:14:08.334582 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 18:14:08.335451 (MainThread): Parsing macros/catalog.sql
2021-11-04 18:14:08.338664 (MainThread): Parsing macros/relations.sql
2021-11-04 18:14:08.339894 (MainThread): Parsing macros/adapters.sql
2021-11-04 18:14:08.361852 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 18:14:08.363428 (MainThread): Parsing macros/core.sql
2021-11-04 18:14:08.366709 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 18:14:08.372783 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 18:14:08.381642 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 18:14:08.383077 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 18:14:08.399179 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 18:14:08.431528 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 18:14:08.451364 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 18:14:08.453040 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 18:14:08.462555 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 18:14:08.481043 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 18:14:08.494512 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 18:14:08.501988 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 18:14:08.509018 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 18:14:08.512539 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 18:14:08.513379 (MainThread): Parsing macros/etc/query.sql
2021-11-04 18:14:08.514308 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 18:14:08.515748 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 18:14:08.524025 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 18:14:08.525704 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 18:14:08.527360 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 18:14:08.579333 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 18:14:08.580902 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 18:14:08.581969 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 18:14:08.583163 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 18:14:08.585033 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 18:14:08.585996 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 18:14:08.587251 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 18:14:08.589292 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 18:14:08.594714 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 18:14:08.595707 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 18:14:08.596856 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 18:14:08.598956 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 18:14:08.599911 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 18:14:08.601966 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 18:14:08.610923 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 18:14:08.612584 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 18:14:08.613847 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 18:14:08.615331 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 18:14:08.616727 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 18:14:08.617578 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 18:14:08.620540 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 18:14:08.625796 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 18:14:08.626505 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 18:14:08.628947 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 18:14:08.630610 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 18:14:08.631955 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 18:14:08.633726 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 18:14:08.657038 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 18:14:08.657640 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 18:14:08.658253 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 18:14:08.658807 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 18:14:08.663159 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 18:14:08.664466 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 18:14:08.666378 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 18:14:08.667324 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 18:14:08.668134 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 18:14:08.669245 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 18:14:08.671006 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 18:14:08.672191 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 18:14:08.673079 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 18:14:08.674494 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 18:14:08.675291 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 18:14:08.677715 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 18:14:08.679143 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 18:14:08.680105 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 18:14:08.681241 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 18:14:08.684421 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 18:14:08.689944 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 18:14:08.690918 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 18:14:08.693076 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 18:14:08.696023 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 18:14:08.698382 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 18:14:08.699207 (MainThread): Parsing macros/sql/star.sql
2021-11-04 18:14:08.702157 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 18:14:08.708404 (MainThread): Parsing macros/sql/union.sql
2021-11-04 18:14:08.716205 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 18:14:08.717000 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 18:14:08.719446 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 18:14:08.720506 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 18:14:08.721500 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 18:14:08.723954 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 18:14:08.727393 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 18:14:08.729726 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 18:14:08.880333 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 18:14:08.880553 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56bed827-a1f3-45b9-a2a1-0ae5113abc8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4610c9d0>]}
2021-11-04 18:14:08.992085 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:14:09.003953 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:14:09.007338 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:14:09.015416 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:14:09.018338 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd460ae940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd461b7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd461c6910>]}
2021-11-04 18:14:09.018614 (MainThread): Flushing usage events
2021-11-04 18:14:15.256294 (MainThread): Connection 'model.dbt_demo_project.cust_count_by_state' was properly closed.
2021-11-04 18:14:15.256618 (MainThread): Encountered an error:
2021-11-04 18:14:15.256844 (MainThread): Compilation Error in model cust_count_by_state (models/postgres_model/cust_count_by_state.sql)
  expected token ':', got '}'
    line 2
      pre_hook=audits('POSTGRES_MODEL','STARTED',{{ this }}),
2021-11-04 18:14:15.266308 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    pre_hook=audits('POSTGRES_MODEL','STARTED',{{ this }}),

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 264, in load
    self.parse_project(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 373, in parse_project
    parser.parse_file(block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 385, in parse_node
    self.render_update(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/models.py", line 58, in render_update
    super().render_update(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 360, in render_update
    self.render_with_context(node, config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 273, in render_with_context
    get_rendered(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 591, in get_rendered
    template = get_template(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model cust_count_by_state (models/postgres_model/cust_count_by_state.sql)
  expected token ':', got '}'
    line 2
      pre_hook=audits('POSTGRES_MODEL','STARTED',{{ this }}),

2021-11-04 18:15:37.561344 (MainThread): Running with dbt=0.21.0-b1
2021-11-04 18:15:37.645085 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-04 18:15:37.647623 (MainThread): Tracking: tracking
2021-11-04 18:15:38.154353 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32301c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd323020d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd322fc15e0>]}
2021-11-04 18:15:38.179359 (MainThread): Partial parsing not enabled
2021-11-04 18:15:38.260960 (MainThread): Parsing macros/test_empty.sql
2021-11-04 18:15:38.261863 (MainThread): Parsing macros/audits.sql
2021-11-04 18:15:38.262701 (MainThread): Parsing macros/test_country.sql
2021-11-04 18:15:38.263351 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-04 18:15:38.264461 (MainThread): Parsing macros/catalog.sql
2021-11-04 18:15:38.268054 (MainThread): Parsing macros/relations.sql
2021-11-04 18:15:38.269606 (MainThread): Parsing macros/adapters.sql
2021-11-04 18:15:38.294096 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-04 18:15:38.295732 (MainThread): Parsing macros/core.sql
2021-11-04 18:15:38.299104 (MainThread): Parsing macros/materializations/test.sql
2021-11-04 18:15:38.305312 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-04 18:15:38.314977 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-04 18:15:38.316482 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-04 18:15:38.332290 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-04 18:15:38.364921 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-04 18:15:38.384922 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-04 18:15:38.386643 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-04 18:15:38.396650 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-04 18:15:38.416111 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-04 18:15:38.429097 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-04 18:15:38.436538 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-04 18:15:38.443556 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-04 18:15:38.447344 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-04 18:15:38.448141 (MainThread): Parsing macros/etc/query.sql
2021-11-04 18:15:38.449010 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-04 18:15:38.450370 (MainThread): Parsing macros/etc/datetime.sql
2021-11-04 18:15:38.458638 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-04 18:15:38.460321 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-04 18:15:38.461714 (MainThread): Parsing macros/adapters/common.sql
2021-11-04 18:15:38.514806 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-04 18:15:38.516429 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-04 18:15:38.517475 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-04 18:15:38.518661 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-04 18:15:38.520645 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-04 18:15:38.521639 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-04 18:15:38.522920 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-04 18:15:38.524881 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-04 18:15:38.530678 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-04 18:15:38.531727 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-04 18:15:38.532908 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-04 18:15:38.535142 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-04 18:15:38.536117 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-04 18:15:38.538212 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-04 18:15:38.547943 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-04 18:15:38.549785 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-04 18:15:38.551129 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-04 18:15:38.552742 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-04 18:15:38.554173 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-04 18:15:38.555048 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-04 18:15:38.558223 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-04 18:15:38.563232 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-04 18:15:38.563954 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-04 18:15:38.566423 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-04 18:15:38.568108 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-04 18:15:38.569483 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-04 18:15:38.571218 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-04 18:15:38.594641 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-04 18:15:38.595415 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-04 18:15:38.596148 (MainThread): Parsing macros/logger/log_info.sql
2021-11-04 18:15:38.596798 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-04 18:15:38.599786 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-04 18:15:38.600932 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-04 18:15:38.602948 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-04 18:15:38.603940 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-04 18:15:38.604812 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-04 18:15:38.606079 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-04 18:15:38.608032 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-04 18:15:38.609292 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-04 18:15:38.610232 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-04 18:15:38.611797 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-04 18:15:38.612647 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-04 18:15:38.615089 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-04 18:15:38.616358 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-04 18:15:38.617262 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-04 18:15:38.618422 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-04 18:15:38.621514 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-04 18:15:38.626770 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-04 18:15:38.627762 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-04 18:15:38.629923 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-04 18:15:38.632954 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-04 18:15:38.635455 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-04 18:15:38.636350 (MainThread): Parsing macros/sql/star.sql
2021-11-04 18:15:38.639050 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-04 18:15:38.646030 (MainThread): Parsing macros/sql/union.sql
2021-11-04 18:15:38.654074 (MainThread): Parsing macros/sql/groupby.sql
2021-11-04 18:15:38.654932 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-04 18:15:38.657802 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-04 18:15:38.658760 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-04 18:15:38.659784 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-04 18:15:38.662219 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-04 18:15:38.666024 (MainThread): Parsing macros/sql/pivot.sql
2021-11-04 18:15:38.668435 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-04 18:15:38.820996 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-04 18:15:38.821208 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3230d0310>]}
2021-11-04 18:15:38.930378 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:38.942148 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:38.945584 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:38.954638 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:38.960244 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:38.965907 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-04 18:15:38.968716 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-04 18:15:39.147923 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-04 18:15:39.152271 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-04 18:15:39.269202 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-04 18:15:39.274036 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3231671f0>]}
2021-11-04 18:15:39.282651 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32312b190>]}
2021-11-04 18:15:39.283021 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-04 18:15:39.284618 (MainThread): 
2021-11-04 18:15:39.285009 (MainThread): Acquiring new postgres connection "master".
2021-11-04 18:15:39.285915 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-04 18:15:39.294984 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-04 18:15:39.295175 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-04 18:15:39.295319 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-04 18:15:43.987567 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 4.69 seconds
2021-11-04 18:15:43.989030 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-04 18:15:43.991005 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-04 18:15:43.997991 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 18:15:43.998186 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-04 18:15:43.998343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 18:15:45.352268 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.35 seconds
2021-11-04 18:15:45.352500 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-04 18:15:45.352648 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-04 18:15:45.375197 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-04 18:15:45.376588 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-04 18:15:45.378055 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-04 18:15:45.378629 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-04 18:15:45.413109 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 18:15:45.413330 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-04 18:15:45.413483 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 18:15:46.933251 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.52 seconds
2021-11-04 18:15:46.933477 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-04 18:15:46.933614 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-04 18:15:46.946746 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-11-04 18:15:46.948045 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-04 18:15:46.949119 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-04 18:15:46.949524 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-04 18:15:46.951083 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 18:15:46.951215 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-04 18:15:46.951346 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-04 18:15:48.694227 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.74 seconds
2021-11-04 18:15:48.694456 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-04 18:15:48.694599 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-04 18:15:48.709132 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-04 18:15:48.710315 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-04 18:15:48.711608 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-04 18:15:48.717965 (MainThread): Using postgres connection "master".
2021-11-04 18:15:48.718182 (MainThread): On master: BEGIN
2021-11-04 18:15:48.718329 (MainThread): Opening a new connection, currently in state init
2021-11-04 18:15:50.363877 (MainThread): SQL status: BEGIN in 1.65 seconds
2021-11-04 18:15:50.364067 (MainThread): Using postgres connection "master".
2021-11-04 18:15:50.364178 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-04 18:15:50.515266 (MainThread): SQL status: SELECT 5 in 0.15 seconds
2021-11-04 18:15:50.516365 (MainThread): On master: ROLLBACK
2021-11-04 18:15:50.518133 (MainThread): Using postgres connection "master".
2021-11-04 18:15:50.518276 (MainThread): On master: BEGIN
2021-11-04 18:15:50.521074 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-04 18:15:50.521309 (MainThread): On master: COMMIT
2021-11-04 18:15:50.521461 (MainThread): Using postgres connection "master".
2021-11-04 18:15:50.521566 (MainThread): On master: COMMIT
2021-11-04 18:15:50.522553 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:50.522707 (MainThread): 23:45:50 | 
2021-11-04 18:15:50.522856 (MainThread): 23:45:50 | Running 1 on-run-start hook
2021-11-04 18:15:50.522994 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-04 18:15:50.525435 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-04 18:15:50.528619 (MainThread): 23:45:50 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-04 18:15:50.528909 (MainThread): Using postgres connection "master".
2021-11-04 18:15:50.529087 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;


2021-11-04 18:15:50.549221 (MainThread): SQL status: COMMIT in 0.02 seconds
2021-11-04 18:15:50.550118 (MainThread): 23:45:50 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.02s]
2021-11-04 18:15:50.550340 (MainThread): 23:45:50 | 
2021-11-04 18:15:50.550537 (MainThread): On master: Close
2021-11-04 18:15:50.550973 (MainThread): 23:45:50 | Concurrency: 1 threads (target='dev')
2021-11-04 18:15:50.551177 (MainThread): 23:45:50 | 
2021-11-04 18:15:50.557390 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-04 18:15:50.557850 (Thread-1): 23:45:50 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-04 18:15:50.558283 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:50.558476 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-04 18:15:50.562855 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 18:15:50.563606 (Thread-1): finished collecting timing info
2021-11-04 18:15:50.587650 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:50.587879 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-04 18:15:50.588032 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 18:15:52.264461 (Thread-1): SQL status: BEGIN in 1.68 seconds
2021-11-04 18:15:52.264822 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.265054 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','"postgres"."dbtdemo"."cust_count_by_state"','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:52.274943 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 18:15:52.282846 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-04 18:15:52.283720 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.283944 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-04 18:15:52.326262 (Thread-1): SQL status: SELECT 44 in 0.04 seconds
2021-11-04 18:15:52.332613 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.332822 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-04 18:15:52.336240 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:52.338742 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.338918 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-04 18:15:52.341219 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:52.347113 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.347301 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','"postgres"."dbtdemo"."cust_count_by_state"','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:52.349952 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:52.356219 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 18:15:52.356419 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.356558 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-04 18:15:52.358495 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:52.364435 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-04 18:15:52.364599 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-04 18:15:52.375539 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-04 18:15:52.376625 (Thread-1): finished collecting timing info
2021-11-04 18:15:52.376806 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-04 18:15:52.377150 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3230fd100>]}
2021-11-04 18:15:52.377458 (Thread-1): 23:45:52 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.82s]
2021-11-04 18:15:52.377777 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-04 18:15:52.378006 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-04 18:15:52.378299 (Thread-1): 23:45:52 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-04 18:15:52.378576 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:52.378713 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-04 18:15:52.384963 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 18:15:52.386691 (Thread-1): finished collecting timing info
2021-11-04 18:15:52.422122 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:52.422333 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-04 18:15:52.422481 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 18:15:54.177336 (Thread-1): SQL status: BEGIN in 1.75 seconds
2021-11-04 18:15:54.177736 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.178048 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:54.186551 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 18:15:54.190632 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.190826 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp234552418011"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-04 18:15:54.215351 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-04 18:15:54.223552 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.223757 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp234552418011'
        
      order by ordinal_position

  
2021-11-04 18:15:54.284497 (Thread-1): SQL status: SELECT 7 in 0.06 seconds
2021-11-04 18:15:54.289657 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.289830 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 18:15:54.294723 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-04 18:15:54.305216 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.305390 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-04 18:15:54.309423 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-04 18:15:54.310785 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-04 18:15:54.311337 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.311456 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp234552418011"
    );
  
2021-11-04 18:15:54.317542 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-11-04 18:15:54.318677 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.318803 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:54.320940 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:54.321600 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 18:15:54.321733 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-04 18:15:54.321850 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-04 18:15:54.323150 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:54.323552 (Thread-1): finished collecting timing info
2021-11-04 18:15:54.323706 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-04 18:15:54.324022 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3231588b0>]}
2021-11-04 18:15:54.324312 (Thread-1): 23:45:54 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 1.95s]
2021-11-04 18:15:54.324494 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-04 18:15:54.324647 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-04 18:15:54.325015 (Thread-1): 23:45:54 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-04 18:15:54.325400 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:54.325581 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-04 18:15:54.327522 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 18:15:54.328490 (Thread-1): finished collecting timing info
2021-11-04 18:15:54.331828 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-04 18:15:54.333270 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:54.333569 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-04 18:15:54.333716 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 18:15:55.664175 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-04 18:15:55.664370 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:55.664485 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '8971d25b-8e6e-4799-a927-9cea1e6b114e' as invocation_id
  );
2021-11-04 18:15:55.691249 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-04 18:15:55.694511 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:55.694686 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-04 18:15:55.696507 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:55.698875 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:55.699027 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-04 18:15:55.700783 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:55.701921 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 18:15:55.702056 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:55.702168 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-04 18:15:55.704890 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:55.706444 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-04 18:15:55.706591 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-04 18:15:55.725044 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-04 18:15:55.726109 (Thread-1): finished collecting timing info
2021-11-04 18:15:55.726301 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-04 18:15:55.726686 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3231e0550>]}
2021-11-04 18:15:55.726995 (Thread-1): 23:45:55 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.40s]
2021-11-04 18:15:55.727152 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-04 18:15:55.727302 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 18:15:55.727605 (Thread-1): 23:45:55 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-04 18:15:55.727878 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:55.728018 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-04 18:15:55.732491 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 18:15:55.733224 (Thread-1): finished collecting timing info
2021-11-04 18:15:55.746612 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:55.746785 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-04 18:15:55.746896 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 18:15:57.425240 (Thread-1): SQL status: BEGIN in 1.68 seconds
2021-11-04 18:15:57.425432 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.425548 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:57.430065 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:57.433789 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-04 18:15:57.434337 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.434465 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-04 18:15:57.450474 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-04 18:15:57.452560 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.452691 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-04 18:15:57.454561 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:57.456555 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.456690 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-04 18:15:57.458859 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:57.459863 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.459985 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:57.462135 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:57.462749 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 18:15:57.462887 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.462990 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-04 18:15:57.464239 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:57.465645 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-04 18:15:57.465776 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-04 18:15:57.469975 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 18:15:57.470916 (Thread-1): finished collecting timing info
2021-11-04 18:15:57.471077 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-04 18:15:57.471412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32306f070>]}
2021-11-04 18:15:57.471713 (Thread-1): 23:45:57 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.74s]
2021-11-04 18:15:57.471921 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-04 18:15:57.472356 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 18:15:57.472652 (Thread-1): 23:45:57 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-04 18:15:57.472924 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:57.473056 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-04 18:15:57.477968 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 18:15:57.478488 (Thread-1): finished collecting timing info
2021-11-04 18:15:57.480698 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:57.480881 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-04 18:15:57.481011 (Thread-1): Opening a new connection, currently in state closed
2021-11-04 18:15:59.172544 (Thread-1): SQL status: BEGIN in 1.69 seconds
2021-11-04 18:15:59.172798 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:59.172962 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:59.180110 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-04 18:15:59.181567 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-04 18:15:59.183166 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:59.183379 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-04 18:15:59.200737 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-04 18:15:59.204431 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:59.204604 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-04 18:15:59.207594 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-04 18:15:59.209324 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:59.209516 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;
      
2021-11-04 18:15:59.212333 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:59.213536 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 18:15:59.213713 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:59.213862 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-04 18:15:59.215560 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:15:59.217315 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-04 18:15:59.217487 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-04 18:15:59.219191 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-04 18:15:59.220429 (Thread-1): finished collecting timing info
2021-11-04 18:15:59.220744 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-04 18:15:59.221613 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8971d25b-8e6e-4799-a927-9cea1e6b114e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd323510d60>]}
2021-11-04 18:15:59.222234 (Thread-1): 23:45:59 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.75s]
2021-11-04 18:15:59.222546 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-04 18:15:59.224038 (MainThread): Acquiring new postgres connection "master".
2021-11-04 18:15:59.224269 (MainThread): Using postgres connection "master".
2021-11-04 18:15:59.224513 (MainThread): On master: BEGIN
2021-11-04 18:15:59.224684 (MainThread): Opening a new connection, currently in state closed
2021-11-04 18:16:01.174317 (MainThread): SQL status: BEGIN in 1.95 seconds
2021-11-04 18:16:01.174600 (MainThread): On master: COMMIT
2021-11-04 18:16:01.174774 (MainThread): Using postgres connection "master".
2021-11-04 18:16:01.174915 (MainThread): On master: COMMIT
2021-11-04 18:16:01.176120 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-04 18:16:01.176324 (MainThread): 23:46:01 | 
2021-11-04 18:16:01.176516 (MainThread): 23:46:01 | Running 1 on-run-end hook
2021-11-04 18:16:01.176688 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-04 18:16:01.179297 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-04 18:16:01.180669 (MainThread): 23:46:01 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-04 18:16:01.180983 (MainThread): Using postgres connection "master".
2021-11-04 18:16:01.181162 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','8971d25b-8e6e-4799-a927-9cea1e6b114e');
    commit;


2021-11-04 18:16:01.189224 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-04 18:16:01.190704 (MainThread): 23:46:01 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-04 18:16:01.190948 (MainThread): 23:46:01 | 
2021-11-04 18:16:01.191149 (MainThread): On master: Close
2021-11-04 18:16:01.191860 (MainThread): 23:46:01 | 
2021-11-04 18:16:01.192207 (MainThread): 23:46:01 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 21.91s.
2021-11-04 18:16:01.192512 (MainThread): Connection 'master' was properly closed.
2021-11-04 18:16:01.192727 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-04 18:16:01.205914 (MainThread): 
2021-11-04 18:16:01.206429 (MainThread): Completed successfully
2021-11-04 18:16:01.206796 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-04 18:16:01.207200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32352e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd322fdea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3231c3a00>]}
2021-11-04 18:16:01.207633 (MainThread): Flushing usage events
2021-11-09 10:00:25.926888 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 10:00:26.080447 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{country:IND}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-09 10:00:26.083493 (MainThread): Tracking: tracking
2021-11-09 10:00:26.298093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a721dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a723eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a6c3640>]}
2021-11-09 10:00:26.321676 (MainThread): Partial parsing not enabled
2021-11-09 10:00:26.399010 (MainThread): Parsing macros/test_empty.sql
2021-11-09 10:00:26.400174 (MainThread): Parsing macros/audits.sql
2021-11-09 10:00:26.400896 (MainThread): Parsing macros/test_country.sql
2021-11-09 10:00:26.401421 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 10:00:26.402585 (MainThread): Parsing macros/catalog.sql
2021-11-09 10:00:26.406610 (MainThread): Parsing macros/relations.sql
2021-11-09 10:00:26.408042 (MainThread): Parsing macros/adapters.sql
2021-11-09 10:00:26.431828 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 10:00:26.433389 (MainThread): Parsing macros/core.sql
2021-11-09 10:00:26.437584 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 10:00:26.444306 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 10:00:26.454059 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 10:00:26.455954 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 10:00:26.473069 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 10:00:26.510348 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 10:00:26.532556 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 10:00:26.534258 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 10:00:26.544977 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 10:00:26.567955 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 10:00:26.582550 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 10:00:26.590184 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 10:00:26.599189 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 10:00:26.603147 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 10:00:26.604126 (MainThread): Parsing macros/etc/query.sql
2021-11-09 10:00:26.605045 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 10:00:26.606461 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 10:00:26.615113 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 10:00:26.616880 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 10:00:26.618335 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 10:00:26.678250 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 10:00:26.680072 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 10:00:26.681291 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 10:00:26.682702 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 10:00:26.684993 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 10:00:26.686265 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 10:00:26.687673 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 10:00:26.689704 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 10:00:26.696405 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 10:00:26.697882 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 10:00:26.699704 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 10:00:26.703603 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 10:00:26.705163 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 10:00:26.708997 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 10:00:26.727209 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 10:00:26.730750 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 10:00:26.732780 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 10:00:26.734557 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 10:00:26.736171 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 10:00:26.737932 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 10:00:26.741737 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 10:00:26.748817 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 10:00:26.750188 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 10:00:26.754531 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 10:00:26.758268 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 10:00:26.760458 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 10:00:26.764635 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 10:00:26.800188 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 10:00:26.801622 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 10:00:26.802491 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 10:00:26.803155 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 10:00:26.807136 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 10:00:26.808828 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 10:00:26.812230 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 10:00:26.814526 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 10:00:26.816613 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 10:00:26.818804 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 10:00:26.822990 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 10:00:26.825229 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 10:00:26.826934 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 10:00:26.829337 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 10:00:26.830277 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 10:00:26.832555 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 10:00:26.833829 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 10:00:26.834892 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 10:00:26.836079 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 10:00:26.839286 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 10:00:26.844615 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 10:00:26.845626 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 10:00:26.849483 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 10:00:26.854079 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 10:00:26.857461 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 10:00:26.859046 (MainThread): Parsing macros/sql/star.sql
2021-11-09 10:00:26.864181 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 10:00:26.875829 (MainThread): Parsing macros/sql/union.sql
2021-11-09 10:00:26.885549 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 10:00:26.886450 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 10:00:26.889003 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 10:00:26.890063 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 10:00:26.891113 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 10:00:26.893988 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 10:00:26.901004 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 10:00:26.906414 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 10:00:27.124217 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 10:00:27.124464 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a7be9d0>]}
2021-11-09 10:00:27.274666 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:00:27.289022 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:27.292389 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:27.303119 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:27.309601 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:27.316764 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 10:00:27.320166 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 10:00:27.340247 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 10:00:27.343385 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 10:00:27.451249 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 10:00:27.457438 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a8410d0>]}
2021-11-09 10:00:27.468805 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6ab1e070>]}
2021-11-09 10:00:27.469250 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 10:00:27.471102 (MainThread): 
2021-11-09 10:00:27.471645 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:00:27.473004 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-09 10:00:27.483449 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-09 10:00:27.483661 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-09 10:00:27.483816 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 10:00:41.363154 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 13.88 seconds
2021-11-09 10:00:41.365163 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-09 10:00:41.367415 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:00:41.374254 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:00:41.374460 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 10:00:41.374609 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:00:43.769548 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.39 seconds
2021-11-09 10:00:43.770009 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:00:43.770353 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 10:00:43.837245 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.07 seconds
2021-11-09 10:00:43.838612 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 10:00:43.840299 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 10:00:43.841106 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 10:00:43.880582 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:00:43.880812 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 10:00:43.880980 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:00:45.376661 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.50 seconds
2021-11-09 10:00:45.376902 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:00:45.377057 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 10:00:45.391716 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-09 10:00:45.393167 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 10:00:45.397162 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 10:00:45.397921 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 10:00:45.399923 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:00:45.400116 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 10:00:45.400268 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:00:47.411035 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.01 seconds
2021-11-09 10:00:47.411627 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:00:47.411980 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 10:00:47.432049 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 10:00:47.433588 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 10:00:47.436150 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 10:00:47.446991 (MainThread): Using postgres connection "master".
2021-11-09 10:00:47.447393 (MainThread): On master: BEGIN
2021-11-09 10:00:47.447614 (MainThread): Opening a new connection, currently in state init
2021-11-09 10:00:49.204057 (MainThread): SQL status: BEGIN in 1.76 seconds
2021-11-09 10:00:49.204309 (MainThread): Using postgres connection "master".
2021-11-09 10:00:49.204460 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 10:00:49.454295 (MainThread): SQL status: SELECT 5 in 0.25 seconds
2021-11-09 10:00:49.455649 (MainThread): On master: ROLLBACK
2021-11-09 10:00:49.457135 (MainThread): Using postgres connection "master".
2021-11-09 10:00:49.457306 (MainThread): On master: BEGIN
2021-11-09 10:00:49.459918 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-09 10:00:49.460113 (MainThread): On master: COMMIT
2021-11-09 10:00:49.460264 (MainThread): Using postgres connection "master".
2021-11-09 10:00:49.460398 (MainThread): On master: COMMIT
2021-11-09 10:00:49.461837 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:49.462026 (MainThread): 15:30:49 | 
2021-11-09 10:00:49.462210 (MainThread): 15:30:49 | Running 1 on-run-start hook
2021-11-09 10:00:49.462390 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-09 10:00:49.464854 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-09 10:00:49.467829 (MainThread): 15:30:49 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-09 10:00:49.468084 (MainThread): Using postgres connection "master".
2021-11-09 10:00:49.468234 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;


2021-11-09 10:00:49.548317 (MainThread): SQL status: COMMIT in 0.08 seconds
2021-11-09 10:00:49.549191 (MainThread): 15:30:49 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.08s]
2021-11-09 10:00:49.549402 (MainThread): 15:30:49 | 
2021-11-09 10:00:49.549592 (MainThread): On master: Close
2021-11-09 10:00:49.549945 (MainThread): 15:30:49 | Concurrency: 1 threads (target='dev')
2021-11-09 10:00:49.550122 (MainThread): 15:30:49 | 
2021-11-09 10:00:49.553914 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:00:49.554366 (Thread-1): 15:30:49 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-09 10:00:49.554964 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:49.555236 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-09 10:00:49.558748 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:00:49.559595 (Thread-1): finished collecting timing info
2021-11-09 10:00:49.579973 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:49.580191 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-09 10:00:49.580342 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:00:51.481207 (Thread-1): SQL status: BEGIN in 1.90 seconds
2021-11-09 10:00:51.481462 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.481622 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:00:51.488667 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:00:51.495428 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:00:51.496825 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.497031 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-09 10:00:51.575755 (Thread-1): SQL status: SELECT 44 in 0.08 seconds
2021-11-09 10:00:51.581998 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.582180 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-09 10:00:51.591238 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-09 10:00:51.594712 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.595005 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-09 10:00:51.602226 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-09 10:00:51.607861 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.608086 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:00:51.611902 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:51.618773 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:00:51.619014 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.619176 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:00:51.621018 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:51.627730 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:00:51.627957 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-09 10:00:51.730049 (Thread-1): SQL status: DROP TABLE in 0.10 seconds
2021-11-09 10:00:51.732462 (Thread-1): finished collecting timing info
2021-11-09 10:00:51.732760 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-09 10:00:51.733256 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a7e83a0>]}
2021-11-09 10:00:51.733672 (Thread-1): 15:30:51 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 2.18s]
2021-11-09 10:00:51.733896 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:00:51.734141 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-09 10:00:51.734786 (Thread-1): 15:30:51 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-09 10:00:51.735269 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:51.735464 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-09 10:00:51.743863 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:00:51.745059 (Thread-1): finished collecting timing info
2021-11-09 10:00:51.807079 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:51.807322 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-09 10:00:51.807492 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:00:53.338167 (Thread-1): SQL status: BEGIN in 1.53 seconds
2021-11-09 10:00:53.338513 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.338800 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:00:53.347909 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:00:53.352394 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.352622 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp153051802531"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-09 10:00:53.402171 (Thread-1): SQL status: SELECT 1 in 0.05 seconds
2021-11-09 10:00:53.411649 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.411914 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp153051802531'
        
      order by ordinal_position

  
2021-11-09 10:00:53.597646 (Thread-1): SQL status: SELECT 7 in 0.19 seconds
2021-11-09 10:00:53.606713 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.607050 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:00:53.618334 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-09 10:00:53.649315 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.649647 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:00:53.658370 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-09 10:00:53.661707 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:00:53.662696 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.662973 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp153051802531"
    );
  
2021-11-09 10:00:53.680520 (Thread-1): SQL status: INSERT 0 1 in 0.02 seconds
2021-11-09 10:00:53.683051 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.683390 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:00:53.687361 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:53.689584 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:00:53.689917 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:00:53.690172 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:00:53.692743 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:53.693357 (Thread-1): finished collecting timing info
2021-11-09 10:00:53.693651 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-09 10:00:53.694252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a86a070>]}
2021-11-09 10:00:53.695158 (Thread-1): 15:30:53 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 1.96s]
2021-11-09 10:00:53.695787 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-09 10:00:53.696284 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:00:53.696936 (Thread-1): 15:30:53 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-09 10:00:53.697948 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:53.698272 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-09 10:00:53.706620 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:00:53.708161 (Thread-1): finished collecting timing info
2021-11-09 10:00:53.714532 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:00:53.716309 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:53.716851 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-09 10:00:53.717523 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:00:55.081502 (Thread-1): SQL status: BEGIN in 1.36 seconds
2021-11-09 10:00:55.082112 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:55.082294 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '9de014af-58a9-4032-8df7-8cfa0a03de23' as invocation_id
  );
2021-11-09 10:00:55.137529 (Thread-1): SQL status: SELECT 1 in 0.06 seconds
2021-11-09 10:00:55.141578 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:55.141814 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-09 10:00:55.146153 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:00:55.149428 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:55.149645 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-09 10:00:55.153587 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:00:55.155029 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:00:55.155210 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:55.155358 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:00:55.159193 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:55.161403 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:00:55.161614 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-09 10:00:55.214620 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-11-09 10:00:55.216433 (Thread-1): finished collecting timing info
2021-11-09 10:00:55.216749 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-09 10:00:55.217484 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a7d1f10>]}
2021-11-09 10:00:55.218124 (Thread-1): 15:30:55 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.52s]
2021-11-09 10:00:55.218492 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:00:55.218914 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:00:55.219530 (Thread-1): 15:30:55 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-09 10:00:55.220081 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:55.220398 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:00:55.226230 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:00:55.227124 (Thread-1): finished collecting timing info
2021-11-09 10:00:55.249139 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:55.249384 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-09 10:00:55.249547 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:00:56.613477 (Thread-1): SQL status: BEGIN in 1.36 seconds
2021-11-09 10:00:56.614043 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.614387 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:00:56.628377 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:00:56.637611 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:00:56.638835 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.639239 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-09 10:00:56.706375 (Thread-1): SQL status: CREATE VIEW in 0.07 seconds
2021-11-09 10:00:56.710775 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.711169 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-09 10:00:56.716164 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:00:56.721042 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.721391 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-09 10:00:56.726536 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:00:56.729221 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.729713 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:00:56.734873 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:56.735808 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:00:56.735995 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.736142 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:00:56.740721 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:00:56.743724 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:00:56.743953 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-09 10:00:56.752772 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-09 10:00:56.755487 (Thread-1): finished collecting timing info
2021-11-09 10:00:56.756046 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-09 10:00:56.756740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a7d1640>]}
2021-11-09 10:00:56.757196 (Thread-1): 15:30:56 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.54s]
2021-11-09 10:00:56.757609 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:00:56.759447 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:00:56.760071 (Thread-1): 15:30:56 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-09 10:00:56.760665 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:00:56.761106 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:00:56.782180 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:00:56.827771 (Thread-1): finished collecting timing info
2021-11-09 10:00:56.833082 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:00:56.833506 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-09 10:00:56.833948 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:01:00.381787 (Thread-1): SQL status: BEGIN in 3.55 seconds
2021-11-09 10:01:00.382508 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:01:00.382975 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:01:00.392893 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:01:00.395157 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:01:00.396177 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:01:00.396441 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-09 10:01:00.438673 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-11-09 10:01:00.443311 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:01:00.443575 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-09 10:01:00.453559 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-09 10:01:00.455268 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:01:00.455572 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;
      
2021-11-09 10:01:00.460450 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:01:00.461409 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:01:00.461598 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:01:00.461912 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:01:00.465271 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:01:00.467545 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:01:00.467801 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-09 10:01:00.471577 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-09 10:01:00.472998 (Thread-1): finished collecting timing info
2021-11-09 10:01:00.473233 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-09 10:01:00.473938 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de014af-58a9-4032-8df7-8cfa0a03de23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6ab0e970>]}
2021-11-09 10:01:00.474347 (Thread-1): 15:31:00 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 3.71s]
2021-11-09 10:01:00.474562 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:01:00.476032 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:01:00.476344 (MainThread): Using postgres connection "master".
2021-11-09 10:01:00.476543 (MainThread): On master: BEGIN
2021-11-09 10:01:00.476704 (MainThread): Opening a new connection, currently in state closed
2021-11-09 10:01:02.766484 (MainThread): SQL status: BEGIN in 2.29 seconds
2021-11-09 10:01:02.769006 (MainThread): On master: COMMIT
2021-11-09 10:01:02.769341 (MainThread): Using postgres connection "master".
2021-11-09 10:01:02.769596 (MainThread): On master: COMMIT
2021-11-09 10:01:02.771812 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:01:02.772190 (MainThread): 15:31:02 | 
2021-11-09 10:01:02.772574 (MainThread): 15:31:02 | Running 1 on-run-end hook
2021-11-09 10:01:02.772891 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-09 10:01:02.779132 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-09 10:01:02.780303 (MainThread): 15:31:02 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-09 10:01:02.780672 (MainThread): Using postgres connection "master".
2021-11-09 10:01:02.781017 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','9de014af-58a9-4032-8df7-8cfa0a03de23');
    commit;


2021-11-09 10:01:02.792664 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:01:02.794128 (MainThread): 15:31:02 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-09 10:01:02.794535 (MainThread): 15:31:02 | 
2021-11-09 10:01:02.794864 (MainThread): On master: Close
2021-11-09 10:01:02.795566 (MainThread): 15:31:02 | 
2021-11-09 10:01:02.795868 (MainThread): 15:31:02 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 35.32s.
2021-11-09 10:01:02.796139 (MainThread): Connection 'master' was properly closed.
2021-11-09 10:01:02.796347 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-09 10:01:02.827293 (MainThread): 
2021-11-09 10:01:02.827766 (MainThread): Completed successfully
2021-11-09 10:01:02.828223 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-09 10:01:02.828679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a6e0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6af0b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6a6cbcd0>]}
2021-11-09 10:01:02.829114 (MainThread): Flushing usage events
2021-11-09 10:08:06.005146 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 10:08:06.108652 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{"country":"IND"}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-09 10:08:06.110795 (MainThread): Tracking: tracking
2021-11-09 10:08:06.315422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a817910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a7c26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a7c2e50>]}
2021-11-09 10:08:06.337152 (MainThread): Partial parsing not enabled
2021-11-09 10:08:06.908765 (MainThread): Parsing macros/test_empty.sql
2021-11-09 10:08:06.909715 (MainThread): Parsing macros/audits.sql
2021-11-09 10:08:06.910659 (MainThread): Parsing macros/test_country.sql
2021-11-09 10:08:06.911321 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 10:08:06.912447 (MainThread): Parsing macros/catalog.sql
2021-11-09 10:08:06.917075 (MainThread): Parsing macros/relations.sql
2021-11-09 10:08:06.918909 (MainThread): Parsing macros/adapters.sql
2021-11-09 10:08:06.947705 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 10:08:06.949839 (MainThread): Parsing macros/core.sql
2021-11-09 10:08:06.954246 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 10:08:06.961695 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 10:08:06.974892 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 10:08:06.976882 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 10:08:06.996472 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 10:08:07.037426 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 10:08:07.060705 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 10:08:07.062627 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 10:08:07.074455 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 10:08:07.097115 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 10:08:07.115179 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 10:08:07.124196 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 10:08:07.133128 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 10:08:07.137719 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 10:08:07.138665 (MainThread): Parsing macros/etc/query.sql
2021-11-09 10:08:07.139747 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 10:08:07.141539 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 10:08:07.151247 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 10:08:07.153214 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 10:08:07.154839 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 10:08:07.215089 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 10:08:07.216934 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 10:08:07.218142 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 10:08:07.219499 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 10:08:07.221701 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 10:08:07.222846 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 10:08:07.224339 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 10:08:07.226695 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 10:08:07.233059 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 10:08:07.234324 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 10:08:07.235698 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 10:08:07.238167 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 10:08:07.239279 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 10:08:07.241685 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 10:08:07.252171 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 10:08:07.254187 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 10:08:07.255696 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 10:08:07.257441 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 10:08:07.259078 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 10:08:07.260040 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 10:08:07.263434 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 10:08:07.269252 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 10:08:07.270199 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 10:08:07.273075 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 10:08:07.275018 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 10:08:07.276599 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 10:08:07.278598 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 10:08:07.305817 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 10:08:07.306581 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 10:08:07.307297 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 10:08:07.307941 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 10:08:07.311436 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 10:08:07.312927 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 10:08:07.315144 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 10:08:07.316358 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 10:08:07.317338 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 10:08:07.318686 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 10:08:07.320826 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 10:08:07.322041 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 10:08:07.323098 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 10:08:07.324838 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 10:08:07.325832 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 10:08:07.328470 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 10:08:07.329993 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 10:08:07.331045 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 10:08:07.332403 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 10:08:07.336082 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 10:08:07.342008 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 10:08:07.343146 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 10:08:07.345605 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 10:08:07.348849 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 10:08:07.351357 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 10:08:07.352313 (MainThread): Parsing macros/sql/star.sql
2021-11-09 10:08:07.355102 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 10:08:07.361458 (MainThread): Parsing macros/sql/union.sql
2021-11-09 10:08:07.369639 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 10:08:07.370601 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 10:08:07.373426 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 10:08:07.374430 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 10:08:07.375593 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 10:08:07.378560 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 10:08:07.382847 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 10:08:07.385778 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 10:08:07.555317 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 10:08:07.555563 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a8bf8e0>]}
2021-11-09 10:08:07.693345 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:07.708809 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:07.712645 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:07.723673 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:07.730636 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:07.740761 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 10:08:07.745133 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 10:08:07.906599 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 10:08:07.912755 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 10:08:08.046103 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 10:08:08.052767 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a967580>]}
2021-11-09 10:08:08.063428 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a959670>]}
2021-11-09 10:08:08.063808 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 10:08:08.065654 (MainThread): 
2021-11-09 10:08:08.066160 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:08:08.067902 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-09 10:08:08.078406 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-09 10:08:08.078609 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-09 10:08:08.078764 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 10:08:13.339960 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 5.26 seconds
2021-11-09 10:08:13.341677 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-09 10:08:13.343719 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 10:08:13.350779 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:08:13.350977 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 10:08:13.351123 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:08:16.667441 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 3.32 seconds
2021-11-09 10:08:16.667678 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:08:16.667828 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 10:08:16.683548 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 10:08:16.685005 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 10:08:16.686382 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 10:08:16.686911 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:08:16.729298 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:08:16.729568 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 10:08:16.729794 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:08:20.526879 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 3.80 seconds
2021-11-09 10:08:20.527105 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:08:20.527245 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 10:08:20.539939 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-09 10:08:20.541203 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 10:08:20.542872 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 10:08:20.543382 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 10:08:20.544989 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:08:20.545147 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 10:08:20.545281 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:08:22.823431 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.28 seconds
2021-11-09 10:08:22.823647 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:08:22.823784 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 10:08:22.837077 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-11-09 10:08:22.838365 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 10:08:22.839693 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 10:08:22.845308 (MainThread): Using postgres connection "master".
2021-11-09 10:08:22.845508 (MainThread): On master: BEGIN
2021-11-09 10:08:22.845650 (MainThread): Opening a new connection, currently in state init
2021-11-09 10:08:24.063822 (MainThread): SQL status: BEGIN in 1.22 seconds
2021-11-09 10:08:24.064083 (MainThread): Using postgres connection "master".
2021-11-09 10:08:24.064241 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 10:08:24.224565 (MainThread): SQL status: SELECT 5 in 0.16 seconds
2021-11-09 10:08:24.225803 (MainThread): On master: ROLLBACK
2021-11-09 10:08:24.227200 (MainThread): Using postgres connection "master".
2021-11-09 10:08:24.227350 (MainThread): On master: BEGIN
2021-11-09 10:08:24.229810 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-09 10:08:24.229990 (MainThread): On master: COMMIT
2021-11-09 10:08:24.230121 (MainThread): Using postgres connection "master".
2021-11-09 10:08:24.230236 (MainThread): On master: COMMIT
2021-11-09 10:08:24.231482 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:24.231657 (MainThread): 15:38:24 | 
2021-11-09 10:08:24.231821 (MainThread): 15:38:24 | Running 1 on-run-start hook
2021-11-09 10:08:24.231971 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-09 10:08:24.234159 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-09 10:08:24.236558 (MainThread): 15:38:24 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-09 10:08:24.236756 (MainThread): Using postgres connection "master".
2021-11-09 10:08:24.236886 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;


2021-11-09 10:08:24.244323 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:08:24.245189 (MainThread): 15:38:24 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-09 10:08:24.245399 (MainThread): 15:38:24 | 
2021-11-09 10:08:24.245575 (MainThread): On master: Close
2021-11-09 10:08:24.245923 (MainThread): 15:38:24 | Concurrency: 1 threads (target='dev')
2021-11-09 10:08:24.246087 (MainThread): 15:38:24 | 
2021-11-09 10:08:24.249164 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:08:24.249747 (Thread-1): 15:38:24 | 1 of 5 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-09 10:08:24.250271 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:24.250528 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-09 10:08:24.254291 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:08:24.255415 (Thread-1): finished collecting timing info
2021-11-09 10:08:24.283955 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:24.284199 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-09 10:08:24.284467 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:08:25.509585 (Thread-1): SQL status: BEGIN in 1.23 seconds
2021-11-09 10:08:25.509823 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.509976 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:25.516143 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:08:25.522136 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:08:25.523342 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.523521 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-09 10:08:25.549545 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-09 10:08:25.556404 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.556641 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-09 10:08:25.559564 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:25.562300 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.562513 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-09 10:08:25.565625 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:25.571115 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.571310 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:25.574619 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:25.581308 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:08:25.581504 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.581642 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:08:25.583765 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:25.590068 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:08:25.590284 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-09 10:08:25.605564 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-09 10:08:25.606976 (Thread-1): finished collecting timing info
2021-11-09 10:08:25.607198 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-09 10:08:25.607639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a8bf070>]}
2021-11-09 10:08:25.608098 (Thread-1): 15:38:25 | 1 of 5 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.36s]
2021-11-09 10:08:25.608439 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:08:25.608787 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-09 10:08:25.609212 (Thread-1): 15:38:25 | 2 of 5 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-09 10:08:25.609688 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:25.609866 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-09 10:08:25.617850 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:08:25.619315 (Thread-1): finished collecting timing info
2021-11-09 10:08:25.658693 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:25.659003 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-09 10:08:25.659199 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:08:26.876250 (Thread-1): SQL status: BEGIN in 1.22 seconds
2021-11-09 10:08:26.876505 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.876648 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:26.881946 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:08:26.885217 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.885375 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp153825653598"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-09 10:08:26.903934 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-09 10:08:26.911096 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.911278 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp153825653598'
        
      order by ordinal_position

  
2021-11-09 10:08:26.948429 (Thread-1): SQL status: SELECT 7 in 0.04 seconds
2021-11-09 10:08:26.954203 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.954419 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:08:26.959306 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-09 10:08:26.970408 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.970605 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:08:26.974935 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-09 10:08:26.976694 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:08:26.977349 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.977534 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp153825653598"
    );
  
2021-11-09 10:08:26.985133 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-11-09 10:08:26.986499 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.986657 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:26.989247 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:26.990049 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:08:26.990213 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:08:26.990343 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:08:26.991832 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:26.992444 (Thread-1): finished collecting timing info
2021-11-09 10:08:26.992662 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-09 10:08:26.993071 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a9774c0>]}
2021-11-09 10:08:26.993424 (Thread-1): 15:38:26 | 2 of 5 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 1.38s]
2021-11-09 10:08:26.993646 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-09 10:08:26.993911 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:08:26.994293 (Thread-1): 15:38:26 | 3 of 5 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-09 10:08:26.994742 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:26.994983 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-09 10:08:26.998334 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:08:26.999673 (Thread-1): finished collecting timing info
2021-11-09 10:08:27.003418 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:08:27.004537 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:27.004759 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-09 10:08:27.004961 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:08:28.203287 (Thread-1): SQL status: BEGIN in 1.20 seconds
2021-11-09 10:08:28.203523 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:28.203666 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '9d01da39-eaad-40c3-b1a5-a127bfaa7040' as invocation_id
  );
2021-11-09 10:08:28.232260 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-09 10:08:28.235830 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:28.236002 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-09 10:08:28.237563 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:28.239776 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:28.239935 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-09 10:08:28.241356 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:28.242690 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:08:28.242880 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:28.243022 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:08:28.247259 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:28.249030 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:08:28.249191 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-09 10:08:28.272351 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-09 10:08:28.273529 (Thread-1): finished collecting timing info
2021-11-09 10:08:28.273727 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-09 10:08:28.274182 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a806a60>]}
2021-11-09 10:08:28.274578 (Thread-1): 15:38:28 | 3 of 5 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.28s]
2021-11-09 10:08:28.274774 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:08:28.274960 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:08:28.275289 (Thread-1): 15:38:28 | 4 of 5 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-09 10:08:28.275620 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:28.275784 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:08:28.280755 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:08:28.281324 (Thread-1): finished collecting timing info
2021-11-09 10:08:28.295906 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:28.296114 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-09 10:08:28.296253 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:08:29.783994 (Thread-1): SQL status: BEGIN in 1.49 seconds
2021-11-09 10:08:29.784313 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.784475 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:29.793020 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:08:29.800491 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:08:29.919303 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.919666 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-09 10:08:29.942640 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-09 10:08:29.945465 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.945737 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-09 10:08:29.949277 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:29.951878 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.952078 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-09 10:08:29.955581 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:29.956907 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.957072 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:29.960740 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:29.962562 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:08:29.962936 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.963378 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:08:29.965922 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:29.968011 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:08:29.968191 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-09 10:08:29.974971 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-09 10:08:29.976256 (Thread-1): finished collecting timing info
2021-11-09 10:08:29.976484 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-09 10:08:29.977358 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819aac0df0>]}
2021-11-09 10:08:29.978055 (Thread-1): 15:38:29 | 4 of 5 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.70s]
2021-11-09 10:08:29.978481 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:08:29.980054 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:08:29.980617 (Thread-1): 15:38:29 | 5 of 5 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-09 10:08:29.981447 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:29.981820 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:08:29.990085 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:08:29.990747 (Thread-1): finished collecting timing info
2021-11-09 10:08:29.995664 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:29.996012 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-09 10:08:29.996261 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:08:31.329469 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-09 10:08:31.329711 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:31.329858 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:31.335380 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:08:31.336608 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:08:31.337261 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:31.337421 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'IND' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-09 10:08:31.349658 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-09 10:08:31.353486 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:31.353682 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-09 10:08:31.356443 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:08:31.357751 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:31.357917 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;
      
2021-11-09 10:08:31.360443 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:31.361486 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:08:31.361722 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:31.361875 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:08:31.363724 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:31.365881 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:08:31.366090 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-09 10:08:31.367847 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-09 10:08:31.369044 (Thread-1): finished collecting timing info
2021-11-09 10:08:31.369254 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-09 10:08:31.369668 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d01da39-eaad-40c3-b1a5-a127bfaa7040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819ad076d0>]}
2021-11-09 10:08:31.370118 (Thread-1): 15:38:31 | 5 of 5 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.39s]
2021-11-09 10:08:31.370373 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:08:31.371676 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:08:31.371915 (MainThread): Using postgres connection "master".
2021-11-09 10:08:31.372066 (MainThread): On master: BEGIN
2021-11-09 10:08:31.372213 (MainThread): Opening a new connection, currently in state closed
2021-11-09 10:08:32.776340 (MainThread): SQL status: BEGIN in 1.40 seconds
2021-11-09 10:08:32.776711 (MainThread): On master: COMMIT
2021-11-09 10:08:32.776892 (MainThread): Using postgres connection "master".
2021-11-09 10:08:32.777033 (MainThread): On master: COMMIT
2021-11-09 10:08:32.778879 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:08:32.779118 (MainThread): 15:38:32 | 
2021-11-09 10:08:32.779428 (MainThread): 15:38:32 | Running 1 on-run-end hook
2021-11-09 10:08:32.779727 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-09 10:08:32.782531 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-09 10:08:32.783656 (MainThread): 15:38:32 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-09 10:08:32.783895 (MainThread): Using postgres connection "master".
2021-11-09 10:08:32.784140 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','9d01da39-eaad-40c3-b1a5-a127bfaa7040');
    commit;


2021-11-09 10:08:32.791599 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:08:32.792567 (MainThread): 15:38:32 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-09 10:08:32.792806 (MainThread): 15:38:32 | 
2021-11-09 10:08:32.793083 (MainThread): On master: Close
2021-11-09 10:08:32.793563 (MainThread): 15:38:32 | 
2021-11-09 10:08:32.793814 (MainThread): 15:38:32 | Finished running 2 table models, 1 incremental model, 2 view models, 2 hooks in 24.73s.
2021-11-09 10:08:32.794249 (MainThread): Connection 'master' was properly closed.
2021-11-09 10:08:32.794527 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-09 10:08:32.806333 (MainThread): 
2021-11-09 10:08:32.806741 (MainThread): Completed successfully
2021-11-09 10:08:32.807040 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-09 10:08:32.807422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a7cbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a7cb970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819a7cbd60>]}
2021-11-09 10:08:32.807842 (MainThread): Flushing usage events
2021-11-09 10:19:41.237672 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 10:19:41.339413 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-09 10:19:41.341713 (MainThread): Tracking: tracking
2021-11-09 10:19:41.521123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da919370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da920cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da7c25e0>]}
2021-11-09 10:19:41.542427 (MainThread): Partial parsing not enabled
2021-11-09 10:19:41.619422 (MainThread): Parsing macros/test_empty.sql
2021-11-09 10:19:41.620176 (MainThread): Parsing macros/audits.sql
2021-11-09 10:19:41.620850 (MainThread): Parsing macros/test_country.sql
2021-11-09 10:19:41.621369 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 10:19:41.622263 (MainThread): Parsing macros/catalog.sql
2021-11-09 10:19:41.625480 (MainThread): Parsing macros/relations.sql
2021-11-09 10:19:41.626747 (MainThread): Parsing macros/adapters.sql
2021-11-09 10:19:41.649257 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 10:19:41.650895 (MainThread): Parsing macros/core.sql
2021-11-09 10:19:41.654314 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 10:19:41.660846 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 10:19:41.670496 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 10:19:41.672642 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 10:19:41.693216 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 10:19:41.735306 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 10:19:41.759310 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 10:19:41.761684 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 10:19:41.771969 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 10:19:41.798281 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 10:19:41.820440 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 10:19:41.833898 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 10:19:41.843431 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 10:19:41.849409 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 10:19:41.850363 (MainThread): Parsing macros/etc/query.sql
2021-11-09 10:19:41.851440 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 10:19:41.853327 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 10:19:41.862335 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 10:19:41.864608 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 10:19:41.868928 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 10:19:41.932582 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 10:19:41.934278 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 10:19:41.935345 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 10:19:41.936549 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 10:19:41.938496 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 10:19:41.939520 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 10:19:41.940845 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 10:19:41.942827 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 10:19:41.948935 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 10:19:41.950039 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 10:19:41.951229 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 10:19:41.953377 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 10:19:41.954450 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 10:19:41.956877 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 10:19:41.966904 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 10:19:41.968863 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 10:19:41.970250 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 10:19:41.971830 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 10:19:41.973269 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 10:19:41.974152 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 10:19:41.977810 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 10:19:41.982783 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 10:19:41.983516 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 10:19:41.986018 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 10:19:41.987706 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 10:19:41.989155 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 10:19:41.990927 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 10:19:42.017338 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 10:19:42.017990 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 10:19:42.018615 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 10:19:42.019175 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 10:19:42.022361 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 10:19:42.023514 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 10:19:42.025435 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 10:19:42.026350 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 10:19:42.027140 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 10:19:42.028232 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 10:19:42.030276 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 10:19:42.031326 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 10:19:42.032242 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 10:19:42.033570 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 10:19:42.034416 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 10:19:42.036578 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 10:19:42.037836 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 10:19:42.038822 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 10:19:42.040111 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 10:19:42.043792 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 10:19:42.049088 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 10:19:42.050256 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 10:19:42.052474 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 10:19:42.055767 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 10:19:42.058011 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 10:19:42.058891 (MainThread): Parsing macros/sql/star.sql
2021-11-09 10:19:42.061437 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 10:19:42.069048 (MainThread): Parsing macros/sql/union.sql
2021-11-09 10:19:42.076751 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 10:19:42.077586 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 10:19:42.080116 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 10:19:42.080982 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 10:19:42.081999 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 10:19:42.084417 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 10:19:42.087935 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 10:19:42.090597 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 10:19:42.311929 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 10:19:42.312274 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da9cceb0>]}
2021-11-09 10:19:42.487656 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:19:42.505366 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:19:42.513100 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:19:42.517424 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:42.528740 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:42.535759 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:19:42.542288 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 10:19:42.547201 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 10:19:42.574340 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 10:19:42.578583 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 10:19:42.692893 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 10:19:42.699300 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3daaa1910>]}
2021-11-09 10:19:42.709921 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3daa74460>]}
2021-11-09 10:19:42.710522 (MainThread): Found 8 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 10:19:42.713137 (MainThread): 
2021-11-09 10:19:42.713694 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:19:42.715021 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-09 10:19:42.785154 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-09 10:19:42.785444 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-09 10:19:42.785651 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 10:19:45.285796 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 2.50 seconds
2021-11-09 10:19:45.287026 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-09 10:19:45.288861 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 10:19:45.294007 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:19:45.294173 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 10:19:45.294322 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:19:48.157541 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.86 seconds
2021-11-09 10:19:48.157779 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:19:48.157930 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 10:19:48.173160 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-09 10:19:48.174521 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 10:19:48.176073 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 10:19:48.176752 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 10:19:48.179950 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:19:48.180516 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 10:19:48.180819 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:19:51.092088 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.91 seconds
2021-11-09 10:19:51.092328 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:19:51.092479 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 10:19:51.112482 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 10:19:51.113979 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 10:19:51.115764 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 10:19:51.116381 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:19:51.118287 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:19:51.118782 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 10:19:51.118967 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:19:54.042748 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.92 seconds
2021-11-09 10:19:54.042982 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:19:54.043133 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 10:19:54.060881 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-09 10:19:54.062063 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 10:19:54.063836 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 10:19:54.070162 (MainThread): Using postgres connection "master".
2021-11-09 10:19:54.070372 (MainThread): On master: BEGIN
2021-11-09 10:19:54.070517 (MainThread): Opening a new connection, currently in state init
2021-11-09 10:19:55.607482 (MainThread): SQL status: BEGIN in 1.54 seconds
2021-11-09 10:19:55.607723 (MainThread): Using postgres connection "master".
2021-11-09 10:19:55.607870 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 10:19:55.872579 (MainThread): SQL status: SELECT 5 in 0.26 seconds
2021-11-09 10:19:55.874018 (MainThread): On master: ROLLBACK
2021-11-09 10:19:55.875852 (MainThread): Using postgres connection "master".
2021-11-09 10:19:55.876171 (MainThread): On master: BEGIN
2021-11-09 10:19:55.888562 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-09 10:19:55.888827 (MainThread): On master: COMMIT
2021-11-09 10:19:55.888988 (MainThread): Using postgres connection "master".
2021-11-09 10:19:55.889130 (MainThread): On master: COMMIT
2021-11-09 10:19:55.891246 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:19:55.891533 (MainThread): 15:49:55 | 
2021-11-09 10:19:55.891729 (MainThread): 15:49:55 | Running 1 on-run-start hook
2021-11-09 10:19:55.891908 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-09 10:19:55.894549 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-09 10:19:55.896741 (MainThread): 15:49:55 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-09 10:19:55.897176 (MainThread): Using postgres connection "master".
2021-11-09 10:19:55.897415 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;


2021-11-09 10:19:55.915131 (MainThread): SQL status: COMMIT in 0.02 seconds
2021-11-09 10:19:55.916037 (MainThread): 15:49:55 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.02s]
2021-11-09 10:19:55.916319 (MainThread): 15:49:55 | 
2021-11-09 10:19:55.916520 (MainThread): On master: Close
2021-11-09 10:19:55.917090 (MainThread): 15:49:55 | Concurrency: 1 threads (target='dev')
2021-11-09 10:19:55.917319 (MainThread): 15:49:55 | 
2021-11-09 10:19:55.920709 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:19:55.921090 (Thread-1): 15:49:55 | 1 of 6 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-09 10:19:55.921551 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:55.921857 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-09 10:19:55.927593 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:19:55.928426 (Thread-1): finished collecting timing info
2021-11-09 10:19:55.953670 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:55.953906 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-09 10:19:55.954060 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:19:57.653594 (Thread-1): SQL status: BEGIN in 1.70 seconds
2021-11-09 10:19:57.653837 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.653992 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:19:57.661797 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:19:57.670509 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:19:57.671517 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.671800 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-09 10:19:57.705461 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-09 10:19:57.713899 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.714127 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-09 10:19:57.718044 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:19:57.720762 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.720963 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-09 10:19:57.723965 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:19:57.729525 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.729734 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:19:57.732826 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:19:57.740762 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:19:57.741037 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.741238 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:19:57.743145 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:19:57.750382 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:19:57.750609 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-09 10:19:57.763255 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-09 10:19:57.765072 (Thread-1): finished collecting timing info
2021-11-09 10:19:57.765326 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-09 10:19:57.765850 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3daac8790>]}
2021-11-09 10:19:57.766325 (Thread-1): 15:49:57 | 1 of 6 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.84s]
2021-11-09 10:19:57.766537 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:19:57.766882 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-09 10:19:57.767527 (Thread-1): 15:49:57 | 2 of 6 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-09 10:19:57.768144 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:57.768356 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-09 10:19:57.779343 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:19:57.779980 (Thread-1): finished collecting timing info
2021-11-09 10:19:57.828760 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:57.829089 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-09 10:19:57.829314 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:19:59.161392 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-09 10:19:59.161649 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.161805 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:19:59.167513 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:19:59.171208 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.171402 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp154957820842"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-09 10:19:59.192386 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-09 10:19:59.201595 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.201829 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp154957820842'
        
      order by ordinal_position

  
2021-11-09 10:19:59.249480 (Thread-1): SQL status: SELECT 7 in 0.05 seconds
2021-11-09 10:19:59.255235 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.255466 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:19:59.261592 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-09 10:19:59.274424 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.274645 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:19:59.280943 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-09 10:19:59.282925 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:19:59.283722 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.283894 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp154957820842"
    );
  
2021-11-09 10:19:59.294679 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-11-09 10:19:59.296994 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.297346 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:19:59.303893 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:19:59.304989 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:19:59.305197 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:19:59.305354 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:19:59.307639 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:19:59.308224 (Thread-1): finished collecting timing info
2021-11-09 10:19:59.308436 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-09 10:19:59.308855 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da9f1e80>]}
2021-11-09 10:19:59.309230 (Thread-1): 15:49:59 | 2 of 6 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 1.54s]
2021-11-09 10:19:59.309424 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-09 10:19:59.309618 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:19:59.309957 (Thread-1): 15:49:59 | 3 of 6 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-09 10:19:59.310382 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:19:59.310737 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-09 10:19:59.314226 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:19:59.315115 (Thread-1): finished collecting timing info
2021-11-09 10:19:59.321386 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:19:59.322236 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:19:59.322445 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-09 10:19:59.322605 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:20:00.605643 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-11-09 10:20:00.606227 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:20:00.606419 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '38e8db57-eb01-4bff-8232-d98b4301f49d' as invocation_id
  );
2021-11-09 10:20:00.658471 (Thread-1): SQL status: SELECT 1 in 0.05 seconds
2021-11-09 10:20:00.663582 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:20:00.663859 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-09 10:20:00.666102 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:20:00.669608 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:20:00.669837 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-09 10:20:00.672178 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:20:00.673997 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:20:00.674204 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:20:00.674361 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:20:00.678438 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:20:00.680801 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:20:00.681031 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-09 10:20:00.713474 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-11-09 10:20:00.715572 (Thread-1): finished collecting timing info
2021-11-09 10:20:00.716002 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-09 10:20:00.716830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da9f1f40>]}
2021-11-09 10:20:00.717472 (Thread-1): 15:50:00 | 3 of 6 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.41s]
2021-11-09 10:20:00.717829 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:20:00.718134 (Thread-1): Began running node model.dbt_demo_project.model_ alias
2021-11-09 10:20:00.719288 (Thread-1): 15:50:00 | 4 of 6 START table model dbtdemo.even_events......................... [RUN]
2021-11-09 10:20:00.719937 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:20:00.720309 (Thread-1): Compiling model.dbt_demo_project.model_ alias
2021-11-09 10:20:00.728275 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.model_ alias"
2021-11-09 10:20:00.729109 (Thread-1): finished collecting timing info
2021-11-09 10:20:00.733291 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:20:00.733522 (Thread-1): On model.dbt_demo_project.model_ alias: BEGIN
2021-11-09 10:20:00.733745 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:20:02.168627 (Thread-1): SQL status: BEGIN in 1.43 seconds
2021-11-09 10:20:02.168877 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:20:02.169036 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','MODEL_ALIAS','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:20:02.178007 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:20:02.179294 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.model_ alias"
2021-11-09 10:20:02.180039 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:20:02.180264 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */


  create  table "postgres"."dbtdemo"."model_ alias__dbt_tmp"
  as (
    
 select * from events where mod(id,2)=0;
  );
2021-11-09 10:20:02.184803 (Thread-1): Postgres error: syntax error at or near ";"
LINE 7:  select * from events where mod(id,2)=0;
                                               ^

2021-11-09 10:20:02.185063 (Thread-1): On model.dbt_demo_project.model_ alias: ROLLBACK
2021-11-09 10:20:02.186806 (Thread-1): finished collecting timing info
2021-11-09 10:20:02.187033 (Thread-1): On model.dbt_demo_project.model_ alias: Close
2021-11-09 10:20:02.187439 (Thread-1): Database Error in model model_ alias (models/postgres_model/model_ alias.sql)
  syntax error at or near ";"
  LINE 7:  select * from events where mod(id,2)=0;
                                                 ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/model_ alias.sql
Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 51, in exception_handler
    yield
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 7:  select * from events where mod(id,2)=0;
                                               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 62, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model model_ alias (models/postgres_model/model_ alias.sql)
  syntax error at or near ";"
  LINE 7:  select * from events where mod(id,2)=0;
                                                 ^
  compiled SQL at target/run/dbt_demo_project/models/postgres_model/model_ alias.sql
2021-11-09 10:20:02.197846 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3daa06970>]}
2021-11-09 10:20:02.198541 (Thread-1): 15:50:02 | 4 of 6 ERROR creating table model dbtdemo.even_events................ [ERROR in 1.48s]
2021-11-09 10:20:02.198853 (Thread-1): Finished running node model.dbt_demo_project.model_ alias
2021-11-09 10:20:02.199197 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:20:02.199864 (Thread-1): 15:50:02 | 5 of 6 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-09 10:20:02.200553 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:02.200856 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:20:02.209157 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:20:02.209933 (Thread-1): finished collecting timing info
2021-11-09 10:20:02.230928 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:02.231198 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-09 10:20:02.231361 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:20:03.629707 (Thread-1): SQL status: BEGIN in 1.40 seconds
2021-11-09 10:20:03.629928 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.630071 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:20:03.636050 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:20:03.640374 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:20:03.640975 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.641124 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-09 10:20:03.664634 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-09 10:20:03.668055 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.668276 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-09 10:20:03.672331 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:20:03.675015 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.675235 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-09 10:20:03.679303 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:20:03.680623 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.680788 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:20:03.684772 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:20:03.685683 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:20:03.685856 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.685998 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:20:03.687739 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:20:03.691281 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:20:03.691516 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-09 10:20:03.700553 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-09 10:20:03.702388 (Thread-1): finished collecting timing info
2021-11-09 10:20:03.702668 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-09 10:20:03.703143 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dae4cd60>]}
2021-11-09 10:20:03.703566 (Thread-1): 15:50:03 | 5 of 6 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.50s]
2021-11-09 10:20:03.703852 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:20:03.704959 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:20:03.705597 (Thread-1): 15:50:03 | 6 of 6 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-09 10:20:03.706012 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:03.706198 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:20:03.712268 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:20:03.712921 (Thread-1): finished collecting timing info
2021-11-09 10:20:03.715625 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:03.716124 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-09 10:20:03.716447 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:20:05.049608 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-09 10:20:05.049870 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:05.050024 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:20:05.055754 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:20:05.056946 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:20:05.057544 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:05.057701 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-09 10:20:05.072171 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-09 10:20:05.074708 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:05.074891 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-09 10:20:05.078023 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:20:05.079364 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:05.079529 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;
      
2021-11-09 10:20:05.082350 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:20:05.083217 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:20:05.083394 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:05.083534 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:20:05.085284 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:20:05.087144 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:20:05.087313 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-09 10:20:05.088767 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-09 10:20:05.090061 (Thread-1): finished collecting timing info
2021-11-09 10:20:05.090279 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-09 10:20:05.090692 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8db57-eb01-4bff-8232-d98b4301f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dad4fb20>]}
2021-11-09 10:20:05.091065 (Thread-1): 15:50:05 | 6 of 6 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.38s]
2021-11-09 10:20:05.091272 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:20:05.092342 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:20:05.092572 (MainThread): Using postgres connection "master".
2021-11-09 10:20:05.092717 (MainThread): On master: BEGIN
2021-11-09 10:20:05.092857 (MainThread): Opening a new connection, currently in state closed
2021-11-09 10:20:06.336187 (MainThread): SQL status: BEGIN in 1.24 seconds
2021-11-09 10:20:06.336733 (MainThread): On master: COMMIT
2021-11-09 10:20:06.336915 (MainThread): Using postgres connection "master".
2021-11-09 10:20:06.337062 (MainThread): On master: COMMIT
2021-11-09 10:20:06.338980 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:20:06.339389 (MainThread): 15:50:06 | 
2021-11-09 10:20:06.339760 (MainThread): 15:50:06 | Running 1 on-run-end hook
2021-11-09 10:20:06.340036 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-09 10:20:06.342778 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-09 10:20:06.343596 (MainThread): 15:50:06 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-09 10:20:06.343824 (MainThread): Using postgres connection "master".
2021-11-09 10:20:06.343972 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','38e8db57-eb01-4bff-8232-d98b4301f49d');
    commit;


2021-11-09 10:20:06.351812 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:20:06.352742 (MainThread): 15:50:06 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-09 10:20:06.352972 (MainThread): 15:50:06 | 
2021-11-09 10:20:06.353168 (MainThread): On master: Close
2021-11-09 10:20:06.353612 (MainThread): 15:50:06 | 
2021-11-09 10:20:06.353797 (MainThread): 15:50:06 | Finished running 3 table models, 1 incremental model, 2 view models, 2 hooks in 23.64s.
2021-11-09 10:20:06.353963 (MainThread): Connection 'master' was properly closed.
2021-11-09 10:20:06.354104 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-09 10:20:06.362894 (MainThread): 
2021-11-09 10:20:06.363163 (MainThread): Completed with 1 error and 0 warnings:
2021-11-09 10:20:06.363350 (MainThread): 
2021-11-09 10:20:06.363538 (MainThread): Database Error in model model_ alias (models/postgres_model/model_ alias.sql)
2021-11-09 10:20:06.363728 (MainThread):   syntax error at or near ";"
2021-11-09 10:20:06.363920 (MainThread):   LINE 7:  select * from events where mod(id,2)=0;
2021-11-09 10:20:06.364095 (MainThread):                                                  ^
2021-11-09 10:20:06.364302 (MainThread):   compiled SQL at target/run/dbt_demo_project/models/postgres_model/model_ alias.sql
2021-11-09 10:20:06.364508 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-11-09 10:20:06.364754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3daaa1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3da7c25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d9c623d0>]}
2021-11-09 10:20:06.365284 (MainThread): Flushing usage events
2021-11-09 10:23:21.168209 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 10:23:21.394345 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-09 10:23:21.396798 (MainThread): Tracking: tracking
2021-11-09 10:23:21.461426 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb806ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb8061be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb8002610>]}
2021-11-09 10:23:21.519553 (MainThread): Partial parsing not enabled
2021-11-09 10:23:21.612585 (MainThread): Parsing macros/test_empty.sql
2021-11-09 10:23:21.613358 (MainThread): Parsing macros/audits.sql
2021-11-09 10:23:21.614014 (MainThread): Parsing macros/test_country.sql
2021-11-09 10:23:21.614520 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 10:23:21.615385 (MainThread): Parsing macros/catalog.sql
2021-11-09 10:23:21.619562 (MainThread): Parsing macros/relations.sql
2021-11-09 10:23:21.621083 (MainThread): Parsing macros/adapters.sql
2021-11-09 10:23:21.647011 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 10:23:21.648778 (MainThread): Parsing macros/core.sql
2021-11-09 10:23:21.653680 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 10:23:21.664152 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 10:23:21.686184 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 10:23:21.692484 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 10:23:21.732910 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 10:23:21.784646 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 10:23:21.815839 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 10:23:21.818472 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 10:23:21.832730 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 10:23:21.855356 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 10:23:21.869918 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 10:23:21.878222 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 10:23:21.887430 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 10:23:21.891175 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 10:23:21.892004 (MainThread): Parsing macros/etc/query.sql
2021-11-09 10:23:21.892920 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 10:23:21.894773 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 10:23:21.902735 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 10:23:21.904460 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 10:23:21.906132 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 10:23:21.966584 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 10:23:21.968264 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 10:23:21.969840 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 10:23:21.971436 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 10:23:21.973453 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 10:23:21.974576 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 10:23:21.976156 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 10:23:21.978324 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 10:23:21.984455 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 10:23:21.985531 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 10:23:21.986917 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 10:23:21.989180 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 10:23:21.990188 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 10:23:21.992576 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 10:23:22.007805 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 10:23:22.010159 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 10:23:22.011490 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 10:23:22.013018 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 10:23:22.014463 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 10:23:22.015354 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 10:23:22.018732 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 10:23:22.023836 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 10:23:22.024620 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 10:23:22.028126 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 10:23:22.030265 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 10:23:22.031793 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 10:23:22.033575 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 10:23:22.060461 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 10:23:22.061528 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 10:23:22.062366 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 10:23:22.062971 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 10:23:22.066394 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 10:23:22.067649 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 10:23:22.069726 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 10:23:22.070653 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 10:23:22.071535 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 10:23:22.072675 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 10:23:22.074763 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 10:23:22.076038 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 10:23:22.077054 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 10:23:22.078707 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 10:23:22.079943 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 10:23:22.082241 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 10:23:22.083516 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 10:23:22.084417 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 10:23:22.085605 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 10:23:22.089241 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 10:23:22.095301 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 10:23:22.096393 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 10:23:22.099094 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 10:23:22.102043 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 10:23:22.104362 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 10:23:22.105354 (MainThread): Parsing macros/sql/star.sql
2021-11-09 10:23:22.108322 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 10:23:22.114011 (MainThread): Parsing macros/sql/union.sql
2021-11-09 10:23:22.121636 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 10:23:22.122491 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 10:23:22.125168 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 10:23:22.126052 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 10:23:22.127196 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 10:23:22.130097 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 10:23:22.134123 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 10:23:22.136806 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 10:23:22.341335 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 10:23:22.341549 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb8210ee0>]}
2021-11-09 10:23:22.458699 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:22.472539 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:22.477395 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:22.480263 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:22.488398 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:22.494233 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:22.499400 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 10:23:22.502353 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 10:23:22.524321 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 10:23:22.527456 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 10:23:22.620454 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 10:23:22.626006 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb82d8160>]}
2021-11-09 10:23:22.636286 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb8286ac0>]}
2021-11-09 10:23:22.636554 (MainThread): Found 8 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 10:23:22.638588 (MainThread): 
2021-11-09 10:23:22.639314 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:23:22.641006 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-09 10:23:22.682442 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-09 10:23:22.682707 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-09 10:23:22.682896 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 10:23:26.387447 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 3.70 seconds
2021-11-09 10:23:26.391286 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-09 10:23:26.395496 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 10:23:26.408711 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:23:26.409210 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 10:23:26.409653 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:23:28.364268 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.95 seconds
2021-11-09 10:23:28.364766 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:23:28.364895 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 10:23:28.385632 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.02 seconds
2021-11-09 10:23:28.387034 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 10:23:28.388734 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 10:23:28.389375 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:23:28.391714 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:23:28.392089 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 10:23:28.392232 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:23:29.659426 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.27 seconds
2021-11-09 10:23:29.659663 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:23:29.659816 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 10:23:29.682725 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-09 10:23:29.684477 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 10:23:29.686300 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 10:23:29.687166 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 10:23:29.689600 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:23:29.689805 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 10:23:29.689958 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:23:31.180092 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.49 seconds
2021-11-09 10:23:31.180338 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:23:31.180486 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 10:23:31.211268 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.03 seconds
2021-11-09 10:23:31.214092 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 10:23:31.216203 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 10:23:31.224629 (MainThread): Using postgres connection "master".
2021-11-09 10:23:31.225009 (MainThread): On master: BEGIN
2021-11-09 10:23:31.225245 (MainThread): Opening a new connection, currently in state init
2021-11-09 10:23:32.577121 (MainThread): SQL status: BEGIN in 1.35 seconds
2021-11-09 10:23:32.577577 (MainThread): Using postgres connection "master".
2021-11-09 10:23:32.577787 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 10:23:32.844530 (MainThread): SQL status: SELECT 5 in 0.27 seconds
2021-11-09 10:23:32.846873 (MainThread): On master: ROLLBACK
2021-11-09 10:23:32.849025 (MainThread): Using postgres connection "master".
2021-11-09 10:23:32.849405 (MainThread): On master: BEGIN
2021-11-09 10:23:32.852886 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-09 10:23:32.853139 (MainThread): On master: COMMIT
2021-11-09 10:23:32.853300 (MainThread): Using postgres connection "master".
2021-11-09 10:23:32.853440 (MainThread): On master: COMMIT
2021-11-09 10:23:32.855309 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:32.855664 (MainThread): 15:53:32 | 
2021-11-09 10:23:32.855900 (MainThread): 15:53:32 | Running 1 on-run-start hook
2021-11-09 10:23:32.856114 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-09 10:23:32.861598 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-09 10:23:32.865309 (MainThread): 15:53:32 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-09 10:23:32.865710 (MainThread): Using postgres connection "master".
2021-11-09 10:23:32.865944 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;


2021-11-09 10:23:32.879193 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:23:32.880285 (MainThread): 15:53:32 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-09 10:23:32.880580 (MainThread): 15:53:32 | 
2021-11-09 10:23:32.880783 (MainThread): On master: Close
2021-11-09 10:23:32.881192 (MainThread): 15:53:32 | Concurrency: 1 threads (target='dev')
2021-11-09 10:23:32.881379 (MainThread): 15:53:32 | 
2021-11-09 10:23:32.886262 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:23:32.887071 (Thread-1): 15:53:32 | 1 of 6 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-09 10:23:32.887812 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:32.888126 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-09 10:23:32.893892 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:23:32.894709 (Thread-1): finished collecting timing info
2021-11-09 10:23:32.922109 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:32.922351 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-09 10:23:32.922511 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:23:34.344769 (Thread-1): SQL status: BEGIN in 1.42 seconds
2021-11-09 10:23:34.345015 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.345169 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:34.351025 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:23:34.356833 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:23:34.357498 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.357673 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-09 10:23:34.392792 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-09 10:23:34.400617 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.400836 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-09 10:23:34.403845 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:34.406251 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.406412 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-09 10:23:34.409487 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:34.415426 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.415642 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:34.419405 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:34.426799 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:23:34.427039 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.427191 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:23:34.429006 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:34.434131 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:23:34.434316 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-09 10:23:34.446237 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-09 10:23:34.447498 (Thread-1): finished collecting timing info
2021-11-09 10:23:34.447719 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-09 10:23:34.448162 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb831fac0>]}
2021-11-09 10:23:34.448538 (Thread-1): 15:53:34 | 1 of 6 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 1.56s]
2021-11-09 10:23:34.448732 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:23:34.448937 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-09 10:23:34.449272 (Thread-1): 15:53:34 | 2 of 6 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-09 10:23:34.449600 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:34.449780 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-09 10:23:34.457416 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:23:34.458024 (Thread-1): finished collecting timing info
2021-11-09 10:23:34.495484 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:34.495708 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-09 10:23:34.495859 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:23:36.704588 (Thread-1): SQL status: BEGIN in 2.21 seconds
2021-11-09 10:23:36.705021 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.705153 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:36.709833 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:36.712621 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.712789 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp155334491366"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-09 10:23:36.730493 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-09 10:23:36.738621 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.738842 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp155334491366'
        
      order by ordinal_position

  
2021-11-09 10:23:36.785699 (Thread-1): SQL status: SELECT 7 in 0.05 seconds
2021-11-09 10:23:36.791131 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.791313 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:23:36.796768 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-11-09 10:23:36.807676 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.807890 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:23:36.812469 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-09 10:23:36.814270 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:23:36.815302 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.815569 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp155334491366"
    );
  
2021-11-09 10:23:36.824977 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-11-09 10:23:36.826461 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.826639 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:36.829458 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:36.830336 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:23:36.830504 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:23:36.830645 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:23:36.832120 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:36.832640 (Thread-1): finished collecting timing info
2021-11-09 10:23:36.832845 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-09 10:23:36.833257 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb82280d0>]}
2021-11-09 10:23:36.833632 (Thread-1): 15:53:36 | 2 of 6 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 2.38s]
2021-11-09 10:23:36.833826 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-09 10:23:36.834016 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:23:36.834403 (Thread-1): 15:53:36 | 3 of 6 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-09 10:23:36.834837 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:36.835053 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-09 10:23:36.837516 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:23:36.838253 (Thread-1): finished collecting timing info
2021-11-09 10:23:36.842785 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:23:36.843554 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:36.843745 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-09 10:23:36.843903 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:23:38.221106 (Thread-1): SQL status: BEGIN in 1.38 seconds
2021-11-09 10:23:38.221354 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:38.221502 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '1b1298dd-b2a3-4826-9adc-80ac5bc8818f' as invocation_id
  );
2021-11-09 10:23:38.253915 (Thread-1): SQL status: SELECT 1 in 0.03 seconds
2021-11-09 10:23:38.256677 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:38.256862 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-09 10:23:38.258398 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:38.260692 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:38.260869 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-09 10:23:38.262464 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:38.263778 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:23:38.263942 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:38.264075 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:23:38.268110 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:38.270276 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:23:38.270475 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-09 10:23:38.292837 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-09 10:23:38.294000 (Thread-1): finished collecting timing info
2021-11-09 10:23:38.294197 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-09 10:23:38.294580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb82280a0>]}
2021-11-09 10:23:38.294928 (Thread-1): 15:53:38 | 3 of 6 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 1.46s]
2021-11-09 10:23:38.295119 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:23:38.295335 (Thread-1): Began running node model.dbt_demo_project.model_ alias
2021-11-09 10:23:38.295685 (Thread-1): 15:53:38 | 4 of 6 START table model dbtdemo.even_events......................... [RUN]
2021-11-09 10:23:38.296023 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:38.296190 (Thread-1): Compiling model.dbt_demo_project.model_ alias
2021-11-09 10:23:38.300376 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.model_ alias"
2021-11-09 10:23:38.301005 (Thread-1): finished collecting timing info
2021-11-09 10:23:38.303414 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:38.303607 (Thread-1): On model.dbt_demo_project.model_ alias: BEGIN
2021-11-09 10:23:38.303756 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:23:39.796382 (Thread-1): SQL status: BEGIN in 1.49 seconds
2021-11-09 10:23:39.796626 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:39.796797 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','MODEL_ALIAS','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:39.803033 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:23:39.804360 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.model_ alias"
2021-11-09 10:23:39.805110 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:39.805286 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */


  create  table "postgres"."dbtdemo"."model_ alias__dbt_tmp"
  as (
    
 select * from events where mod(id,2)=0
  );
2021-11-09 10:23:39.830641 (Thread-1): SQL status: SELECT 100 in 0.03 seconds
2021-11-09 10:23:39.835500 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:39.835979 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */
alter table "postgres"."dbtdemo"."model_ alias__dbt_tmp" rename to "even_events"
2021-11-09 10:23:39.840757 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:39.842180 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:39.842369 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','MODEL_ALIAS','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:39.864422 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-11-09 10:23:39.865843 (Thread-1): On model.dbt_demo_project.model_ alias: COMMIT
2021-11-09 10:23:39.866037 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:39.866185 (Thread-1): On model.dbt_demo_project.model_ alias: COMMIT
2021-11-09 10:23:39.868272 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:39.871348 (Thread-1): Using postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:23:39.871689 (Thread-1): On model.dbt_demo_project.model_ alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_ alias"} */
drop table if exists "postgres"."dbtdemo"."model_ alias__dbt_backup" cascade
2021-11-09 10:23:39.879652 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-09 10:23:39.881897 (Thread-1): finished collecting timing info
2021-11-09 10:23:39.882312 (Thread-1): On model.dbt_demo_project.model_ alias: Close
2021-11-09 10:23:39.883012 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb846c910>]}
2021-11-09 10:23:39.883652 (Thread-1): 15:53:39 | 4 of 6 OK created table model dbtdemo.even_events.................... [SELECT 100 in 1.59s]
2021-11-09 10:23:39.884060 (Thread-1): Finished running node model.dbt_demo_project.model_ alias
2021-11-09 10:23:39.884460 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:23:39.884918 (Thread-1): 15:53:39 | 5 of 6 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-09 10:23:39.885577 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:39.885870 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:23:39.895286 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:23:39.896351 (Thread-1): finished collecting timing info
2021-11-09 10:23:39.917741 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:39.917979 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-09 10:23:39.918195 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:23:41.260192 (Thread-1): SQL status: BEGIN in 1.34 seconds
2021-11-09 10:23:41.260456 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.260610 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:41.269504 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:23:41.274024 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:23:41.274745 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.274915 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-09 10:23:41.313185 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-11-09 10:23:41.319933 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.320415 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-09 10:23:41.324238 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:41.326792 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.326966 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-09 10:23:41.330802 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:41.332686 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.333047 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:41.336412 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:41.337354 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:23:41.337532 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.337681 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:23:41.339539 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:41.341359 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:23:41.341528 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-09 10:23:41.346904 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-09 10:23:41.348147 (Thread-1): finished collecting timing info
2021-11-09 10:23:41.348361 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-09 10:23:41.348802 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb83cbe80>]}
2021-11-09 10:23:41.349181 (Thread-1): 15:53:41 | 5 of 6 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 1.46s]
2021-11-09 10:23:41.349413 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:23:41.350393 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:23:41.350755 (Thread-1): 15:53:41 | 6 of 6 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-09 10:23:41.351150 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:41.351342 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:23:41.356196 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:23:41.356798 (Thread-1): finished collecting timing info
2021-11-09 10:23:41.359256 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:41.359429 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-09 10:23:41.359630 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:23:42.624632 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 10:23:42.624869 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:42.625017 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:42.631064 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:23:42.632336 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:23:42.632937 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:42.633089 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-09 10:23:42.646460 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-09 10:23:42.649040 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:42.649228 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-09 10:23:42.651956 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:23:42.653334 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:42.653524 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;
      
2021-11-09 10:23:42.656354 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:42.657205 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:23:42.657372 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:42.657513 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:23:42.658746 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:42.660576 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:23:42.660737 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-09 10:23:42.661976 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-09 10:23:42.663028 (Thread-1): finished collecting timing info
2021-11-09 10:23:42.663239 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-09 10:23:42.663742 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1298dd-b2a3-4826-9adc-80ac5bc8818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb83dfb80>]}
2021-11-09 10:23:42.664190 (Thread-1): 15:53:42 | 6 of 6 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 1.31s]
2021-11-09 10:23:42.664398 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:23:42.666082 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:23:42.666308 (MainThread): Using postgres connection "master".
2021-11-09 10:23:42.666452 (MainThread): On master: BEGIN
2021-11-09 10:23:42.666608 (MainThread): Opening a new connection, currently in state closed
2021-11-09 10:23:44.323310 (MainThread): SQL status: BEGIN in 1.66 seconds
2021-11-09 10:23:44.323612 (MainThread): On master: COMMIT
2021-11-09 10:23:44.323778 (MainThread): Using postgres connection "master".
2021-11-09 10:23:44.323976 (MainThread): On master: COMMIT
2021-11-09 10:23:44.325560 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:23:44.325749 (MainThread): 15:53:44 | 
2021-11-09 10:23:44.325959 (MainThread): 15:53:44 | Running 1 on-run-end hook
2021-11-09 10:23:44.326135 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-09 10:23:44.328875 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-09 10:23:44.329902 (MainThread): 15:53:44 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-09 10:23:44.330241 (MainThread): Using postgres connection "master".
2021-11-09 10:23:44.330429 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','1b1298dd-b2a3-4826-9adc-80ac5bc8818f');
    commit;


2021-11-09 10:23:44.341054 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:23:44.342259 (MainThread): 15:53:44 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-09 10:23:44.342512 (MainThread): 15:53:44 | 
2021-11-09 10:23:44.342730 (MainThread): On master: Close
2021-11-09 10:23:44.343315 (MainThread): 15:53:44 | 
2021-11-09 10:23:44.343545 (MainThread): 15:53:44 | Finished running 3 table models, 1 incremental model, 2 view models, 2 hooks in 21.70s.
2021-11-09 10:23:44.343789 (MainThread): Connection 'master' was properly closed.
2021-11-09 10:23:44.343996 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-09 10:23:44.358912 (MainThread): 
2021-11-09 10:23:44.359196 (MainThread): Completed successfully
2021-11-09 10:23:44.359404 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-11-09 10:23:44.359732 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb800abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb800aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb800ab20>]}
2021-11-09 10:23:44.360246 (MainThread): Flushing usage events
2021-11-09 10:29:15.054305 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 10:29:15.165597 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-09 10:29:15.167778 (MainThread): Tracking: tracking
2021-11-09 10:29:15.189216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f115c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f10ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808efc1640>]}
2021-11-09 10:29:15.222667 (MainThread): Partial parsing not enabled
2021-11-09 10:29:15.336939 (MainThread): Parsing macros/test_empty.sql
2021-11-09 10:29:15.338020 (MainThread): Parsing macros/audits.sql
2021-11-09 10:29:15.339100 (MainThread): Parsing macros/test_country.sql
2021-11-09 10:29:15.340208 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 10:29:15.341824 (MainThread): Parsing macros/catalog.sql
2021-11-09 10:29:15.347168 (MainThread): Parsing macros/relations.sql
2021-11-09 10:29:15.348999 (MainThread): Parsing macros/adapters.sql
2021-11-09 10:29:15.384728 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 10:29:15.387221 (MainThread): Parsing macros/core.sql
2021-11-09 10:29:15.392888 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 10:29:15.402833 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 10:29:15.418506 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 10:29:15.421336 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 10:29:15.451235 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 10:29:15.498348 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 10:29:15.541897 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 10:29:15.544995 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 10:29:15.559925 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 10:29:15.591009 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 10:29:15.612473 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 10:29:15.623260 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 10:29:15.637167 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 10:29:15.643282 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 10:29:15.645122 (MainThread): Parsing macros/etc/query.sql
2021-11-09 10:29:15.647014 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 10:29:15.649049 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 10:29:15.661355 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 10:29:15.664590 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 10:29:15.666854 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 10:29:15.760049 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 10:29:15.763160 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 10:29:15.767131 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 10:29:15.770656 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 10:29:15.778599 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 10:29:15.781429 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 10:29:15.785346 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 10:29:15.791928 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 10:29:15.808469 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 10:29:15.810839 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 10:29:15.813142 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 10:29:15.816624 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 10:29:15.818011 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 10:29:15.821316 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 10:29:15.858302 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 10:29:15.862485 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 10:29:15.865558 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 10:29:15.872587 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 10:29:15.882326 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 10:29:15.884008 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 10:29:15.889940 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 10:29:15.902795 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 10:29:15.904564 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 10:29:15.911170 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 10:29:15.913938 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 10:29:15.916919 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 10:29:15.919796 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 10:29:15.964275 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 10:29:15.965160 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 10:29:15.966000 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 10:29:15.967212 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 10:29:15.971474 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 10:29:15.973194 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 10:29:15.976001 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 10:29:15.977265 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 10:29:15.978282 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 10:29:15.979744 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 10:29:15.982117 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 10:29:15.983673 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 10:29:15.985237 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 10:29:15.987187 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 10:29:15.988315 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 10:29:15.993424 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 10:29:15.996024 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 10:29:15.997687 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 10:29:16.000452 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 10:29:16.006660 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 10:29:16.013821 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 10:29:16.015118 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 10:29:16.018348 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 10:29:16.022067 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 10:29:16.025205 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 10:29:16.026346 (MainThread): Parsing macros/sql/star.sql
2021-11-09 10:29:16.029502 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 10:29:16.041105 (MainThread): Parsing macros/sql/union.sql
2021-11-09 10:29:16.050870 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 10:29:16.052058 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 10:29:16.055687 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 10:29:16.057019 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 10:29:16.058360 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 10:29:16.062058 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 10:29:16.067809 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 10:29:16.071132 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 10:29:16.282120 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 10:29:16.282360 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '343b54ff-3470-4dcb-b438-79acac2a68fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f1d1880>]}
2021-11-09 10:29:16.444883 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:29:16.463988 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_ alias".
2021-11-09 10:29:16.470913 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:29:16.475136 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:29:16.481977 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:29:16.494552 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:29:16.501372 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:29:16.509080 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 10:29:16.513306 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 10:29:16.545723 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 10:29:16.550150 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 10:29:16.656440 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f2d3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f2c3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f2c3df0>]}
2021-11-09 10:29:16.656774 (MainThread): Flushing usage events
2021-11-09 10:29:18.669252 (MainThread): Connection 'operation.dbt_demo_project.dbt_demo_project-on-run-end-0' was properly closed.
2021-11-09 10:29:18.669529 (MainThread): Encountered an error:
2021-11-09 10:29:18.669737 (MainThread): Compilation Error in model odd_events (models/postgres_model/odd_events.sql)
  Model 'model.dbt_demo_project.odd_events' (models/postgres_model/odd_events.sql) depends on a node named 'model_alias' which was not found
2021-11-09 10:29:18.679590 (MainThread): Traceback (most recent call last):
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 408, in run
    self._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 81, in _runtime_initialize
    self.load_manifest()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 68, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 180, in get_full_manifest
    manifest = loader.load()
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 318, in load
    self.process_refs(self.root_project.project_name)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 669, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 980, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 753, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 575, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/pl465j/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model odd_events (models/postgres_model/odd_events.sql)
  Model 'model.dbt_demo_project.odd_events' (models/postgres_model/odd_events.sql) depends on a node named 'model_alias' which was not found

2021-11-09 10:31:04.400944 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 10:31:04.553520 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='run', write_json=True)
2021-11-09 10:31:04.556057 (MainThread): Tracking: tracking
2021-11-09 10:31:04.576495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e829ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e7c16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e7c1e80>]}
2021-11-09 10:31:04.607628 (MainThread): Partial parsing not enabled
2021-11-09 10:31:05.310159 (MainThread): Parsing macros/test_empty.sql
2021-11-09 10:31:05.311354 (MainThread): Parsing macros/audits.sql
2021-11-09 10:31:05.313912 (MainThread): Parsing macros/test_country.sql
2021-11-09 10:31:05.315667 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 10:31:05.318403 (MainThread): Parsing macros/catalog.sql
2021-11-09 10:31:05.338802 (MainThread): Parsing macros/relations.sql
2021-11-09 10:31:05.345353 (MainThread): Parsing macros/adapters.sql
2021-11-09 10:31:05.416063 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 10:31:05.418484 (MainThread): Parsing macros/core.sql
2021-11-09 10:31:05.424911 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 10:31:05.443385 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 10:31:05.460684 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 10:31:05.463470 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 10:31:05.489219 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 10:31:05.543829 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 10:31:05.575321 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 10:31:05.577575 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 10:31:05.592272 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 10:31:05.622445 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 10:31:05.652214 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 10:31:05.663916 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 10:31:05.675781 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 10:31:05.681395 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 10:31:05.682559 (MainThread): Parsing macros/etc/query.sql
2021-11-09 10:31:05.683784 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 10:31:05.685591 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 10:31:05.701580 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 10:31:05.705327 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 10:31:05.708393 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 10:31:05.837591 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 10:31:05.840466 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 10:31:05.842078 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 10:31:05.843804 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 10:31:05.846520 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 10:31:05.847950 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 10:31:05.849829 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 10:31:05.853413 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 10:31:05.861385 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 10:31:05.862815 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 10:31:05.864414 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 10:31:05.867225 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 10:31:05.868493 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 10:31:05.871403 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 10:31:05.883658 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 10:31:05.885869 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 10:31:05.887861 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 10:31:05.890049 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 10:31:05.891988 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 10:31:05.893142 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 10:31:05.897210 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 10:31:05.903942 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 10:31:05.905090 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 10:31:05.908576 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 10:31:05.910951 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 10:31:05.912748 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 10:31:05.915102 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 10:31:05.948527 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 10:31:05.949435 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 10:31:05.950343 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 10:31:05.951486 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 10:31:05.956992 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 10:31:05.959043 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 10:31:05.961680 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 10:31:05.962944 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 10:31:05.964060 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 10:31:05.965610 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 10:31:05.967913 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 10:31:05.969340 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 10:31:05.970424 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 10:31:05.972526 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 10:31:05.974005 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 10:31:05.976885 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 10:31:05.978524 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 10:31:05.979708 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 10:31:05.981153 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 10:31:05.985067 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 10:31:05.992119 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 10:31:05.993422 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 10:31:05.997090 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 10:31:06.002101 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 10:31:06.006249 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 10:31:06.007614 (MainThread): Parsing macros/sql/star.sql
2021-11-09 10:31:06.012460 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 10:31:06.023112 (MainThread): Parsing macros/sql/union.sql
2021-11-09 10:31:06.038393 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 10:31:06.040889 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 10:31:06.044499 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 10:31:06.045764 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 10:31:06.047452 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 10:31:06.050847 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 10:31:06.056038 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 10:31:06.059343 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 10:31:06.284912 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 10:31:06.285303 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e8d1ac0>]}
2021-11-09 10:31:06.455475 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:06.471007 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:06.477394 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:06.480940 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:06.489011 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:06.501033 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:06.509125 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:06.516354 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 10:31:06.520843 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 10:31:06.552377 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 10:31:06.559021 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 10:31:06.691892 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 10:31:06.698567 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e95d1c0>]}
2021-11-09 10:31:06.757926 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3dc901c0>]}
2021-11-09 10:31:06.758751 (MainThread): Found 9 models, 10 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 10:31:06.761926 (MainThread): 
2021-11-09 10:31:06.762662 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:31:06.764430 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-11-09 10:31:06.776862 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-11-09 10:31:06.777081 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-11-09 10:31:06.777234 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-09 10:31:08.810487 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 2.03 seconds
2021-11-09 10:31:08.812009 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-11-09 10:31:08.814755 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:31:08.824508 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:31:08.824728 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 10:31:08.824880 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:31:10.564586 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.74 seconds
2021-11-09 10:31:10.564824 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 10:31:10.564973 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 10:31:10.581824 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-09 10:31:10.583033 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 10:31:10.584542 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 10:31:10.585071 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 10:31:10.586749 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:31:10.586925 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 10:31:10.587122 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:31:13.237507 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 2.65 seconds
2021-11-09 10:31:13.237756 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 10:31:13.237905 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 10:31:13.255595 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.02 seconds
2021-11-09 10:31:13.257100 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 10:31:13.258658 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 10:31:13.259249 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 10:31:13.261765 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:31:13.261968 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 10:31:13.262120 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 10:31:15.163034 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.90 seconds
2021-11-09 10:31:15.163276 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 10:31:15.163422 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 10:31:15.178948 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 10:31:15.180498 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 10:31:15.181692 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 10:31:15.188633 (MainThread): Using postgres connection "master".
2021-11-09 10:31:15.188866 (MainThread): On master: BEGIN
2021-11-09 10:31:15.189038 (MainThread): Opening a new connection, currently in state init
2021-11-09 10:31:16.962887 (MainThread): SQL status: BEGIN in 1.77 seconds
2021-11-09 10:31:16.963121 (MainThread): Using postgres connection "master".
2021-11-09 10:31:16.963271 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 10:31:17.128014 (MainThread): SQL status: SELECT 5 in 0.16 seconds
2021-11-09 10:31:17.129135 (MainThread): On master: ROLLBACK
2021-11-09 10:31:17.132012 (MainThread): Using postgres connection "master".
2021-11-09 10:31:17.132317 (MainThread): On master: BEGIN
2021-11-09 10:31:17.135664 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-09 10:31:17.135851 (MainThread): On master: COMMIT
2021-11-09 10:31:17.135976 (MainThread): Using postgres connection "master".
2021-11-09 10:31:17.136084 (MainThread): On master: COMMIT
2021-11-09 10:31:17.137215 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:17.137380 (MainThread): 16:01:17 | 
2021-11-09 10:31:17.137528 (MainThread): 16:01:17 | Running 1 on-run-start hook
2021-11-09 10:31:17.137676 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-start-0
2021-11-09 10:31:17.139759 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-start-0"
2021-11-09 10:31:17.141812 (MainThread): 16:01:17 | 1 of 1 START hook: dbt_demo_project.on-run-start.0................... [RUN]
2021-11-09 10:31:17.142023 (MainThread): Using postgres connection "master".
2021-11-09 10:31:17.142146 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','START','','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;


2021-11-09 10:31:17.149138 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:17.150005 (MainThread): 16:01:17 | 1 of 1 OK hook: dbt_demo_project.on-run-start.0...................... [COMMIT in 0.01s]
2021-11-09 10:31:17.150206 (MainThread): 16:01:17 | 
2021-11-09 10:31:17.150379 (MainThread): On master: Close
2021-11-09 10:31:17.150714 (MainThread): 16:01:17 | Concurrency: 1 threads (target='dev')
2021-11-09 10:31:17.150916 (MainThread): 16:01:17 | 
2021-11-09 10:31:17.153733 (Thread-1): Began running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:31:17.154128 (Thread-1): 16:01:17 | 1 of 7 START table model dbtdemo.cust_count_by_state................. [RUN]
2021-11-09 10:31:17.154509 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:17.154733 (Thread-1): Compiling model.dbt_demo_project.cust_count_by_state
2021-11-09 10:31:17.160363 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:31:17.161295 (Thread-1): finished collecting timing info
2021-11-09 10:31:17.184417 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:17.184655 (Thread-1): On model.dbt_demo_project.cust_count_by_state: BEGIN
2021-11-09 10:31:17.184921 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:19.963259 (Thread-1): SQL status: BEGIN in 2.78 seconds
2021-11-09 10:31:19.963494 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:19.963674 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_COUNT_BY_STATE','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:19.971137 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:19.977324 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_count_by_state"
2021-11-09 10:31:19.978034 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:19.978217 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */


  create  table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp"
  as (
    

with store_sales as (
    select * from "postgres"."dims"."customers"
),
final as (select * from store_sales)
select CUSTOMER_STATE,count(*) as CUST_COUNT from final group by CUSTOMER_STATE
  );
2021-11-09 10:31:20.005653 (Thread-1): SQL status: SELECT 44 in 0.03 seconds
2021-11-09 10:31:20.012400 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:20.012613 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state" rename to "cust_count_by_state__dbt_backup"
2021-11-09 10:31:20.015400 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:20.017886 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:20.018059 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
alter table "postgres"."dbtdemo"."cust_count_by_state__dbt_tmp" rename to "cust_count_by_state"
2021-11-09 10:31:20.020708 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:20.026355 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:20.026545 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_COUNT_BY_STATE','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:20.029393 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:20.037061 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:31:20.037294 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:20.037438 (Thread-1): On model.dbt_demo_project.cust_count_by_state: COMMIT
2021-11-09 10:31:20.039251 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:20.044413 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 10:31:20.044607 (Thread-1): On model.dbt_demo_project.cust_count_by_state: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_count_by_state"} */
drop table if exists "postgres"."dbtdemo"."cust_count_by_state__dbt_backup" cascade
2021-11-09 10:31:20.060876 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-11-09 10:31:20.062091 (Thread-1): finished collecting timing info
2021-11-09 10:31:20.062293 (Thread-1): On model.dbt_demo_project.cust_count_by_state: Close
2021-11-09 10:31:20.062712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e8f7580>]}
2021-11-09 10:31:20.063074 (Thread-1): 16:01:20 | 1 of 7 OK created table model dbtdemo.cust_count_by_state............ [SELECT 44 in 2.91s]
2021-11-09 10:31:20.063327 (Thread-1): Finished running node model.dbt_demo_project.cust_count_by_state
2021-11-09 10:31:20.063528 (Thread-1): Began running node model.dbt_demo_project.incr_load
2021-11-09 10:31:20.063865 (Thread-1): 16:01:20 | 2 of 7 START incremental model dbtdemo.incr_load..................... [RUN]
2021-11-09 10:31:20.064187 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:20.064352 (Thread-1): Compiling model.dbt_demo_project.incr_load
2021-11-09 10:31:20.071230 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:31:20.072643 (Thread-1): finished collecting timing info
2021-11-09 10:31:20.110726 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:20.110966 (Thread-1): On model.dbt_demo_project.incr_load: BEGIN
2021-11-09 10:31:20.111119 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:23.086908 (Thread-1): SQL status: BEGIN in 2.98 seconds
2021-11-09 10:31:23.087245 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.087463 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','INCR_LOAD','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:23.093328 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:23.096596 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.096761 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

    

  create temporary table "incr_load__dbt_tmp160120106324"
  as (
    

     select *,current_timestamp from events
     
       where id >= (select max(id) from "postgres"."dbtdemo"."incr_load")
     
  );
  
2021-11-09 10:31:23.112282 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-11-09 10:31:23.119526 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.119686 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incr_load__dbt_tmp160120106324'
        
      order by ordinal_position

  
2021-11-09 10:31:23.159554 (Thread-1): SQL status: SELECT 7 in 0.04 seconds
2021-11-09 10:31:23.163825 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.163966 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:31:23.168037 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-09 10:31:23.178031 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.178196 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'incr_load'
        
        and table_schema = 'dbtdemo'
        
      order by ordinal_position

  
2021-11-09 10:31:23.182173 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-11-09 10:31:23.183562 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.incr_load"
2021-11-09 10:31:23.184404 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.184549 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

      

    insert into "postgres"."dbtdemo"."incr_load" ("id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp")
    (
       select "id", "first_name", "last_name", "email", "gender", "ip_address", "current_timestamp"
       from "incr_load__dbt_tmp160120106324"
    );
  
2021-11-09 10:31:23.190272 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-11-09 10:31:23.191382 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.191506 (Thread-1): On model.dbt_demo_project.incr_load: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.incr_load"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','INCR_LOAD','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:23.193554 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:23.194189 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:31:23.194333 (Thread-1): Using postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 10:31:23.194468 (Thread-1): On model.dbt_demo_project.incr_load: COMMIT
2021-11-09 10:31:23.195853 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:23.196297 (Thread-1): finished collecting timing info
2021-11-09 10:31:23.196462 (Thread-1): On model.dbt_demo_project.incr_load: Close
2021-11-09 10:31:23.196793 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3ea42550>]}
2021-11-09 10:31:23.197090 (Thread-1): 16:01:23 | 2 of 7 OK created incremental model dbtdemo.incr_load................ [INSERT 0 1 in 3.13s]
2021-11-09 10:31:23.197249 (Thread-1): Finished running node model.dbt_demo_project.incr_load
2021-11-09 10:31:23.197400 (Thread-1): Began running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:31:23.197657 (Thread-1): 16:01:23 | 3 of 7 START table model dbtdemo.invocation_id_gen................... [RUN]
2021-11-09 10:31:23.197915 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:23.198048 (Thread-1): Compiling model.dbt_demo_project.invocation_id_gen
2021-11-09 10:31:23.200047 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:31:23.200920 (Thread-1): finished collecting timing info
2021-11-09 10:31:23.204854 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.invocation_id_gen"
2021-11-09 10:31:23.206057 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:23.206276 (Thread-1): On model.dbt_demo_project.invocation_id_gen: BEGIN
2021-11-09 10:31:23.206481 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:26.828625 (Thread-1): SQL status: BEGIN in 3.62 seconds
2021-11-09 10:31:26.828883 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:26.829031 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */


  create  table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp"
  as (
    select '84305075-9707-4ca8-837a-ff19a8f78f39' as invocation_id
  );
2021-11-09 10:31:26.868384 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-11-09 10:31:26.871459 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:26.871782 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen" rename to "invocation_id_gen__dbt_backup"
2021-11-09 10:31:26.874041 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:26.876652 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:26.876849 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
alter table "postgres"."dbtdemo"."invocation_id_gen__dbt_tmp" rename to "invocation_id_gen"
2021-11-09 10:31:26.878607 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:26.879905 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:31:26.880083 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:26.880226 (Thread-1): On model.dbt_demo_project.invocation_id_gen: COMMIT
2021-11-09 10:31:26.884325 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:26.886158 (Thread-1): Using postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 10:31:26.886324 (Thread-1): On model.dbt_demo_project.invocation_id_gen: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.invocation_id_gen"} */
drop table if exists "postgres"."dbtdemo"."invocation_id_gen__dbt_backup" cascade
2021-11-09 10:31:26.916406 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-11-09 10:31:26.917580 (Thread-1): finished collecting timing info
2021-11-09 10:31:26.917779 (Thread-1): On model.dbt_demo_project.invocation_id_gen: Close
2021-11-09 10:31:26.918195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3ea7f610>]}
2021-11-09 10:31:26.918569 (Thread-1): 16:01:26 | 3 of 7 OK created table model dbtdemo.invocation_id_gen.............. [SELECT 1 in 3.72s]
2021-11-09 10:31:26.918921 (Thread-1): Finished running node model.dbt_demo_project.invocation_id_gen
2021-11-09 10:31:26.919138 (Thread-1): Began running node model.dbt_demo_project.model_alias
2021-11-09 10:31:26.919798 (Thread-1): 16:01:26 | 4 of 7 START table model dbtdemo.even_events......................... [RUN]
2021-11-09 10:31:26.920295 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:26.920566 (Thread-1): Compiling model.dbt_demo_project.model_alias
2021-11-09 10:31:26.925650 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.model_alias"
2021-11-09 10:31:26.926302 (Thread-1): finished collecting timing info
2021-11-09 10:31:26.928898 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:26.929086 (Thread-1): On model.dbt_demo_project.model_alias: BEGIN
2021-11-09 10:31:26.929237 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:32.139107 (Thread-1): SQL status: BEGIN in 5.21 seconds
2021-11-09 10:31:32.139318 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.139432 (Thread-1): On model.dbt_demo_project.model_alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_alias"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','MODEL_ALIAS','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:32.143770 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:32.144743 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.model_alias"
2021-11-09 10:31:32.145233 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.145353 (Thread-1): On model.dbt_demo_project.model_alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_alias"} */


  create  table "postgres"."dbtdemo"."model_alias__dbt_tmp"
  as (
    
 select * from events where mod(id,2)=0
  );
2021-11-09 10:31:32.164792 (Thread-1): SQL status: SELECT 100 in 0.02 seconds
2021-11-09 10:31:32.167049 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.167205 (Thread-1): On model.dbt_demo_project.model_alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_alias"} */
alter table "postgres"."dbtdemo"."even_events" rename to "model_alias__dbt_backup"
2021-11-09 10:31:32.169602 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:32.174458 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.174670 (Thread-1): On model.dbt_demo_project.model_alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_alias"} */
alter table "postgres"."dbtdemo"."model_alias__dbt_tmp" rename to "even_events"
2021-11-09 10:31:32.177647 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:32.179052 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.179220 (Thread-1): On model.dbt_demo_project.model_alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_alias"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','MODEL_ALIAS','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:32.182190 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:32.183430 (Thread-1): On model.dbt_demo_project.model_alias: COMMIT
2021-11-09 10:31:32.183601 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.183741 (Thread-1): On model.dbt_demo_project.model_alias: COMMIT
2021-11-09 10:31:32.185111 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:32.187065 (Thread-1): Using postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 10:31:32.187278 (Thread-1): On model.dbt_demo_project.model_alias: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.model_alias"} */
drop table if exists "postgres"."dbtdemo"."model_alias__dbt_backup" cascade
2021-11-09 10:31:32.202044 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-09 10:31:32.203320 (Thread-1): finished collecting timing info
2021-11-09 10:31:32.203622 (Thread-1): On model.dbt_demo_project.model_alias: Close
2021-11-09 10:31:32.204103 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3ede2dc0>]}
2021-11-09 10:31:32.204573 (Thread-1): 16:01:32 | 4 of 7 OK created table model dbtdemo.even_events.................... [SELECT 100 in 5.28s]
2021-11-09 10:31:32.204914 (Thread-1): Finished running node model.dbt_demo_project.model_alias
2021-11-09 10:31:32.205142 (Thread-1): Began running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:31:32.205524 (Thread-1): 16:01:32 | 5 of 7 START view model dbtdemo.orders_count_by_cust................. [RUN]
2021-11-09 10:31:32.206109 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:32.206297 (Thread-1): Compiling model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:31:32.211381 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:31:32.212010 (Thread-1): finished collecting timing info
2021-11-09 10:31:32.227505 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:32.227716 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: BEGIN
2021-11-09 10:31:32.227864 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:36.862525 (Thread-1): SQL status: BEGIN in 4.63 seconds
2021-11-09 10:31:36.863000 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.863228 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ORDERS_COUNT_BY_CUST','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:36.874563 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:36.880050 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.orders_count_by_cust"
2021-11-09 10:31:36.881208 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.881386 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

  create view "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" as (
    
with cust as (
    select * from "postgres"."dims"."customers"
),ord as (
    select * from "postgres"."facts"."orders"
)


select a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME as CUST_NAME,count(*) as ord_count from cust a,ord b
where b.order_customer_id=a.customer_id group by a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by 2
  );

2021-11-09 10:31:36.924504 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-11-09 10:31:36.927754 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.928079 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust" rename to "orders_count_by_cust__dbt_backup"
2021-11-09 10:31:36.936077 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-09 10:31:36.940681 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.940990 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
alter table "postgres"."dbtdemo"."orders_count_by_cust__dbt_tmp" rename to "orders_count_by_cust"
2021-11-09 10:31:36.949642 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-11-09 10:31:36.951499 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.951799 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ORDERS_COUNT_BY_CUST','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:36.956969 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:36.958354 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:31:36.958616 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.958789 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: COMMIT
2021-11-09 10:31:36.961090 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:36.963355 (Thread-1): Using postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 10:31:36.963539 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.orders_count_by_cust"} */
drop view if exists "postgres"."dbtdemo"."orders_count_by_cust__dbt_backup" cascade
2021-11-09 10:31:36.972511 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-11-09 10:31:36.974029 (Thread-1): finished collecting timing info
2021-11-09 10:31:36.974301 (Thread-1): On model.dbt_demo_project.orders_count_by_cust: Close
2021-11-09 10:31:36.975081 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e8f6ee0>]}
2021-11-09 10:31:36.975596 (Thread-1): 16:01:36 | 5 of 7 OK created view model dbtdemo.orders_count_by_cust............ [CREATE VIEW in 4.77s]
2021-11-09 10:31:36.975941 (Thread-1): Finished running node model.dbt_demo_project.orders_count_by_cust
2021-11-09 10:31:36.976267 (Thread-1): Began running node model.dbt_demo_project.odd_events
2021-11-09 10:31:36.976685 (Thread-1): 16:01:36 | 6 of 7 START table model dbtdemo.odd_events.......................... [RUN]
2021-11-09 10:31:36.977205 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:36.977392 (Thread-1): Compiling model.dbt_demo_project.odd_events
2021-11-09 10:31:36.982839 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.odd_events"
2021-11-09 10:31:36.983681 (Thread-1): finished collecting timing info
2021-11-09 10:31:36.986818 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:36.987133 (Thread-1): On model.dbt_demo_project.odd_events: BEGIN
2021-11-09 10:31:36.987318 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:40.259254 (Thread-1): SQL status: BEGIN in 3.27 seconds
2021-11-09 10:31:40.259496 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:40.259647 (Thread-1): On model.dbt_demo_project.odd_events: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.odd_events"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','ODD_EVENTS','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:40.266183 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:40.267539 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.odd_events"
2021-11-09 10:31:40.268127 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:40.268284 (Thread-1): On model.dbt_demo_project.odd_events: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.odd_events"} */


  create  table "postgres"."dbtdemo"."odd_events__dbt_tmp"
  as (
    
select * from events a where not exists 
(select 1 from "postgres"."dbtdemo"."even_events" b where a.id=b.id)
  );
2021-11-09 10:31:40.296916 (Thread-1): SQL status: SELECT 100 in 0.03 seconds
2021-11-09 10:31:40.300699 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:40.300890 (Thread-1): On model.dbt_demo_project.odd_events: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.odd_events"} */
alter table "postgres"."dbtdemo"."odd_events__dbt_tmp" rename to "odd_events"
2021-11-09 10:31:40.304870 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:40.306327 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:40.306533 (Thread-1): On model.dbt_demo_project.odd_events: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.odd_events"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','ODD_EVENTS','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:40.310904 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:40.312042 (Thread-1): On model.dbt_demo_project.odd_events: COMMIT
2021-11-09 10:31:40.312209 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:40.312353 (Thread-1): On model.dbt_demo_project.odd_events: COMMIT
2021-11-09 10:31:40.314316 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:40.316138 (Thread-1): Using postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 10:31:40.316299 (Thread-1): On model.dbt_demo_project.odd_events: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.odd_events"} */
drop table if exists "postgres"."dbtdemo"."odd_events__dbt_backup" cascade
2021-11-09 10:31:40.317943 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-09 10:31:40.319122 (Thread-1): finished collecting timing info
2021-11-09 10:31:40.319330 (Thread-1): On model.dbt_demo_project.odd_events: Close
2021-11-09 10:31:40.319833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3dc774c0>]}
2021-11-09 10:31:40.320424 (Thread-1): 16:01:40 | 6 of 7 OK created table model dbtdemo.odd_events..................... [SELECT 100 in 3.34s]
2021-11-09 10:31:40.320767 (Thread-1): Finished running node model.dbt_demo_project.odd_events
2021-11-09 10:31:40.321054 (Thread-1): Began running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:31:40.321454 (Thread-1): 16:01:40 | 7 of 7 START view model dbtdemo.cust_details_ord_counts.............. [RUN]
2021-11-09 10:31:40.321835 (Thread-1): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:40.322014 (Thread-1): Compiling model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:31:40.327387 (Thread-1): Writing injected SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:31:40.328064 (Thread-1): finished collecting timing info
2021-11-09 10:31:40.330941 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:40.331205 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: BEGIN
2021-11-09 10:31:40.331367 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 10:31:43.825667 (Thread-1): SQL status: BEGIN in 3.49 seconds
2021-11-09 10:31:43.825917 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:43.826118 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','STARTED','CUST_DETAILS_ORD_COUNTS','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:43.836974 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:43.838674 (Thread-1): Writing runtime SQL for node "model.dbt_demo_project.cust_details_ord_counts"
2021-11-09 10:31:43.839481 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:43.839760 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

  create view "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" as (
    
select b.CUST_NAME,a.CUSTOMER_ZIPCODE,b.ORD_COUNT ,'USA' as CNTRY
from "postgres"."dims"."customers" a,"postgres"."dbtdemo"."orders_count_by_cust" b
where b.CUST_NAME=a.CUSTOMER_FNAME||' '||a.CUSTOMER_LNAME order by b.ORD_COUNT
  );

2021-11-09 10:31:43.854430 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-11-09 10:31:43.857855 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:43.858082 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
alter table "postgres"."dbtdemo"."cust_details_ord_counts__dbt_tmp" rename to "cust_details_ord_counts"
2021-11-09 10:31:43.861287 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-09 10:31:43.862603 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:43.862770 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */

        insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('POSTGRES_MODEL','ENDED','CUST_DETAILS_ORD_COUNTS','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;
      
2021-11-09 10:31:43.865540 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:43.866365 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:31:43.866526 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:43.866666 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: COMMIT
2021-11-09 10:31:43.868019 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:43.869826 (Thread-1): Using postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 10:31:43.869985 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "model.dbt_demo_project.cust_details_ord_counts"} */
drop view if exists "postgres"."dbtdemo"."cust_details_ord_counts__dbt_backup" cascade
2021-11-09 10:31:43.871734 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-09 10:31:43.872939 (Thread-1): finished collecting timing info
2021-11-09 10:31:43.873150 (Thread-1): On model.dbt_demo_project.cust_details_ord_counts: Close
2021-11-09 10:31:43.873595 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84305075-9707-4ca8-837a-ff19a8f78f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3edf8e80>]}
2021-11-09 10:31:43.874002 (Thread-1): 16:01:43 | 7 of 7 OK created view model dbtdemo.cust_details_ord_counts......... [CREATE VIEW in 3.55s]
2021-11-09 10:31:43.874205 (Thread-1): Finished running node model.dbt_demo_project.cust_details_ord_counts
2021-11-09 10:31:43.875305 (MainThread): Acquiring new postgres connection "master".
2021-11-09 10:31:43.875518 (MainThread): Using postgres connection "master".
2021-11-09 10:31:43.875661 (MainThread): On master: BEGIN
2021-11-09 10:31:43.875799 (MainThread): Opening a new connection, currently in state closed
2021-11-09 10:31:45.706465 (MainThread): SQL status: BEGIN in 1.83 seconds
2021-11-09 10:31:45.706731 (MainThread): On master: COMMIT
2021-11-09 10:31:45.706884 (MainThread): Using postgres connection "master".
2021-11-09 10:31:45.707021 (MainThread): On master: COMMIT
2021-11-09 10:31:45.708238 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-09 10:31:45.708447 (MainThread): 16:01:45 | 
2021-11-09 10:31:45.708635 (MainThread): 16:01:45 | Running 1 on-run-end hook
2021-11-09 10:31:45.708803 (MainThread): Compiling operation.dbt_demo_project.dbt_demo_project-on-run-end-0
2021-11-09 10:31:45.711570 (MainThread): Writing injected SQL for node "operation.dbt_demo_project.dbt_demo_project-on-run-end-0"
2021-11-09 10:31:45.713062 (MainThread): 16:01:45 | 1 of 1 START hook: dbt_demo_project.on-run-end.0..................... [RUN]
2021-11-09 10:31:45.713300 (MainThread): Using postgres connection "master".
2021-11-09 10:31:45.713451 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */


insert into dbtdemo.dbt_audit_table (status,model,sub_model,invocation_id)  values('MAIN','END','','84305075-9707-4ca8-837a-ff19a8f78f39');
    commit;


2021-11-09 10:31:45.719834 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-11-09 10:31:45.720816 (MainThread): 16:01:45 | 1 of 1 OK hook: dbt_demo_project.on-run-end.0........................ [COMMIT in 0.01s]
2021-11-09 10:31:45.721056 (MainThread): 16:01:45 | 
2021-11-09 10:31:45.721315 (MainThread): On master: Close
2021-11-09 10:31:45.721774 (MainThread): 16:01:45 | 
2021-11-09 10:31:45.721960 (MainThread): 16:01:45 | Finished running 4 table models, 1 incremental model, 2 view models, 2 hooks in 38.96s.
2021-11-09 10:31:45.722214 (MainThread): Connection 'master' was properly closed.
2021-11-09 10:31:45.722477 (MainThread): Connection 'model.dbt_demo_project.cust_details_ord_counts' was properly closed.
2021-11-09 10:31:45.734102 (MainThread): 
2021-11-09 10:31:45.734449 (MainThread): Completed successfully
2021-11-09 10:31:45.734771 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-09 10:31:45.735187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e829bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e9ba6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e7ca910>]}
2021-11-09 10:31:45.735592 (MainThread): Flushing usage events
2021-11-09 11:24:23.193573 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 11:24:23.296121 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-11-09 11:24:23.297760 (MainThread): Tracking: tracking
2021-11-09 11:24:23.793538 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225914e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225914e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82259149a0>]}
2021-11-09 11:24:23.826129 (MainThread): Partial parsing not enabled
2021-11-09 11:24:23.919250 (MainThread): Parsing macros/test_empty.sql
2021-11-09 11:24:23.920290 (MainThread): Parsing macros/audits.sql
2021-11-09 11:24:23.921161 (MainThread): Parsing macros/test_country.sql
2021-11-09 11:24:23.921817 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 11:24:23.922924 (MainThread): Parsing macros/catalog.sql
2021-11-09 11:24:23.927097 (MainThread): Parsing macros/relations.sql
2021-11-09 11:24:23.928890 (MainThread): Parsing macros/adapters.sql
2021-11-09 11:24:23.959814 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 11:24:23.961922 (MainThread): Parsing macros/core.sql
2021-11-09 11:24:23.966564 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 11:24:23.974534 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 11:24:23.984061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 11:24:23.985637 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 11:24:24.004377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 11:24:24.038381 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 11:24:24.059722 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 11:24:24.061392 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 11:24:24.071595 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 11:24:24.091173 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 11:24:24.105086 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 11:24:24.112879 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 11:24:24.120129 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 11:24:24.123837 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 11:24:24.124814 (MainThread): Parsing macros/etc/query.sql
2021-11-09 11:24:24.125679 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 11:24:24.127091 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 11:24:24.136234 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 11:24:24.138060 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 11:24:24.139510 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 11:24:24.196143 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 11:24:24.197779 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 11:24:24.198834 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 11:24:24.200257 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 11:24:24.202454 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 11:24:24.203539 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 11:24:24.204859 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 11:24:24.206850 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 11:24:24.213404 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 11:24:24.214484 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 11:24:24.216077 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 11:24:24.219003 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 11:24:24.220286 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 11:24:24.222629 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 11:24:24.233090 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 11:24:24.235175 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 11:24:24.236529 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 11:24:24.238086 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 11:24:24.239552 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 11:24:24.240441 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 11:24:24.243761 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 11:24:24.248943 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 11:24:24.249743 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 11:24:24.252243 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 11:24:24.253935 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 11:24:24.255318 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 11:24:24.257075 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 11:24:24.281875 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 11:24:24.282557 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 11:24:24.283197 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 11:24:24.283767 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 11:24:24.286734 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 11:24:24.287889 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 11:24:24.289855 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 11:24:24.290931 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 11:24:24.291885 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 11:24:24.293089 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 11:24:24.294976 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 11:24:24.296121 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 11:24:24.297006 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 11:24:24.298534 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 11:24:24.299463 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 11:24:24.301659 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 11:24:24.302930 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 11:24:24.303882 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 11:24:24.305206 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 11:24:24.308877 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 11:24:24.314459 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 11:24:24.315471 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 11:24:24.317637 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 11:24:24.320827 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 11:24:24.323677 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 11:24:24.324566 (MainThread): Parsing macros/sql/star.sql
2021-11-09 11:24:24.327509 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 11:24:24.333708 (MainThread): Parsing macros/sql/union.sql
2021-11-09 11:24:24.342368 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 11:24:24.343560 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 11:24:24.346659 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 11:24:24.347544 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 11:24:24.348572 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 11:24:24.351686 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 11:24:24.355548 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 11:24:24.358269 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 11:24:24.529852 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 11:24:24.530080 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ce31846-e0d6-40c7-b504-4eb5f867c42c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82259cc3d0>]}
2021-11-09 11:24:24.661556 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 11:24:24.677249 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 11:24:24.683454 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 11:24:24.687172 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 11:24:24.693403 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 11:24:24.705565 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 11:24:24.711948 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 11:24:24.718707 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 11:24:24.722632 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 11:24:24.738841 (MainThread): Acquiring new postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:24:24.763779 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 11:24:24.768073 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 11:24:24.998493 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 11:24:25.005907 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ce31846-e0d6-40c7-b504-4eb5f867c42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82255f5400>]}
2021-11-09 11:24:25.017764 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ce31846-e0d6-40c7-b504-4eb5f867c42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82255f5910>]}
2021-11-09 11:24:25.018369 (MainThread): Found 9 models, 11 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 11:24:25.020375 (MainThread): 
2021-11-09 11:24:25.020838 (MainThread): Acquiring new postgres connection "master".
2021-11-09 11:24:25.023163 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:24:25.034603 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:24:25.034855 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 11:24:25.035024 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 11:24:38.097732 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 13.06 seconds
2021-11-09 11:24:38.098158 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:24:38.098297 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 11:24:38.117712 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-09 11:24:38.118889 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 11:24:38.119942 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 11:24:38.120392 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 11:24:38.121796 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 11:24:38.121932 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 11:24:38.122041 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 11:24:39.358975 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.24 seconds
2021-11-09 11:24:39.359236 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 11:24:39.359352 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 11:24:39.369956 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-11-09 11:24:39.371241 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 11:24:39.372336 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 11:24:39.372793 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 11:24:39.374496 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 11:24:39.374675 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 11:24:39.374792 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 11:24:40.715415 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.34 seconds
2021-11-09 11:24:40.715813 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 11:24:40.716083 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 11:24:40.735941 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 11:24:40.737993 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 11:24:40.741384 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 11:24:40.752837 (MainThread): Using postgres connection "master".
2021-11-09 11:24:40.753134 (MainThread): On master: BEGIN
2021-11-09 11:24:40.753302 (MainThread): Opening a new connection, currently in state init
2021-11-09 11:24:42.042131 (MainThread): SQL status: BEGIN in 1.29 seconds
2021-11-09 11:24:42.042515 (MainThread): Using postgres connection "master".
2021-11-09 11:24:42.042672 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 11:24:42.282132 (MainThread): SQL status: SELECT 5 in 0.24 seconds
2021-11-09 11:24:42.286461 (MainThread): On master: ROLLBACK
2021-11-09 11:24:42.289612 (MainThread): On master: Close
2021-11-09 11:24:42.290654 (MainThread): 16:54:42 | Concurrency: 1 threads (target='dev')
2021-11-09 11:24:42.291391 (MainThread): 16:54:42 | 
2021-11-09 11:24:42.318890 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:24:42.320091 (Thread-1): 16:54:42 | 1 of 6 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-11-09 11:24:42.321075 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:24:42.321891 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:24:42.337286 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-11-09 11:24:42.340065 (Thread-1): finished collecting timing info
2021-11-09 11:24:42.370458 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-11-09 11:24:42.373114 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:24:42.373296 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: BEGIN
2021-11-09 11:24:42.373443 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:24:43.630251 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:24:43.630611 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:24:43.630766 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_count_by_state"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:24:43.639291 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-11-09 11:24:43.655182 (Thread-1): finished collecting timing info
2021-11-09 11:24:43.655960 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: ROLLBACK
2021-11-09 11:24:43.657314 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-11-09 11:24:43.657919 (Thread-1): 16:54:43 | 1 of 6 PASS is_not_empty_cust_count_by_state_........................ [PASS in 1.34s]
2021-11-09 11:24:43.658213 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:24:43.658527 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:24:43.659100 (Thread-1): 16:54:43 | 2 of 6 START test is_not_empty_cust_details_ord_counts_.............. [RUN]
2021-11-09 11:24:43.659454 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:24:43.659643 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:24:43.665314 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-11-09 11:24:43.666479 (Thread-1): finished collecting timing info
2021-11-09 11:24:43.668508 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-11-09 11:24:43.669517 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:24:43.669736 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: BEGIN
2021-11-09 11:24:43.669889 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:24:44.886236 (Thread-1): SQL status: BEGIN in 1.22 seconds
2021-11-09 11:24:44.886673 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:24:44.887034 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_details_ord_counts"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:24:45.033295 (Thread-1): SQL status: SELECT 1 in 0.15 seconds
2021-11-09 11:24:45.034842 (Thread-1): finished collecting timing info
2021-11-09 11:24:45.035064 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: ROLLBACK
2021-11-09 11:24:45.036773 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-11-09 11:24:45.037308 (Thread-1): 16:54:45 | 2 of 6 PASS is_not_empty_cust_details_ord_counts_.................... [PASS in 1.38s]
2021-11-09 11:24:45.037527 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:24:45.037725 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:24:45.038084 (Thread-1): 16:54:45 | 3 of 6 START test is_not_empty_orders_count_by_cust_................. [RUN]
2021-11-09 11:24:45.038450 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:24:45.038629 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:24:45.044037 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-11-09 11:24:45.045136 (Thread-1): finished collecting timing info
2021-11-09 11:24:45.048013 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-11-09 11:24:45.048922 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:24:45.049189 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: BEGIN
2021-11-09 11:24:45.049407 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:24:46.321791 (Thread-1): SQL status: BEGIN in 1.27 seconds
2021-11-09 11:24:46.322176 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:24:46.322392 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."orders_count_by_cust"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:24:46.428604 (Thread-1): SQL status: SELECT 1 in 0.11 seconds
2021-11-09 11:24:46.430466 (Thread-1): finished collecting timing info
2021-11-09 11:24:46.430739 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: ROLLBACK
2021-11-09 11:24:46.433090 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-11-09 11:24:46.433605 (Thread-1): 16:54:46 | 3 of 6 PASS is_not_empty_orders_count_by_cust_....................... [PASS in 1.40s]
2021-11-09 11:24:46.433843 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:24:46.434278 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:24:46.434696 (Thread-1): 16:54:46 | 4 of 6 START test is_usa_cust_details_ord_counts_cntry............... [RUN]
2021-11-09 11:24:46.435052 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:24:46.435220 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:24:46.441858 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-11-09 11:24:46.444731 (Thread-1): finished collecting timing info
2021-11-09 11:24:46.449705 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-11-09 11:24:46.450953 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:24:46.451250 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: BEGIN
2021-11-09 11:24:46.451460 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:24:47.779189 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-09 11:24:47.779917 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:24:47.780073 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select * from "postgres"."dbtdemo"."cust_details_ord_counts" where cntry != 'USA'


      
    ) dbt_internal_test
2021-11-09 11:24:47.788708 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-11-09 11:24:47.790204 (Thread-1): finished collecting timing info
2021-11-09 11:24:47.790417 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: ROLLBACK
2021-11-09 11:24:47.791919 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: Close
2021-11-09 11:24:47.792387 (Thread-1): 16:54:47 | 4 of 6 PASS is_usa_cust_details_ord_counts_cntry..................... [PASS in 1.36s]
2021-11-09 11:24:47.792591 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:24:47.792788 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:24:47.793082 (Thread-1): 16:54:47 | 5 of 6 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-11-09 11:24:47.793416 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:24:47.793582 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:24:47.803416 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-11-09 11:24:47.804132 (Thread-1): finished collecting timing info
2021-11-09 11:24:47.806235 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-11-09 11:24:47.806899 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:24:47.807057 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: BEGIN
2021-11-09 11:24:47.807205 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:24:49.099657 (Thread-1): SQL status: BEGIN in 1.29 seconds
2021-11-09 11:24:49.100209 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:24:49.100380 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-11-09 11:24:49.103512 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:24:49.105785 (Thread-1): finished collecting timing info
2021-11-09 11:24:49.106025 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: ROLLBACK
2021-11-09 11:24:49.107960 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-11-09 11:24:49.108357 (Thread-1): 16:54:49 | 5 of 6 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 1.32s]
2021-11-09 11:24:49.108591 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:24:49.108906 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:24:49.109206 (Thread-1): 16:54:49 | 6 of 6 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-11-09 11:24:49.109577 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:24:49.109755 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:24:49.116086 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-11-09 11:24:49.116749 (Thread-1): finished collecting timing info
2021-11-09 11:24:49.118972 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-11-09 11:24:49.119478 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:24:49.119619 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: BEGIN
2021-11-09 11:24:49.119725 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:24:50.401000 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-11-09 11:24:50.401262 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:24:50.401439 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-11-09 11:24:50.405256 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:24:50.407402 (Thread-1): finished collecting timing info
2021-11-09 11:24:50.407823 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: ROLLBACK
2021-11-09 11:24:50.409815 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-11-09 11:24:50.410435 (Thread-1): 16:54:50 | 6 of 6 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 1.30s]
2021-11-09 11:24:50.410734 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:24:50.414609 (MainThread): Acquiring new postgres connection "master".
2021-11-09 11:24:50.415096 (MainThread): 16:54:50 | 
2021-11-09 11:24:50.415326 (MainThread): 16:54:50 | Finished running 6 tests in 25.39s.
2021-11-09 11:24:50.415511 (MainThread): Connection 'master' was properly closed.
2021-11-09 11:24:50.415751 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-11-09 11:24:50.432348 (MainThread): 
2021-11-09 11:24:50.432685 (MainThread): Completed successfully
2021-11-09 11:24:50.432963 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-11-09 11:24:50.433685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82255f5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82256c8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82256c8ca0>]}
2021-11-09 11:24:50.434875 (MainThread): Flushing usage events
2021-11-09 11:25:24.485180 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 11:25:24.586624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-11-09 11:25:24.588152 (MainThread): Tracking: tracking
2021-11-09 11:25:24.688133 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb82aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb821be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb7c1610>]}
2021-11-09 11:25:24.710717 (MainThread): Partial parsing not enabled
2021-11-09 11:25:24.782902 (MainThread): Parsing macros/test_empty.sql
2021-11-09 11:25:24.784001 (MainThread): Parsing macros/audits.sql
2021-11-09 11:25:24.784895 (MainThread): Parsing macros/test_country.sql
2021-11-09 11:25:24.785569 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 11:25:24.786704 (MainThread): Parsing macros/catalog.sql
2021-11-09 11:25:24.790677 (MainThread): Parsing macros/relations.sql
2021-11-09 11:25:24.792408 (MainThread): Parsing macros/adapters.sql
2021-11-09 11:25:24.823033 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 11:25:24.825281 (MainThread): Parsing macros/core.sql
2021-11-09 11:25:24.830188 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 11:25:24.840002 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 11:25:24.860698 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 11:25:24.864703 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 11:25:24.905348 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 11:25:24.988809 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 11:25:25.044815 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 11:25:25.050126 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 11:25:25.073445 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 11:25:25.108150 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 11:25:25.130898 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 11:25:25.142198 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 11:25:25.151181 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 11:25:25.155694 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 11:25:25.156733 (MainThread): Parsing macros/etc/query.sql
2021-11-09 11:25:25.157862 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 11:25:25.159596 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 11:25:25.170718 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 11:25:25.173057 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 11:25:25.175253 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 11:25:25.241014 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 11:25:25.243925 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 11:25:25.245330 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 11:25:25.246833 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 11:25:25.249391 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 11:25:25.250792 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 11:25:25.252579 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 11:25:25.255061 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 11:25:25.261863 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 11:25:25.263250 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 11:25:25.264830 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 11:25:25.267557 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 11:25:25.268776 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 11:25:25.271367 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 11:25:25.281392 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 11:25:25.283146 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 11:25:25.284501 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 11:25:25.287135 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 11:25:25.290136 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 11:25:25.291106 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 11:25:25.294623 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 11:25:25.301808 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 11:25:25.302842 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 11:25:25.306076 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 11:25:25.308438 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 11:25:25.310293 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 11:25:25.312584 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 11:25:25.340707 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 11:25:25.341597 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 11:25:25.342393 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 11:25:25.343121 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 11:25:25.346850 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 11:25:25.348310 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 11:25:25.350564 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 11:25:25.351570 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 11:25:25.352392 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 11:25:25.353528 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 11:25:25.355301 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 11:25:25.356330 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 11:25:25.357156 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 11:25:25.358732 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 11:25:25.359702 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 11:25:25.361972 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 11:25:25.363279 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 11:25:25.364176 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 11:25:25.365335 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 11:25:25.369340 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 11:25:25.376772 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 11:25:25.377961 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 11:25:25.380209 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 11:25:25.383207 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 11:25:25.385411 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 11:25:25.386247 (MainThread): Parsing macros/sql/star.sql
2021-11-09 11:25:25.389214 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 11:25:25.395261 (MainThread): Parsing macros/sql/union.sql
2021-11-09 11:25:25.406433 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 11:25:25.407479 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 11:25:25.410781 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 11:25:25.411985 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 11:25:25.413442 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 11:25:25.416917 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 11:25:25.421464 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 11:25:25.424519 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 11:25:25.600622 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 11:25:25.600860 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96eb5227-0f91-425d-93eb-38473181775b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb8d1d60>]}
2021-11-09 11:25:25.747516 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 11:25:25.762684 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 11:25:25.769151 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 11:25:25.772825 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 11:25:25.779469 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 11:25:25.791042 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 11:25:25.798304 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 11:25:25.806673 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 11:25:25.811220 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 11:25:25.828236 (MainThread): Acquiring new postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:25:25.855878 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 11:25:25.860405 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 11:25:26.023952 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 11:25:26.033507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96eb5227-0f91-425d-93eb-38473181775b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb7b42e0>]}
2021-11-09 11:25:26.045177 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96eb5227-0f91-425d-93eb-38473181775b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb7b44f0>]}
2021-11-09 11:25:26.045579 (MainThread): Found 9 models, 11 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 11:25:26.047983 (MainThread): 
2021-11-09 11:25:26.048726 (MainThread): Acquiring new postgres connection "master".
2021-11-09 11:25:26.051415 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:25:26.064868 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:25:26.065282 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 11:25:26.065482 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 11:25:27.427317 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.36 seconds
2021-11-09 11:25:27.427579 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:25:27.427726 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 11:25:27.445922 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-09 11:25:27.447292 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 11:25:27.448987 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 11:25:27.449693 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 11:25:27.452335 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 11:25:27.452561 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 11:25:27.452775 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 11:25:28.700944 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.25 seconds
2021-11-09 11:25:28.701222 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 11:25:28.701408 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 11:25:28.716545 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-11-09 11:25:28.718307 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 11:25:28.720028 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 11:25:28.720792 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 11:25:28.723630 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 11:25:28.723911 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 11:25:28.724121 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 11:25:29.988176 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:25:29.988422 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 11:25:29.988568 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 11:25:30.005435 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 11:25:30.006816 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 11:25:30.008289 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 11:25:30.016607 (MainThread): Using postgres connection "master".
2021-11-09 11:25:30.016833 (MainThread): On master: BEGIN
2021-11-09 11:25:30.017040 (MainThread): Opening a new connection, currently in state init
2021-11-09 11:25:31.263389 (MainThread): SQL status: BEGIN in 1.25 seconds
2021-11-09 11:25:31.263636 (MainThread): Using postgres connection "master".
2021-11-09 11:25:31.263782 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 11:25:31.455470 (MainThread): SQL status: SELECT 5 in 0.19 seconds
2021-11-09 11:25:31.456922 (MainThread): On master: ROLLBACK
2021-11-09 11:25:31.458602 (MainThread): On master: Close
2021-11-09 11:25:31.459010 (MainThread): 16:55:31 | Concurrency: 1 threads (target='dev')
2021-11-09 11:25:31.459212 (MainThread): 16:55:31 | 
2021-11-09 11:25:31.461702 (Thread-1): Began running node test.dbt_demo_project.assert_total_payment_amount_is_positive
2021-11-09 11:25:31.462034 (Thread-1): 16:55:31 | 1 of 11 START test assert_total_payment_amount_is_positive........... [RUN]
2021-11-09 11:25:31.462615 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:25:31.462819 (Thread-1): Compiling test.dbt_demo_project.assert_total_payment_amount_is_positive
2021-11-09 11:25:31.464720 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.assert_total_payment_amount_is_positive"
2021-11-09 11:25:31.465514 (Thread-1): finished collecting timing info
2021-11-09 11:25:31.484538 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.assert_total_payment_amount_is_positive"
2021-11-09 11:25:31.485375 (Thread-1): Using postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:25:31.485543 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: BEGIN
2021-11-09 11:25:31.485690 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:32.818802 (Thread-1): SQL status: BEGIN in 1.33 seconds
2021-11-09 11:25:32.819086 (Thread-1): Using postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:25:32.819245 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.assert_total_payment_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select order_item_order_id,sum(order_item_subtotal) as total_amount 
	  from facts.order_items group by order_item_order_id
	  having not(sum(order_item_subtotal) >= 0)
      
    ) dbt_internal_test
2021-11-09 11:25:33.771707 (Thread-1): SQL status: SELECT 1 in 0.95 seconds
2021-11-09 11:25:33.773528 (Thread-1): finished collecting timing info
2021-11-09 11:25:33.773715 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: ROLLBACK
2021-11-09 11:25:33.774768 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: Close
2021-11-09 11:25:33.775181 (Thread-1): 16:55:33 | 1 of 11 PASS assert_total_payment_amount_is_positive................. [PASS in 2.31s]
2021-11-09 11:25:33.775417 (Thread-1): Finished running node test.dbt_demo_project.assert_total_payment_amount_is_positive
2021-11-09 11:25:33.775593 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:25:33.775850 (Thread-1): 16:55:33 | 2 of 11 START test is_not_empty_cust_count_by_state_................. [RUN]
2021-11-09 11:25:33.776137 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:25:33.776300 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:25:33.780480 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-11-09 11:25:33.781122 (Thread-1): finished collecting timing info
2021-11-09 11:25:33.782999 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-11-09 11:25:33.783694 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:25:33.783853 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: BEGIN
2021-11-09 11:25:33.783995 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:35.060447 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-11-09 11:25:35.060695 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:25:35.060848 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_count_by_state"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:25:35.064304 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:25:35.065712 (Thread-1): finished collecting timing info
2021-11-09 11:25:35.065933 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: ROLLBACK
2021-11-09 11:25:35.067685 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-11-09 11:25:35.068180 (Thread-1): 16:55:35 | 2 of 11 PASS is_not_empty_cust_count_by_state_....................... [PASS in 1.29s]
2021-11-09 11:25:35.068393 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:25:35.068591 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:25:35.068865 (Thread-1): 16:55:35 | 3 of 11 START test is_not_empty_cust_details_ord_counts_............. [RUN]
2021-11-09 11:25:35.069188 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:25:35.069356 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:25:35.073995 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-11-09 11:25:35.074646 (Thread-1): finished collecting timing info
2021-11-09 11:25:35.076785 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-11-09 11:25:35.077394 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:25:35.077558 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: BEGIN
2021-11-09 11:25:35.077707 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:36.333584 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:25:36.333824 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:25:36.333974 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_details_ord_counts"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:25:36.417399 (Thread-1): SQL status: SELECT 1 in 0.08 seconds
2021-11-09 11:25:36.418933 (Thread-1): finished collecting timing info
2021-11-09 11:25:36.419179 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: ROLLBACK
2021-11-09 11:25:36.420682 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-11-09 11:25:36.421136 (Thread-1): 16:55:36 | 3 of 11 PASS is_not_empty_cust_details_ord_counts_................... [PASS in 1.35s]
2021-11-09 11:25:36.421340 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:25:36.421558 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:25:36.421830 (Thread-1): 16:55:36 | 4 of 11 START test is_not_empty_orders_count_by_cust_................ [RUN]
2021-11-09 11:25:36.422152 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:25:36.422317 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:25:36.427172 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-11-09 11:25:36.427903 (Thread-1): finished collecting timing info
2021-11-09 11:25:36.430236 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-11-09 11:25:36.431158 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:25:36.431430 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: BEGIN
2021-11-09 11:25:36.431650 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:37.661431 (Thread-1): SQL status: BEGIN in 1.23 seconds
2021-11-09 11:25:37.661685 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:25:37.661843 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."orders_count_by_cust"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:25:37.729055 (Thread-1): SQL status: SELECT 1 in 0.07 seconds
2021-11-09 11:25:37.730516 (Thread-1): finished collecting timing info
2021-11-09 11:25:37.730733 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: ROLLBACK
2021-11-09 11:25:37.732891 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-11-09 11:25:37.733344 (Thread-1): 16:55:37 | 4 of 11 PASS is_not_empty_orders_count_by_cust_...................... [PASS in 1.31s]
2021-11-09 11:25:37.733552 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:25:37.733787 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:25:37.734074 (Thread-1): 16:55:37 | 5 of 11 START test is_usa_cust_details_ord_counts_cntry.............. [RUN]
2021-11-09 11:25:37.734471 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:25:37.734643 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:25:37.740709 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-11-09 11:25:37.741399 (Thread-1): finished collecting timing info
2021-11-09 11:25:37.743589 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-11-09 11:25:37.744371 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:25:37.744573 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: BEGIN
2021-11-09 11:25:37.744743 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:39.031649 (Thread-1): SQL status: BEGIN in 1.29 seconds
2021-11-09 11:25:39.031991 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:25:39.032166 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select * from "postgres"."dbtdemo"."cust_details_ord_counts" where cntry != 'USA'


      
    ) dbt_internal_test
2021-11-09 11:25:39.039768 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-11-09 11:25:39.041173 (Thread-1): finished collecting timing info
2021-11-09 11:25:39.041380 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: ROLLBACK
2021-11-09 11:25:39.042545 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: Close
2021-11-09 11:25:39.042988 (Thread-1): 16:55:39 | 5 of 11 PASS is_usa_cust_details_ord_counts_cntry.................... [PASS in 1.31s]
2021-11-09 11:25:39.043192 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:25:39.043431 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:25:39.043738 (Thread-1): 16:55:39 | 6 of 11 START test not_null_cust_count_by_state_CUSTOMER_STATE....... [RUN]
2021-11-09 11:25:39.044074 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:25:39.044241 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:25:39.052048 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-11-09 11:25:39.052774 (Thread-1): finished collecting timing info
2021-11-09 11:25:39.054940 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-11-09 11:25:39.055714 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:25:39.055904 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: BEGIN
2021-11-09 11:25:39.056056 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:40.292507 (Thread-1): SQL status: BEGIN in 1.24 seconds
2021-11-09 11:25:40.292759 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:25:40.292911 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-11-09 11:25:40.296716 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:25:40.298311 (Thread-1): finished collecting timing info
2021-11-09 11:25:40.298556 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: ROLLBACK
2021-11-09 11:25:40.300382 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-11-09 11:25:40.300883 (Thread-1): 16:55:40 | 6 of 11 PASS not_null_cust_count_by_state_CUSTOMER_STATE............. [PASS in 1.26s]
2021-11-09 11:25:40.301091 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:25:40.301412 (Thread-1): Began running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-11-09 11:25:40.301719 (Thread-1): 16:55:40 | 7 of 11 START test not_null_my_first_dbt_model_id.................... [RUN]
2021-11-09 11:25:40.302130 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-11-09 11:25:40.302390 (Thread-1): Compiling test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-11-09 11:25:40.308117 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-11-09 11:25:40.309297 (Thread-1): finished collecting timing info
2021-11-09 11:25:40.311403 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"
2021-11-09 11:25:40.312285 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-11-09 11:25:40.312458 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-11-09 11:25:40.312618 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:41.592878 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-11-09 11:25:41.593109 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44".
2021-11-09 11:25:41.593252 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
2021-11-09 11:25:41.601954 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-11-09 11:25:41.603376 (Thread-1): finished collecting timing info
2021-11-09 11:25:41.603590 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-11-09 11:25:41.605053 (Thread-1): On test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44: Close
2021-11-09 11:25:41.605530 (Thread-1): 16:55:41 | 7 of 11 FAIL 1 not_null_my_first_dbt_model_id........................ [FAIL 1 in 1.30s]
2021-11-09 11:25:41.605745 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_first_dbt_model_id.f479667b44
2021-11-09 11:25:41.605996 (Thread-1): Began running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-11-09 11:25:41.606351 (Thread-1): 16:55:41 | 8 of 11 START test not_null_my_second_dbt_model_id................... [RUN]
2021-11-09 11:25:41.606731 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-11-09 11:25:41.606906 (Thread-1): Compiling test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-11-09 11:25:41.611336 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-11-09 11:25:41.612076 (Thread-1): finished collecting timing info
2021-11-09 11:25:41.614259 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-11-09 11:25:41.615122 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-11-09 11:25:41.615412 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-11-09 11:25:41.615599 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:42.891849 (Thread-1): SQL status: BEGIN in 1.28 seconds
2021-11-09 11:25:42.892079 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-11-09 11:25:42.892217 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
2021-11-09 11:25:42.895587 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:25:42.897549 (Thread-1): finished collecting timing info
2021-11-09 11:25:42.897909 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-11-09 11:25:42.899642 (Thread-1): On test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-11-09 11:25:42.900213 (Thread-1): 16:55:42 | 8 of 11 PASS not_null_my_second_dbt_model_id......................... [PASS in 1.29s]
2021-11-09 11:25:42.900429 (Thread-1): Finished running node test.dbt_demo_project.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-11-09 11:25:42.900655 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:25:42.901025 (Thread-1): 16:55:42 | 9 of 11 START test unique_cust_count_by_state_CUSTOMER_STATE......... [RUN]
2021-11-09 11:25:42.901620 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:25:42.901905 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:25:42.910322 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-11-09 11:25:42.911084 (Thread-1): finished collecting timing info
2021-11-09 11:25:42.913975 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-11-09 11:25:42.915146 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:25:42.915496 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: BEGIN
2021-11-09 11:25:42.915714 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:44.178515 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:25:44.178753 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:25:44.178908 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-11-09 11:25:44.182307 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:25:44.183787 (Thread-1): finished collecting timing info
2021-11-09 11:25:44.184003 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: ROLLBACK
2021-11-09 11:25:44.185449 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-11-09 11:25:44.185896 (Thread-1): 16:55:44 | 9 of 11 PASS unique_cust_count_by_state_CUSTOMER_STATE............... [PASS in 1.28s]
2021-11-09 11:25:44.186119 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:25:44.186476 (Thread-1): Began running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-11-09 11:25:44.186757 (Thread-1): 16:55:44 | 10 of 11 START test unique_my_first_dbt_model_id..................... [RUN]
2021-11-09 11:25:44.187090 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-11-09 11:25:44.187260 (Thread-1): Compiling test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-11-09 11:25:44.193135 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-11-09 11:25:44.194258 (Thread-1): finished collecting timing info
2021-11-09 11:25:44.196613 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"
2021-11-09 11:25:44.198186 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-11-09 11:25:44.198597 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-11-09 11:25:44.198873 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:45.446510 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-11-09 11:25:45.446767 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb".
2021-11-09 11:25:45.446922 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from "postgres"."dbtdemo"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-09 11:25:45.450475 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:25:45.451894 (Thread-1): finished collecting timing info
2021-11-09 11:25:45.452110 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-11-09 11:25:45.453580 (Thread-1): On test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-11-09 11:25:45.454032 (Thread-1): 16:55:45 | 10 of 11 PASS unique_my_first_dbt_model_id........................... [PASS in 1.27s]
2021-11-09 11:25:45.454240 (Thread-1): Finished running node test.dbt_demo_project.unique_my_first_dbt_model_id.5ef3c774bb
2021-11-09 11:25:45.454452 (Thread-1): Began running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-11-09 11:25:45.454711 (Thread-1): 16:55:45 | 11 of 11 START test unique_my_second_dbt_model_id.................... [RUN]
2021-11-09 11:25:45.455022 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-11-09 11:25:45.455182 (Thread-1): Compiling test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-11-09 11:25:45.460158 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-11-09 11:25:45.460884 (Thread-1): finished collecting timing info
2021-11-09 11:25:45.464218 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"
2021-11-09 11:25:45.465342 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-11-09 11:25:45.465712 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-11-09 11:25:45.466104 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:25:46.725972 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:25:46.726212 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570".
2021-11-09 11:25:46.726361 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id,
    count(*) as n_records

from "postgres"."dbtdemo"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-11-09 11:25:46.729805 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:25:46.731273 (Thread-1): finished collecting timing info
2021-11-09 11:25:46.731507 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-11-09 11:25:46.732973 (Thread-1): On test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570: Close
2021-11-09 11:25:46.733473 (Thread-1): 16:55:46 | 11 of 11 PASS unique_my_second_dbt_model_id.......................... [PASS in 1.28s]
2021-11-09 11:25:46.733685 (Thread-1): Finished running node test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570
2021-11-09 11:25:46.734872 (MainThread): Acquiring new postgres connection "master".
2021-11-09 11:25:46.735247 (MainThread): 16:55:46 | 
2021-11-09 11:25:46.735435 (MainThread): 16:55:46 | Finished running 11 tests in 20.69s.
2021-11-09 11:25:46.735611 (MainThread): Connection 'master' was properly closed.
2021-11-09 11:25:46.735750 (MainThread): Connection 'test.dbt_demo_project.unique_my_second_dbt_model_id.bc96125570' was properly closed.
2021-11-09 11:25:46.744943 (MainThread): 
2021-11-09 11:25:46.745215 (MainThread): Completed with 1 error and 0 warnings:
2021-11-09 11:25:46.745407 (MainThread): 
2021-11-09 11:25:46.745710 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-11-09 11:25:46.746009 (MainThread):   Got 1 result, configured to fail if != 0
2021-11-09 11:25:46.746208 (MainThread): 
2021-11-09 11:25:46.746386 (MainThread):   compiled SQL at target/compiled/dbt_demo_project/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-11-09 11:25:46.746593 (MainThread): 
Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
2021-11-09 11:25:46.746937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb7c9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb7c9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bb7c9a00>]}
2021-11-09 11:25:46.747402 (MainThread): Flushing usage events
2021-11-09 11:30:08.842282 (MainThread): Running with dbt=0.21.0-b1
2021-11-09 11:30:08.951859 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['postgres_model'], partial_parse=None, profile=None, profiles_dir='/Users/pl465j/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='test', write_json=True)
2021-11-09 11:30:08.953886 (MainThread): Tracking: tracking
2021-11-09 11:30:08.970243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30edbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30f05700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30f05eb0>]}
2021-11-09 11:30:08.992160 (MainThread): Partial parsing not enabled
2021-11-09 11:30:09.069460 (MainThread): Parsing macros/test_empty.sql
2021-11-09 11:30:09.070718 (MainThread): Parsing macros/audits.sql
2021-11-09 11:30:09.071738 (MainThread): Parsing macros/test_country.sql
2021-11-09 11:30:09.072651 (MainThread): Parsing macros/generate_schema_name.sql
2021-11-09 11:30:09.074229 (MainThread): Parsing macros/catalog.sql
2021-11-09 11:30:09.079317 (MainThread): Parsing macros/relations.sql
2021-11-09 11:30:09.081410 (MainThread): Parsing macros/adapters.sql
2021-11-09 11:30:09.114007 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-09 11:30:09.116230 (MainThread): Parsing macros/core.sql
2021-11-09 11:30:09.121347 (MainThread): Parsing macros/materializations/test.sql
2021-11-09 11:30:09.130736 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-09 11:30:09.143252 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-09 11:30:09.145363 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-09 11:30:09.168077 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-09 11:30:09.210776 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-09 11:30:09.235500 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-09 11:30:09.237330 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-09 11:30:09.248205 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-09 11:30:09.268045 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-09 11:30:09.283480 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-09 11:30:09.291360 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-09 11:30:09.298736 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-09 11:30:09.302516 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-09 11:30:09.303375 (MainThread): Parsing macros/etc/query.sql
2021-11-09 11:30:09.304298 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-09 11:30:09.305781 (MainThread): Parsing macros/etc/datetime.sql
2021-11-09 11:30:09.315676 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-09 11:30:09.317858 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-09 11:30:09.319617 (MainThread): Parsing macros/adapters/common.sql
2021-11-09 11:30:09.373860 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-09 11:30:09.375500 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-09 11:30:09.376641 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-09 11:30:09.377905 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-09 11:30:09.379933 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-11-09 11:30:09.380927 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-11-09 11:30:09.382435 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-11-09 11:30:09.384443 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-11-09 11:30:09.390505 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-11-09 11:30:09.391865 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-11-09 11:30:09.393097 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-11-09 11:30:09.395277 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-11-09 11:30:09.396259 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-11-09 11:30:09.398503 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-11-09 11:30:09.409818 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-11-09 11:30:09.412064 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-11-09 11:30:09.413712 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-11-09 11:30:09.415805 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-11-09 11:30:09.417631 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-11-09 11:30:09.418726 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-11-09 11:30:09.422586 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-11-09 11:30:09.428109 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-11-09 11:30:09.428856 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-11-09 11:30:09.431586 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-11-09 11:30:09.433370 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-11-09 11:30:09.434779 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-11-09 11:30:09.436569 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-11-09 11:30:09.461499 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-11-09 11:30:09.462247 (MainThread): Parsing macros/logger/pretty_time.sql
2021-11-09 11:30:09.462956 (MainThread): Parsing macros/logger/log_info.sql
2021-11-09 11:30:09.463573 (MainThread): Parsing macros/datetime/date_spine.sql
2021-11-09 11:30:09.467025 (MainThread): Parsing macros/web/get_url_host.sql
2021-11-09 11:30:09.468439 (MainThread): Parsing macros/web/get_url_path.sql
2021-11-09 11:30:09.470690 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-11-09 11:30:09.471760 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-11-09 11:30:09.472635 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-11-09 11:30:09.473859 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-11-09 11:30:09.475712 (MainThread): Parsing macros/schema_tests/recency.sql
2021-11-09 11:30:09.476770 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-11-09 11:30:09.477601 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-11-09 11:30:09.478942 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-11-09 11:30:09.479761 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-11-09 11:30:09.481950 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-11-09 11:30:09.483228 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-11-09 11:30:09.484131 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-11-09 11:30:09.485293 (MainThread): Parsing macros/schema_tests/equality.sql
2021-11-09 11:30:09.488508 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-11-09 11:30:09.494550 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-11-09 11:30:09.495711 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-11-09 11:30:09.498105 (MainThread): Parsing macros/sql/generate_series.sql
2021-11-09 11:30:09.501138 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-11-09 11:30:09.503569 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-11-09 11:30:09.504531 (MainThread): Parsing macros/sql/star.sql
2021-11-09 11:30:09.507650 (MainThread): Parsing macros/sql/unpivot.sql
2021-11-09 11:30:09.514546 (MainThread): Parsing macros/sql/union.sql
2021-11-09 11:30:09.523349 (MainThread): Parsing macros/sql/groupby.sql
2021-11-09 11:30:09.524275 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-11-09 11:30:09.526928 (MainThread): Parsing macros/sql/safe_add.sql
2021-11-09 11:30:09.527817 (MainThread): Parsing macros/sql/nullcheck.sql
2021-11-09 11:30:09.528899 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-11-09 11:30:09.531371 (MainThread): Parsing macros/sql/get_column_values.sql
2021-11-09 11:30:09.534912 (MainThread): Parsing macros/sql/pivot.sql
2021-11-09 11:30:09.537467 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-11-09 11:30:09.699791 (MainThread): * Deprecation Warning: The "packages" argument of adapter.dispatch() has been
deprecated. Use the "macro_namespace" argument instead.
Raised during dispatch for: except
For more information, see:
https://docs.getdbt.com/reference/dbt-jinja-functions/dispatch
2021-11-09 11:30:09.700122 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8ae74ee3-b5e8-4442-8a1a-769547e84d39', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30f96dc0>]}
2021-11-09 11:30:09.821903 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_details_ord_counts".
2021-11-09 11:30:09.836837 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.model_alias".
2021-11-09 11:30:09.843104 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.invocation_id_gen".
2021-11-09 11:30:09.847159 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.odd_events".
2021-11-09 11:30:09.854350 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.incr_load".
2021-11-09 11:30:09.867849 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.cust_count_by_state".
2021-11-09 11:30:09.875689 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.orders_count_by_cust".
2021-11-09 11:30:09.885495 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_first_dbt_model".
2021-11-09 11:30:09.891872 (MainThread): Acquiring new postgres connection "model.dbt_demo_project.my_second_dbt_model".
2021-11-09 11:30:09.915058 (MainThread): Acquiring new postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:30:09.941028 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-start-0".
2021-11-09 11:30:09.945896 (MainThread): Acquiring new postgres connection "operation.dbt_demo_project.dbt_demo_project-on-run-end-0".
2021-11-09 11:30:10.098015 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo_project.snowflake_model_data

2021-11-09 11:30:10.105226 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ae74ee3-b5e8-4442-8a1a-769547e84d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30edc310>]}
2021-11-09 11:30:10.116509 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ae74ee3-b5e8-4442-8a1a-769547e84d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30edc940>]}
2021-11-09 11:30:10.116863 (MainThread): Found 9 models, 11 tests, 0 snapshots, 0 analyses, 290 macros, 2 operations, 1 seed file, 8 sources, 0 exposures
2021-11-09 11:30:10.118735 (MainThread): 
2021-11-09 11:30:10.119228 (MainThread): Acquiring new postgres connection "master".
2021-11-09 11:30:10.121393 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbtdemo".
2021-11-09 11:30:10.132215 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 11:30:10.132430 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: BEGIN
2021-11-09 11:30:10.132607 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-11-09 11:30:11.600759 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.47 seconds
2021-11-09 11:30:11.601029 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbtdemo".
2021-11-09 11:30:11.601187 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbtdemo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbtdemo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbtdemo'
  
2021-11-09 11:30:11.616867 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.02 seconds
2021-11-09 11:30:11.618504 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: ROLLBACK
2021-11-09 11:30:11.619875 (ThreadPoolExecutor-1_0): On list_postgres_dbtdemo: Close
2021-11-09 11:30:11.620539 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2021-11-09 11:30:11.622690 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 11:30:11.622950 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2021-11-09 11:30:11.623218 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 11:30:12.882774 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:30:12.883088 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2021-11-09 11:30:12.883258 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-09 11:30:12.901485 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-11-09 11:30:12.903770 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2021-11-09 11:30:12.905783 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2021-11-09 11:30:12.906701 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:30:12.909369 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:30:12.909661 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: BEGIN
2021-11-09 11:30:12.909995 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-09 11:30:14.137978 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 1.23 seconds
2021-11-09 11:30:14.138201 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_test__audit".
2021-11-09 11:30:14.138329 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "list_postgres_dbt_test__audit"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_test__audit'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_test__audit'
  
2021-11-09 11:30:14.149176 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-11-09 11:30:14.150168 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: ROLLBACK
2021-11-09 11:30:14.151142 (ThreadPoolExecutor-1_0): On list_postgres_dbt_test__audit: Close
2021-11-09 11:30:14.157404 (MainThread): Using postgres connection "master".
2021-11-09 11:30:14.157575 (MainThread): On master: BEGIN
2021-11-09 11:30:14.157707 (MainThread): Opening a new connection, currently in state init
2021-11-09 11:30:15.413966 (MainThread): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:30:15.414164 (MainThread): Using postgres connection "master".
2021-11-09 11:30:15.414278 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-09 11:30:15.585642 (MainThread): SQL status: SELECT 5 in 0.17 seconds
2021-11-09 11:30:15.586995 (MainThread): On master: ROLLBACK
2021-11-09 11:30:15.588353 (MainThread): On master: Close
2021-11-09 11:30:15.588711 (MainThread): 17:00:15 | Concurrency: 1 threads (target='dev')
2021-11-09 11:30:15.588956 (MainThread): 17:00:15 | 
2021-11-09 11:30:15.591512 (Thread-1): Began running node test.dbt_demo_project.assert_total_payment_amount_is_positive
2021-11-09 11:30:15.591834 (Thread-1): 17:00:15 | 1 of 7 START test assert_total_payment_amount_is_positive............ [RUN]
2021-11-09 11:30:15.592221 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:30:15.592376 (Thread-1): Compiling test.dbt_demo_project.assert_total_payment_amount_is_positive
2021-11-09 11:30:15.593756 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.assert_total_payment_amount_is_positive"
2021-11-09 11:30:15.594514 (Thread-1): finished collecting timing info
2021-11-09 11:30:15.610044 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.assert_total_payment_amount_is_positive"
2021-11-09 11:30:15.610792 (Thread-1): Using postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:30:15.611101 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: BEGIN
2021-11-09 11:30:15.611305 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:16.864935 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-11-09 11:30:16.865390 (Thread-1): Using postgres connection "test.dbt_demo_project.assert_total_payment_amount_is_positive".
2021-11-09 11:30:16.865733 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.assert_total_payment_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select order_item_order_id,sum(order_item_subtotal) as total_amount 
	  from facts.order_items group by order_item_order_id
	  having not(sum(order_item_subtotal) >= 0)
      
    ) dbt_internal_test
2021-11-09 11:30:17.689853 (Thread-1): SQL status: SELECT 1 in 0.82 seconds
2021-11-09 11:30:17.692429 (Thread-1): finished collecting timing info
2021-11-09 11:30:17.692605 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: ROLLBACK
2021-11-09 11:30:17.694445 (Thread-1): On test.dbt_demo_project.assert_total_payment_amount_is_positive: Close
2021-11-09 11:30:17.694793 (Thread-1): 17:00:17 | 1 of 7 PASS assert_total_payment_amount_is_positive.................. [PASS in 2.10s]
2021-11-09 11:30:17.694991 (Thread-1): Finished running node test.dbt_demo_project.assert_total_payment_amount_is_positive
2021-11-09 11:30:17.695158 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:30:17.695534 (Thread-1): 17:00:17 | 2 of 7 START test is_not_empty_cust_count_by_state_.................. [RUN]
2021-11-09 11:30:17.695841 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:30:17.696017 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:30:17.702659 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-11-09 11:30:17.704103 (Thread-1): finished collecting timing info
2021-11-09 11:30:17.707116 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"
2021-11-09 11:30:17.707977 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:30:17.708288 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: BEGIN
2021-11-09 11:30:17.708550 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:19.025462 (Thread-1): SQL status: BEGIN in 1.32 seconds
2021-11-09 11:30:19.025666 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5".
2021-11-09 11:30:19.025785 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_count_by_state"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:30:19.029391 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:30:19.031288 (Thread-1): finished collecting timing info
2021-11-09 11:30:19.031525 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: ROLLBACK
2021-11-09 11:30:19.033160 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5: Close
2021-11-09 11:30:19.033680 (Thread-1): 17:00:19 | 2 of 7 PASS is_not_empty_cust_count_by_state_........................ [PASS in 1.34s]
2021-11-09 11:30:19.033945 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_count_by_state_.3d031667b5
2021-11-09 11:30:19.034279 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:30:19.034670 (Thread-1): 17:00:19 | 3 of 7 START test is_not_empty_cust_details_ord_counts_.............. [RUN]
2021-11-09 11:30:19.035079 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:30:19.035251 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:30:19.040709 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-11-09 11:30:19.041585 (Thread-1): finished collecting timing info
2021-11-09 11:30:19.044009 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"
2021-11-09 11:30:19.044954 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:30:19.045193 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: BEGIN
2021-11-09 11:30:19.045352 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:20.305744 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:30:20.306383 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466".
2021-11-09 11:30:20.306620 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."cust_details_ord_counts"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:30:20.418112 (Thread-1): SQL status: SELECT 1 in 0.11 seconds
2021-11-09 11:30:20.419479 (Thread-1): finished collecting timing info
2021-11-09 11:30:20.419753 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: ROLLBACK
2021-11-09 11:30:20.421602 (Thread-1): On test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466: Close
2021-11-09 11:30:20.422285 (Thread-1): 17:00:20 | 3 of 7 PASS is_not_empty_cust_details_ord_counts_.................... [PASS in 1.39s]
2021-11-09 11:30:20.422576 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_cust_details_ord_counts_.14d8768466
2021-11-09 11:30:20.422952 (Thread-1): Began running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:30:20.423288 (Thread-1): 17:00:20 | 4 of 7 START test is_not_empty_orders_count_by_cust_................. [RUN]
2021-11-09 11:30:20.423735 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:30:20.423954 (Thread-1): Compiling test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:30:20.430691 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-11-09 11:30:20.432507 (Thread-1): finished collecting timing info
2021-11-09 11:30:20.435168 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"
2021-11-09 11:30:20.436083 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:30:20.436280 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: BEGIN
2021-11-09 11:30:20.436461 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:21.688059 (Thread-1): SQL status: BEGIN in 1.25 seconds
2021-11-09 11:30:21.688404 (Thread-1): Using postgres connection "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289".
2021-11-09 11:30:21.688666 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation(rw) as (

    select case when count(*)=0 then 1 else 0 end
    from "postgres"."dbtdemo"."orders_count_by_cust"

)

select *
from validation where rw=1


      
    ) dbt_internal_test
2021-11-09 11:30:21.763996 (Thread-1): SQL status: SELECT 1 in 0.08 seconds
2021-11-09 11:30:21.765179 (Thread-1): finished collecting timing info
2021-11-09 11:30:21.765341 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: ROLLBACK
2021-11-09 11:30:21.766580 (Thread-1): On test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289: Close
2021-11-09 11:30:21.767015 (Thread-1): 17:00:21 | 4 of 7 PASS is_not_empty_orders_count_by_cust_....................... [PASS in 1.34s]
2021-11-09 11:30:21.767177 (Thread-1): Finished running node test.dbt_demo_project.is_not_empty_orders_count_by_cust_.b759a96289
2021-11-09 11:30:21.767409 (Thread-1): Began running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:30:21.767629 (Thread-1): 17:00:21 | 5 of 7 START test is_usa_cust_details_ord_counts_cntry............... [RUN]
2021-11-09 11:30:21.767922 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:30:21.768054 (Thread-1): Compiling test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:30:21.775033 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-11-09 11:30:21.776056 (Thread-1): finished collecting timing info
2021-11-09 11:30:21.778288 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"
2021-11-09 11:30:21.779318 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:30:21.779516 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: BEGIN
2021-11-09 11:30:21.779707 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:23.037766 (Thread-1): SQL status: BEGIN in 1.26 seconds
2021-11-09 11:30:23.038088 (Thread-1): Using postgres connection "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a".
2021-11-09 11:30:23.038350 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select * from "postgres"."dbtdemo"."cust_details_ord_counts" where cntry != 'USA'


      
    ) dbt_internal_test
2021-11-09 11:30:23.049578 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-11-09 11:30:23.051252 (Thread-1): finished collecting timing info
2021-11-09 11:30:23.051474 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: ROLLBACK
2021-11-09 11:30:23.052976 (Thread-1): On test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a: Close
2021-11-09 11:30:23.053409 (Thread-1): 17:00:23 | 5 of 7 PASS is_usa_cust_details_ord_counts_cntry..................... [PASS in 1.29s]
2021-11-09 11:30:23.053609 (Thread-1): Finished running node test.dbt_demo_project.is_usa_cust_details_ord_counts_cntry.062143592a
2021-11-09 11:30:23.053823 (Thread-1): Began running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:30:23.054229 (Thread-1): 17:00:23 | 6 of 7 START test not_null_cust_count_by_state_CUSTOMER_STATE........ [RUN]
2021-11-09 11:30:23.054572 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:30:23.054740 (Thread-1): Compiling test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:30:23.063536 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-11-09 11:30:23.064349 (Thread-1): finished collecting timing info
2021-11-09 11:30:23.066918 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"
2021-11-09 11:30:23.067707 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:30:23.067956 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: BEGIN
2021-11-09 11:30:23.068162 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:24.266020 (Thread-1): SQL status: BEGIN in 1.20 seconds
2021-11-09 11:30:24.266323 (Thread-1): Using postgres connection "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245".
2021-11-09 11:30:24.266450 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is null



      
    ) dbt_internal_test
2021-11-09 11:30:24.270291 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:30:24.272576 (Thread-1): finished collecting timing info
2021-11-09 11:30:24.272893 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: ROLLBACK
2021-11-09 11:30:24.274434 (Thread-1): On test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245: Close
2021-11-09 11:30:24.274993 (Thread-1): 17:00:24 | 6 of 7 PASS not_null_cust_count_by_state_CUSTOMER_STATE.............. [PASS in 1.22s]
2021-11-09 11:30:24.275279 (Thread-1): Finished running node test.dbt_demo_project.not_null_cust_count_by_state_CUSTOMER_STATE.bdf92e6245
2021-11-09 11:30:24.275538 (Thread-1): Began running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:30:24.275917 (Thread-1): 17:00:24 | 7 of 7 START test unique_cust_count_by_state_CUSTOMER_STATE.......... [RUN]
2021-11-09 11:30:24.276398 (Thread-1): Acquiring new postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:30:24.276728 (Thread-1): Compiling test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:30:24.288174 (Thread-1): Writing injected SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-11-09 11:30:24.288963 (Thread-1): finished collecting timing info
2021-11-09 11:30:24.291380 (Thread-1): Writing runtime SQL for node "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"
2021-11-09 11:30:24.292369 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:30:24.292546 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: BEGIN
2021-11-09 11:30:24.292780 (Thread-1): Opening a new connection, currently in state closed
2021-11-09 11:30:25.532581 (Thread-1): SQL status: BEGIN in 1.24 seconds
2021-11-09 11:30:25.532783 (Thread-1): Using postgres connection "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455".
2021-11-09 11:30:25.532898 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: /* {"app": "dbt", "dbt_version": "0.21.0b1", "profile_name": "postgres-db", "target_name": "dev", "node_id": "test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_STATE,
    count(*) as n_records

from "postgres"."dbtdemo"."cust_count_by_state"
where CUSTOMER_STATE is not null
group by CUSTOMER_STATE
having count(*) > 1



      
    ) dbt_internal_test
2021-11-09 11:30:25.536017 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-11-09 11:30:25.537146 (Thread-1): finished collecting timing info
2021-11-09 11:30:25.537315 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: ROLLBACK
2021-11-09 11:30:25.538446 (Thread-1): On test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455: Close
2021-11-09 11:30:25.538794 (Thread-1): 17:00:25 | 7 of 7 PASS unique_cust_count_by_state_CUSTOMER_STATE................ [PASS in 1.26s]
2021-11-09 11:30:25.538978 (Thread-1): Finished running node test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455
2021-11-09 11:30:25.540179 (MainThread): Acquiring new postgres connection "master".
2021-11-09 11:30:25.540487 (MainThread): 17:00:25 | 
2021-11-09 11:30:25.540637 (MainThread): 17:00:25 | Finished running 7 tests in 15.42s.
2021-11-09 11:30:25.540817 (MainThread): Connection 'master' was properly closed.
2021-11-09 11:30:25.540997 (MainThread): Connection 'test.dbt_demo_project.unique_cust_count_by_state_CUSTOMER_STATE.3fd6626455' was properly closed.
2021-11-09 11:30:25.550740 (MainThread): 
2021-11-09 11:30:25.550954 (MainThread): Completed successfully
2021-11-09 11:30:25.551151 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-09 11:30:25.551461 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30f26a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30e8f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf30e8f430>]}
2021-11-09 11:30:25.551719 (MainThread): Flushing usage events
